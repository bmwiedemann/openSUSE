From 664ceac73d76b6b3760557b2ba080296b8c840a6 Mon Sep 17 00:00:00 2001
From: Ferdinand Thiessen <rpm@fthiessen.de>
Date: Thu, 3 Mar 2022 18:22:31 +0100
Subject: [PATCH 3/4] build: Fix ovs include paths

---
 controller-vtep/binding.c             |  6 ++--
 controller-vtep/gateway.c             |  8 +++---
 controller-vtep/ovn-controller-vtep.c | 22 +++++++--------
 controller-vtep/vtep.c                | 12 ++++----
 controller/bfd.c                      |  8 +++---
 controller/binding.c                  | 10 +++----
 controller/binding.h                  |  2 +-
 controller/chassis.c                  |  8 +++---
 controller/encaps.c                   |  8 +++---
 controller/ha-chassis.c               |  2 +-
 controller/if-status.c                |  6 ++--
 controller/ip-mcast.h                 |  2 +-
 controller/lflow-cache.c              |  4 +--
 controller/lflow-cache.h              |  2 +-
 controller/lflow.c                    | 10 +++----
 controller/local_data.c               | 10 +++----
 controller/local_data.h               |  6 ++--
 controller/lport.c                    |  4 +--
 controller/mac-learn.c                |  4 +--
 controller/ofctrl-seqno.c             |  4 +--
 controller/ofctrl.c                   | 20 +++++++-------
 controller/ofctrl.h                   |  2 +-
 controller/ovn-controller.c           | 40 +++++++++++++--------------
 controller/ovn-controller.h           |  2 +-
 controller/patch.c                    |  6 ++--
 controller/physical.c                 | 22 +++++++--------
 controller/pinctrl.c                  | 32 ++++++++++-----------
 controller/pinctrl.h                  |  2 +-
 controller/test-lflow-cache.c         |  4 +--
 controller/test-ofctrl-seqno.c        |  4 +--
 ic/ovn-ic.c                           | 30 ++++++++++----------
 include/ovn/actions.h                 |  2 +-
 include/ovn/expr.h                    |  2 +-
 include/ovn/features.h                |  2 +-
 lib/acl-log.c                         |  2 +-
 lib/actions.c                         | 18 ++++++------
 lib/copp.c                            |  4 +--
 lib/expr.c                            | 10 +++----
 lib/extend-table.c                    |  6 ++--
 lib/features.c                        |  8 +++---
 lib/inc-proc-eng.c                    |  6 ++--
 lib/lb.c                              |  2 +-
 lib/lb.h                              |  2 +-
 lib/lex.c                             |  4 +--
 lib/logical-fields.c                  |  4 +--
 lib/ovn-dirs.c.in                     |  4 +--
 lib/ovn-l7.h                          |  6 ++--
 lib/ovn-parallel-hmap.c               |  8 +++---
 lib/ovn-util.c                        |  8 +++---
 lib/ovn-util.h                        |  2 +-
 northd/ipam.c                         |  6 ++--
 northd/northd.c                       | 32 ++++++++++-----------
 northd/ovn-northd-ddlog.c             | 26 ++++++++---------
 northd/ovn-northd.c                   | 20 +++++++-------
 northd/ovn.rs                         |  2 +-
 northd/test-ipam.c                    |  6 ++--
 tests/ovstest.c                       |  4 +--
 tests/ovstest.h                       |  2 +-
 tests/test-ovn.c                      | 14 +++++-----
 tests/test-utils.c                    |  2 +-
 utilities/ovn-appctl.c                | 14 +++++-----
 utilities/ovn-dbctl.c                 | 28 +++++++++----------
 utilities/ovn-ic-nbctl.c              | 24 ++++++++--------
 utilities/ovn-ic-sbctl.c              | 22 +++++++--------
 utilities/ovn-nbctl.c                 | 40 +++++++++++++--------------
 utilities/ovn-sbctl.c                 | 38 ++++++++++++-------------
 utilities/ovn-trace.c                 | 22 +++++++--------
 67 files changed, 352 insertions(+), 352 deletions(-)

diff --git a/controller-vtep/binding.c b/controller-vtep/binding.c
index 01d5a16d2..4f042cb4a 100644
--- a/controller-vtep/binding.c
+++ b/controller-vtep/binding.c
@@ -17,12 +17,12 @@
 #include "binding.h"
 
 #include "openvswitch/shash.h"
-#include "lib/smap.h"
-#include "lib/util.h"
+#include "internal/smap.h"
+#include "internal/util.h"
 #include "openvswitch/vlog.h"
 #include "ovn-controller-vtep.h"
 #include "lib/ovn-sb-idl.h"
-#include "vtep/vtep-idl.h"
+#include "internal/vtep-idl.h"
 
 VLOG_DEFINE_THIS_MODULE(binding);
 
diff --git a/controller-vtep/gateway.c b/controller-vtep/gateway.c
index 288772dc4..e4f4999e9 100644
--- a/controller-vtep/gateway.c
+++ b/controller-vtep/gateway.c
@@ -17,12 +17,12 @@
 #include "gateway.h"
 
 #include "openvswitch/poll-loop.h"
-#include "lib/simap.h"
-#include "lib/sset.h"
-#include "lib/util.h"
+#include "internal/simap.h"
+#include "internal/sset.h"
+#include "internal/util.h"
 #include "openvswitch/vlog.h"
 #include "lib/ovn-sb-idl.h"
-#include "vtep/vtep-idl.h"
+#include "internal/vtep-idl.h"
 #include "ovn-controller-vtep.h"
 
 VLOG_DEFINE_THIS_MODULE(gateway);
diff --git a/controller-vtep/ovn-controller-vtep.c b/controller-vtep/ovn-controller-vtep.c
index 1d35c7f04..c3c2dbcc9 100644
--- a/controller-vtep/ovn-controller-vtep.c
+++ b/controller-vtep/ovn-controller-vtep.c
@@ -21,24 +21,24 @@
 #include <stdlib.h>
 #include <string.h>
 
-#include "command-line.h"
+#include "internal/command-line.h"
 #include "compiler.h"
-#include "daemon.h"
-#include "dirs.h"
-#include "memory.h"
+#include "internal/daemon.h"
+#include "internal/dirs.h"
+#include "internal/memory.h"
 #include "openvswitch/dynamic-string.h"
-#include "fatal-signal.h"
+#include "internal/fatal-signal.h"
 #include "openvswitch/poll-loop.h"
-#include "simap.h"
-#include "stream.h"
-#include "stream-ssl.h"
-#include "unixctl.h"
-#include "util.h"
+#include "internal/simap.h"
+#include "internal/stream.h"
+#include "internal/stream-ssl.h"
+#include "internal/unixctl.h"
+#include "internal/util.h"
 #include "openvswitch/vconn.h"
 #include "openvswitch/vlog.h"
 #include "lib/ovn-sb-idl.h"
 #include "lib/ovn-util.h"
-#include "vtep/vtep-idl.h"
+#include "internal/vtep-idl.h"
 
 #include "binding.h"
 #include "gateway.h"
diff --git a/controller-vtep/vtep.c b/controller-vtep/vtep.c
index ecca00b54..33035a180 100644
--- a/controller-vtep/vtep.c
+++ b/controller-vtep/vtep.c
@@ -17,18 +17,18 @@
 
 #include "vtep.h"
 
-#include "lib/hash.h"
-#include "lib/hmapx.h"
+#include "internal/hash.h"
+#include "internal/hmapx.h"
 #include "openvswitch/hmap.h"
 #include "openvswitch/shash.h"
 #include "lib/ovn-util.h"
-#include "lib/smap.h"
-#include "lib/sset.h"
-#include "lib/util.h"
+#include "internal/smap.h"
+#include "internal/sset.h"
+#include "internal/util.h"
 #include "ovn-controller-vtep.h"
 #include "openvswitch/vlog.h"
 #include "lib/ovn-sb-idl.h"
-#include "vtep/vtep-idl.h"
+#include "internal/vtep-idl.h"
 
 VLOG_DEFINE_THIS_MODULE(vtep);
 
diff --git a/controller/bfd.c b/controller/bfd.c
index cf011e382..c66beaf61 100644
--- a/controller/bfd.c
+++ b/controller/bfd.c
@@ -18,10 +18,10 @@
 #include "encaps.h"
 #include "lport.h"
 
-#include "lib/hash.h"
-#include "lib/sset.h"
-#include "lib/util.h"
-#include "lib/vswitch-idl.h"
+#include "internal/hash.h"
+#include "internal/sset.h"
+#include "internal/util.h"
+#include "internal/vswitch-idl.h"
 #include "openvswitch/vlog.h"
 #include "lib/ovn-sb-idl.h"
 #include "ovn-controller.h"
diff --git a/controller/binding.c b/controller/binding.c
index c037b2352..40c333e3d 100644
--- a/controller/binding.c
+++ b/controller/binding.c
@@ -16,12 +16,12 @@
 #include <config.h>
 
 /* OVS includes. */
-#include "lib/bitmap.h"
+#include "internal/bitmap.h"
 #include "openvswitch/poll-loop.h"
-#include "lib/sset.h"
-#include "lib/util.h"
-#include "lib/netdev.h"
-#include "lib/vswitch-idl.h"
+#include "internal/sset.h"
+#include "internal/util.h"
+#include "internal/netdev.h"
+#include "internal/vswitch-idl.h"
 #include "openvswitch/hmap.h"
 #include "openvswitch/vlog.h"
 
diff --git a/controller/binding.h b/controller/binding.h
index 70cc37c78..3f0742ac7 100644
--- a/controller/binding.h
+++ b/controller/binding.h
@@ -22,7 +22,7 @@
 #include "openvswitch/hmap.h"
 #include "openvswitch/uuid.h"
 #include "openvswitch/list.h"
-#include "sset.h"
+#include "internal/sset.h"
 
 struct hmap;
 struct ovsdb_idl;
diff --git a/controller/chassis.c b/controller/chassis.c
index c11c10a34..b9350214c 100644
--- a/controller/chassis.c
+++ b/controller/chassis.c
@@ -18,16 +18,16 @@
 
 #include "chassis.h"
 
-#include "lib/smap.h"
-#include "lib/sset.h"
-#include "lib/vswitch-idl.h"
+#include "internal/smap.h"
+#include "internal/sset.h"
+#include "internal/vswitch-idl.h"
 #include "openvswitch/dynamic-string.h"
 #include "openvswitch/vlog.h"
 #include "openvswitch/ofp-parse.h"
 #include "lib/chassis-index.h"
 #include "lib/ovn-sb-idl.h"
 #include "ovn-controller.h"
-#include "lib/util.h"
+#include "internal/util.h"
 #include "ovn/features.h"
 
 VLOG_DEFINE_THIS_MODULE(chassis);
diff --git a/controller/encaps.c b/controller/encaps.c
index 823870979..9e1f472b1 100644
--- a/controller/encaps.c
+++ b/controller/encaps.c
@@ -16,10 +16,10 @@
 #include <config.h>
 #include "encaps.h"
 
-#include "lib/hash.h"
-#include "lib/sset.h"
-#include "lib/util.h"
-#include "lib/vswitch-idl.h"
+#include "internal/hash.h"
+#include "internal/sset.h"
+#include "internal/util.h"
+#include "internal/vswitch-idl.h"
 #include "openvswitch/vlog.h"
 #include "lib/ovn-sb-idl.h"
 #include "ovn-controller.h"
diff --git a/controller/ha-chassis.c b/controller/ha-chassis.c
index d6ec7b658..f0ffe86f9 100644
--- a/controller/ha-chassis.c
+++ b/controller/ha-chassis.c
@@ -16,7 +16,7 @@
 #include <config.h>
 
 #include "ha-chassis.h"
-#include "lib/sset.h"
+#include "internal/sset.h"
 #include "openvswitch/vlog.h"
 #include "lib/ovn-sb-idl.h"
 
diff --git a/controller/if-status.c b/controller/if-status.c
index b5a4025fc..ebfda96ab 100644
--- a/controller/if-status.c
+++ b/controller/if-status.c
@@ -19,9 +19,9 @@
 #include "if-status.h"
 #include "ofctrl-seqno.h"
 
-#include "lib/hmapx.h"
-#include "lib/util.h"
-#include "timeval.h"
+#include "internal/hmapx.h"
+#include "internal/util.h"
+#include "internal/timeval.h"
 #include "openvswitch/vlog.h"
 
 VLOG_DEFINE_THIS_MODULE(if_status);
diff --git a/controller/ip-mcast.h b/controller/ip-mcast.h
index b3447d4c7..a2e75ada7 100644
--- a/controller/ip-mcast.h
+++ b/controller/ip-mcast.h
@@ -16,7 +16,7 @@
 #ifndef OVN_IP_MCAST_H
 #define OVN_IP_MCAST_H 1
 
-#include "mcast-snooping.h"
+#include "internal/mcast-snooping.h"
 
 struct ovsdb_idl;
 struct ovsdb_idl_txn;
diff --git a/controller/lflow-cache.c b/controller/lflow-cache.c
index ece39dbf0..552c062e3 100644
--- a/controller/lflow-cache.c
+++ b/controller/lflow-cache.c
@@ -21,9 +21,9 @@
 #include <malloc.h>
 #endif
 
-#include "coverage.h"
+#include "internal/coverage.h"
 #include "lflow-cache.h"
-#include "lib/uuid.h"
+#include "internal/uuid.h"
 #include "openvswitch/vlog.h"
 #include "ovn/expr.h"
 
diff --git a/controller/lflow-cache.h b/controller/lflow-cache.h
index 6166fa7c5..ed737adef 100644
--- a/controller/lflow-cache.h
+++ b/controller/lflow-cache.h
@@ -21,7 +21,7 @@
 #include "openvswitch/dynamic-string.h"
 #include "openvswitch/hmap.h"
 #include "openvswitch/uuid.h"
-#include "simap.h"
+#include "internal/simap.h"
 
 struct lflow_cache;
 
diff --git a/controller/lflow.c b/controller/lflow.c
index 923d8f0a4..11a15c5dd 100644
--- a/controller/lflow.c
+++ b/controller/lflow.c
@@ -15,9 +15,9 @@
 
 #include <config.h>
 #include "lflow.h"
-#include "coverage.h"
+#include "internal/coverage.h"
 #include "ha-chassis.h"
-#include "lib/id-pool.h"
+#include "internal/id-pool.h"
 #include "lflow-cache.h"
 #include "local_data.h"
 #include "lport.h"
@@ -33,10 +33,10 @@
 #include "lib/ovn-l7.h"
 #include "lib/ovn-sb-idl.h"
 #include "lib/extend-table.h"
-#include "packets.h"
+#include "internal/packets.h"
 #include "physical.h"
-#include "simap.h"
-#include "sset.h"
+#include "internal/simap.h"
+#include "internal/sset.h"
 
 VLOG_DEFINE_THIS_MODULE(lflow);
 
diff --git a/controller/local_data.c b/controller/local_data.c
index 6efed2de0..416e744c1 100644
--- a/controller/local_data.c
+++ b/controller/local_data.c
@@ -16,11 +16,11 @@
 #include <config.h>
 
 /* OVS includes. */
-#include "include/openvswitch/json.h"
-#include "lib/hmapx.h"
-#include "lib/flow.h"
-#include "lib/util.h"
-#include "lib/vswitch-idl.h"
+#include "openvswitch/json.h"
+#include "internal/hmapx.h"
+#include "internal/flow.h"
+#include "internal/util.h"
+#include "internal/vswitch-idl.h"
 #include "openvswitch/vlog.h"
 
 /* OVN includes. */
diff --git a/controller/local_data.h b/controller/local_data.h
index f6317e9ca..9c5e96b5a 100644
--- a/controller/local_data.h
+++ b/controller/local_data.h
@@ -17,9 +17,9 @@
 #define LOCAL_DATA_H 1
 
 /* OVS includes. */
-#include "include/openvswitch/shash.h"
-#include "lib/smap.h"
-#include "lib/simap.h"
+#include "openvswitch/shash.h"
+#include "internal/smap.h"
+#include "internal/simap.h"
 
 struct sbrec_datapath_binding;
 struct sbrec_port_binding;
diff --git a/controller/lport.c b/controller/lport.c
index 25b4ef200..b8cb045b2 100644
--- a/controller/lport.c
+++ b/controller/lport.c
@@ -15,10 +15,10 @@
 
 #include <config.h>
 
-#include "lib/sset.h"
+#include "internal/sset.h"
 #include "lport.h"
 #include "ha-chassis.h"
-#include "hash.h"
+#include "internal/hash.h"
 #include "openvswitch/vlog.h"
 #include "lib/ovn-sb-idl.h"
 VLOG_DEFINE_THIS_MODULE(lport);
diff --git a/controller/mac-learn.c b/controller/mac-learn.c
index 27634dca8..e301149b1 100644
--- a/controller/mac-learn.c
+++ b/controller/mac-learn.c
@@ -19,8 +19,8 @@
 
 /* OpenvSwitch lib includes. */
 #include "openvswitch/vlog.h"
-#include "lib/packets.h"
-#include "lib/smap.h"
+#include "internal/packets.h"
+#include "internal/smap.h"
 
 VLOG_DEFINE_THIS_MODULE(mac_learn);
 
diff --git a/controller/ofctrl-seqno.c b/controller/ofctrl-seqno.c
index c9334b078..3cb27f04a 100644
--- a/controller/ofctrl-seqno.c
+++ b/controller/ofctrl-seqno.c
@@ -15,10 +15,10 @@
 
 #include <config.h>
 
-#include "hash.h"
+#include "internal/hash.h"
 #include "ofctrl-seqno.h"
 #include "openvswitch/list.h"
-#include "util.h"
+#include "internal/util.h"
 
 /* A sequence number update request, i.e., when the barrier corresponding to
  * the 'flow_cfg' sequence number is replied to by OVS then it is safe
diff --git a/controller/ofctrl.c b/controller/ofctrl.c
index 08fcfed8b..f4d71ac3c 100644
--- a/controller/ofctrl.c
+++ b/controller/ofctrl.c
@@ -14,13 +14,13 @@
  */
 
 #include <config.h>
-#include "bitmap.h"
-#include "byte-order.h"
-#include "dirs.h"
-#include "dp-packet.h"
-#include "flow.h"
-#include "hash.h"
-#include "hindex.h"
+#include "internal/bitmap.h"
+#include "internal/byte-order.h"
+#include "internal/dirs.h"
+#include "internal/dp-packet.h"
+#include "internal/flow.h"
+#include "internal/hash.h"
+#include "internal/hindex.h"
 #include "lflow.h"
 #include "ofctrl.h"
 #include "openflow/openflow.h"
@@ -46,9 +46,9 @@
 #include "openvswitch/poll-loop.h"
 #include "physical.h"
 #include "openvswitch/rconn.h"
-#include "socket-util.h"
-#include "util.h"
-#include "vswitch-idl.h"
+#include "internal/socket-util.h"
+#include "internal/util.h"
+#include "internal/vswitch-idl.h"
 
 VLOG_DEFINE_THIS_MODULE(ofctrl);
 
diff --git a/controller/ofctrl.h b/controller/ofctrl.h
index 014de210d..76ad0153f 100644
--- a/controller/ofctrl.h
+++ b/controller/ofctrl.h
@@ -21,7 +21,7 @@
 
 #include "openvswitch/meta-flow.h"
 #include "ovsdb-idl.h"
-#include "hindex.h"
+#include "internal/hindex.h"
 
 struct ovn_extend_table;
 struct hmap;
diff --git a/controller/ovn-controller.c b/controller/ovn-controller.c
index 4b90806ff..6b6ce8818 100644
--- a/controller/ovn-controller.c
+++ b/controller/ovn-controller.c
@@ -26,23 +26,23 @@
 #include "bfd.h"
 #include "binding.h"
 #include "chassis.h"
-#include "command-line.h"
+#include "internal/command-line.h"
 #include "compiler.h"
-#include "daemon.h"
-#include "dirs.h"
+#include "internal/daemon.h"
+#include "internal/dirs.h"
 #include "openvswitch/dynamic-string.h"
 #include "encaps.h"
-#include "fatal-signal.h"
-#include "lib/id-pool.h"
+#include "internal/fatal-signal.h"
+#include "internal/id-pool.h"
 #include "if-status.h"
 #include "ip-mcast.h"
 #include "openvswitch/hmap.h"
 #include "lflow.h"
 #include "lflow-cache.h"
-#include "lib/vswitch-idl.h"
+#include "internal/vswitch-idl.h"
 #include "local_data.h"
 #include "lport.h"
-#include "memory.h"
+#include "internal/memory.h"
 #include "ofctrl.h"
 #include "ofctrl-seqno.h"
 #include "openvswitch/vconn.h"
@@ -59,20 +59,20 @@
 #include "physical.h"
 #include "pinctrl.h"
 #include "openvswitch/poll-loop.h"
-#include "lib/bitmap.h"
-#include "lib/hash.h"
-#include "simap.h"
-#include "smap.h"
-#include "sset.h"
-#include "stream-ssl.h"
-#include "stream.h"
-#include "unixctl.h"
-#include "util.h"
-#include "timeval.h"
-#include "timer.h"
-#include "stopwatch.h"
+#include "internal/bitmap.h"
+#include "internal/hash.h"
+#include "internal/simap.h"
+#include "internal/smap.h"
+#include "internal/sset.h"
+#include "internal/stream-ssl.h"
+#include "internal/stream.h"
+#include "internal/unixctl.h"
+#include "internal/util.h"
+#include "internal/timeval.h"
+#include "internal/timer.h"
+#include "internal/stopwatch.h"
 #include "lib/inc-proc-eng.h"
-#include "hmapx.h"
+#include "internal/hmapx.h"
 
 VLOG_DEFINE_THIS_MODULE(main);
 
diff --git a/controller/ovn-controller.h b/controller/ovn-controller.h
index df28c62cb..4adb6f1d2 100644
--- a/controller/ovn-controller.h
+++ b/controller/ovn-controller.h
@@ -17,7 +17,7 @@
 #ifndef OVN_CONTROLLER_H
 #define OVN_CONTROLLER_H 1
 
-#include "simap.h"
+#include "internal/simap.h"
 #include "lib/ovn-sb-idl.h"
 
 struct ovsrec_bridge_table;
diff --git a/controller/patch.c b/controller/patch.c
index a661025da..66d1abd90 100644
--- a/controller/patch.c
+++ b/controller/patch.c
@@ -17,15 +17,15 @@
 
 #include "patch.h"
 
-#include "hash.h"
+#include "internal/hash.h"
 #include "lflow.h"
-#include "lib/vswitch-idl.h"
+#include "internal/vswitch-idl.h"
 #include "local_data.h"
 #include "lport.h"
 #include "openvswitch/hmap.h"
 #include "openvswitch/vlog.h"
 #include "ovn-controller.h"
-#include "sset.h"
+#include "internal/sset.h"
 
 VLOG_DEFINE_THIS_MODULE(patch);
 
diff --git a/controller/physical.c b/controller/physical.c
index 35e726ee6..5fb00114c 100644
--- a/controller/physical.c
+++ b/controller/physical.c
@@ -15,18 +15,18 @@
 
 #include <config.h>
 #include "binding.h"
-#include "coverage.h"
-#include "byte-order.h"
+#include "internal/coverage.h"
+#include "internal/byte-order.h"
 #include "encaps.h"
-#include "flow.h"
+#include "internal/flow.h"
 #include "ha-chassis.h"
 #include "lflow.h"
 #include "local_data.h"
 #include "lport.h"
 #include "chassis.h"
-#include "lib/bundle.h"
+#include "internal/bundle.h"
 #include "openvswitch/poll-loop.h"
-#include "lib/uuid.h"
+#include "internal/uuid.h"
 #include "ofctrl.h"
 #include "openvswitch/list.h"
 #include "openvswitch/hmap.h"
@@ -42,12 +42,12 @@
 #include "lib/ovn-util.h"
 #include "physical.h"
 #include "openvswitch/shash.h"
-#include "simap.h"
-#include "smap.h"
-#include "sset.h"
-#include "util.h"
-#include "vswitch-idl.h"
-#include "hmapx.h"
+#include "internal/simap.h"
+#include "internal/smap.h"
+#include "internal/sset.h"
+#include "internal/util.h"
+#include "internal/vswitch-idl.h"
+#include "internal/hmapx.h"
 
 VLOG_DEFINE_THIS_MODULE(physical);
 
diff --git a/controller/pinctrl.c b/controller/pinctrl.c
index 19ef5fa2a..a66fcec39 100644
--- a/controller/pinctrl.c
+++ b/controller/pinctrl.c
@@ -18,20 +18,20 @@
 
 #include "pinctrl.h"
 
-#include "coverage.h"
-#include "csum.h"
-#include "dirs.h"
-#include "dp-packet.h"
+#include "internal/coverage.h"
+#include "internal/csum.h"
+#include "internal/dirs.h"
+#include "internal/dp-packet.h"
 #include "encaps.h"
-#include "flow.h"
+#include "internal/flow.h"
 #include "ha-chassis.h"
 #include "local_data.h"
 #include "lport.h"
 #include "mac-learn.h"
-#include "nx-match.h"
-#include "latch.h"
-#include "lib/packets.h"
-#include "lib/sset.h"
+#include "internal/nx-match.h"
+#include "internal/latch.h"
+#include "internal/packets.h"
+#include "internal/sset.h"
 #include "openvswitch/ofp-actions.h"
 #include "openvswitch/ofp-msgs.h"
 #include "openvswitch/ofp-packet.h"
@@ -39,10 +39,10 @@
 #include "openvswitch/ofp-switch.h"
 #include "openvswitch/ofp-util.h"
 #include "openvswitch/vlog.h"
-#include "lib/random.h"
-#include "lib/crc32c.h"
+#include "internal/random.h"
+#include "internal/crc32c.h"
 
-#include "lib/dhcp.h"
+#include "internal/dhcp.h"
 #include "ovn-controller.h"
 #include "ovn/actions.h"
 #include "ovn/lex.h"
@@ -54,10 +54,10 @@
 #include "ovn/logical-fields.h"
 #include "openvswitch/poll-loop.h"
 #include "openvswitch/rconn.h"
-#include "socket-util.h"
-#include "seq.h"
-#include "timeval.h"
-#include "vswitch-idl.h"
+#include "internal/socket-util.h"
+#include "internal/seq.h"
+#include "internal/timeval.h"
+#include "internal/vswitch-idl.h"
 #include "lflow.h"
 #include "ip-mcast.h"
 
diff --git a/controller/pinctrl.h b/controller/pinctrl.h
index 88f18e983..564476df7 100644
--- a/controller/pinctrl.h
+++ b/controller/pinctrl.h
@@ -19,7 +19,7 @@
 
 #include <stdint.h>
 
-#include "lib/sset.h"
+#include "internal/sset.h"
 #include "openvswitch/meta-flow.h"
 
 struct hmap;
diff --git a/controller/test-lflow-cache.c b/controller/test-lflow-cache.c
index b46b1f743..31d6e5f62 100644
--- a/controller/test-lflow-cache.c
+++ b/controller/test-lflow-cache.c
@@ -15,11 +15,11 @@
 
 #include <config.h>
 
-#include "lib/uuid.h"
+#include "internal/uuid.h"
 #include "ovn/expr.h"
 #include "tests/ovstest.h"
 #include "tests/test-utils.h"
-#include "util.h"
+#include "internal/util.h"
 
 #include "lflow-cache.h"
 
diff --git a/controller/test-ofctrl-seqno.c b/controller/test-ofctrl-seqno.c
index b96da9d2f..86995d147 100644
--- a/controller/test-ofctrl-seqno.c
+++ b/controller/test-ofctrl-seqno.c
@@ -17,8 +17,8 @@
 
 #include "tests/ovstest.h"
 #include "tests/test-utils.h"
-#include "sort.h"
-#include "util.h"
+#include "internal/sort.h"
+#include "internal/util.h"
 
 #include "ofctrl-seqno.h"
 
diff --git a/ic/ovn-ic.c b/ic/ovn-ic.c
index 99356253d..be3e188a4 100644
--- a/ic/ovn-ic.c
+++ b/ic/ovn-ic.c
@@ -20,29 +20,29 @@
 #include <stdlib.h>
 #include <stdio.h>
 
-#include "bitmap.h"
-#include "command-line.h"
-#include "daemon.h"
-#include "dirs.h"
+#include "internal/bitmap.h"
+#include "internal/command-line.h"
+#include "internal/daemon.h"
+#include "internal/dirs.h"
 #include "openvswitch/dynamic-string.h"
-#include "fatal-signal.h"
-#include "hash.h"
+#include "internal/fatal-signal.h"
+#include "internal/hash.h"
 #include "openvswitch/hmap.h"
 #include "lib/ovn-ic-nb-idl.h"
 #include "lib/ovn-ic-sb-idl.h"
 #include "lib/ovn-nb-idl.h"
 #include "lib/ovn-sb-idl.h"
 #include "lib/ovn-util.h"
-#include "memory.h"
+#include "internal/memory.h"
 #include "openvswitch/poll-loop.h"
-#include "simap.h"
-#include "smap.h"
-#include "sset.h"
-#include "stream.h"
-#include "stream-ssl.h"
-#include "unixctl.h"
-#include "util.h"
-#include "uuid.h"
+#include "internal/simap.h"
+#include "internal/smap.h"
+#include "internal/sset.h"
+#include "internal/stream.h"
+#include "internal/stream-ssl.h"
+#include "internal/unixctl.h"
+#include "internal/util.h"
+#include "internal/uuid.h"
 #include "openvswitch/vlog.h"
 
 VLOG_DEFINE_THIS_MODULE(ovn_ic);
diff --git a/include/ovn/actions.h b/include/ovn/actions.h
index f023a37b9..02dd3228d 100644
--- a/include/ovn/actions.h
+++ b/include/ovn/actions.h
@@ -24,7 +24,7 @@
 #include "openvswitch/dynamic-string.h"
 #include "openvswitch/hmap.h"
 #include "openvswitch/uuid.h"
-#include "util.h"
+#include "internal/util.h"
 #include "ovn/features.h"
 
 struct expr;
diff --git a/include/ovn/expr.h b/include/ovn/expr.h
index 3b5653f7b..addfc36db 100644
--- a/include/ovn/expr.h
+++ b/include/ovn/expr.h
@@ -52,7 +52,7 @@
  *      x > a && x < b.
  */
 
-#include "classifier.h"
+#include "internal/classifier.h"
 #include "lex.h"
 #include "openvswitch/hmap.h"
 #include "openvswitch/list.h"
diff --git a/include/ovn/features.h b/include/ovn/features.h
index d12a8eb0d..8c60b98e1 100644
--- a/include/ovn/features.h
+++ b/include/ovn/features.h
@@ -18,7 +18,7 @@
 
 #include <stdbool.h>
 
-#include "smap.h"
+#include "internal/smap.h"
 
 /* ovn-controller supported feature names. */
 #define OVN_FEATURE_PORT_UP_NOTIF "port-up-notif"
diff --git a/lib/acl-log.c b/lib/acl-log.c
index 220b6dc30..ad0cde563 100644
--- a/lib/acl-log.c
+++ b/lib/acl-log.c
@@ -17,7 +17,7 @@
 #include <config.h>
 #include "acl-log.h"
 #include <string.h>
-#include "flow.h"
+#include "internal/flow.h"
 #include "openvswitch/json.h"
 #include "openvswitch/ofpbuf.h"
 #include "openvswitch/vlog.h"
diff --git a/lib/actions.c b/lib/actions.c
index 7cf6be308..c00dedc06 100644
--- a/lib/actions.c
+++ b/lib/actions.c
@@ -18,14 +18,14 @@
 #include <stdarg.h>
 #include <stdbool.h>
 #include "acl-log.h"
-#include "bitmap.h"
-#include "byte-order.h"
+#include "internal/bitmap.h"
+#include "internal/byte-order.h"
 #include "compiler.h"
 #include "extend-table.h"
 #include "ovn-l7.h"
-#include "hash.h"
-#include "lib/packets.h"
-#include "nx-match.h"
+#include "internal/hash.h"
+#include "internal/packets.h"
+#include "internal/nx-match.h"
 #include "openvswitch/dynamic-string.h"
 #include "openvswitch/hmap.h"
 #include "openvswitch/json.h"
@@ -35,11 +35,11 @@
 #include "ovn/actions.h"
 #include "ovn/expr.h"
 #include "ovn/lex.h"
-#include "packets.h"
+#include "internal/packets.h"
 #include "openvswitch/shash.h"
-#include "simap.h"
-#include "uuid.h"
-#include "socket-util.h"
+#include "internal/simap.h"
+#include "internal/uuid.h"
+#include "internal/socket-util.h"
 
 VLOG_DEFINE_THIS_MODULE(actions);
 
diff --git a/lib/copp.c b/lib/copp.c
index bbe66924b..8cef0bb37 100644
--- a/lib/copp.c
+++ b/lib/copp.c
@@ -17,8 +17,8 @@
 #include <stdlib.h>
 
 #include "openvswitch/shash.h"
-#include "db-ctl-base.h"
-#include "smap.h"
+#include "internal/db-ctl-base.h"
+#include "internal/smap.h"
 #include "lib/ovn-nb-idl.h"
 #include "lib/copp.h"
 
diff --git a/lib/expr.c b/lib/expr.c
index e3f6bb892..2d5a725f8 100644
--- a/lib/expr.c
+++ b/lib/expr.c
@@ -15,9 +15,9 @@
  */
 
 #include <config.h>
-#include "byte-order.h"
+#include "internal/byte-order.h"
 #include "openvswitch/json.h"
-#include "nx-match.h"
+#include "internal/nx-match.h"
 #include "openvswitch/dynamic-string.h"
 #include "openvswitch/match.h"
 #include "openvswitch/ofp-actions.h"
@@ -26,9 +26,9 @@
 #include "ovn/expr.h"
 #include "ovn/lex.h"
 #include "ovn/logical-fields.h"
-#include "simap.h"
-#include "sset.h"
-#include "util.h"
+#include "internal/simap.h"
+#include "internal/sset.h"
+#include "internal/util.h"
 #include "ovn-util.h"
 
 VLOG_DEFINE_THIS_MODULE(expr);
diff --git a/lib/extend-table.c b/lib/extend-table.c
index c708e24b9..d97b5463d 100644
--- a/lib/extend-table.c
+++ b/lib/extend-table.c
@@ -17,10 +17,10 @@
 #include <config.h>
 #include <string.h>
 
-#include "bitmap.h"
+#include "internal/bitmap.h"
 #include "extend-table.h"
-#include "hash.h"
-#include "lib/uuid.h"
+#include "internal/hash.h"
+#include "internal/uuid.h"
 #include "openvswitch/vlog.h"
 
 VLOG_DEFINE_THIS_MODULE(extend_table);
diff --git a/lib/features.c b/lib/features.c
index f15ec42bb..9a93e68a4 100644
--- a/lib/features.c
+++ b/lib/features.c
@@ -17,10 +17,10 @@
 #include <stdint.h>
 #include <stdlib.h>
 
-#include "lib/util.h"
-#include "lib/dirs.h"
-#include "socket-util.h"
-#include "lib/vswitch-idl.h"
+#include "internal/util.h"
+#include "internal/dirs.h"
+#include "internal/socket-util.h"
+#include "internal/vswitch-idl.h"
 #include "openvswitch/vlog.h"
 #include "openvswitch/ofpbuf.h"
 #include "openvswitch/rconn.h"
diff --git a/lib/inc-proc-eng.c b/lib/inc-proc-eng.c
index 49a1fe2f2..a822ec901 100644
--- a/lib/inc-proc-eng.c
+++ b/lib/inc-proc-eng.c
@@ -22,13 +22,13 @@
 #include <stdlib.h>
 #include <string.h>
 
-#include "lib/util.h"
+#include "internal/util.h"
 #include "openvswitch/dynamic-string.h"
 #include "openvswitch/hmap.h"
 #include "openvswitch/vlog.h"
 #include "inc-proc-eng.h"
-#include "timeval.h"
-#include "unixctl.h"
+#include "internal/timeval.h"
+#include "internal/unixctl.h"
 
 VLOG_DEFINE_THIS_MODULE(inc_proc_eng);
 
diff --git a/lib/lb.c b/lib/lb.c
index 7b0ed1abe..0a0954dbc 100644
--- a/lib/lb.c
+++ b/lib/lb.c
@@ -22,7 +22,7 @@
 
 /* OpenvSwitch lib includes. */
 #include "openvswitch/vlog.h"
-#include "lib/smap.h"
+#include "internal/smap.h"
 
 VLOG_DEFINE_THIS_MODULE(lb);
 
diff --git a/lib/lb.h b/lib/lb.h
index 832ed31fb..77e9fb857 100644
--- a/lib/lb.h
+++ b/lib/lb.h
@@ -20,7 +20,7 @@
 #include <sys/types.h>
 #include <netinet/in.h>
 #include "openvswitch/hmap.h"
-#include "sset.h"
+#include "internal/sset.h"
 #include "ovn-util.h"
 
 struct nbrec_load_balancer;
diff --git a/lib/lex.c b/lib/lex.c
index c84d52aa8..26b7bdae4 100644
--- a/lib/lex.c
+++ b/lib/lex.c
@@ -21,8 +21,8 @@
 #include "openvswitch/dynamic-string.h"
 #include "openvswitch/json.h"
 #include "ovn/lex.h"
-#include "packets.h"
-#include "util.h"
+#include "internal/packets.h"
+#include "internal/util.h"
 
 /* Returns a string that represents 'format'. */
 const char *
diff --git a/lib/logical-fields.c b/lib/logical-fields.c
index 7b3d431e0..586661005 100644
--- a/lib/logical-fields.c
+++ b/lib/logical-fields.c
@@ -18,8 +18,8 @@
 #include "openvswitch/shash.h"
 #include "ovn/expr.h"
 #include "ovn/logical-fields.h"
-#include "ovs-thread.h"
-#include "packets.h"
+#include "openvswitch/ovs-thread.h"
+#include "internal/packets.h"
 
 /* Silence a warning. */
 extern const struct ovn_field ovn_fields[OVN_FIELD_N_IDS];
diff --git a/lib/ovn-dirs.c.in b/lib/ovn-dirs.c.in
index 49cfb4aed..89602c2ad 100644
--- a/lib/ovn-dirs.c.in
+++ b/lib/ovn-dirs.c.in
@@ -18,8 +18,8 @@
 #include <config.h>
 #include "ovn-dirs.h"
 #include <stdlib.h>
-#include "lib/ovs-thread.h"
-#include "lib/util.h"
+#include "openvswitch/ovs-thread.h"
+#include "internal/util.h"
 
 struct directory {
     const char *value;          /* Actual value; NULL if not yet determined. */
diff --git a/lib/ovn-l7.h b/lib/ovn-l7.h
index 9a33f5cda..1563e6356 100644
--- a/lib/ovn-l7.h
+++ b/lib/ovn-l7.h
@@ -20,10 +20,10 @@
 #include <sys/types.h>
 #include <netinet/in.h>
 #include <netinet/icmp6.h>
-#include "csum.h"
-#include "dp-packet.h"
+#include "internal/csum.h"
+#include "internal/dp-packet.h"
 #include "openvswitch/hmap.h"
-#include "hash.h"
+#include "internal/hash.h"
 #include "ovn/logical-fields.h"
 
 #define BFD_PACKET_LEN  24
diff --git a/lib/ovn-parallel-hmap.c b/lib/ovn-parallel-hmap.c
index 56ceed8e8..f3d8039b4 100644
--- a/lib/ovn-parallel-hmap.c
+++ b/lib/ovn-parallel-hmap.c
@@ -23,16 +23,16 @@
 #include <unistd.h>
 #include <errno.h>
 #include <semaphore.h>
-#include "fatal-signal.h"
-#include "util.h"
+#include "internal/fatal-signal.h"
+#include "internal/util.h"
 #include "openvswitch/vlog.h"
 #include "openvswitch/hmap.h"
 #include "openvswitch/thread.h"
 #include "ovn-parallel-hmap.h"
 #include "ovs-atomic.h"
-#include "ovs-thread.h"
+#include "openvswitch/ovs-thread.h"
 #include "ovs-numa.h"
-#include "random.h"
+#include "internal/random.h"
 
 VLOG_DEFINE_THIS_MODULE(ovn_parallel_hmap);
 
diff --git a/lib/ovn-util.c b/lib/ovn-util.c
index 683ca37d9..a08e6514f 100644
--- a/lib/ovn-util.c
+++ b/lib/ovn-util.c
@@ -19,16 +19,16 @@
 #include <ctype.h>
 #include <unistd.h>
 
-#include "daemon.h"
+#include "internal/daemon.h"
 #include "include/ovn/actions.h"
 #include "openvswitch/ofp-parse.h"
 #include "openvswitch/vlog.h"
 #include "ovn-dirs.h"
 #include "ovn-nb-idl.h"
 #include "ovn-sb-idl.h"
-#include "socket-util.h"
-#include "svec.h"
-#include "unixctl.h"
+#include "internal/socket-util.h"
+#include "internal/svec.h"
+#include "internal/unixctl.h"
 
 VLOG_DEFINE_THIS_MODULE(ovn_util);
 
diff --git a/lib/ovn-util.h b/lib/ovn-util.h
index b0bc70a16..095a4c2bd 100644
--- a/lib/ovn-util.h
+++ b/lib/ovn-util.h
@@ -16,7 +16,7 @@
 #ifndef OVN_UTIL_H
 #define OVN_UTIL_H 1
 
-#include "lib/packets.h"
+#include "internal/packets.h"
 #include "include/ovn/version.h"
 
 #define ovn_set_program_name(name) \
diff --git a/northd/ipam.c b/northd/ipam.c
index 68a757098..3cde59a02 100644
--- a/northd/ipam.c
+++ b/northd/ipam.c
@@ -8,9 +8,9 @@
 #include "ipam.h"
 #include "ovn/lex.h"
 
-#include "smap.h"
-#include "packets.h"
-#include "bitmap.h"
+#include "internal/smap.h"
+#include "internal/packets.h"
+#include "internal/bitmap.h"
 #include "openvswitch/vlog.h"
 
 VLOG_DEFINE_THIS_MODULE(ipam)
diff --git a/northd/northd.c b/northd/northd.c
index c4c181096..30882a1ad 100644
--- a/northd/northd.c
+++ b/northd/northd.c
@@ -17,12 +17,12 @@
 #include <stdlib.h>
 #include <stdio.h>
 
-#include "bitmap.h"
-#include "dirs.h"
+#include "internal/bitmap.h"
+#include "internal/dirs.h"
 #include "ipam.h"
 #include "openvswitch/dynamic-string.h"
-#include "hash.h"
-#include "hmapx.h"
+#include "internal/hash.h"
+#include "internal/hmapx.h"
 #include "openvswitch/hmap.h"
 #include "openvswitch/json.h"
 #include "ovn/lex.h"
@@ -35,24 +35,24 @@
 #include "lib/ovn-sb-idl.h"
 #include "lib/ovn-util.h"
 #include "lib/lb.h"
-#include "memory.h"
+#include "internal/memory.h"
 #include "northd.h"
 #include "lib/ovn-parallel-hmap.h"
 #include "ovn/actions.h"
 #include "ovn/features.h"
 #include "ovn/logical-fields.h"
-#include "packets.h"
-#include "simap.h"
-#include "smap.h"
-#include "sset.h"
-#include "svec.h"
-#include "stopwatch.h"
+#include "internal/packets.h"
+#include "internal/simap.h"
+#include "internal/smap.h"
+#include "internal/sset.h"
+#include "internal/svec.h"
+#include "internal/stopwatch.h"
 #include "lib/stopwatch-names.h"
-#include "stream.h"
-#include "timeval.h"
-#include "util.h"
-#include "uuid.h"
-#include "ovs-thread.h"
+#include "internal/stream.h"
+#include "internal/timeval.h"
+#include "internal/util.h"
+#include "internal/uuid.h"
+#include "openvswitch/ovs-thread.h"
 #include "openvswitch/vlog.h"
 
 VLOG_DEFINE_THIS_MODULE(northd);
diff --git a/northd/ovn-northd-ddlog.c b/northd/ovn-northd-ddlog.c
index a02949b2d..9398fa3cb 100644
--- a/northd/ovn-northd-ddlog.c
+++ b/northd/ovn-northd-ddlog.c
@@ -20,13 +20,13 @@
 #include <fcntl.h>
 #include <unistd.h>
 
-#include "command-line.h"
-#include "daemon.h"
-#include "fatal-signal.h"
-#include "hash.h"
-#include "jsonrpc.h"
+#include "internal/command-line.h"
+#include "internal/daemon.h"
+#include "internal/fatal-signal.h"
+#include "internal/hash.h"
+#include "internal/jsonrpc.h"
 #include "lib/ovn-util.h"
-#include "memory.h"
+#include "internal/memory.h"
 #include "openvswitch/hmap.h"
 #include "openvswitch/json.h"
 #include "openvswitch/poll-loop.h"
@@ -37,14 +37,14 @@
 #include "ovsdb-error.h"
 #include "ovsdb-parser.h"
 #include "ovsdb-types.h"
-#include "simap.h"
-#include "stopwatch.h"
+#include "internal/simap.h"
+#include "internal/stopwatch.h"
 #include "lib/stopwatch-names.h"
-#include "stream-ssl.h"
-#include "stream.h"
-#include "unixctl.h"
-#include "util.h"
-#include "uuid.h"
+#include "internal/stream-ssl.h"
+#include "internal/stream.h"
+#include "internal/unixctl.h"
+#include "internal/util.h"
+#include "internal/uuid.h"
 
 #include "northd/ovn_northd_ddlog/ddlog.h"
 
diff --git a/northd/ovn-northd.c b/northd/ovn-northd.c
index 39aa96055..a51af9f50 100644
--- a/northd/ovn-northd.c
+++ b/northd/ovn-northd.c
@@ -19,12 +19,12 @@
 #include <stdio.h>
 
 #include "lib/chassis-index.h"
-#include "command-line.h"
-#include "daemon.h"
-#include "fatal-signal.h"
+#include "internal/command-line.h"
+#include "internal/daemon.h"
+#include "internal/fatal-signal.h"
 #include "lib/ip-mcast-index.h"
 #include "lib/mcast-group-index.h"
-#include "memory.h"
+#include "internal/memory.h"
 #include "northd.h"
 #include "ovs-numa.h"
 #include "ovsdb-idl.h"
@@ -33,13 +33,13 @@
 #include "lib/ovn-parallel-hmap.h"
 #include "lib/ovn-sb-idl.h"
 #include "openvswitch/poll-loop.h"
-#include "simap.h"
-#include "stopwatch.h"
+#include "internal/simap.h"
+#include "internal/stopwatch.h"
 #include "lib/stopwatch-names.h"
-#include "stream.h"
-#include "stream-ssl.h"
-#include "unixctl.h"
-#include "util.h"
+#include "internal/stream.h"
+#include "internal/stream-ssl.h"
+#include "internal/unixctl.h"
+#include "internal/util.h"
 #include "openvswitch/vlog.h"
 
 VLOG_DEFINE_THIS_MODULE(ovn_northd);
diff --git a/northd/ovn.rs b/northd/ovn.rs
index 746884071..1f6456234 100644
--- a/northd/ovn.rs
+++ b/northd/ovn.rs
@@ -667,7 +667,7 @@ mod ovs {
         pub fn ip_parse(s: *const raw::c_char, ip: *mut ovs_be32) -> bool;
         pub fn eth_addr_from_string(s: *const raw::c_char, ea: *mut eth_addr_c) -> bool;
 
-        // include/openvswitch/json.h
+        // openvswitch/json.h
         pub fn json_string_escape(str: *const raw::c_char, out: *mut ovs_ds);
         // openvswitch/dynamic-string.h
         pub fn ds_destroy(ds: *mut ovs_ds);
diff --git a/northd/test-ipam.c b/northd/test-ipam.c
index 62a4fd399..672c91bbc 100644
--- a/northd/test-ipam.c
+++ b/northd/test-ipam.c
@@ -18,9 +18,9 @@
 #include "tests/ovstest.h"
 
 #include "openvswitch/dynamic-string.h"
-#include "smap.h"
-#include "packets.h"
-#include "bitmap.h"
+#include "internal/smap.h"
+#include "internal/packets.h"
+#include "internal/bitmap.h"
 
 #include "ipam.h"
 
diff --git a/tests/ovstest.c b/tests/ovstest.c
index 86a60db36..71e160bc5 100644
--- a/tests/ovstest.c
+++ b/tests/ovstest.c
@@ -21,11 +21,11 @@
 #include <inttypes.h>
 #include <limits.h>
 #include <stdlib.h>
-#include "command-line.h"
+#include "internal/command-line.h"
 #include "openvswitch/dynamic-string.h"
 #include "openvswitch/vlog.h"
 #include "ovstest.h"
-#include "util.h"
+#include "internal/util.h"
 
 static struct ovs_cmdl_command *commands = NULL;
 static size_t n_commands = 0;
diff --git a/tests/ovstest.h b/tests/ovstest.h
index ddd7f3eb9..e8d93418e 100644
--- a/tests/ovstest.h
+++ b/tests/ovstest.h
@@ -19,7 +19,7 @@
 
 #include "compiler.h"
 
-#include "command-line.h"
+#include "internal/command-line.h"
 
 /* Overview
  * ========
diff --git a/tests/test-ovn.c b/tests/test-ovn.c
index d79c6a5bc..26ec7e05a 100644
--- a/tests/test-ovn.c
+++ b/tests/test-ovn.c
@@ -19,10 +19,10 @@
 #include <getopt.h>
 #include <sys/wait.h>
 
-#include "command-line.h"
-#include "dp-packet.h"
-#include "fatal-signal.h"
-#include "flow.h"
+#include "internal/command-line.h"
+#include "internal/dp-packet.h"
+#include "internal/fatal-signal.h"
+#include "internal/flow.h"
 #include "openvswitch/dynamic-string.h"
 #include "openvswitch/match.h"
 #include "openvswitch/ofp-actions.h"
@@ -34,11 +34,11 @@
 #include "ovn/logical-fields.h"
 #include "lib/ovn-l7.h"
 #include "lib/extend-table.h"
-#include "ovs-thread.h"
+#include "openvswitch/ovs-thread.h"
 #include "ovstest.h"
 #include "openvswitch/shash.h"
-#include "simap.h"
-#include "util.h"
+#include "internal/simap.h"
+#include "internal/util.h"
 #include "controller/lflow.h"
 
 /* --relops: Bitmap of the relational operators to test, in exhaustive test. */
diff --git a/tests/test-utils.c b/tests/test-utils.c
index 6a3b198ae..3ef569b62 100644
--- a/tests/test-utils.c
+++ b/tests/test-utils.c
@@ -17,7 +17,7 @@
 
 #include "test-utils.h"
 
-#include "util.h"
+#include "internal/util.h"
 
 bool
 test_read_uint_value(struct ovs_cmdl_context *ctx, unsigned int index,
diff --git a/utilities/ovn-appctl.c b/utilities/ovn-appctl.c
index 912e96890..5d79ccc6d 100644
--- a/utilities/ovn-appctl.c
+++ b/utilities/ovn-appctl.c
@@ -22,16 +22,16 @@
 #include <string.h>
 #include <stdlib.h>
 
-#include "command-line.h"
-#include "daemon.h"
+#include "internal/command-line.h"
+#include "internal/daemon.h"
 #include "lib/ovn-dirs.h"
 #include "lib/ovn-util.h"
 #include "openvswitch/dynamic-string.h"
-#include "jsonrpc.h"
-#include "process.h"
-#include "timeval.h"
-#include "unixctl.h"
-#include "util.h"
+#include "internal/jsonrpc.h"
+#include "internal/process.h"
+#include "internal/timeval.h"
+#include "internal/unixctl.h"
+#include "internal/util.h"
 #include "openvswitch/vlog.h"
 
 static void usage(void);
diff --git a/utilities/ovn-dbctl.c b/utilities/ovn-dbctl.c
index 791caabb2..9cb4565c1 100644
--- a/utilities/ovn-dbctl.c
+++ b/utilities/ovn-dbctl.c
@@ -18,24 +18,24 @@
 
 #include <getopt.h>
 
-#include "command-line.h"
-#include "daemon.h"
-#include "db-ctl-base.h"
-#include "fatal-signal.h"
-#include "jsonrpc.h"
-#include "memory.h"
+#include "internal/command-line.h"
+#include "internal/daemon.h"
+#include "internal/db-ctl-base.h"
+#include "internal/fatal-signal.h"
+#include "internal/jsonrpc.h"
+#include "internal/memory.h"
 #include "openvswitch/poll-loop.h"
 #include "openvswitch/vlog.h"
 #include "ovn-util.h"
 #include "ovsdb-idl.h"
-#include "process.h"
-#include "simap.h"
-#include "stream-ssl.h"
-#include "svec.h"
-#include "table.h"
-#include "timer.h"
-#include "unixctl.h"
-#include "util.h"
+#include "internal/process.h"
+#include "internal/simap.h"
+#include "internal/stream-ssl.h"
+#include "internal/svec.h"
+#include "internal/table.h"
+#include "internal/timer.h"
+#include "internal/unixctl.h"
+#include "internal/util.h"
 
 VLOG_DEFINE_THIS_MODULE(ovn_dbctl);
 
diff --git a/utilities/ovn-ic-nbctl.c b/utilities/ovn-ic-nbctl.c
index 46cf5189b..245f2cf1c 100644
--- a/utilities/ovn-ic-nbctl.c
+++ b/utilities/ovn-ic-nbctl.c
@@ -22,11 +22,11 @@
 #include <stdarg.h>
 #include <stdlib.h>
 
-#include "command-line.h"
+#include "internal/command-line.h"
 #include "compiler.h"
-#include "db-ctl-base.h"
-#include "dirs.h"
-#include "fatal-signal.h"
+#include "internal/db-ctl-base.h"
+#include "internal/dirs.h"
+#include "internal/fatal-signal.h"
 #include "openvswitch/dynamic-string.h"
 #include "openvswitch/json.h"
 #include "openvswitch/shash.h"
@@ -35,14 +35,14 @@
 #include "lib/ovn-ic-nb-idl.h"
 #include "lib/ovn-util.h"
 #include "openvswitch/poll-loop.h"
-#include "process.h"
-#include "sset.h"
-#include "stream-ssl.h"
-#include "stream.h"
-#include "table.h"
-#include "timeval.h"
-#include "util.h"
-#include "svec.h"
+#include "internal/process.h"
+#include "internal/sset.h"
+#include "internal/stream-ssl.h"
+#include "internal/stream.h"
+#include "internal/table.h"
+#include "internal/timeval.h"
+#include "internal/util.h"
+#include "internal/svec.h"
 
 VLOG_DEFINE_THIS_MODULE(ic_nbctl);
 
diff --git a/utilities/ovn-ic-sbctl.c b/utilities/ovn-ic-sbctl.c
index e46b3bbbd..c980073ec 100644
--- a/utilities/ovn-ic-sbctl.c
+++ b/utilities/ovn-ic-sbctl.c
@@ -22,11 +22,11 @@
 #include <stdarg.h>
 #include <stdlib.h>
 
-#include "command-line.h"
+#include "internal/command-line.h"
 #include "compiler.h"
-#include "db-ctl-base.h"
-#include "dirs.h"
-#include "fatal-signal.h"
+#include "internal/db-ctl-base.h"
+#include "internal/dirs.h"
+#include "internal/fatal-signal.h"
 #include "openvswitch/dynamic-string.h"
 #include "openvswitch/json.h"
 #include "openvswitch/shash.h"
@@ -35,13 +35,13 @@
 #include "lib/ovn-ic-sb-idl.h"
 #include "lib/ovn-util.h"
 #include "openvswitch/poll-loop.h"
-#include "process.h"
-#include "sset.h"
-#include "stream-ssl.h"
-#include "stream.h"
-#include "table.h"
-#include "util.h"
-#include "svec.h"
+#include "internal/process.h"
+#include "internal/sset.h"
+#include "internal/stream-ssl.h"
+#include "internal/stream.h"
+#include "internal/table.h"
+#include "internal/util.h"
+#include "internal/svec.h"
 
 VLOG_DEFINE_THIS_MODULE(ic_sbctl);
 
diff --git a/utilities/ovn-nbctl.c b/utilities/ovn-nbctl.c
index 9e6bef9d6..2e4d09e0d 100644
--- a/utilities/ovn-nbctl.c
+++ b/utilities/ovn-nbctl.c
@@ -19,33 +19,33 @@
 #include <stdlib.h>
 #include <stdio.h>
 
-#include "command-line.h"
-#include "daemon.h"
-#include "db-ctl-base.h"
-#include "dirs.h"
-#include "fatal-signal.h"
-#include "jsonrpc.h"
+#include "internal/command-line.h"
+#include "internal/daemon.h"
+#include "internal/db-ctl-base.h"
+#include "internal/dirs.h"
+#include "internal/fatal-signal.h"
+#include "internal/jsonrpc.h"
 #include "openvswitch/json.h"
 #include "lib/acl-log.h"
 #include "lib/copp.h"
 #include "lib/ovn-nb-idl.h"
 #include "lib/ovn-util.h"
-#include "memory.h"
+#include "internal/memory.h"
 #include "ovn-dbctl.h"
-#include "packets.h"
+#include "internal/packets.h"
 #include "openvswitch/poll-loop.h"
-#include "process.h"
-#include "simap.h"
-#include "smap.h"
-#include "sset.h"
-#include "stream.h"
-#include "stream-ssl.h"
-#include "svec.h"
-#include "table.h"
-#include "timeval.h"
-#include "timer.h"
-#include "unixctl.h"
-#include "util.h"
+#include "internal/process.h"
+#include "internal/simap.h"
+#include "internal/smap.h"
+#include "internal/sset.h"
+#include "internal/stream.h"
+#include "internal/stream-ssl.h"
+#include "internal/svec.h"
+#include "internal/table.h"
+#include "internal/timeval.h"
+#include "internal/timer.h"
+#include "internal/unixctl.h"
+#include "internal/util.h"
 #include "openvswitch/vlog.h"
 
 VLOG_DEFINE_THIS_MODULE(nbctl);
diff --git a/utilities/ovn-sbctl.c b/utilities/ovn-sbctl.c
index 4d7e7d670..1380aae23 100644
--- a/utilities/ovn-sbctl.c
+++ b/utilities/ovn-sbctl.c
@@ -27,14 +27,14 @@
 #include <string.h>
 #include <unistd.h>
 
-#include "colors.h"
-#include "command-line.h"
+#include "internal/colors.h"
+#include "internal/command-line.h"
 #include "compiler.h"
-#include "db-ctl-base.h"
-#include "daemon.h"
-#include "dirs.h"
-#include "fatal-signal.h"
-#include "jsonrpc.h"
+#include "internal/db-ctl-base.h"
+#include "internal/daemon.h"
+#include "internal/dirs.h"
+#include "internal/fatal-signal.h"
+#include "internal/jsonrpc.h"
 #include "openvswitch/dynamic-string.h"
 #include "openvswitch/json.h"
 #include "openvswitch/ofp-actions.h"
@@ -45,22 +45,22 @@
 #include "openvswitch/vlog.h"
 #include "lib/ovn-sb-idl.h"
 #include "lib/ovn-util.h"
-#include "memory.h"
+#include "internal/memory.h"
 #include "ovn-dbctl.h"
 #include "ovsdb-data.h"
 #include "ovsdb-idl.h"
 #include "openvswitch/poll-loop.h"
-#include "process.h"
-#include "simap.h"
-#include "sset.h"
-#include "stream-ssl.h"
-#include "stream.h"
-#include "table.h"
-#include "timer.h"
-#include "timeval.h"
-#include "unixctl.h"
-#include "util.h"
-#include "svec.h"
+#include "internal/process.h"
+#include "internal/simap.h"
+#include "internal/sset.h"
+#include "internal/stream-ssl.h"
+#include "internal/stream.h"
+#include "internal/table.h"
+#include "internal/timer.h"
+#include "internal/timeval.h"
+#include "internal/unixctl.h"
+#include "internal/util.h"
+#include "internal/svec.h"
 
 VLOG_DEFINE_THIS_MODULE(sbctl);
 
diff --git a/utilities/ovn-trace.c b/utilities/ovn-trace.c
index 65a1822ea..3595cb3ee 100644
--- a/utilities/ovn-trace.c
+++ b/utilities/ovn-trace.c
@@ -18,13 +18,13 @@
 
 #include <getopt.h>
 
-#include "command-line.h"
+#include "internal/command-line.h"
 #include "compiler.h"
-#include "daemon.h"
-#include "dirs.h"
-#include "fatal-signal.h"
-#include "flow.h"
-#include "nx-match.h"
+#include "internal/daemon.h"
+#include "internal/dirs.h"
+#include "internal/fatal-signal.h"
+#include "internal/flow.h"
+#include "internal/nx-match.h"
 #include "openvswitch/dynamic-string.h"
 #include "openvswitch/json.h"
 #include "openvswitch/ofp-actions.h"
@@ -42,11 +42,11 @@
 #include "lib/ovn-util.h"
 #include "ovsdb-idl.h"
 #include "openvswitch/poll-loop.h"
-#include "stream-ssl.h"
-#include "stream.h"
-#include "unixctl.h"
-#include "util.h"
-#include "random.h"
+#include "internal/stream-ssl.h"
+#include "internal/stream.h"
+#include "internal/unixctl.h"
+#include "internal/util.h"
+#include "internal/random.h"
 
 VLOG_DEFINE_THIS_MODULE(ovntrace);
 
-- 
2.35.1


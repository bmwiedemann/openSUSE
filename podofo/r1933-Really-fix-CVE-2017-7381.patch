------------------------------------------------------------------------
r1933 | mabri | 2018-07-16 02:34:38 +0200 (lun 16 de jul de 2018) | 2 líneas

Really fix CVE-2017-7381


Index: src/doc/PdfPage.cpp
===================================================================
--- src/doc/PdfPage.cpp	(revisión: 1932)
+++ src/doc/PdfPage.cpp	(revisión: 1933)
@@ -673,6 +673,10 @@
 
 PdfObject* PdfPage::GetFromResources( const PdfName & rType, const PdfName & rKey )
 {
+    if( m_pResources == NULL ) // Fix CVE-2017-7381
+    {
+        PODOFO_RAISE_ERROR_INFO( ePdfError_InvalidHandle, "No Resources" );
+    } 
     if( m_pResources->GetDictionary().HasKey( rType ) ) 
     {
         // OC 15.08.2010 BugFix: Ghostscript creates here sometimes an indirect reference to a directory

------------------------------------------------------------------------

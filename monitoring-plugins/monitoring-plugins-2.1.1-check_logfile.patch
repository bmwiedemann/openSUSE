Index: monitoring-plugins-2.2/plugins-scripts/check_log.sh
===================================================================
--- monitoring-plugins-2.2.orig/plugins-scripts/check_log.sh
+++ monitoring-plugins-2.2/plugins-scripts/check_log.sh
@@ -115,27 +115,27 @@ while test -n "$1"; do
             exit $STATE_OK
             ;;
         --filename)
-            logfile=$2
+            logfile="$2"
             shift
             ;;
         -F)
-            logfile=$2
+            logfile="$2"
             shift
             ;;
         --oldlog)
-            oldlog=$2
+            oldlog="$2"
             shift
             ;;
         -O)
-            oldlog=$2
+            oldlog="$2"
             shift
             ;;
         --query)
-            query=$2
+            query="$2"
             shift
             ;;
         -q)
-            query=$2
+            query="$2"
             shift
             ;;
         -x)
@@ -157,10 +157,10 @@ done
 
 # If the source log file doesn't exist, exit
 
-if [ ! -e $logfile ]; then
+if [ ! -e "$logfile" ]; then
     echo "Log check error: Log file $logfile does not exist!"
     exit $STATE_UNKNOWN
-elif [ ! -r $logfile ] ; then
+elif [ ! -r "$logfile" ] ; then
     echo "Log check error: Log file $logfile is not readable!"
     exit $STATE_UNKNOWN
 fi
@@ -169,8 +169,8 @@ fi
 # we're running this test, so copy the original log file over to
 # the old diff file and exit
 
-if [ ! -e $oldlog ]; then
-    cat $logfile > $oldlog
+if [ ! -e "$oldlog" ]; then
+    cat "$logfile" > "$oldlog"
     echo "Log check data initialized..."
     exit $STATE_OK
 fi
@@ -184,20 +184,20 @@ if [ -x /bin/mktemp ]; then
 else
     tempdiff=`/bin/date '+%H%M%S'`
     tempdiff="/tmp/check_log.${tempdiff}"
-    touch $tempdiff
-    chmod 600 $tempdiff
+    touch "$tempdiff"
+    chmod 600 "$tempdiff"
 fi
 
-diff $logfile $oldlog | grep -v "^>" > $tempdiff
+diff "$logfile" "$oldlog" | grep -v "^>" > "$tempdiff"
 
 # Count the number of matching log entries we have
-count=`grep -c "$query" $tempdiff`
+count=`grep -c "$query" "$tempdiff"`
 
 # Get the last matching entry in the diff file
-lastentry=`grep "$query" $tempdiff | tail -1`
+lastentry=`grep "$query" "$tempdiff" | tail -1`
 
-rm -f $tempdiff
-cat $logfile > $oldlog
+rm -f "$tempdiff"
+cat "$logfile" > "$oldlog"
 
 if [ "$count" = "0" ]; then # no matches, exit with no error
     echo "Log check ok - 0 pattern matches found"

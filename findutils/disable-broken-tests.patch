Downstream patch, possibly removed with next upstream findutils version.

gnulib tests: skip some tests to make build with GCC -flto flag work

The gnulib tests 'test-lock' and 'test-thread_create' are failing with the
GCC flag -flto=<N>, link-time optimization.
On OBS, this is with:

  %global optflags %optflags %{_lto_cflags}

See also:
- openSUSE:LTO
  https://en.opensuse.org/openSUSE:LTO
- [META] GCC + LTO package failures
  https://bugzilla.opensuse.org/show_bug.cgi?id=1133084
- LTO: findutils build fails
  https://bugzilla.opensuse.org/show_bug.cgi?id=1138800
  (boo#1138800)
---
diff --git a/tests/Makefile.am b/tests/Makefile.am
index 537712f..25b9a4d 100644
--- a/tests/Makefile.am
+++ b/tests/Makefile.am
@@ -966,15 +966,6 @@ EXTRA_DIST += test-localename.c macros.h
 
 ## end   gnulib module localename-tests
 
-## begin gnulib module lock-tests
-
-TESTS += test-lock
-check_PROGRAMS += test-lock
-test_lock_LDADD = $(LDADD) @LIBMULTITHREAD@ @YIELD_LIB@
-EXTRA_DIST += test-lock.c
-
-## end   gnulib module lock-tests
-
 ## begin gnulib module lseek-tests
 
 TESTS += test-lseek.sh
@@ -1985,16 +1976,6 @@ libtests_a_SOURCES += glthread/thread.h glthread/thread.c
 
 ## end   gnulib module thread
 
-## begin gnulib module thread-tests
-
-TESTS += test-thread_self test-thread_create
-check_PROGRAMS += test-thread_self test-thread_create
-test_thread_self_LDADD = $(LDADD) @LIBTHREAD@
-test_thread_create_LDADD = $(LDADD) @LIBMULTITHREAD@
-EXTRA_DIST += test-thread_self.c test-thread_create.c macros.h
-
-## end   gnulib module thread-tests
-
 ## begin gnulib module time-tests
 
 TESTS += test-time
diff --git a/tests/Makefile.in b/tests/Makefile.in
index 2bedfe1..1dcd443 100644
--- a/tests/Makefile.in
+++ b/tests/Makefile.in
@@ -141,7 +141,7 @@ TESTS = test-accept$(EXEEXT) test-alloca-opt$(EXEEXT) \
 	test-isnanl-nolibm$(EXEEXT) test-iswblank$(EXEEXT) \
 	test-langinfo$(EXEEXT) test-listen$(EXEEXT) \
 	test-locale$(EXEEXT) test-localeconv$(EXEEXT) \
-	test-localename$(EXEEXT) test-lock$(EXEEXT) test-lseek.sh \
+	test-localename$(EXEEXT) test-lseek.sh \
 	test-lstat$(EXEEXT) test-malloc-gnu$(EXEEXT) \
 	test-malloca$(EXEEXT) test-math$(EXEEXT) test-mbrtowc1.sh \
 	test-mbrtowc2.sh test-mbrtowc3.sh test-mbrtowc4.sh \
@@ -182,7 +182,7 @@ TESTS = test-accept$(EXEEXT) test-alloca-opt$(EXEEXT) \
 	test-sys_time$(EXEEXT) test-sys_types$(EXEEXT) \
 	test-sys_uio$(EXEEXT) test-sys_utsname$(EXEEXT) \
 	test-sys_wait$(EXEEXT) test-init.sh test-thread_self$(EXEEXT) \
-	test-thread_create$(EXEEXT) test-time$(EXEEXT) \
+	test-time$(EXEEXT) \
 	test-timespec$(EXEEXT) test-trunc1$(EXEEXT) \
 	test-trunc2$(EXEEXT) test-uname$(EXEEXT) \
 	test-dup-safer$(EXEEXT) test-unistd$(EXEEXT) \
@@ -242,7 +242,7 @@ check_PROGRAMS = test-accept$(EXEEXT) test-alloca-opt$(EXEEXT) \
 	test-iswblank$(EXEEXT) test-langinfo$(EXEEXT) \
 	test-listen$(EXEEXT) test-locale$(EXEEXT) \
 	test-localeconv$(EXEEXT) test-localename$(EXEEXT) \
-	test-lock$(EXEEXT) test-lseek$(EXEEXT) test-lstat$(EXEEXT) \
+	test-lseek$(EXEEXT) test-lstat$(EXEEXT) \
 	test-malloc-gnu$(EXEEXT) test-malloca$(EXEEXT) \
 	test-math$(EXEEXT) test-mbrtowc$(EXEEXT) \
 	test-mbrtowc-w32$(EXEEXT) test-mbscasestr1$(EXEEXT) \
@@ -281,7 +281,7 @@ check_PROGRAMS = test-accept$(EXEEXT) test-alloca-opt$(EXEEXT) \
 	test-sys_time$(EXEEXT) test-sys_types$(EXEEXT) \
 	test-sys_uio$(EXEEXT) test-sys_utsname$(EXEEXT) \
 	test-sys_wait$(EXEEXT) test-thread_self$(EXEEXT) \
-	test-thread_create$(EXEEXT) test-time$(EXEEXT) \
+	test-time$(EXEEXT) \
 	test-timespec$(EXEEXT) test-trunc1$(EXEEXT) \
 	test-trunc2$(EXEEXT) test-uname$(EXEEXT) \
 	test-dup-safer$(EXEEXT) test-unistd$(EXEEXT) \
@@ -952,9 +952,6 @@ test_localename_SOURCES = test-localename.c
 test_localename_OBJECTS = test-localename.$(OBJEXT)
 test_localename_DEPENDENCIES = $(am__DEPENDENCIES_2) \
 	$(am__DEPENDENCIES_1)
-test_lock_SOURCES = test-lock.c
-test_lock_OBJECTS = test-lock.$(OBJEXT)
-test_lock_DEPENDENCIES = $(am__DEPENDENCIES_2)
 test_lseek_SOURCES = test-lseek.c
 test_lseek_OBJECTS = test-lseek.$(OBJEXT)
 test_lseek_LDADD = $(LDADD)
@@ -1334,9 +1331,6 @@ test_sys_wait_OBJECTS = test-sys_wait.$(OBJEXT)
 test_sys_wait_LDADD = $(LDADD)
 test_sys_wait_DEPENDENCIES = libtests.a ../gl/lib/libgnulib.a \
 	libtests.a $(am__DEPENDENCIES_1)
-test_thread_create_SOURCES = test-thread_create.c
-test_thread_create_OBJECTS = test-thread_create.$(OBJEXT)
-test_thread_create_DEPENDENCIES = $(am__DEPENDENCIES_2)
 test_thread_self_SOURCES = test-thread_self.c
 test_thread_self_OBJECTS = test-thread_self.$(OBJEXT)
 test_thread_self_DEPENDENCIES = $(am__DEPENDENCIES_2)
@@ -1491,7 +1485,7 @@ SOURCES = $(libtests_a_SOURCES) $(EXTRA_libtests_a_SOURCES) \
 	test-isfinite.c test-isinf.c test-isnand-nolibm.c \
 	test-isnanf-nolibm.c test-isnanl-nolibm.c test-iswblank.c \
 	test-langinfo.c test-listen.c test-locale.c test-localeconv.c \
-	test-localename.c test-lock.c test-lseek.c test-lstat.c \
+	test-localename.c test-lseek.c test-lstat.c \
 	test-malloc-gnu.c test-malloca.c test-math.c test-mbrtowc.c \
 	test-mbrtowc-w32.c test-mbscasestr1.c test-mbscasestr2.c \
 	test-mbscasestr3.c test-mbscasestr4.c test-mbsinit.c \
@@ -1516,7 +1510,7 @@ SOURCES = $(libtests_a_SOURCES) $(EXTRA_libtests_a_SOURCES) \
 	test-symlinkat.c test-sys_ioctl.c test-sys_select.c \
 	test-sys_socket.c test-sys_stat.c test-sys_time.c \
 	test-sys_types.c test-sys_uio.c test-sys_utsname.c \
-	test-sys_wait.c test-thread_create.c test-thread_self.c \
+	test-sys_wait.c test-thread_self.c \
 	test-time.c test-timespec.c test-trunc1.c test-trunc2.c \
 	$(test_uc_width_SOURCES) $(test_uc_width2_SOURCES) \
 	test-uname.c test-unistd.c test-unlink.c test-unlinkat.c \
@@ -1552,7 +1546,7 @@ DIST_SOURCES = $(libtests_a_SOURCES) $(EXTRA_libtests_a_SOURCES) \
 	test-isfinite.c test-isinf.c test-isnand-nolibm.c \
 	test-isnanf-nolibm.c test-isnanl-nolibm.c test-iswblank.c \
 	test-langinfo.c test-listen.c test-locale.c test-localeconv.c \
-	test-localename.c test-lock.c test-lseek.c test-lstat.c \
+	test-localename.c test-lseek.c test-lstat.c \
 	test-malloc-gnu.c test-malloca.c test-math.c test-mbrtowc.c \
 	test-mbrtowc-w32.c test-mbscasestr1.c test-mbscasestr2.c \
 	test-mbscasestr3.c test-mbscasestr4.c test-mbsinit.c \
@@ -1577,7 +1571,7 @@ DIST_SOURCES = $(libtests_a_SOURCES) $(EXTRA_libtests_a_SOURCES) \
 	test-symlinkat.c test-sys_ioctl.c test-sys_select.c \
 	test-sys_socket.c test-sys_stat.c test-sys_time.c \
 	test-sys_types.c test-sys_uio.c test-sys_utsname.c \
-	test-sys_wait.c test-thread_create.c test-thread_self.c \
+	test-sys_wait.c test-thread_self.c \
 	test-time.c test-timespec.c test-trunc1.c test-trunc2.c \
 	$(test_uc_width_SOURCES) $(test_uc_width2_SOURCES) \
 	test-uname.c test-unistd.c test-unlink.c test-unlinkat.c \
@@ -3178,7 +3172,7 @@ EXTRA_DIST = accept.c w32sock.h test-accept.c signature.h macros.h \
 	test-iswblank.c macros.h test-langinfo.c listen.c w32sock.h \
 	test-listen.c signature.h macros.h test-locale.c \
 	test-localeconv.c signature.h macros.h localename.h \
-	test-localename.c macros.h test-lock.c test-lseek.c \
+	test-localename.c macros.h test-lseek.c \
 	test-lseek.sh signature.h macros.h test-lstat.h test-lstat.c \
 	signature.h macros.h test-malloc-gnu.c test-malloca.c \
 	test-math.c macros.h test-mbrtowc1.sh test-mbrtowc2.sh \
@@ -3243,7 +3237,7 @@ EXTRA_DIST = accept.c w32sock.h test-accept.c signature.h macros.h \
 	test-sys_socket.c test-sys_stat.c test-sys_time.c \
 	test-sys_types.c test-sys_uio.c test-sys_utsname.c \
 	test-sys_wait.c test-sys_wait.h init.sh test-init.sh \
-	test-thread_self.c test-thread_create.c macros.h test-time.c \
+	test-thread_self.c macros.h test-time.c \
 	test-timespec.c macros.h test-trunc1.c test-trunc2.c \
 	minus-zero.h infinity.h nan.h signature.h macros.h \
 	test-uname.c signature.h macros.h test-dup-safer.c macros.h \
@@ -3367,7 +3361,6 @@ test_stat_time_LDADD = $(LDADD) $(LIB_NANOSLEEP)
 test_statat_LDADD = $(LDADD) @LIBINTL@
 test_symlinkat_LDADD = $(LDADD) @LIBINTL@
 test_thread_self_LDADD = $(LDADD) @LIBTHREAD@
-test_thread_create_LDADD = $(LDADD) @LIBMULTITHREAD@
 test_trunc1_LDADD = $(LDADD) @TRUNC_LIBM@
 test_trunc2_LDADD = $(LDADD) @TRUNC_LIBM@
 test_uname_LDADD = $(LDADD) @GETHOSTNAME_LIB@
@@ -3819,10 +3812,6 @@ test-localename$(EXEEXT): $(test_localename_OBJECTS) $(test_localename_DEPENDENC
 	@rm -f test-localename$(EXEEXT)
 	$(AM_V_CCLD)$(LINK) $(test_localename_OBJECTS) $(test_localename_LDADD) $(LIBS)
 
-test-lock$(EXEEXT): $(test_lock_OBJECTS) $(test_lock_DEPENDENCIES) $(EXTRA_test_lock_DEPENDENCIES) 
-	@rm -f test-lock$(EXEEXT)
-	$(AM_V_CCLD)$(LINK) $(test_lock_OBJECTS) $(test_lock_LDADD) $(LIBS)
-
 test-lseek$(EXEEXT): $(test_lseek_OBJECTS) $(test_lseek_DEPENDENCIES) $(EXTRA_test_lseek_DEPENDENCIES) 
 	@rm -f test-lseek$(EXEEXT)
 	$(AM_V_CCLD)$(LINK) $(test_lseek_OBJECTS) $(test_lseek_LDADD) $(LIBS)
@@ -4151,10 +4140,6 @@ test-sys_wait$(EXEEXT): $(test_sys_wait_OBJECTS) $(test_sys_wait_DEPENDENCIES) $
 	@rm -f test-sys_wait$(EXEEXT)
 	$(AM_V_CCLD)$(LINK) $(test_sys_wait_OBJECTS) $(test_sys_wait_LDADD) $(LIBS)
 
-test-thread_create$(EXEEXT): $(test_thread_create_OBJECTS) $(test_thread_create_DEPENDENCIES) $(EXTRA_test_thread_create_DEPENDENCIES) 
-	@rm -f test-thread_create$(EXEEXT)
-	$(AM_V_CCLD)$(LINK) $(test_thread_create_OBJECTS) $(test_thread_create_LDADD) $(LIBS)
-
 test-thread_self$(EXEEXT): $(test_thread_self_OBJECTS) $(test_thread_self_DEPENDENCIES) $(EXTRA_test_thread_self_DEPENDENCIES) 
 	@rm -f test-thread_self$(EXEEXT)
 	$(AM_V_CCLD)$(LINK) $(test_thread_self_OBJECTS) $(test_thread_self_LDADD) $(LIBS)
@@ -4402,7 +4387,6 @@ distclean-compile:
 @AMDEP_TRUE@@am__include@ @am__quote@./$(DEPDIR)/test-locale.Po@am__quote@
 @AMDEP_TRUE@@am__include@ @am__quote@./$(DEPDIR)/test-localeconv.Po@am__quote@
 @AMDEP_TRUE@@am__include@ @am__quote@./$(DEPDIR)/test-localename.Po@am__quote@
-@AMDEP_TRUE@@am__include@ @am__quote@./$(DEPDIR)/test-lock.Po@am__quote@
 @AMDEP_TRUE@@am__include@ @am__quote@./$(DEPDIR)/test-lseek.Po@am__quote@
 @AMDEP_TRUE@@am__include@ @am__quote@./$(DEPDIR)/test-lstat.Po@am__quote@
 @AMDEP_TRUE@@am__include@ @am__quote@./$(DEPDIR)/test-malloc-gnu.Po@am__quote@
@@ -4485,7 +4469,6 @@ distclean-compile:
 @AMDEP_TRUE@@am__include@ @am__quote@./$(DEPDIR)/test-sys_uio.Po@am__quote@
 @AMDEP_TRUE@@am__include@ @am__quote@./$(DEPDIR)/test-sys_utsname.Po@am__quote@
 @AMDEP_TRUE@@am__include@ @am__quote@./$(DEPDIR)/test-sys_wait.Po@am__quote@
-@AMDEP_TRUE@@am__include@ @am__quote@./$(DEPDIR)/test-thread_create.Po@am__quote@
 @AMDEP_TRUE@@am__include@ @am__quote@./$(DEPDIR)/test-thread_self.Po@am__quote@
 @AMDEP_TRUE@@am__include@ @am__quote@./$(DEPDIR)/test-time.Po@am__quote@
 @AMDEP_TRUE@@am__include@ @am__quote@./$(DEPDIR)/test-timespec.Po@am__quote@
@@ -5455,13 +5438,6 @@ test-localename.log: test-localename$(EXEEXT)
 	--log-file $$b.log --trs-file $$b.trs \
 	$(am__common_driver_flags) $(AM_LOG_DRIVER_FLAGS) $(LOG_DRIVER_FLAGS) -- $(LOG_COMPILE) \
 	"$$tst" $(AM_TESTS_FD_REDIRECT)
-test-lock.log: test-lock$(EXEEXT)
-	@p='test-lock$(EXEEXT)'; \
-	b='test-lock'; \
-	$(am__check_pre) $(LOG_DRIVER) --test-name "$$f" \
-	--log-file $$b.log --trs-file $$b.trs \
-	$(am__common_driver_flags) $(AM_LOG_DRIVER_FLAGS) $(LOG_DRIVER_FLAGS) -- $(LOG_COMPILE) \
-	"$$tst" $(AM_TESTS_FD_REDIRECT)
 test-lseek.sh.log: test-lseek.sh
 	@p='test-lseek.sh'; \
 	b='test-lseek.sh'; \
@@ -6120,13 +6096,6 @@ test-thread_self.log: test-thread_self$(EXEEXT)
 	--log-file $$b.log --trs-file $$b.trs \
 	$(am__common_driver_flags) $(AM_LOG_DRIVER_FLAGS) $(LOG_DRIVER_FLAGS) -- $(LOG_COMPILE) \
 	"$$tst" $(AM_TESTS_FD_REDIRECT)
-test-thread_create.log: test-thread_create$(EXEEXT)
-	@p='test-thread_create$(EXEEXT)'; \
-	b='test-thread_create'; \
-	$(am__check_pre) $(LOG_DRIVER) --test-name "$$f" \
-	--log-file $$b.log --trs-file $$b.trs \
-	$(am__common_driver_flags) $(AM_LOG_DRIVER_FLAGS) $(LOG_DRIVER_FLAGS) -- $(LOG_COMPILE) \
-	"$$tst" $(AM_TESTS_FD_REDIRECT)
 test-time.log: test-time$(EXEEXT)
 	@p='test-time$(EXEEXT)'; \
 	b='test-time'; \

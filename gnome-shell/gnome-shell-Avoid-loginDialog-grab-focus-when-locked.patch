From 83b01d946517b5995e6423582de13307af91716b Mon Sep 17 00:00:00 2001
From: Xiaoguang Wang <xwang@suse.com>
Date: Tue, 26 Sep 2017 16:54:15 +0800
Subject: [PATCH] gdm: Avoid loginDialog grab focus when locked

https://bugzilla.gnome.org/show_bug.cgi?id=788169
---
 js/gdm/loginDialog.js | 3 ++-
 1 file changed, 2 insertions(+), 1 deletion(-)

diff --git a/js/gdm/loginDialog.js b/js/gdm/loginDialog.js
index 6c4d135..cfc445b 100644
--- a/js/gdm/loginDialog.js
+++ b/js/gdm/loginDialog.js
@@ -1119,7 +1119,8 @@ var LoginDialog = GObject.registerClass({
         this._sessionMenuButton.close();
         this._setUserListExpanded(true);
         this._notListedButton.show();
-        this._userList.actor.grab_key_focus();
+        if (!Main.screenShield.locked)
+            this._userList.actor.grab_key_focus();
     }
 
     _beginVerificationForItem(item) {
-- 
2.16.4


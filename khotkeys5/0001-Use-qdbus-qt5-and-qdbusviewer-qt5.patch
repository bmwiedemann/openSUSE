From 44722a4ec5f54803f092d81b4c08e055052aa138 Mon Sep 17 00:00:00 2001
From: Wolfgang Bauer <wbauer@tmo.at>
Date: Thu, 17 Aug 2017 16:13:31 +0200
Subject: [PATCH] Use qdbus-qt5 and qdbusviewer-qt5

The Qt4 version might not be installed any more, and it's needed for
D-BUS actions like spectacle's "Print Screen" shortcuts.
---
 kcm_hotkeys/actions/dbus_action_widget.cpp | 2 +-
 libkhotkeysprivate/actions/dbus_action.cpp | 2 +-
 2 files changed, 2 insertions(+), 2 deletions(-)

Index: khotkeys-5.10.4/kcm_hotkeys/actions/dbus_action_widget.cpp
===================================================================
--- khotkeys-5.10.4.orig/kcm_hotkeys/actions/dbus_action_widget.cpp
+++ khotkeys-5.10.4/kcm_hotkeys/actions/dbus_action_widget.cpp
@@ -117,9 +117,9 @@ bool DbusActionWidget::isChanged() const
 
 void DbusActionWidget::launchDbusBrowser() const
     {
-    if( KRun::runCommand( "qdbusviewer", window()) == 0 )
+    if( KRun::runCommand( "qdbusviewer-qt5", window()) == 0 )
         {
-        KMessageBox::sorry( window(), i18n( "Failed to run qdbusviewer" ));
+        KMessageBox::sorry( window(), i18n( "Failed to run qdbusviewer-qt5, maybe you need to install libqt5-qttools?" ));
         }
     }
 
Index: khotkeys-5.10.4/libkhotkeysprivate/actions/dbus_action.cpp
===================================================================
--- khotkeys-5.10.4.orig/libkhotkeysprivate/actions/dbus_action.cpp
+++ khotkeys-5.10.4/libkhotkeysprivate/actions/dbus_action.cpp
@@ -133,7 +133,7 @@ void DBusAction::execute()
         }
     qDebug() << "D-Bus call:" << _application << ":" << _object << ":" << _function << ":" << args_list;
     KProcess proc;
-    proc << "qdbus" << _application << _object << _function << args_list;
+    proc << "qdbus-qt5" << _application << _object << _function << args_list;
     proc.startDetached();
     }
 

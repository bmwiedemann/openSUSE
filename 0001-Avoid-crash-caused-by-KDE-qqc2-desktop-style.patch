From c11ed62920c472057295720cb53373b86f93eb20 Mon Sep 17 00:00:00 2001
From: =?UTF-8?q?Stefan=20Br=C3=BCns?= <stefan.bruens@rwth-aachen.de>
Date: Thu, 20 Feb 2020 02:05:19 +0100
Subject: [PATCH] Avoid crash caused by KDE qqc2-desktop-style

https://bugs.kde.org/show_bug.cgi?id=417900
---
 cura_app.py | 6 ++++++
 1 file changed, 6 insertions(+)

diff --git a/cura_app.py b/cura_app.py
index 6149eeeb9..236dfb618 100755
--- a/cura_app.py
+++ b/cura_app.py
@@ -207,5 +207,11 @@ if Platform.isLinux() and getattr(sys, "frozen", False):
     import trimesh.exchange.load
     os.environ["LD_LIBRARY_PATH"] = old_env
 
+# WORKAROUND: CURA-5488
+# When using the KDE qqc2-desktop-style, the UI layout is completely broken, and
+# even worse, it crashes when switching to the "Preview" pane.
+if Platform.isLinux():
+    os.environ["QT_QUICK_CONTROLS_STYLE"] = "material"
+
 app = CuraApplication()
 app.run()
-- 
2.25.0


From d54db37c125ecc057246f656c014ea849f6a0dcb Mon Sep 17 00:00:00 2001
From: =?UTF-8?q?Stefan=20Br=C3=BCns?= <stefan.bruens@rwth-aachen.de>
Date: Sun, 7 Jun 2020 20:05:23 +0200
Subject: [PATCH] Avoid crash caused by KDE qqc2-desktop-style

https://bugs.kde.org/show_bug.cgi?id=417900
---
 cura_app.py | 6 ++++++
 1 file changed, 6 insertions(+)

diff --git a/cura_app.py b/cura_app.py
index a78e7cabd..7c9771d20 100755
--- a/cura_app.py
+++ b/cura_app.py
@@ -230,5 +230,11 @@ if ApplicationMetadata.CuraDebugMode:
     ssl_conf.setPeerVerifyMode(QSslSocket.VerifyNone)
     QSslConfiguration.setDefaultConfiguration(ssl_conf)
 
+# WORKAROUND: CURA-5488
+# When using the KDE qqc2-desktop-style, the UI layout is completely broken, and
+# even worse, it crashes when switching to the "Preview" pane.
+if Platform.isLinux():
+    os.environ["QT_QUICK_CONTROLS_STYLE"] = "material"
+
 app = CuraApplication()
 app.run()
-- 
2.26.2


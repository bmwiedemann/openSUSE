From: Jan Engelhardt <jengelh@inai.de>
Date: 2020-08-29 10:10:12.022296526 +0200

Avoid the installation of a custom xxhash.h header. Since vk_*.h header files
still include xxhash.h (and now would source the system xxhash instead of the
bundled one), it makes sense to build ValidationLayers itself with the system
xxhash as well, so that the ABI matches.

---
 layers/CMakeLists.txt |    6 +-----
 1 file changed, 1 insertion(+), 5 deletions(-)

Index: Vulkan-ValidationLayers-sdk-1.3.239.0/layers/CMakeLists.txt
===================================================================
--- Vulkan-ValidationLayers-sdk-1.3.239.0.orig/layers/CMakeLists.txt
+++ Vulkan-ValidationLayers-sdk-1.3.239.0/layers/CMakeLists.txt
@@ -50,8 +50,6 @@ target_sources(VkLayer_utils PRIVATE
     vk_layer_logging.cpp
     vk_layer_utils.h
     vk_layer_utils.cpp
-    xxhash.h
-    xxhash.c
 )
 set_target_properties(VkLayer_utils PROPERTIES OUTPUT_NAME "VkLayer_utils-@PACKAGE_VERSION@")
 target_link_libraries(VkLayer_utils PUBLIC Vulkan::Headers)
@@ -259,8 +257,6 @@ target_sources(VkLayer_khronos_validatio
     video_validation.cpp
     vk_layer_settings_ext.h
     wsi_validation.cpp
-    xxhash.c
-    xxhash.h
 )
 
 target_compile_definitions(VkLayer_khronos_validation PUBLIC ${KHRONOS_LAYER_COMPILE_DEFINITIONS})
@@ -279,7 +275,7 @@ if (USE_ROBIN_HOOD_HASHING)
 endif()
 # Order matters here. VkLayer_utils should be the last link library to ensure mimalloc overrides are picked up correctly.
 # Otherwise, libraries after VkLayer_utils will not benefit from this performance improvement.
-target_link_libraries(VkLayer_khronos_validation PRIVATE VVL-SPIRV-LIBS VkLayer_utils)
+target_link_libraries(VkLayer_khronos_validation PRIVATE VVL-SPIRV-LIBS VkLayer_utils -lxxhash)
 
 # There are 2 primary deliverables for the validation layers.
 # - The actual library VkLayer_khronos_validation.(dll|so|dylib)

-------------------------------------------------------------------
Fri Feb 27 21:29:46 UTC 2026 - Kirk Allan <kallan@suse.com>

- Updates in VMDP-WIN-2.5.5.1:
  https://github.com/SUSE/vmdp/releases/tag/v2.5.5.1

- Added WHQL signed drivers for the RTL_QUERY_REGISTRY_TYPECHECK fix.
- Added RTL_QUERY_REGISTRY_TYPECHECK to calls to RtlQueryRegistryValues.
- Cleanedup deprecated ExAlloc calls by using the workaround macros and
  defining POOL_ZERO_DOWN_LEVEL_SUPPORT for pvvxbn, fwcfg, virtio_fs,
  virtio_rng, and virtio_serial for w2k12 through w2k19.  Newer versions
  of Windows use the new ExAlloc calls.
- Cleaned up compiler warnings that were manifested with compiler updates.
- Fixed setup from copying drivers to \windows\system32\drivers for w2k22
  and w2k25.
- Removed the utilities\x86ex directory and files from the media layout.
  There is no x86 OS that use the functionality contained in those files.
- Fixed a Driver Verifier crash in pvvxnet on Xen when shutting down or
  restarting the driver after a save/restore of the vm.  Memory wasn't
  being freed on the restore.

Known issues:
- Drivers are not removed from \windows\system32\drivers directory during
  uninstall for w2k16 and w2k19.  This is due to the PnpLockdown=1 in the
  driver inf files which was required for attestation signed drivers.

-------------------------------------------------------------------
Mon Jul 14 14:24:27 UTC 2025 - Kirk Allan <kallan@suse.com>

- Updates in VMDP-WIN-2.5.5: https://github.com/SUSE/vmdp/releases/tag/v2.5.5

- Renamed vmdp-250424 to VMDP-WiN-2.5.5.

- All drivers for Windows Server 2025 have been signed and are now supported.

- The same driver binary is used for both Windows Server 2022 and Windows
  Server 2025.  The drivers contain signatures for both versions of
  Windows Server.

- Updated driver INF files to follow driver isolation policies.

- Drivers for Windows Server 2008 R2 have been removed from this package.

- Use a common style help box for setup, uninstall, and pvctrlw.

- Media layout changes:
  - Renamed directories to better identify drivers to Windows versions:
    - win7-8r2 -> Server2008r2-Win7
    - win8-2012 -> Server2012-Win8
    - win8.1-2012r2 -> Server2012r2-Win8.1
    - win10-server16-19 -> Server2016-19-Win10
    - win10-11-server22 -> Server2022-25-Win11.
  - Removed the <win_os>\<arch>\pvvx directory and moved its contents to the
    <win_os>\<arch> directory.
  - In the root directory created a utilities directory.  Moved the x86,
    x86ex, x64, and x64ex directories into the utilities directory.

- pvvxnet.sys:
  - NDIS Poll functionality is fully supported.
  - Split event channels in now on by default for Xen environments.

- virtio_rng.sys:
   Fixed bsc#1227857 virtio_rng to correctly initialize the virtio queue
   to utilize MSI interrupts.

- setup.exe:
  - Updated setup to recognize the new media directory layout.
  - setup now installs qemu-ga by default.  If the /qemu-ga parameter is
    given, only install qemu-ga along with the virtio_serial driver if needed.
  - setup renames the \program files\vmdp\pvvx directory
    to \program files\vmdp\drivers.
  - Flush the pv log file after each write.  Helps to follow setup's progress.
  - Update setup to be able to install individual drivers.
  - Fixed possible buffer overflow error when writing out the virtio_rng
    registry entries.

- uninstall.exe
  - When uninstalling virtiofs_svc, stop the service first so that the file
    can be deleted without a reboot.  If the file is successfully removed,
    no need to prompt for a reboot.
  - Remove the virtio_rng registry entries when uninstalling virtio_rng.

- qemu-ga:
  - Update to latest code.

- virtiofs_svc:
  - Update to latest code.

-------------------------------------------------------------------
Tue Jul  2 16:22:25 UTC 2024 - Vasily Ulyanov <vasily.ulyanov@suse.com>

- Update to version 2.5.4.3: https://github.com/SUSE/vmdp/releases/tag/v2.5.4.3
  * Media layout changes:
    . Renamed the win10-server and win10-2204 driver directories on the
      distribution media to win10-server16-19 and win10-11-server22 to better
      identify which versions of Windows that are supported by the drivers in
      that directory.
    . Added v2v_scripts directory: Contains scripts to help with the virt-v2v
      process.
    . Added virt-v2v-vmdp.sh: Copies VMDP files to the host for use with
      virt-v2v.
  * qemu-ga:
    . Update to latest code.
  * virtiofs_svc:
    . Update to latest code.
  * pvctrl.exe:
    . Add the ability to remove registry parameters for drivers.
  * virtio ring:
    . Remove viorngci.dll from vmdp. It is no longer needed.
  * setup.exe:
    . virt-v2v enhancements: Test if doing first boot and add retry setup script.
    . Handle the removal of viorngci.dll from vmdp.
    . For Windows Server 1909, install the drivers for win10-server-16-19.
    . Updated to install drivers from the new media directory layout:
      win10-server16-19 and win10-11-server22
    . When installing on Xen and it's a new install, always prompt for a reboot.
  * uninstall.exe:
    . Handle the removal of viorngci.dll from vmdp.
  * pvvxsvc.exe:
    . virt-v2v enhancements: Test if doing first boot and if vmdp setup
      previously failed. Re-extract vmdp*exe and run vmdp setup.
  * pvvxbn.sys:
    . Bug 1209311. For Xen ballooning switch the default to use
      xenstore first to determine the total number of memory pages instead of
      using the OS. If it can't get the memory pages from Xen, fall back to
      using the OS. pvctrl.exe can be used to switch the default order for
      getting the memory pages.
    . Issue a HYPERVISOR_Shutdown(SHUTDOWN_poweroff) when shutting
      down by clicking on the shutdown button.
  * virtio_fs.sys
    . Fixed memory leak.

-------------------------------------------------------------------
Wed May 22 08:12:59 UTC 2024 - Vasily Ulyanov <vasily.ulyanov@suse.com>

- Add LABEL with source URL

-------------------------------------------------------------------
Fri May  5 07:41:11 UTC 2023 - Vasily Ulyanov <vasily.ulyanov@suse.com>

- Update to version 2.5.4.2: https://github.com/SUSE/vmdp/releases/tag/v2.5.4.2
  * virtio_fs and virtiofs_svc:
    . New driver and service added to VMDP.
  * pvcrash_notify:
    . Added support for the pvpanic-pci device in the pvcrash_notify driver.
    . To use the PCI device the QEMU option "-device pvpanic-pci" is needed.
    . Switched from using symbolic link names to GUID access.
  * pvvxblk:
    . Updated to properly use multiple queues.
    . Increased the possible number of physical page brakes.
    . Properly enable supported features.
    . Now supports discard and write zeros.
    . Report the backend serial number if provided.
    . Support code pages VPD_BLOCK_LIMITS, VPD_BLOCK_DEVICE_CHARACTERISTICS, and VPD_LOGICAL_BLOCK_PROVISIONING.
    . Fixed race condition that could prevent pvvxblk from shutting down correctly causing the vm to hang on shutdown or restart.
    . Fixed potential hang on shutdown/reboot where driver was calling KeDelayExecutionThread at DPC level.
  * pvvxscsi:
    . Updated to properly use multiple queues.
    . Increased the possible number of physical page brakes.
  * pvvxnet:
    . Fixed crash when doing virsh restore.
    . Removed NumPath parameter.
    . Fixed potential crash when uninstalling/reinstalled driver when using RSS.
    . Stopped writing the number of RSS queses in use back to the registry.

-------------------------------------------------------------------
Thu Aug  4 07:31:45 UTC 2022 - Vasily Ulyanov <vasily.ulyanov@suse.com>

- Use standard LABEL directive to add mandatory labels

-------------------------------------------------------------------
Fri Jan 14 09:04:24 UTC 2022 - Vasily Ulyanov <vasily.ulyanov@suse.com>

- Enable only x86_64 build

-------------------------------------------------------------------
Thu Nov 25 06:13:44 UTC 2021 - Vasily Ulyanov <vasily.ulyanov@suse.com>

- Update to version 2.5.3:
  * Added native drivers for Windows 10-2004/Windows Server 2022.
  * For virtio drivers: acknowledge host features supported by the guest that
    had previously been missed.  Add support for packed rings.
  * Better support for wsl2.
  * pvvxbn:
    . Fixed include file issue causing registry reads to fail.
  * pvvxblk:
    . Handle force unit access commands for virtio.
    . Fixed hibernate when using VRTIO_RING_F_EVENT_IDX.
    . Add support for IOCTL_SCSI_MINIPORT_FIRMWARE.
    . Fixed bnc #1170061 (xen): Do gnttab_alloc_grant_references() up front.
  * pvvxscsi:
    . Process Srbs at DPC time rather than interrupt time.
  * pvvxnet:
    . Update to NDIS 6.85 spec. for w2k22.
    . Add priority vlan tagging support.
    . Fixed bnc #1173964 - Schedule rx work after enabling interrupts.
    . Add packet length to IP header for IPv4 LS0v2.
    . Added the ability to use indirect descriptors for TX packets.  Added
      parameters to enable/disable IndirectDescriptors and TxSgCnt to specify
      the manixum number of TX descriptors to use.

-------------------------------------------------------------------
Thu Nov 18 10:27:46 UTC 2021 - Vasily Ulyanov <vasily.ulyanov@suse.com>

- Add 'vendor' and 'url' image labels

-------------------------------------------------------------------
Wed Nov 17 09:40:29 UTC 2021 - Vasily Ulyanov <vasily.ulyanov@suse.com>

- Add workaround for the problem with dependencies
  https://github.com/openSUSE/obs-build/issues/487

-------------------------------------------------------------------
Tue Oct  5 16:59:06 UTC 2021 - Vasily Ulyanov <vasily.ulyanov@suse.com>

- Align the image with officially supported version 2.5.2-200205

-------------------------------------------------------------------
Thu Sep 16 06:19:28 UTC 2021 - Vasily Ulyanov <vasily.ulyanov@suse.com>

- Initial container for VMDP ISO (version 2.5.3-210811)

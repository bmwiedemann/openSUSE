Index: VirtualBox-7.0.10/src/VBox/Additions/linux/drm/vbox_drv.h
===================================================================
--- VirtualBox-7.0.10.orig/src/VBox/Additions/linux/drm/vbox_drv.h
+++ VirtualBox-7.0.10/src/VBox/Additions/linux/drm/vbox_drv.h
@@ -39,6 +39,7 @@
 # pragma once
 #endif
 
+
 #include <linux/version.h>
 
 /* iprt/linux/version.h copy - start */
@@ -166,9 +167,9 @@
 # include <drm/drm_device.h>
 # include <drm/drm_ioctl.h>
 # include <drm/drm_fourcc.h>
-# if RTLNX_VER_MAX(5,15,0) && !RTLNX_RHEL_RANGE(8,7, 8,99) && !RTLNX_RHEL_MAJ_PREREQ(9,1)
-#  include <drm/drm_irq.h>
-# endif
+//# if RTLNX_VER_MAX(5,15,0) && !RTLNX_RHEL_RANGE(8,7, 8,99) && !RTLNX_RHEL_MAJ_PREREQ(9,1)
+//#  include <drm/drm_irq.h>
+//# endif
 # include <drm/drm_vblank.h>
 #else /* < 5.5.0 || RHEL < 8.3 || SLES < 15-SP3 */
 # include <drm/drmP.h>
@@ -198,15 +199,15 @@
 # include <drm/ttm/ttm_resource.h>
 #endif
 
-#if RTLNX_VER_MIN(6,0,0) || RTLNX_RHEL_RANGE(8,8, 8,99) || RTLNX_RHEL_MAJ_PREREQ(9,2)
+#if RTLNX_VER_MIN(5,14,0) || RTLNX_RHEL_RANGE(8,8, 8,99) || RTLNX_RHEL_MAJ_PREREQ(9,2)
 # include <drm/drm_framebuffer.h>
-#endif
 
 #include "vboxvideo_guest.h"
 #include "vboxvideo_vbe.h"
 #include "hgsmi_ch_setup.h"
 
 #include "product-generated.h"
+#endif
 
 #if RTLNX_VER_MAX(4,12,0) && !RTLNX_RHEL_MAJ_PREREQ(7,5)
 static inline void drm_gem_object_put_unlocked(struct drm_gem_object *obj)
Index: VirtualBox-7.0.10/src/VBox/Additions/linux/drm/vbox_drv.c
===================================================================
--- VirtualBox-7.0.10.orig/src/VBox/Additions/linux/drm/vbox_drv.c
+++ VirtualBox-7.0.10/src/VBox/Additions/linux/drm/vbox_drv.c
@@ -52,7 +52,7 @@
 
 /** Detect whether kernel mode setting is OFF. */
 #if defined(CONFIG_VGA_CONSOLE)
-# if RTLNX_VER_MIN(5,17,0) || RTLNX_RHEL_RANGE(8,7, 8,99) || RTLNX_RHEL_MIN(9,1)
+# if RTLNX_VER_MIN(5,14,0) || RTLNX_RHEL_RANGE(8,7, 8,99) || RTLNX_RHEL_MIN(9,1)
 #  define VBOX_VIDEO_NOMODESET() drm_firmware_drivers_only() && vbox_modeset == -1
 # elif RTLNX_VER_MIN(4,7,0)
 #  define VBOX_VIDEO_NOMODESET() vgacon_text_force() && vbox_modeset == -1
@@ -372,7 +372,7 @@ static struct drm_driver driver = {
 #endif
 
 	.fops = &vbox_fops,
-#if RTLNX_VER_MAX(5,15,0) && !RTLNX_RHEL_RANGE(8,7, 8,99) && !RTLNX_RHEL_MAJ_PREREQ(9,1)
+#if RTLNX_VER_MIN(5,15,0)
 	.irq_handler = vbox_irq_handler,
 #endif
 	.name = DRIVER_NAME,
Index: VirtualBox-7.0.10/src/VBox/Additions/linux/drm/vbox_irq.c
===================================================================
--- VirtualBox-7.0.10.orig/src/VBox/Additions/linux/drm/vbox_irq.c
+++ VirtualBox-7.0.10/src/VBox/Additions/linux/drm/vbox_irq.c
@@ -205,21 +205,11 @@ int vbox_irq_init(struct vbox_private *v
 {
 	INIT_WORK(&vbox->hotplug_work, vbox_hotplug_worker);
 	vbox_update_mode_hints(vbox);
-#if RTLNX_VER_MIN(5,15,0) || RTLNX_RHEL_RANGE(8,7, 8,99) || RTLNX_RHEL_MAJ_PREREQ(9,1)
 	return request_irq(VBOX_DRM_TO_PCI_DEV(vbox->dev)->irq, vbox_irq_handler, IRQF_SHARED, vbox->dev->driver->name, vbox->dev);
-#elif RTLNX_VER_MIN(3,16,0) || RTLNX_RHEL_MAJ_PREREQ(7,1)
-	return drm_irq_install(vbox->dev, VBOX_DRM_TO_PCI_DEV(vbox->dev)->irq);
-#else
-	return drm_irq_install(vbox->dev);
-#endif
 }
 
 void vbox_irq_fini(struct vbox_private *vbox)
 {
-#if RTLNX_VER_MIN(5,15,0) || RTLNX_RHEL_RANGE(8,7, 8,99) || RTLNX_RHEL_MAJ_PREREQ(9,1)
 	free_irq(VBOX_DRM_TO_PCI_DEV(vbox->dev)->irq, vbox->dev);
-#else
-	drm_irq_uninstall(vbox->dev);
-#endif
 	flush_work(&vbox->hotplug_work);
 }
Index: VirtualBox-7.0.10/src/VBox/Additions/linux/drm/vbox_ttm.c
===================================================================
--- VirtualBox-7.0.10.orig/src/VBox/Additions/linux/drm/vbox_ttm.c
+++ VirtualBox-7.0.10/src/VBox/Additions/linux/drm/vbox_ttm.c
@@ -323,18 +323,10 @@ static struct ttm_tt *vbox_ttm_tt_create
 #endif
 #if RTLNX_VER_MIN(5,19,0) || RTLNX_RHEL_RANGE(8,8, 8,99) || RTLNX_RHEL_MAJ_PREREQ(9,2)
 	if (ttm_tt_init(tt, bo, page_flags, ttm_write_combined, 0)) {
-#elif RTLNX_VER_MIN(5,11,0) || RTLNX_RHEL_RANGE(8,5, 8,99)
-	if (ttm_tt_init(tt, bo, page_flags, ttm_write_combined)) {
-#elif RTLNX_VER_MIN(4,17,0) || RTLNX_RHEL_MAJ_PREREQ(7,6) || RTLNX_SUSE_MAJ_PREREQ(15,1) || RTLNX_SUSE_MAJ_PREREQ(12,5)
-	if (ttm_tt_init(tt, bo, page_flags)) {
-#else
-	if (ttm_tt_init(tt, bdev, size, page_flags, dummy_read_page)) {
-#endif
-
 		kfree(tt);
 		return NULL;
 	}
-
+#endif
 	return tt;
 }
 
@@ -628,11 +620,7 @@ int vbox_bo_create(struct drm_device *de
 	drm_vma_node_reset(&vboxbo->bo.base.vma_node);
 #endif
 
-#if RTLNX_VER_MIN(6,1,0)
 	ret = ttm_bo_init_validate(&vbox->ttm.bdev, &vboxbo->bo,
-#else
-	ret = ttm_bo_init(&vbox->ttm.bdev, &vboxbo->bo, size,
-#endif /* < 6.1.0 */
 			  ttm_bo_type_device, &vboxbo->placement,
 #if RTLNX_VER_MAX(4,17,0) && !RTLNX_RHEL_MAJ_PREREQ(7,6) && !RTLNX_SUSE_MAJ_PREREQ(15,1) && !RTLNX_SUSE_MAJ_PREREQ(12,5) && !defined(SUSE_SLE12)
 			  align >> PAGE_SHIFT, false, NULL, acc_size,
Index: VirtualBox-7.0.10/src/VBox/Additions/linux/drm/vbox_fb.c
===================================================================
--- VirtualBox-7.0.10.orig/src/VBox/Additions/linux/drm/vbox_fb.c
+++ VirtualBox-7.0.10/src/VBox/Additions/linux/drm/vbox_fb.c
@@ -47,6 +47,7 @@
 #include <drm/drm_crtc.h>
 #include <drm/drm_fb_helper.h>
 #include <drm/drm_crtc_helper.h>
+#include <drm/drm_framebuffer.h>
 
 #include <VBoxVideo.h>
 
Index: VirtualBox-7.0.10/src/VBox/Additions/linux/drm/vbox_mode.c
===================================================================
--- VirtualBox-7.0.10.orig/src/VBox/Additions/linux/drm/vbox_mode.c
+++ VirtualBox-7.0.10/src/VBox/Additions/linux/drm/vbox_mode.c
@@ -39,10 +39,8 @@
 #include "vbox_drv.h"
 #include <linux/export.h>
 #include <drm/drm_crtc_helper.h>
-#if RTLNX_VER_MIN(6,3,0)
 # include <drm/drm_modeset_helper_vtables.h>
 # include <drm/drm_modeset_helper.h>
-#endif
 #if RTLNX_VER_MIN(3,18,0) || RTLNX_RHEL_MAJ_PREREQ(7,2)
 # include <drm/drm_plane_helper.h>
 #endif
@@ -53,6 +51,7 @@
 #if RTLNX_VER_MIN(6,0,0) || RTLNX_RHEL_RANGE(8,8, 8,99) || RTLNX_RHEL_MAJ_PREREQ(9,2)
 # include <drm/drm_edid.h>
 #endif
+#include <drm/drm_edid.h>
 
 #include "VBoxVideo.h"
 
Index: VirtualBox-7.0.10/src/VBox/Frontends/VBoxSDL/VBoxSDL.cpp
===================================================================
--- VirtualBox-7.0.10.orig/src/VBox/Frontends/VBoxSDL/VBoxSDL.cpp
+++ VirtualBox-7.0.10/src/VBox/Frontends/VBoxSDL/VBoxSDL.cpp
@@ -710,7 +710,7 @@ static const char *keyModToStr(unsigned
         RT_CASE_RET_STR(KMOD_NUM);
         RT_CASE_RET_STR(KMOD_CAPS);
         RT_CASE_RET_STR(KMOD_MODE);
-        RT_CASE_RET_STR(KMOD_SCROLL);
+        RT_CASE_RET_STR(KMOD_RESERVED);
         default:
             break;
     }

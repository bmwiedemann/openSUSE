From 5bb6c7f53a6ab5b44c282ba5b118927fd4f17e4f Mon Sep 17 00:00:00 2001
From: Martin Whitaker <icarus@martin-whitaker.me.uk>
Date: Sun, 2 Jun 2019 18:50:18 +0100
Subject: [PATCH] Fix makefile rules for header files generated by bison.

bison 3.4.1 writes the header file before the c++ file. Our makefile
rules make the header files depend on the c++ files, so we need to
fix the timestamps accordingly.
---
 Makefile.in         | 1 +
 tgt-pcb/Makefile.in | 1 +
 vhdlpp/Makefile.in  | 1 +
 vvp/Makefile.in     | 1 +
 4 files changed, 4 insertions(+)

diff --git a/Makefile.in b/Makefile.in
index 6c92581be..fff9534e5 100644
--- a/Makefile.in
+++ b/Makefile.in
@@ -258,6 +258,7 @@ parse.cc: $(srcdir)/parse.y
 	$(YACC) --verbose -t -p VL -d -o $@ $<
 parse.h: parse.cc
 	mv parse.cc.h $@ 2>/dev/null || mv parse.hh $@
+	touch $@
 
 syn-rules.cc: $(srcdir)/syn-rules.y
 	$(YACC) --verbose -t -p syn_ -o $@ $<
diff --git a/tgt-pcb/Makefile.in b/tgt-pcb/Makefile.in
index 9049f38fd..228ede553 100644
--- a/tgt-pcb/Makefile.in
+++ b/tgt-pcb/Makefile.in
@@ -91,6 +91,7 @@ fp.cc: $(srcdir)/fp.y
 	$(YACC) --verbose -t -p fp -d -o $@ $<
 fp.h: fp.cc
 	mv fp.cc.h $@ 2>/dev/null || mv fp.hh $@
+	touch $@
 
 ifeq (@WIN32@,yes)
   TGTLDFLAGS=-L.. -livl
diff --git a/vhdlpp/Makefile.in b/vhdlpp/Makefile.in
index 0a0f264d2..9bafaf100 100644
--- a/vhdlpp/Makefile.in
+++ b/vhdlpp/Makefile.in
@@ -120,6 +120,7 @@ parse.cc: $(srcdir)/parse.y
 	$(YACC) --verbose -t -d -o $@ $<
 parse.h: parse.cc
 	mv parse.cc.h $@ 2>/dev/null || mv parse.hh $@
+	touch $@
 
 lexor_keyword.o: lexor_keyword.cc parse.h
 
diff --git a/vvp/Makefile.in b/vvp/Makefile.in
index 998e38969..469972fbe 100644
--- a/vvp/Makefile.in
+++ b/vvp/Makefile.in
@@ -169,6 +169,7 @@ parse.cc: $(srcdir)/parse.y
 	$(YACC) --verbose -t -d -o $@ $<
 parse.h: parse.cc
 	mv parse.cc.h $@ 2>/dev/null || mv parse.hh $@
+	touch $@
 
 lexor.cc: $(srcdir)/lexor.lex
 	$(LEX) -s -olexor.cc $(srcdir)/lexor.lex

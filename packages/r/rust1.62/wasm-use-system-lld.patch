From 27326c9d887d3409005ce65b0be22e7d4e3ef9c0 Mon Sep 17 00:00:00 2001
From: William Brown <william@blackhats.net.au>
Date: Fri, 20 May 2022 11:14:11 +1000
Subject: [PATCH] wasm use system lld

---
 compiler/rustc_target/src/spec/wasm_base.rs | 6 +++---
 1 file changed, 3 insertions(+), 3 deletions(-)

diff --git a/compiler/rustc_target/src/spec/wasm_base.rs b/compiler/rustc_target/src/spec/wasm_base.rs
index de7b7374af3..00d7db94f89 100644
--- a/compiler/rustc_target/src/spec/wasm_base.rs
+++ b/compiler/rustc_target/src/spec/wasm_base.rs
@@ -99,9 +99,9 @@ pub fn options() -> TargetOptions {
         // arguments just yet
         limit_rdylib_exports: false,
 
-        // we use the LLD shipped with the Rust toolchain by default
-        linker: Some("rust-lld".into()),
-        lld_flavor: LldFlavor::Wasm,
+        // Use lld's wasm-ld frontend.
+        linker: None,
+        linker_flavor: LinkerFlavor::Lld(LldFlavor::Wasm),
         linker_is_gnu: false,
 
         pre_link_args,
-- 
2.32.1 (Apple Git-133)


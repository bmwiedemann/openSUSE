From 7a45c828d05304d90b3a202e55acbbcaab5cdac2 Mon Sep 17 00:00:00 2001
From: =?UTF-8?q?Marcus=20R=C3=BCckert?= <darix@nordisch.org>
Date: Fri, 13 Mar 2015 03:24:25 +0100
Subject: [PATCH 18/32] Only use the extensions doc dir on MRI 2.1.x

---
 templates/gem_packages.spec.erb | 3 +++
 1 file changed, 3 insertions(+)

diff --git a/templates/gem_packages.spec.erb b/templates/gem_packages.spec.erb
index 9e2e877..80e552e 100644
--- a/templates/gem_packages.spec.erb
+++ b/templates/gem_packages.spec.erb
@@ -14,6 +14,9 @@
   end
 
   def self.get_extension_doc_dir(gem_spec)
+    # TODO: This is kinda ugly but it does the job for now.
+    rv = Gem::Version.new(RUBY_VERSION)
+    return nil unless RUBY_ENGINE=='ruby' && (Gem::Version.new('2.2.0') > rv && rv > Gem::Version.new('2.1.0'))
     if gem_spec.respond_to?(:extensions_dir) && RUBY_ENGINE != 'rbx'
       rp = gem_spec.extensions_dir.rpartition(gem_spec.base_dir)
       return File.join(rp[1], 'doc', rp[2]) 
-- 
2.20.1


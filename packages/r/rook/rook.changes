-------------------------------------------------------------------
Mon Sep 16 14:37:05 UTC 2019 - Kristoffer Gronlund <kgronlund@suse.com>

- rook-k8s-yaml: Revert to buildrequire for ceph

-------------------------------------------------------------------------------
Fri Sep 13 16:31:44 UTC 2019 - Blaine Gardner <blaine.gardner@suse.com>

- Update tar creation script
  + build rook tag 'v1.1.0' from 'suse-release-1.1' branch
- Update Rook to tag 'v1.1.0'
  + fix HighMonLeaderChanges alert
  + add leases rules to CSI rules
  + only schedule node drain canaries on nodes with OSDs
  + increase sidecar timeout from 60s to 150s
  + use combined (stdout+stderr) output from ceph-volume
  + set command property for the OSD prepare init container blkdevmapper
  + change OSD DOWN message to debug level
  + discovery daemon: ignore updates on nbd devices

-------------------------------------------------------------------------------
Mon Sep  9 18:17:52 UTC 2019 - Blaine Gardner <blaine.gardner@suse.com>

- Support upstream beta tags by replacing hyphens in release tag with tildes
  + RPMs sorts tildes before anything else to support vX.Y.0~beta.B coming before vX.Y.0

-------------------------------------------------------------------------------
Mon Sep  9 17:27:16 UTC 2019 - Blaine Gardner <blaine.gardner@suse.com>

- Update tar creation script
  + fail on more types of script errors
  + exit properly on error
  + allow checking out tags
  + allow parsing tag versions with hyphens (e.g., v1.1.0-beta.1)
  + use revision (tag) 'v1.1.0-beta.1' from ('suse-release-1.1' branch)
- Update Rook to tag 'v1.1.0-beta.1'
  + support external Ceph clusters
  + fix osdsPerDevice config
  + add portable failure-domain label to OSD deployments
  + add bucket provisioner
  + use deployment with leader election instead of stateful set for CSI drivers
  + fix alerting & recording rules
  + fix race in create ObjectUser
  + support mon migrations without rebuilds when using PVCs
  + allow CRUSH map to be based on PVCs for PVC-based OSDs
  + fix md and dev ordering for ceph-volume batch operations
  + improve upgrades when a mon is down
  + fix service account name for CSI RBD provisioner
  + add -pidlimit flag for CephFS and RBD plugins for CSI driver
  + add image pull secrets option to manifests
  + remove OSD pods marked out if pod is more than an hour old
  + add --db-devices flag to ceph-volume provisioning & fix MB size bug
  + implement GRPC metrics for cephcsi
  + clean up verbose Ceph logging
  + update upgrade documentation for v1.1 release
  + remove unused attacher service account
  + add dynamic expansion to FlexVolume driver
  + fix random OSD pod failures when using PVCs
  + fix osd prepare panic
  + lower minimum OSD memory to 2GB
  + add ability to enable mgr modules via CRD (notably the pg_autoscaler module)
  + fix topologyAware on PVC-based OSDs
  + add support for OpenShift machine disruption budgets

-------------------------------------------------------------------
Fri Aug 23 12:29:48 UTC 2019 - Kristoffer Gronlund <kgronlund@suse.com>

- Make rook-k8s-yaml require the matching ceph version

- Update rook to commit 692553221d8b18fec8aa3ccdc5872e51f05ca372:
  +  uncomment ROOK_CSI_CEPH_IMAGE var

-------------------------------------------------------------------
Fri Aug 16 07:51:27 UTC 2019 - Jan Engelhardt <jengelh@inai.de>

- Trim redundant wording from description.

-------------------------------------------------------------------
Mon Aug 13 11:00:17 UTC 2019 - Denis Kondratenko <denis.kondratenko@suse.com>

- Tech preview release for containers (bsc#1145433)

-------------------------------------------------------------------
Mon Aug 12 11:05:32 UTC 2019 - Denis Kondratenko <denis.kondratenko@suse.com>

- Update Rook to commit e9abbf4831673a9a5545971532ae326e95f3ea60
  + enable the ceph-csi driver by default
  + remove csi default settings from yaml
  + add option to disable flex driver
  + allow the discovery daemon to be optional
  + automatically create the csi secret with the cluster
  + Allow to launch pods when memory request is set (but no memory limit)
  + ceph: chown with init container
  + ceph: when mons use pvc mount volume at subpath
- csi was merged to operator.yaml, sed to correct file

-------------------------------------------------------------------
Fri Aug  2 15:43:42 UTC 2019 - Blaine Gardner <blaine.gardner@suse.com>

- Fix build broken with creation of new rook-integration helper files
- Put helper files into /usr/share/rook-integration dir
- Change name of 'integration' binary to 'rook-integration'

-------------------------------------------------------------------
Thu Aug  1 22:32:25 UTC 2019 - Blaine Gardner <blaine.gardner@suse.com>

- Generate files which contain the names of all images used in the manifests produced by this build
  which are installed with the rook-integration package to assist the integration tooling.

-------------------------------------------------------------------
Thu Aug  1 22:05:36 UTC 2019 - Blaine Gardner <blaine.gardner@suse.com>

- Update spec file to build rook-integration binary
  - Building test binaries is different from building main binaries, so manual steps needed
- Apply linker flags to rookflex binary also (just in case)
- Slightly rework rook-k8s-yaml summary description

-------------------------------------------------------------------
Fri Jul 26 06:59:32 UTC 2019 - Denis Kondratenko <denis.kondratenko@suse.com>

- Correct toolbox location in manifest files

-------------------------------------------------------------------
Tue Jul 23 12:16:41 UTC 2019 - Denis Kondratenko <denis.kondratenko@suse.com>

- Update Rook to commit 7a48482f5cd92397eef068d097ad233739ceae06
  + ceph: run ceph processes with the 'ceph' user
  + Correct typo about skipVolumeForDirectory's code comment
  + Fix: topologyAware does not pick up failure domains.
  + Correct typo about skipVolumeForDirectory's code comment

-------------------------------------------------------------------
Mon Jul 22 12:53:20 UTC 2019 - Denis Kondratenko <denis.kondratenko@suse.com>

- Update Rook to commit 0141cfea50a7f80ff1ee67aa8cc7ad28edc79a64
  + OSD startup on SDN for error "Cannot assign requested address"
  + Change default frontend on nautilus to beast
  + RGW daemon updates:
    ~ Remove support for AllNodes where we would deploy one rgw per node on all the nodes
    ~ Each rgw deployed has its own cephx key
    ~ Upgrades will automatically transition these changes to the rgw daemons
  + Correct --ms-learn-addr-from-peer=false argument for ceph-osd
  + When updating the CephCluster CR to run unsupported octopus, fix operator panic
  + Add metrics for the flexvolume driver
  + Set the fully qualified apiVersion on the OwnerReferences for cleanup on OpenShift
  + Stop enforcing crush tunables for octopus warning
  + Apply the osd nautilus flag for upgrade
  + RGW: Set proper port syntax for beast in nautilus deployments
  + Stop creating initial crushmap to avoid incorrect crush map warning
  + Use correct rounding of PV size for binding of PVCs (for example G or Gi)
- Add psp to common.yaml

-------------------------------------------------------------------
Wed Jul 17 13:34:28 UTC 2019 - Denis Kondratenko <denis.kondratenko@suse.com>

- Use ceph-base pattern instead of packages

-------------------------------------------------------------------
Fri Jul 12 08:29:40 UTC 2019 - Denis Kondratenko <denis.kondratenko@suse.com>

- Fix sed expression to replace correct link

-------------------------------------------------------------------
Fri Jul 12 07:51:34 UTC 2019 - Denis Kondratenko <denis.kondratenko@suse.com>

- Add ceph-csi as a dependency and update manifest link with it

-------------------------------------------------------------------
Thu Jul 11 11:57:09 UTC 2019 - Denis Kondratenko <denis.kondratenko@suse.com>

- correct version for Rook build that doesn's support "+"

-------------------------------------------------------------------
Tue Jul  9 11:02:37 UTC 2019 - Denis Kondratenko <denis.kondratenko@suse.com>

- noarch for the rook-k8s-yaml package
- update rook to a265cdf commit
  + added ROOK_CSI_* template pathes
- modify update script for none Go enviroment

-------------------------------------------------------------------
Mon Jul  8 20:31:11 UTC 2019 - Blaine Gardner <blaine.gardner@suse.com>

- Fix subtly broken dependency (vendor dir) generation
- Generate two tarballs for builds to follow latest upstream best practices for Golang RPM builds
  + primary source tarball is unmodified from source code, and vendor dir is a separate tarball
- Add Rook toolbox script to main rook package
- Update manifests to use SUSE image for toolbox
- Update spec file dependencies
  + remove old Rook dependencies
  + add missing dependencies from the upstream Ceph image (notably nfs-ganesha and CSI requirements)
- Update build to include go build linker flag to set rook binary's internal version representation
- Remove FlexVolume config from manifests, as we intend to use CSI henceforth
- Update Rook to commit c4a3763b6415a118aedaee52eaf76cbdf6b0dabb
  + delay starting Rook system daemons until a CephCluster is created
  + stop setting CRUSH tunable automatically
  + use --ms-learn-addr-from-peer flag for OSDs for Ceph v14.2.2 and up - https://github.com/rook/rook/issues/3140
  + when appropriate, look for rook and tini binaries in PATH if not found in default location
  + set fully qualified apiVersion on OwnerReferences
  + OSDs marked out by Ceph will have their Kubernetes resources automatically cleaned up (will not be removed from CRUSH map)
  + add NodeAffinity to system daemons

-------------------------------------------------------------------
Wed Jul  3 10:02:05 UTC 2019 - Denis Kondratenko <denis.kondratenko@suse.com>

- restore package name and correct unique containers tags

-------------------------------------------------------------------
Tue Jun 18 19:24:25 UTC 2019 - Denis Kondratenko <denis.kondratenko@suse.com>

- changing package name as it couldn't comply to the container tag name
  + https://github.com/containers/image/issues/649

-------------------------------------------------------------------
Tue Jun 18 16:56:11 UTC 2019 - Denis Kondratenko <denis.kondratenko@suse.com>

- Ceph added as a requirement to get it version for the container image
- Added service to strip Ceph version from ceph package
- Fixed sed for the container images names

-------------------------------------------------------------------
Tue Jun 18 15:45:01 UTC 2019 - Denis Kondratenko <denis.kondratenko@suse.com>

- Update Rook to commit ad89e4f47e744c484b8e264e351f6276a42eedfc
  + change csi template path to match rook-k8s-yaml package files
- Fix update-tarball.sh to delete right files
- Add all manifests to the rook-k8s-yaml packages
- Fix rook binary location from /usr/local/bin/ to /usr/bin/

-------------------------------------------------------------------
Tue Jun 18 13:25:46 UTC 2019 - Denis Kondratenko <denis.kondratenko@suse.com>

- Fix update-tarball.sh to ignore errors where is needed
- Update spec to include additional ceph-csi config files

-------------------------------------------------------------------
Mon Jun 17 14:38:33 UTC 2019 - Denis Kondratenko <denis.kondratenko@suse.com>

- Adding additional files as Source to spec

-------------------------------------------------------------------
Mon Jun 17 07:37:48 UTC 2019 - Denis Kondratenko <denis.kondratenko@suse.com>

- Update tarball generation script to get correct version
- Correct tarball name, spec version and package name
- Add new k8s-yaml package to distribute manifests files

-------------------------------------------------------------------
Tue May 21 11:10:14 UTC 2019 - Denis Kondratenko <denis.kondratenko@suse.com>

- Update rook to commit 700cdd36fe9107733a717fac934c2bedd91fd290
- build from https://github.com/SUSE/rook/tree/suse-master
- based on Rook v1.0.0
- Ceph:
  + Ceph Nautilus (v14) is now supported by Rook
  + The Ceph-CSI driver is available for experimental mode
  + A CephNFS CRD will start NFS daemon(s) for exporting CephFS volumes or RGW buckets
  + The number of mons can be increased automatically when new nodes come online
  + OSDs provisioned by ceph-volume now supports metadataDevice and databaseSizeMB options

-------------------------------------------------------------------
Thu Apr 29 12:14:48 UTC 2019 - Jan Fajerski <jan.fajerski@suse.com>

- Update rook to commit c43b57844e37a7909beb362d08ef85fffdd5fed4
- build from https://github.com/SUSE/rook/tree/suse-master
- Ceph:
  + Improve rbd hotplug selection
  + set default version to nautilus
  + improved OSD removal
  + clean shutdown of CephFS
  + improve logging
  + improved upgrade ochestration

-------------------------------------------------------------------
Mon Apr  8 11:45:36 UTC 2019 - Jan Fajerski <jan.fajerski@suse.com>

- Update rook to commit 69936c170cb3913a539eacf963993e9bb3545e8a
- Cassandra: Fix the mount point for th
- Ceph:
  + Improve mon failover cleanup and operator restart during failover
  + Enable host ipc for osd encryption
  + Add missing "host path requires privileged" setting to the helm chart

-------------------------------------------------------------------
Tue Jan 29 07:59:35 UTC 2019 - Jan Fajerski <jan.fajerski@suse.com>

- Update rook to commit 8e263cd9c31b0a310b0d1180e58ac843b432b14b
- Correctly capture and log the stderr output from child processes
- Allow disabling setting fsgroup when mounting a volume
- Allow configuration of SELinux relabeling
- Correctly set the secretKey used for cephfs mounts
- Set ceph-mgr privileges to prevent the dashboard from failing on rbd mirroring settings
- Correctly configure the ssl certificate for the RGW service
- Allow configuration of the dashboard port
- Allow disabling of ssl on the dashboard


-------------------------------------------------------------------
Thu Jan 17 16:33:54 UTC 2019 - Jan Fajerski <jan.fajerski@suse.com>

- Update rook to commit d0cd8cec72176bf28a3ac0ba1457297151004f79
- Ceph CRDs have been declared stable V1.
- Ceph versioning is decoupled from the Rook version. Luminous and Mimic can be run in production, or Nautilus in experimental mode.
- Ceph upgrades are greatly simplified
- The minimum version of Kubernetes supported by Rook changed from 1.7 to 1.8

-------------------------------------------------------------------
Mon Jan 14 11:21:03 UTC 2019 - Jan Fajerski <jan.fajerski@suse.com>

- install to /usr/local/bin as rook hardcodes this path for rookflex

-------------------------------------------------------------------
Tue Oct 30 15:02:03 UTC 2018 - Jan Fajerski <jan.fajerski@suse.com>

- Update rook to commit bf2759e317c44c0ad0aaf635e04cbd72a002a5a0
- Refactor ceph containers to disconnect rook and ceph versions

--------------------------------------------------------------------------------
Thu Apr 26 17:57:19 UTC 2018 - blaine.gardner@suse.com

- Update Rook build to use '-buildmode=pie' flag
- Version at commit e11b3d863728667ea018aa329f3ad907360473cf

--------------------------------------------------------------------------------
Tue Apr 24 16:47:22 UTC 2018 - blaine.gardner@suse.com

- Initial submission
- Version at commit 71514921ad8e41ede6f2814e7004f0465e3dd0f7

- Modifications to upstream Rook to support SLE:
  - None

From e105f89205c68afcca2e4c4a9f925ac44aa80a12 Mon Sep 17 00:00:00 2001
From: "Ivan T. Ivanov" <iivanov@suse.de>
Date: Mon, 17 Jul 2023 17:38:31 +0300
Subject: [PATCH] ARM: dts: bcm27xx: Use better name for spidev

Since this patch [1] 'spidev' compatible strings can not be used to auto bind
to spidev module. Aparently upstream don not want these to used anymore.

Vendor linux tree, from where we are geting thse Device Tree files, still
support this becase it have this [2] patch.

Lets follow upstream descision even if we slighly diverge from the Vendor
Device Tree sources.

[1] fffc84fd87d9 ("spi: spidev: Make probe to fail early if a spidev compatible is used")
[2] 0dd30794bd79 ("spi: spidev: Restore loading from Device Tree")

This fixes bsc#1212791

Signed-off-by: Ivan T. Ivanov <iivanov@suse.de>
---
 arch/arm/boot/dts/broadcom/bcm2708-rpi-b-plus.dts   | 4 ++--
 arch/arm/boot/dts/broadcom/bcm2708-rpi-b-rev1.dts   | 4 ++--
 arch/arm/boot/dts/broadcom/bcm2708-rpi-b.dts        | 4 ++--
 arch/arm/boot/dts/broadcom/bcm2708-rpi-cm.dts       | 4 ++--
 arch/arm/boot/dts/broadcom/bcm2708-rpi-zero-w.dts   | 4 ++--
 arch/arm/boot/dts/broadcom/bcm2708-rpi-zero.dts     | 4 ++--
 arch/arm/boot/dts/broadcom/bcm2709-rpi-2-b.dts      | 4 ++--
 arch/arm/boot/dts/broadcom/bcm2709-rpi-cm2.dts      | 4 ++--
 arch/arm/boot/dts/broadcom/bcm2710-rpi-2-b.dts      | 4 ++--
 arch/arm/boot/dts/broadcom/bcm2710-rpi-3-b-plus.dts | 4 ++--
 arch/arm/boot/dts/broadcom/bcm2710-rpi-3-b.dts      | 4 ++--
 arch/arm/boot/dts/broadcom/bcm2710-rpi-cm3.dts      | 4 ++--
 arch/arm/boot/dts/broadcom/bcm2710-rpi-zero-2-w.dts | 4 ++--
 arch/arm/boot/dts/broadcom/bcm2711-rpi-4-b.dts      | 4 ++--
 arch/arm/boot/dts/broadcom/bcm2711-rpi-cm4.dts      | 4 ++--
 arch/arm/boot/dts/broadcom/bcm2711-rpi-cm4s.dts     | 4 ++--
 16 files changed, 32 insertions(+), 32 deletions(-)

diff --git a/arch/arm/boot/dts/broadcom/bcm2708-rpi-b-plus.dts b/arch/arm/boot/dts/broadcom/bcm2708-rpi-b-plus.dts
index b317e83..c94e102 100644
--- a/arch/arm/boot/dts/broadcom/bcm2708-rpi-b-plus.dts
+++ b/arch/arm/boot/dts/broadcom/bcm2708-rpi-b-plus.dts
@@ -121,7 +121,7 @@
 	cs-gpios = <&gpio 8 1>, <&gpio 7 1>;
 
 	spidev0: spidev@0{
-		compatible = "spidev";
+		compatible = "rohm,dh2228fv";
 		reg = <0>;	/* CE0 */
 		#address-cells = <1>;
 		#size-cells = <0>;
@@ -129,7 +129,7 @@
 	};
 
 	spidev1: spidev@1{
-		compatible = "spidev";
+		compatible = "rohm,dh2228fv";
 		reg = <1>;	/* CE1 */
 		#address-cells = <1>;
 		#size-cells = <0>;
diff --git a/arch/arm/boot/dts/broadcom/bcm2708-rpi-b-rev1.dts b/arch/arm/boot/dts/broadcom/bcm2708-rpi-b-rev1.dts
index 228fd47..f3055af 100644
--- a/arch/arm/boot/dts/broadcom/bcm2708-rpi-b-rev1.dts
+++ b/arch/arm/boot/dts/broadcom/bcm2708-rpi-b-rev1.dts
@@ -121,7 +121,7 @@
 	cs-gpios = <&gpio 8 1>, <&gpio 7 1>;
 
 	spidev0: spidev@0{
-		compatible = "spidev";
+		compatible = "rohm,dh2228fv";
 		reg = <0>;	/* CE0 */
 		#address-cells = <1>;
 		#size-cells = <0>;
@@ -129,7 +129,7 @@
 	};
 
 	spidev1: spidev@1{
-		compatible = "spidev";
+		compatible = "rohm,dh2228fv";
 		reg = <1>;	/* CE1 */
 		#address-cells = <1>;
 		#size-cells = <0>;
diff --git a/arch/arm/boot/dts/broadcom/bcm2708-rpi-b.dts b/arch/arm/boot/dts/broadcom/bcm2708-rpi-b.dts
index 1df74d5..ef6dbf9 100644
--- a/arch/arm/boot/dts/broadcom/bcm2708-rpi-b.dts
+++ b/arch/arm/boot/dts/broadcom/bcm2708-rpi-b.dts
@@ -121,7 +121,7 @@
 	cs-gpios = <&gpio 8 1>, <&gpio 7 1>;
 
 	spidev0: spidev@0{
-		compatible = "spidev";
+		compatible = "rohm,dh2228fv";
 		reg = <0>;	/* CE0 */
 		#address-cells = <1>;
 		#size-cells = <0>;
@@ -129,7 +129,7 @@
 	};
 
 	spidev1: spidev@1{
-		compatible = "spidev";
+		compatible = "rohm,dh2228fv";
 		reg = <1>;	/* CE1 */
 		#address-cells = <1>;
 		#size-cells = <0>;
diff --git a/arch/arm/boot/dts/broadcom/bcm2708-rpi-cm.dts b/arch/arm/boot/dts/broadcom/bcm2708-rpi-cm.dts
index 6f7fea0..a4aaadf 100644
--- a/arch/arm/boot/dts/broadcom/bcm2708-rpi-cm.dts
+++ b/arch/arm/boot/dts/broadcom/bcm2708-rpi-cm.dts
@@ -126,7 +126,7 @@ cam0_reg: &cam0_regulator {
 	cs-gpios = <&gpio 8 1>, <&gpio 7 1>;
 
 	spidev0: spidev@0{
-		compatible = "spidev";
+		compatible = "rohm,dh2228fv";
 		reg = <0>;	/* CE0 */
 		#address-cells = <1>;
 		#size-cells = <0>;
@@ -134,7 +134,7 @@ cam0_reg: &cam0_regulator {
 	};
 
 	spidev1: spidev@1{
-		compatible = "spidev";
+		compatible = "rohm,dh2228fv";
 		reg = <1>;	/* CE1 */
 		#address-cells = <1>;
 		#size-cells = <0>;
diff --git a/arch/arm/boot/dts/broadcom/bcm2708-rpi-zero-w.dts b/arch/arm/boot/dts/broadcom/bcm2708-rpi-zero-w.dts
index 4266caf..8a2225e 100644
--- a/arch/arm/boot/dts/broadcom/bcm2708-rpi-zero-w.dts
+++ b/arch/arm/boot/dts/broadcom/bcm2708-rpi-zero-w.dts
@@ -183,7 +183,7 @@
 	cs-gpios = <&gpio 8 1>, <&gpio 7 1>;
 
 	spidev0: spidev@0{
-		compatible = "spidev";
+		compatible = "rohm,dh2228fv";
 		reg = <0>;	/* CE0 */
 		#address-cells = <1>;
 		#size-cells = <0>;
@@ -191,7 +191,7 @@
 	};
 
 	spidev1: spidev@1{
-		compatible = "spidev";
+		compatible = "rohm,dh2228fv";
 		reg = <1>;	/* CE1 */
 		#address-cells = <1>;
 		#size-cells = <0>;
diff --git a/arch/arm/boot/dts/broadcom/bcm2708-rpi-zero.dts b/arch/arm/boot/dts/broadcom/bcm2708-rpi-zero.dts
index 3069f58..14c44c7 100644
--- a/arch/arm/boot/dts/broadcom/bcm2708-rpi-zero.dts
+++ b/arch/arm/boot/dts/broadcom/bcm2708-rpi-zero.dts
@@ -118,7 +118,7 @@
 	cs-gpios = <&gpio 8 1>, <&gpio 7 1>;
 
 	spidev0: spidev@0{
-		compatible = "spidev";
+		compatible = "rohm,dh2228fv";
 		reg = <0>;	/* CE0 */
 		#address-cells = <1>;
 		#size-cells = <0>;
@@ -126,7 +126,7 @@
 	};
 
 	spidev1: spidev@1{
-		compatible = "spidev";
+		compatible = "rohm,dh2228fv";
 		reg = <1>;	/* CE1 */
 		#address-cells = <1>;
 		#size-cells = <0>;
diff --git a/arch/arm/boot/dts/broadcom/bcm2709-rpi-2-b.dts b/arch/arm/boot/dts/broadcom/bcm2709-rpi-2-b.dts
index c3e1b1b..c2f6a2b 100644
--- a/arch/arm/boot/dts/broadcom/bcm2709-rpi-2-b.dts
+++ b/arch/arm/boot/dts/broadcom/bcm2709-rpi-2-b.dts
@@ -121,7 +121,7 @@
 	cs-gpios = <&gpio 8 1>, <&gpio 7 1>;
 
 	spidev0: spidev@0{
-		compatible = "spidev";
+		compatible = "rohm,dh2228fv";
 		reg = <0>;	/* CE0 */
 		#address-cells = <1>;
 		#size-cells = <0>;
@@ -129,7 +129,7 @@
 	};
 
 	spidev1: spidev@1{
-		compatible = "spidev";
+		compatible = "rohm,dh2228fv";
 		reg = <1>;	/* CE1 */
 		#address-cells = <1>;
 		#size-cells = <0>;
diff --git a/arch/arm/boot/dts/broadcom/bcm2709-rpi-cm2.dts b/arch/arm/boot/dts/broadcom/bcm2709-rpi-cm2.dts
index 78881c5..c22e94b 100644
--- a/arch/arm/boot/dts/broadcom/bcm2709-rpi-cm2.dts
+++ b/arch/arm/boot/dts/broadcom/bcm2709-rpi-cm2.dts
@@ -155,7 +155,7 @@ cam0_reg: &cam0_regulator {
 	cs-gpios = <&gpio 8 1>, <&gpio 7 1>;
 
 	spidev0: spidev@0{
-		compatible = "spidev";
+		compatible = "rohm,dh2228fv";
 		reg = <0>;	/* CE0 */
 		#address-cells = <1>;
 		#size-cells = <0>;
@@ -163,7 +163,7 @@ cam0_reg: &cam0_regulator {
 	};
 
 	spidev1: spidev@1{
-		compatible = "spidev";
+		compatible = "rohm,dh2228fv";
 		reg = <1>;	/* CE1 */
 		#address-cells = <1>;
 		#size-cells = <0>;
diff --git a/arch/arm/boot/dts/broadcom/bcm2710-rpi-2-b.dts b/arch/arm/boot/dts/broadcom/bcm2710-rpi-2-b.dts
index 3c89b44..5e365c9 100644
--- a/arch/arm/boot/dts/broadcom/bcm2710-rpi-2-b.dts
+++ b/arch/arm/boot/dts/broadcom/bcm2710-rpi-2-b.dts
@@ -121,7 +121,7 @@
 	cs-gpios = <&gpio 8 1>, <&gpio 7 1>;
 
 	spidev0: spidev@0{
-		compatible = "spidev";
+		compatible = "rohm,dh2228fv";
 		reg = <0>;	/* CE0 */
 		#address-cells = <1>;
 		#size-cells = <0>;
@@ -129,7 +129,7 @@
 	};
 
 	spidev1: spidev@1{
-		compatible = "spidev";
+		compatible = "rohm,dh2228fv";
 		reg = <1>;	/* CE1 */
 		#address-cells = <1>;
 		#size-cells = <0>;
diff --git a/arch/arm/boot/dts/broadcom/bcm2710-rpi-3-b-plus.dts b/arch/arm/boot/dts/broadcom/bcm2710-rpi-3-b-plus.dts
index 818804d..a636fc5 100644
--- a/arch/arm/boot/dts/broadcom/bcm2710-rpi-3-b-plus.dts
+++ b/arch/arm/boot/dts/broadcom/bcm2710-rpi-3-b-plus.dts
@@ -203,7 +203,7 @@
 	cs-gpios = <&gpio 8 1>, <&gpio 7 1>;
 
 	spidev0: spidev@0{
-		compatible = "spidev";
+		compatible = "rohm,dh2228fv";
 		reg = <0>;	/* CE0 */
 		#address-cells = <1>;
 		#size-cells = <0>;
@@ -211,7 +211,7 @@
 	};
 
 	spidev1: spidev@1{
-		compatible = "spidev";
+		compatible = "rohm,dh2228fv";
 		reg = <1>;	/* CE1 */
 		#address-cells = <1>;
 		#size-cells = <0>;
diff --git a/arch/arm/boot/dts/broadcom/bcm2710-rpi-3-b.dts b/arch/arm/boot/dts/broadcom/bcm2710-rpi-3-b.dts
index 14bb3be..9070cc7 100644
--- a/arch/arm/boot/dts/broadcom/bcm2710-rpi-3-b.dts
+++ b/arch/arm/boot/dts/broadcom/bcm2710-rpi-3-b.dts
@@ -218,7 +218,7 @@
 	cs-gpios = <&gpio 8 1>, <&gpio 7 1>;
 
 	spidev0: spidev@0{
-		compatible = "spidev";
+		compatible = "rohm,dh2228fv";
 		reg = <0>;	/* CE0 */
 		#address-cells = <1>;
 		#size-cells = <0>;
@@ -226,7 +226,7 @@
 	};
 
 	spidev1: spidev@1{
-		compatible = "spidev";
+		compatible = "rohm,dh2228fv";
 		reg = <1>;	/* CE1 */
 		#address-cells = <1>;
 		#size-cells = <0>;
diff --git a/arch/arm/boot/dts/broadcom/bcm2710-rpi-cm3.dts b/arch/arm/boot/dts/broadcom/bcm2710-rpi-cm3.dts
index 5cb7342..6fa4d8a 100644
--- a/arch/arm/boot/dts/broadcom/bcm2710-rpi-cm3.dts
+++ b/arch/arm/boot/dts/broadcom/bcm2710-rpi-cm3.dts
@@ -155,7 +155,7 @@ cam0_reg: &cam0_regulator {
 	cs-gpios = <&gpio 8 1>, <&gpio 7 1>;
 
 	spidev0: spidev@0{
-		compatible = "spidev";
+		compatible = "rohm,dh2228fv";
 		reg = <0>;	/* CE0 */
 		#address-cells = <1>;
 		#size-cells = <0>;
@@ -163,7 +163,7 @@ cam0_reg: &cam0_regulator {
 	};
 
 	spidev1: spidev@1{
-		compatible = "spidev";
+		compatible = "rohm,dh2228fv";
 		reg = <1>;	/* CE1 */
 		#address-cells = <1>;
 		#size-cells = <0>;
diff --git a/arch/arm/boot/dts/broadcom/bcm2710-rpi-zero-2-w.dts b/arch/arm/boot/dts/broadcom/bcm2710-rpi-zero-2-w.dts
index 8cf0f45..ebdf5e7 100644
--- a/arch/arm/boot/dts/broadcom/bcm2710-rpi-zero-2-w.dts
+++ b/arch/arm/boot/dts/broadcom/bcm2710-rpi-zero-2-w.dts
@@ -196,7 +196,7 @@
 	cs-gpios = <&gpio 8 1>, <&gpio 7 1>;
 
 	spidev0: spidev@0{
-		compatible = "spidev";
+		compatible = "rohm,dh2228fv";
 		reg = <0>;	/* CE0 */
 		#address-cells = <1>;
 		#size-cells = <0>;
@@ -204,7 +204,7 @@
 	};
 
 	spidev1: spidev@1{
-		compatible = "spidev";
+		compatible = "rohm,dh2228fv";
 		reg = <1>;	/* CE1 */
 		#address-cells = <1>;
 		#size-cells = <0>;
diff --git a/arch/arm/boot/dts/broadcom/bcm2711-rpi-4-b.dts b/arch/arm/boot/dts/broadcom/bcm2711-rpi-4-b.dts
index 15f46d5..cfe3228 100644
--- a/arch/arm/boot/dts/broadcom/bcm2711-rpi-4-b.dts
+++ b/arch/arm/boot/dts/broadcom/bcm2711-rpi-4-b.dts
@@ -294,7 +294,7 @@
 	cs-gpios = <&gpio 8 1>, <&gpio 7 1>;
 
 	spidev0: spidev@0{
-		compatible = "spidev";
+		compatible = "rohm,dh2228fv";
 		reg = <0>;	/* CE0 */
 		#address-cells = <1>;
 		#size-cells = <0>;
@@ -302,7 +302,7 @@
 	};
 
 	spidev1: spidev@1{
-		compatible = "spidev";
+		compatible = "rohm,dh2228fv";
 		reg = <1>;	/* CE1 */
 		#address-cells = <1>;
 		#size-cells = <0>;
diff --git a/arch/arm/boot/dts/broadcom/bcm2711-rpi-cm4.dts b/arch/arm/boot/dts/broadcom/bcm2711-rpi-cm4.dts
index 8718e13..e4618d5 100644
--- a/arch/arm/boot/dts/broadcom/bcm2711-rpi-cm4.dts
+++ b/arch/arm/boot/dts/broadcom/bcm2711-rpi-cm4.dts
@@ -303,7 +303,7 @@
 	cs-gpios = <&gpio 8 1>, <&gpio 7 1>;
 
 	spidev0: spidev@0{
-		compatible = "spidev";
+		compatible = "rohm,dh2228fv";
 		reg = <0>;	/* CE0 */
 		#address-cells = <1>;
 		#size-cells = <0>;
@@ -311,7 +311,7 @@
 	};
 
 	spidev1: spidev@1{
-		compatible = "spidev";
+		compatible = "rohm,dh2228fv";
 		reg = <1>;	/* CE1 */
 		#address-cells = <1>;
 		#size-cells = <0>;
diff --git a/arch/arm/boot/dts/broadcom/bcm2711-rpi-cm4s.dts b/arch/arm/boot/dts/broadcom/bcm2711-rpi-cm4s.dts
index 1069184..69cbca6 100644
--- a/arch/arm/boot/dts/broadcom/bcm2711-rpi-cm4s.dts
+++ b/arch/arm/boot/dts/broadcom/bcm2711-rpi-cm4s.dts
@@ -182,7 +182,7 @@
 	cs-gpios = <&gpio 8 1>, <&gpio 7 1>;
 
 	spidev0: spidev@0{
-		compatible = "spidev";
+		compatible = "rohm,dh2228fv";
 		reg = <0>;	/* CE0 */
 		#address-cells = <1>;
 		#size-cells = <0>;
@@ -190,7 +190,7 @@
 	};
 
 	spidev1: spidev@1{
-		compatible = "spidev";
+		compatible = "rohm,dh2228fv";
 		reg = <1>;	/* CE1 */
 		#address-cells = <1>;
 		#size-cells = <0>;
-- 
2.35.3

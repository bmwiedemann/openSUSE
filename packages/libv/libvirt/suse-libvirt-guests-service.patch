From b447f2a3042a206bebb897874af20fdd7d897347 Mon Sep 17 00:00:00 2001
From: Jim Fehlig <jfehlig@suse.com>
Date: Tue, 5 Jul 2022 11:41:58 -0600
Subject: Adjust libvirt-guests service to conform to SUSE standards

Signed-off-by: Jim Fehlig <jfehlig@suse.com>
---
 tools/libvirt-guests.sh.in | 10 +++++-----
 1 file changed, 5 insertions(+), 5 deletions(-)

Index: libvirt-9.0.0/tools/libvirt-guests.sh.in
===================================================================
--- libvirt-9.0.0.orig/tools/libvirt-guests.sh.in
+++ libvirt-9.0.0/tools/libvirt-guests.sh.in
@@ -20,10 +20,6 @@ sysconfdir="@sysconfdir@"
 localstatedir="@localstatedir@"
 libvirtd="@sbindir@"/libvirtd
 
-# Source function library.
-test ! -r "$sysconfdir"/rc.d/init.d/functions ||
-    . "$sysconfdir"/rc.d/init.d/functions
-
 # Source gettext library.
 # Make sure this file is recognized as having translations: _("dummy")
 . "@bindir@"/gettext.sh
@@ -43,7 +39,11 @@ test -f "$sysconfdir"/sysconfig/libvirt-
     . "$sysconfdir"/sysconfig/libvirt-guests
 
 LISTFILE="$localstatedir"/lib/libvirt/libvirt-guests
-VAR_SUBSYS_LIBVIRT_GUESTS="$localstatedir"/lock/subsys/libvirt-guests
+if [ -d "$localstatedir"/lock/subsys ]; then
+    VAR_SUBSYS_LIBVIRT_GUESTS="$localstatedir"/lock/subsys/libvirt-guests
+else
+    VAR_SUBSYS_LIBVIRT_GUESTS="$localstatedir"/lock/libvirt-guests
+fi
 
 RETVAL=0
 

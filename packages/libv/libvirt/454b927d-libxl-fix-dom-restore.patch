commit 454b927d1e33a1fe9dca535db2c97300fdae62cc
Author: Jim Fehlig <jfehlig@suse.com>
Date:   Thu Feb 17 11:48:13 2022 -0700

    libxl: Fix libvirtd crash on domain restore
    
    Commit cc2a3c2a94 missed one case in the libxl driver where virDomainDef
    is returned from libxlDomainSaveImageOpen and a g_steal_pointer is needed.
    Without it, the virDomainDef object is freed and the driver crashes later
    in the restore process when accessing the object.
    
    Signed-off-by: Jim Fehlig <jfehlig@suse.com>
    Reviewed-by: JÃ¡n Tomko <jtomko@redhat.com>

Index: libvirt-8.0.0/src/libxl/libxl_domain.c
===================================================================
--- libvirt-8.0.0.orig/src/libxl/libxl_domain.c
+++ libvirt-8.0.0/src/libxl/libxl_domain.c
@@ -811,7 +811,7 @@ libxlDomainSaveImageOpen(libxlDriverPriv
                                         VIR_DOMAIN_DEF_PARSE_SKIP_VALIDATE)))
         goto error;
 
-    *ret_def = def;
+    *ret_def = g_steal_pointer(&def);
     *ret_hdr = hdr;
 
     return fd;

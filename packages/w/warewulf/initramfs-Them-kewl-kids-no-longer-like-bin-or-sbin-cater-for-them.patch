From: Egbert Eich <eich@suse.com>
Date: Sat Oct 9 10:50:49 2021 +0200
Subject: initramfs: Them 'kewl' kids no longer like /bin or /sbin - cater for them
Patch-mainline: Not yet
Git-commit: 940464e684aac87bea21bf6c9d73ed13453584ac
References: 

Create relative links to help installation, replace by absolute links
before creating the image.

Signed-off-by: Egbert Eich <eich@suse.com>
---
 provision/initramfs/Makefile.am | 6 ++++++
 1 file changed, 6 insertions(+)
diff --git a/provision/initramfs/Makefile.am b/provision/initramfs/Makefile.am
index cc032d4..bf03405 100644
--- a/provision/initramfs/Makefile.am
+++ b/provision/initramfs/Makefile.am
@@ -119,6 +119,8 @@ rootfs: busybox e2fsprogs libarchive parted
 	mkdir rootfs/usr
 	mkdir rootfs/lib
 	mkdir rootfs/lib64
+	ln -s ../bin rootfs/usr/bin
+	ln -s ../sbin rootfs/usr/sbin
 	chmod -R u+w rootfs/
 	if [ -n "@local_busybox_path@" -a -f "@local_busybox_path@" -a \
 	    -n "@local_busybox_path@" -a -f "@busybox_links_path@" ]; then \
@@ -169,6 +171,10 @@ rootfs: busybox e2fsprogs libarchive parted
 	ln -s transporthandler rootfs/sbin/wwgetscript
 	ln -s transporthandler rootfs/sbin/wwgetnodeconfig
 	ln -s transporthandler rootfs/sbin/wwgetfiles
+	rm -f rootfs/usr/bin
+	ln -s /bin rootfs/usr/bin
+	rm -f rootfs/usr/sbin
+	ln -s /sbin rootfs/usr/sbin
 
 initramfs.cpio: rootfs
 	install -m 644 $(srcdir)/devs.cpio initramfs.cpio

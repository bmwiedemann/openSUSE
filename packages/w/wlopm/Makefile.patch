--- Makefile.orig	2022-06-05 20:00:49.854139519 +0800
+++ Makefile	2022-06-05 20:13:15.797079274 +0800
@@ -4,8 +4,8 @@
 BINDIR=$(PREFIX)/bin
 MANDIR=$(PREFIX)/share/man
 
-CFLAGS+=-Wall -Werror -Wextra -Wpedantic -Wno-unused-parameter -Wconversion -Wformat-security -Wformat -Wsign-conversion -Wfloat-conversion -Wunused-result
-LIBS=-lwayland-client
+CFLAGS+=-Wall -Werror -Wextra -Wpedantic -Wno-unused-parameter -Wconversion -Wformat-security -Wformat -Wsign-conversion -Wfloat-conversion -Wunused-result $(shell pkg-config --cflags wayland-client)
+LIBS=$(shell pkg-config --libs wayland-client)
 OBJ=wlopm.o wlr-output-power-management-unstable-v1.o
 GEN=wlr-output-power-management-unstable-v1.c wlr-output-power-management-unstable-v1.h
 
@@ -21,8 +21,8 @@
 	$(SCANNER) client-header < $< > $@
 
 install: wlopm
-	install -D wlopm   $(DESTDIR)$(BINDIR)/wlopm
-	install -D wlopm.1 $(DESTDIR)$(MANDIR)/man1/wlopm.1
+	install -Dm755 wlopm   $(DESTDIR)$(BINDIR)/wlopm
+	install -Dm644 wlopm.1 $(DESTDIR)$(MANDIR)/man1/wlopm.1
 
 uninstall:
 	$(RM) $(DESTDIR)$(BINDIR)/wlopm

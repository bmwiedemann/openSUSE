From 5831161b1eb27c78246ffff562a5c5c3eb3bbade Mon Sep 17 00:00:00 2001
From: Marco Bettini <marco.bettini@open-xchange.com>
Date: Tue, 9 Dec 2025 09:18:19 +0000
Subject: [PATCH 4/4] auth: Set CRYPT as default passdb_default_password_scheme

---
 src/auth/auth-settings.c                   | 2 +-
 src/lib-settings/settings-history-core.txt | 3 +++
 2 files changed, 4 insertions(+), 1 deletion(-)

Index: core/src/auth/auth-settings.c
===================================================================
--- core.orig/src/auth/auth-settings.c
+++ core/src/auth/auth-settings.c
@@ -136,7 +136,7 @@ static const struct auth_passdb_settings
 	.mechanisms_filter = ARRAY_INIT,
 	.username_filter = "",
 
-	.default_password_scheme = "PLAIN",
+	.default_password_scheme = "CRYPT",
 
 	.skip = "never:authenticated:unauthenticated",
 	.result_success = "return-ok:return:return-fail:continue:continue-ok:continue-fail",
Index: core/src/lib-settings/settings-history-core.txt
===================================================================
--- core.orig/src/lib-settings/settings-history-core.txt
+++ core/src/lib-settings/settings-history-core.txt
@@ -1,3 +1,6 @@
+default	passdb_ldap/passdb_default_password_scheme	CRYPT	2.4.2	3.2.0
+default	passdb_passwd/passdb_default_password_scheme	CRYPT	2.4.2	3.2.0
+default	passdb_default_password_scheme	PLAIN	2.4.2	3.2.0
 default	mail_attachment_detection_options		2.4.2	3.2.0
 default	@metric_defaults/proxy/metric	auth_successes,auth_failures,login_aborted	2.4.2	3.2.0
 default	fts_search_read_fallback	yes	-	3.2.0

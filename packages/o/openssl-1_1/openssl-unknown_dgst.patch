Index: openssl-1.1.1d/apps/dgst.c
===================================================================
--- openssl-1.1.1d.orig/apps/dgst.c	2019-09-10 15:13:07.000000000 +0200
+++ openssl-1.1.1d/apps/dgst.c	2020-03-20 11:20:27.618536409 +0100
@@ -95,6 +95,10 @@ int dgst_main(int argc, char **argv)
     prog = opt_progname(argv[0]);
     buf = app_malloc(BUFSIZE, "I/O buffer");
     md = EVP_get_digestbyname(prog);
+    if (md == NULL && strcmp(prog, "dgst") != 0) {
+        BIO_printf(bio_err, "%s is not a known digest\n", prog);
+        goto end;
+    }
 
     prog = opt_init(argc, argv, dgst_options);
     while ((o = opt_next()) != OPT_EOF) {

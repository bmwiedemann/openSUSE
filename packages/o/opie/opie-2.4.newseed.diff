--- opie-2.4/libopie/newseed.c
+++ opie-2.4/libopie/newseed.c
@@ -55,7 +55,8 @@
 			if (++i >= max)
 				i = 1;
 
-			snprintf(c, end - c, "%d", i);
+         /* fix: use all available space and don't break seedlength */
+         snprintf(c, OPIE_SEED_MAX - (c - seed), "%04d", i);
 			seed[OPIE_SEED_MAX] = 0;
 			return 0;
 		}

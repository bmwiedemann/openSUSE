Index: openssh-7.9p1/openbsd-compat/openssl-compat.c
===================================================================
--- openssh-7.9p1.orig/openbsd-compat/openssl-compat.c	2018-11-26 11:47:17.417925053 +0100
+++ openssh-7.9p1/openbsd-compat/openssl-compat.c	2018-11-26 11:52:47.127727580 +0100
@@ -76,7 +76,7 @@ ssh_OpenSSL_add_all_algorithms(void)
 	ENGINE_load_builtin_engines();
 	ENGINE_register_all_complete();
 
-#if OPENSSL_VERSION_NUMBER < 0x10001000L
+#if OPENSSL_VERSION_NUMBER < 0x10100000L
 	OPENSSL_config(NULL);
 #else
 	OPENSSL_init_crypto(OPENSSL_INIT_ADD_ALL_CIPHERS |
Index: openssh-7.9p1/gss-genr.c
===================================================================
--- openssh-7.9p1.orig/gss-genr.c	2018-11-26 11:47:17.417925053 +0100
+++ openssh-7.9p1/gss-genr.c	2018-11-26 12:01:40.354642746 +0100
@@ -114,7 +114,11 @@ ssh_gssapi_kex_mechs(gss_OID_set gss_sup
        if ((buf = sshbuf_new()) == NULL)
 	 fatal("%s: sshbuf_new failed", __func__);
 
+#if OPENSSL_VERSION_NUMBER < 0x10100000L
+       md = EVP_MD_CTX_create();
+#else
        md = EVP_MD_CTX_new();
+#endif
        oidpos = 0;
        for (i = 0; i < gss_supported->count; i++) {
 	       if (gss_supported->elements[i].length < 128 &&
@@ -156,7 +160,11 @@ ssh_gssapi_kex_mechs(gss_OID_set gss_sup
 		       oidpos++;
 	       }
        }
+#if OPENSSL_VERSION_NUMBER < 0x10100000L
+       EVP_MD_CTX_destroy(md);
+#else
        EVP_MD_CTX_free(md);
+#endif
        gss_enc2oid[oidpos].oid = NULL;
        gss_enc2oid[oidpos].encoded = NULL;
 

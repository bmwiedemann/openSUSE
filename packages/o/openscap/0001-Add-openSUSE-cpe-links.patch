From 48685f390b865f6edd7df8dba955c03dff6045e8 Mon Sep 17 00:00:00 2001
From: =?UTF-8?q?Klaus=20K=C3=A4mpf?= <kkaempf@suse.de>
Date: Tue, 28 Mar 2023 12:02:43 +0200
Subject: [PATCH 1/5] Add openSUSE cpe links

---
 cpe/openscap-cpe-dict.xml |  24 +++++++
 cpe/openscap-cpe-oval.xml | 127 ++++++++++++++++++++++++++++++++++++++
 2 files changed, 151 insertions(+)

diff --git a/cpe/openscap-cpe-dict.xml b/cpe/openscap-cpe-dict.xml
index 02d5361..cf52bee 100644
--- a/cpe/openscap-cpe-dict.xml
+++ b/cpe/openscap-cpe-dict.xml
@@ -53,4 +53,28 @@
             <title xml:lang="en-us">Fedora 35</title>
             <check system="http://oval.mitre.org/XMLSchema/oval-definitions-5" href="openscap-cpe-oval.xml">oval:org.open-scap.cpe.fedora:def:35</check>
       </cpe-item>
+      <cpe-item name="cpe:/o:opensuse:leap:15.1">
+            <title xml:lang="en-us">openSUSE Leap 15.1</title>
+            <check system="http://oval.mitre.org/XMLSchema/oval-definitions-5" href="openscap-cpe-oval.xml">oval:org.open-scap.cpe.opensuse:def:151</check>
+      </cpe-item>
+      <cpe-item name="cpe:/o:opensuse:leap:15.2">
+            <title xml:lang="en-us">openSUSE Leap 15.2</title>
+            <check system="http://oval.mitre.org/XMLSchema/oval-definitions-5" href="openscap-cpe-oval.xml">oval:org.open-scap.cpe.opensuse:def:152</check>
+      </cpe-item>
+      <cpe-item name="cpe:/o:opensuse:leap:15.3">
+            <title xml:lang="en-us">openSUSE Leap 15.3</title>
+            <check system="http://oval.mitre.org/XMLSchema/oval-definitions-5" href="openscap-cpe-oval.xml">oval:org.open-scap.cpe.opensuse:def:153</check>
+      </cpe-item>
+      <cpe-item name="cpe:/o:opensuse:leap:15.4">
+            <title xml:lang="en-us">openSUSE Leap 15.4</title>
+            <check system="http://oval.mitre.org/XMLSchema/oval-definitions-5" href="openscap-cpe-oval.xml">oval:org.open-scap.cpe.opensuse:def:154</check>
+      </cpe-item>
+      <cpe-item name="cpe:/o:opensuse:leap:15.5">
+            <title xml:lang="en-us">openSUSE Leap 15.5</title>
+            <check system="http://oval.mitre.org/XMLSchema/oval-definitions-5" href="openscap-cpe-oval.xml">oval:org.open-scap.cpe.opensuse:def:155</check>
+      </cpe-item>
+      <cpe-item name="cpe:/o:opensuse:tumbleweed">
+            <title xml:lang="en-us">openSUSE Tumbleweed</title>
+            <check system="http://oval.mitre.org/XMLSchema/oval-definitions-5" href="openscap-cpe-oval.xml">oval:org.open-scap.cpe.opensuse:def:9999</check>
+      </cpe-item>
 </cpe-list>
diff --git a/cpe/openscap-cpe-oval.xml b/cpe/openscap-cpe-oval.xml
index 6409940..a402c7f 100644
--- a/cpe/openscap-cpe-oval.xml
+++ b/cpe/openscap-cpe-oval.xml
@@ -690,6 +690,84 @@
                         <criterion comment="openSUSE Leap 15.0 is installed" test_ref="oval:org.open-scap.cpe.opensuse:tst:150"/>
                   </criteria>
             </definition>
+            <definition class="inventory" id="oval:org.open-scap.cpe.opensuse:def:151" version="1">
+                  <metadata>
+                        <title>openSUSE Leap 15.1</title>
+                        <affected family="unix">
+                            <platform>openSUSE Leap 15.1</platform>
+                        </affected>
+                        <reference ref_id="cpe:/o:opensuse:leap:15.1" source="CPE"/>
+                        <description>The operating system installed on the system is openSUSE Leap 15.1</description>
+                  </metadata>
+                  <criteria>
+                        <criterion comment="openSUSE Leap 15.1 is installed" test_ref="oval:org.open-scap.cpe.opensuse:tst:151"/>
+                  </criteria>
+            </definition>
+            <definition class="inventory" id="oval:org.open-scap.cpe.opensuse:def:152" version="1">
+                  <metadata>
+                        <title>openSUSE Leap 15.2</title>
+                        <affected family="unix">
+                            <platform>openSUSE Leap 15.2</platform>
+                        </affected>
+                        <reference ref_id="cpe:/o:opensuse:leap:15.2" source="CPE"/>
+                        <description>The operating system installed on the system is openSUSE Leap 15.2</description>
+                  </metadata>
+                  <criteria>
+                        <criterion comment="openSUSE Leap 15.2 is installed" test_ref="oval:org.open-scap.cpe.opensuse:tst:152"/>
+                  </criteria>
+            </definition>
+            <definition class="inventory" id="oval:org.open-scap.cpe.opensuse:def:153" version="1">
+                  <metadata>
+                        <title>openSUSE Leap 15.3</title>
+                        <affected family="unix">
+                            <platform>openSUSE Leap 15.3</platform>
+                        </affected>
+                        <reference ref_id="cpe:/o:opensuse:leap:15.3" source="CPE"/>
+                        <description>The operating system installed on the system is openSUSE Leap 15.3</description>
+                  </metadata>
+                  <criteria>
+                        <criterion comment="openSUSE Leap 15.3 is installed" test_ref="oval:org.open-scap.cpe.opensuse:tst:153"/>
+                  </criteria>
+            </definition>
+            <definition class="inventory" id="oval:org.open-scap.cpe.opensuse:def:154" version="1">
+                  <metadata>
+                        <title>openSUSE Leap 15.4</title>
+                        <affected family="unix">
+                            <platform>openSUSE Leap 15.4</platform>
+                        </affected>
+                        <reference ref_id="cpe:/o:opensuse:leap:15.4" source="CPE"/>
+                        <description>The operating system installed on the system is openSUSE Leap 15.4</description>
+                  </metadata>
+                  <criteria>
+                        <criterion comment="openSUSE Leap 15.4 is installed" test_ref="oval:org.open-scap.cpe.opensuse:tst:154"/>
+                  </criteria>
+            </definition>
+            <definition class="inventory" id="oval:org.open-scap.cpe.opensuse:def:155" version="1">
+                  <metadata>
+                        <title>openSUSE Leap 15.5</title>
+                        <affected family="unix">
+                            <platform>openSUSE Leap 15.5</platform>
+                        </affected>
+                        <reference ref_id="cpe:/o:opensuse:leap:15.5" source="CPE"/>
+                        <description>The operating system installed on the system is openSUSE Leap 15.5</description>
+                  </metadata>
+                  <criteria>
+                        <criterion comment="openSUSE Leap 15.5 is installed" test_ref="oval:org.open-scap.cpe.opensuse:tst:155"/>
+                  </criteria>
+            </definition>
+            <definition class="inventory" id="oval:org.open-scap.cpe.opensuse:def:9999" version="1">
+                  <metadata>
+                        <title>openSUSE Tumbleweed</title>
+                        <affected family="unix">
+                            <platform>openSUSE Tumbleweed</platform>
+                        </affected>
+                        <reference ref_id="cpe:/o:opensuse:tumbleweed" source="CPE"/>
+                        <description>The operating system installed on the system is openSUSE Tumbleweed</description>
+                  </metadata>
+                  <criteria>
+                        <criterion comment="openSUSE Tumbleweed is installed" test_ref="oval:org.open-scap.cpe.opensuse:tst:9999"/>
+                  </criteria>
+            </definition>
             <definition class="inventory" id="oval:org.open-scap.cpe.wrlinux:def:1" version="1" >
                   <metadata>
                         <title>Wind River Linux</title>
@@ -1087,6 +1165,36 @@
                   <object object_ref="oval:org.open-scap.cpe.openSUSE-release:obj:1"/>
                   <state state_ref="oval:org.open-scap.cpe.opensuse:ste:150"/>
             </rpminfo_test>
+            <rpminfo_test check_existence="at_least_one_exists" id="oval:org.open-scap.cpe.opensuse:tst:151" version="2" check="at least one" comment="openSUSE-release is version 15.1"
+                  xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#linux">
+                  <object object_ref="oval:org.open-scap.cpe.openSUSE-release:obj:1"/>
+                  <state state_ref="oval:org.open-scap.cpe.opensuse:ste:151"/>
+            </rpminfo_test>
+            <rpminfo_test check_existence="at_least_one_exists" id="oval:org.open-scap.cpe.opensuse:tst:152" version="2" check="at least one" comment="openSUSE-release is version 15.2"
+                  xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#linux">
+                  <object object_ref="oval:org.open-scap.cpe.openSUSE-release:obj:1"/>
+                  <state state_ref="oval:org.open-scap.cpe.opensuse:ste:152"/>
+            </rpminfo_test>
+            <rpminfo_test check_existence="at_least_one_exists" id="oval:org.open-scap.cpe.opensuse:tst:153" version="2" check="at least one" comment="openSUSE-release is version 15.3"
+                  xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#linux">
+                  <object object_ref="oval:org.open-scap.cpe.openSUSE-release:obj:1"/>
+                  <state state_ref="oval:org.open-scap.cpe.opensuse:ste:153"/>
+            </rpminfo_test>
+            <rpminfo_test check_existence="at_least_one_exists" id="oval:org.open-scap.cpe.opensuse:tst:154" version="2" check="at least one" comment="openSUSE-release is version 15.4"
+                  xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#linux">
+                  <object object_ref="oval:org.open-scap.cpe.openSUSE-release:obj:1"/>
+                  <state state_ref="oval:org.open-scap.cpe.opensuse:ste:154"/>
+            </rpminfo_test>
+            <rpminfo_test check_existence="at_least_one_exists" id="oval:org.open-scap.cpe.opensuse:tst:155" version="2" check="at least one" comment="openSUSE-release is version 15.5"
+                  xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#linux">
+                  <object object_ref="oval:org.open-scap.cpe.openSUSE-release:obj:1"/>
+                  <state state_ref="oval:org.open-scap.cpe.opensuse:ste:155"/>
+            </rpminfo_test>
+            <rpminfo_test check_existence="at_least_one_exists" id="oval:org.open-scap.cpe.opensuse:tst:9999" version="2" check="at least one" comment="openSUSE-release is openSUSE Tumbleweed"
+                  xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#linux">
+                  <object object_ref="oval:org.open-scap.cpe.openSUSE-release:obj:1"/>
+                  <state state_ref="oval:org.open-scap.cpe.opensuse:ste:9999"/>
+            </rpminfo_test>
             <family_test check_existence="at_least_one_exists" id="oval:org.open-scap.cpe.wrlinux:tst:1" version="1" check="only one"
                   comment="Installed operating system is part of the Unix family."
                   xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent">
@@ -1415,6 +1523,25 @@
             <rpminfo_state id="oval:org.open-scap.cpe.opensuse:ste:150" version="1" xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#linux">
                   <version operation="pattern match">^15.0$</version>
             </rpminfo_state>
+            <rpminfo_state id="oval:org.open-scap.cpe.opensuse:ste:151" version="1" xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#linux">
+                  <version operation="pattern match">^15.1$</version>
+            </rpminfo_state>
+            <rpminfo_state id="oval:org.open-scap.cpe.opensuse:ste:152" version="1" xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#linux">
+                  <version operation="pattern match">^15.2$</version>
+            </rpminfo_state>
+            <rpminfo_state id="oval:org.open-scap.cpe.opensuse:ste:153" version="1" xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#linux">
+                  <version operation="pattern match">^15.3$</version>
+            </rpminfo_state>
+            <rpminfo_state id="oval:org.open-scap.cpe.opensuse:ste:154" version="1" xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#linux">
+                  <version operation="pattern match">^15.4$</version>
+            </rpminfo_state>
+            <rpminfo_state id="oval:org.open-scap.cpe.opensuse:ste:155" version="1" xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#linux">
+                  <version operation="pattern match">^15.5$</version>
+            </rpminfo_state>
+            <rpminfo_state id="oval:org.open-scap.cpe.opensuse:ste:9999" version="1" xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#linux">
+              <!-- matching for timestamp -->
+              <version operation="pattern match">^\d{8}$</version>
+            </rpminfo_state>
             <textfilecontent54_state
                             id="oval:org.open-scap.cpe.wrlinux-release:ste:8"
                             comment="Check the /etc/wrlinux-release file for VERSION 8 specification."
-- 
2.40.0


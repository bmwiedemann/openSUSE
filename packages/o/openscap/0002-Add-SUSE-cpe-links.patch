From 8ef63951ad8e87a65cb252601a03bd958631f94c Mon Sep 17 00:00:00 2001
From: =?UTF-8?q?Klaus=20K=C3=A4mpf?= <kkaempf@suse.de>
Date: Tue, 28 Mar 2023 12:04:28 +0200
Subject: [PATCH 2/5] Add SUSE cpe links

---
 cpe/openscap-cpe-dict.xml | 16 +++++++++++++++
 cpe/openscap-cpe-oval.xml | 42 +++++++++++++++++++++++++++++++++++++++
 2 files changed, 58 insertions(+)

diff --git a/cpe/openscap-cpe-dict.xml b/cpe/openscap-cpe-dict.xml
index cf52bee..85917a8 100644
--- a/cpe/openscap-cpe-dict.xml
+++ b/cpe/openscap-cpe-dict.xml
@@ -77,4 +77,20 @@
             <title xml:lang="en-us">openSUSE Tumbleweed</title>
             <check system="http://oval.mitre.org/XMLSchema/oval-definitions-5" href="openscap-cpe-oval.xml">oval:org.open-scap.cpe.opensuse:def:9999</check>
       </cpe-item>
+      <cpe-item name="cpe:/o:suse:sles:12">
+            <title xml:lang="en-us">SUSE Linux Enterprise Server 12</title>
+            <check system="http://oval.mitre.org/XMLSchema/oval-definitions-5" href="openscap-cpe-oval.xml">oval:org.open-scap.cpe.sles:def:12</check>
+      </cpe-item>
+      <cpe-item name="cpe:/o:suse:sled:12">
+            <title xml:lang="en-us">SUSE Linux Enterprise Desktop 12</title>
+            <check system="http://oval.mitre.org/XMLSchema/oval-definitions-5" href="openscap-cpe-oval.xml">oval:org.open-scap.cpe.sled:def:12</check>
+      </cpe-item>
+      <cpe-item name="cpe:/o:suse:sles:15">
+            <title xml:lang="en-us">SUSE Linux Enterprise Server 15</title>
+            <check system="http://oval.mitre.org/XMLSchema/oval-definitions-5" href="openscap-cpe-oval.xml">oval:org.open-scap.cpe.sles:def:15</check>
+      </cpe-item>
+      <cpe-item name="cpe:/o:suse:sled:15">
+            <title xml:lang="en-us">SUSE Linux Enterprise Desktop 15</title>
+            <check system="http://oval.mitre.org/XMLSchema/oval-definitions-5" href="openscap-cpe-oval.xml">oval:org.open-scap.cpe.sled:def:15</check>
+      </cpe-item>
 </cpe-list>
diff --git a/cpe/openscap-cpe-oval.xml b/cpe/openscap-cpe-oval.xml
index a402c7f..531297b 100644
--- a/cpe/openscap-cpe-oval.xml
+++ b/cpe/openscap-cpe-oval.xml
@@ -768,6 +768,32 @@
                         <criterion comment="openSUSE Tumbleweed is installed" test_ref="oval:org.open-scap.cpe.opensuse:tst:9999"/>
                   </criteria>
             </definition>
+            <definition class="inventory" id="oval:org.open-scap.cpe.sles:def:15" version="1">
+                  <metadata>
+                        <title>SUSE Linux Enterprise Server 15</title>
+                        <affected family="unix">
+                            <platform>SUSE Linux Enterprise Server 15</platform>
+                        </affected>
+                        <reference ref_id="cpe:/o:suse:sles:15" source="CPE"/>
+                        <description>The operating system installed on the system is SUSE Linux Enterprise Server 15</description>
+                  </metadata>
+                  <criteria>
+                        <criterion comment="SLES 15 is installed" test_ref="oval:org.open-scap.cpe.sles:tst:15"/>
+                  </criteria>
+            </definition>
+            <definition class="inventory" id="oval:org.open-scap.cpe.sled:def:15" version="1">
+                  <metadata>
+                        <title>SUSE Linux Enterprise Desktop 15</title>
+                        <affected family="unix">
+                            <platform>SUSE Linux Enterprise Desktop 15</platform>
+                        </affected>
+                        <reference ref_id="cpe:/o:suse:sled:15" source="CPE"/>
+                        <description>The operating system installed on the system is SUSE Linux Enterprise Desktop 15</description>
+                  </metadata>
+                  <criteria>
+                        <criterion comment="SLED 15 is installed" test_ref="oval:org.open-scap.cpe.sled:tst:15"/>
+                  </criteria>
+            </definition>
             <definition class="inventory" id="oval:org.open-scap.cpe.wrlinux:def:1" version="1" >
                   <metadata>
                         <title>Wind River Linux</title>
@@ -1110,6 +1136,11 @@
                   <object object_ref="oval:org.open-scap.cpe.sles-release:obj:1"/>
                   <state state_ref="oval:org.open-scap.cpe.sles:ste:12"/>
             </rpminfo_test>
+            <rpminfo_test check_existence="at_least_one_exists" id="oval:org.open-scap.cpe.sles:tst:15" version="1" check="at least one" comment="sles-release is version 15"
+                  xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#linux">
+                  <object object_ref="oval:org.open-scap.cpe.sles-release:obj:1"/>
+                  <state state_ref="oval:org.open-scap.cpe.sles:ste:15"/>
+           </rpminfo_test>
             <rpminfo_test check_existence="at_least_one_exists" id="oval:org.open-scap.cpe.sled:tst:10" version="1" check="at least one" comment="sled-release is version 10"
                   xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#linux">
                   <object object_ref="oval:org.open-scap.cpe.sled-release:obj:1"/>
@@ -1125,6 +1156,11 @@
                   <object object_ref="oval:org.open-scap.cpe.sled-release:obj:1"/>
                   <state state_ref="oval:org.open-scap.cpe.sled:ste:12"/>
             </rpminfo_test>
+            <rpminfo_test check_existence="at_least_one_exists" id="oval:org.open-scap.cpe.sled:tst:15" version="1" check="at least one" comment="sled-release is version 15"
+                  xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#linux">
+                  <object object_ref="oval:org.open-scap.cpe.sled-release:obj:1"/>
+                  <state state_ref="oval:org.open-scap.cpe.sled:ste:15"/>
+            </rpminfo_test>
             <rpminfo_test check_existence="at_least_one_exists" id="oval:org.open-scap.cpe.opensuse:tst:1" version="1" check="at least one" comment="openSUSE-release is version 11.4"
                   xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#linux">
                   <object object_ref="oval:org.open-scap.cpe.openSUSE-release:obj:1"/>
@@ -1490,6 +1526,9 @@
             <rpminfo_state id="oval:org.open-scap.cpe.sles:ste:12" version="1" xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#linux">
                   <version operation="pattern match">^12($|[^\d])</version>
             </rpminfo_state>
+            <rpminfo_state id="oval:org.open-scap.cpe.sles:ste:15" version="1" xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#linux">
+                  <version operation="pattern match">^15($|[^\d])</version>
+            </rpminfo_state>
             <rpminfo_state id="oval:org.open-scap.cpe.sled:ste:10" version="1" xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#linux">
                   <version operation="pattern match">^10($|[^\d])</version>
             </rpminfo_state>
@@ -1499,6 +1538,9 @@
             <rpminfo_state id="oval:org.open-scap.cpe.sled:ste:12" version="1" xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#linux">
                   <version operation="pattern match">^12($|[^\d])</version>
             </rpminfo_state>
+            <rpminfo_state id="oval:org.open-scap.cpe.sled:ste:15" version="1" xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#linux">
+                  <version operation="pattern match">^15($|[^\d])</version>
+            </rpminfo_state>
             <rpminfo_state id="oval:org.open-scap.cpe.opensuse:ste:2" version="1" xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#linux">
                   <name operation="pattern match">^openSUSE-release</name>
             </rpminfo_state>
-- 
2.40.0


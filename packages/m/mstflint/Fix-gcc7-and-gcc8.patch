commit 7d87bd0f4679e7547678e2d26fca1277d2b8cbbd
Author: Nicolas Morey-Chaisemartin <NMoreyChaisemartin@suse.com>
Date:   Wed Aug 9 17:31:57 2017 +0200

    Fix gcc7 and gcc8
    
    Fix compilation errors for GCC7 and GCC8
    
    Signed-off-by: Nicolas Morey-Chaisemartin <NMoreyChaisemartin@suse.com>

diff --git configure.ac configure.ac
index 3a9246b87e89..7422cbc2103d 100644
--- configure.ac
+++ configure.ac
@@ -296,6 +296,7 @@ AC_SEARCH_LIBS([sqlite3_initialize], [sqlite3], [SQLITE_SYSTEM_AVAILABLE="yes"],
 AM_CONDITIONAL([USE_LOCAL_SQLITE], [test "$SQLITE_SYSTEM_AVAILABLE" = no])
 
 CFLAGS="$CFLAGS -DMST_UL"
+CPPFLAGS="$CPPFLAGS -DMST_UL"
 CXXFLAGS="$CXXFLAGS -DMST_UL"
 
 AM_CFLAGS="-Wall"
@@ -314,6 +315,14 @@ AX_CHECK_COMPILE_FLAG([-Wno-implicit-fallthrough], [CFLAGS="$CFLAGS -Wno-implici
 AX_CHECK_COMPILE_FLAG([-Wno-cast-function-type], [CFLAGS="$CFLAGS -Wno-cast-function-type"], [], [])
 CFLAGS="$OLD_CFLAGS"
 
+# C GCC [78] related ignores
+OLD_CPPFLAGS="$CPPFLAGS"
+CPPFLAGS="$CPPFLAGS -Wall -Werror"
+AX_CHECK_COMPILE_FLAG([-Wno-format-overflow], [CPPFLAGS="$CPPFLAGS -Wno-format-overflow"], [], [])
+AX_CHECK_COMPILE_FLAG([-Wno-implicit-fallthrough], [CPPFLAGS="$CPPFLAGS -Wno-implicit-fallthrough"], [], [])
+AX_CHECK_COMPILE_FLAG([-Wno-cast-function-type], [CPPFLAGS="$CPPFLAGS -Wno-cast-function-type"], [], [])
+CPPFLAGS="$OLD_CPPFLAGS"
+
 # C++ related ignores
 OLD_CXXFLAGS="$CXXFLAGS"
 CXXFLAGS="$CXXFLAGS -Wall -Werror"

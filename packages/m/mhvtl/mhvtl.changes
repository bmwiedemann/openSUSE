-------------------------------------------------------------------
Thu Oct  7 16:20:07 UTC 2021 - Lee Duncan <lduncan@suse.com>

- Remoed the "BuildRequires: lzo-devel" line from the SPEC file,
  since this dependence was removed with upstream commit
  c327afb77cff ("Remove dependency on external lzo packages").

-------------------------------------------------------------------
Mon Oct  4 21:07:48 UTC 2021 - Lee Duncan <lduncan@suse.com>

- Fix failing OBS build, since it doesn't like empty DB files
  being installed as part of the package. The DB-creation
  script was copied from the Makefile (under "make install") to
  a SPEC-file "%post" script.

-------------------------------------------------------------------
Fri Sep 17 18:05:56 UTC 2021 - Lee Duncan <lduncan@suse.com>

- Updated to upstream version 1.63_release+759.35ddb48e5262,
  so that it will compile on latest (5.14 kernel). Changes:
  * mhvtl.ko: Remove reference to DRIVER_SENSE (fixes our build)
  * mhvtl.ko: reinstate HAVE_UNLOCKED_IOCTL
  * mhvtl.ko: Compile on RH using 4.18 kernels
  * Handle scsi_host_template removal of unchecked_isa_dma.
  Removing previously-needed patch:
  * Handle-scsi_host_template-removal-of-unchecked_isa_d.patch

-------------------------------------------------------------------
Fri Jul 09 00:22:26 UTC 2021 - lduncan@suse.com

- Update to version 1.63_release+754.ff8861da60c9:
  * Use bounce buffer if tape block size is larger than request buffer
  * dump_tape: Fix segfault due to local variable conflict
  * Fix typos in mktape man page
  * Fix routine to extract barcode from string
  * Correcting minor typos.
  * Undo previous edits to LTO-7 media density
  * Security Protocol OUT: Fix null pointer check
  * Update LTO-8 media denisty codes
  * small adjustment in the emulation of the ts3100 library
  * Update for 1.6_3_release
  * mktape: Set default version string based from MHVTL_VERSION
  * mhvtl.ko: Bump kernel version
  * mhvtl.ko: Initialise outstanding op struct before adding to list
  * mhvtl.ko: Bump kernel module version string
  * mhvtl.ko: Limit number of outstanding queued commands
  * Add kernel file_inode() commit ID as comment
  * mhvtl.ko: Bump kernel module version string
  * mhvtl.ko: Use _safe version of list_for_each_entry
  * mhvtl.ko: Simplify file_inode()
  * mhvtl.ko: Correct compiler warning about printf var sizes
  * mhvtl.ko: Log errors if they occur
  * mhvtl.ko: bump kernel module version
  * mhvtl.ko: kernel module oops on PPC
  * mhvtl.ko: bump kernel module version
  * Increase default kmem_cache bounce buffer size to 64k
  * mhvtl.ko: Define SG_SEGMENT_SZ only if not defined
  * Fix spelling of retrieving
  * Exclude __builtin_cpu_supports() on non x86_64 CPU types
  * fix wording
  * rename log.h to avoid generic name conflict
  * rename scsi.h to avoid generic name conflict
  * rename list.h to avoid generic name conflict
  * Rename tapeLoaded to load_status
  * Use ccan version of crc32c
  * Fix startup script

- Also, remove patch (no longer needed, fixed upstream):
  * mhvtl-fix-ppc-Makefile.patch
  And add a patch: to handle an issue submitted upstream
  but not yet integrated:
  * Handle-scsi_host_template-removal-of-unchecked_isa_d.patch

-------------------------------------------------------------------
Thu Oct 29 18:09:33 UTC 2020 - Lee Duncan <lduncan@suse.com>

- Added "-DHAVE_UNLOCKED_IOCTL" to kernel module build in SPEC file

-------------------------------------------------------------------
Mon Jun 22 17:02:05 UTC 2020 - Cristian Rodr√≠guez <crrodriguez@opensuse.org>

-Do not Require insserv or fillup which are no longer needed 

-------------------------------------------------------------------
Fri Nov 15 17:16:03 UTC 2019 - Lee Duncan <lduncan@suse.com>

- Fix some builds of ppc and arm that were failing to compile
  the dump_tape command. This adds the patch:
  * mhvtl-fix-ppc-Makefile.patch

-------------------------------------------------------------------
Sat Nov  9 04:13:39 UTC 2019 - Neal Gompa <ngompa13@gmail.com>

- Use the correct macro for systemd generator directory

-------------------------------------------------------------------
Mon Nov  4 23:43:56 UTC 2019 - Lee Duncan <lduncan@suse.com>

- Change install of systemd generatos to /usr/lib/systemd/...
  instead of /usr/libexec/systemd/..., which does not yet exist,
  to fix build issue

-------------------------------------------------------------------
Sun Oct 06 14:42:22 UTC 2019 - lduncan@suse.com

- Update to version 1.62_release:
  * Update the 1.6.2 tarball name
  * Update spec file for 1.6-2 release
  * mhvtl.ko: Bump module version to reflect white-listed buffer work
  * mhvtl.ko: Use white-listed buffer to copy data to/from kernel space
  * Bump kernel module version
  * mhvtl.ko: scsi_host_template changed block .ioctl
  * mhvtl.ko: Remove useless printk("\n")
  * Reformat KERNEL_VERSION() to make checkpatch.pl happier
  * Bump kernel module version
  * Fix kernel build SUBDIR going away post 5.3
  * mhvtl.ko: Fix compile on 5.0+ kernels
  * mhvtl.ko: Bump version number due to serial_number change
  * mhvtl.ko: Remove dependency on scsi mid layer serial_number
  * Remove dead code
  * Only build symlink paths for tape devices
  * Silence another gcc error regarding snprintf
  * Silence another gcc error regarding snprintf
  * Make sure target buffer is large enough
  * Use systemd-path to query mhvtl-device-conf-generator path
  * Change Vagrantbox for Centos to one that is  publicly available.
  * Remove lzo from the install script and added -g to lsscsi
  * Add Vagrant file with install script for testing
  * Revert "Correct yet another /usr -> / path - this time for systemd etc stuff"
  * Correct yet another /usr -> / path - this time for systemd etc stuff
  * Correct systemd-generator default path
  * Fix path to modprobe
  * Ubuntu/Debian need the systemd-generators install in /lib not /usr/lib
  * Sample script to build /dev/tape/by-path/ entries
  * Add test for root user on install
  * Update Change log and spec file for 1.6-1_release
  * Add CRC check on read path
  * Update dump_tape to understand CRC32
  * Add CRC32 to each block write
  * Add libcrc32c routines
  * Add additional field to reflect if tape in drive
  * Move true/false values into single bit field
  * Allow to override build date with SOURCE_DATE_EPOCH
  * dump_tape: Fix off-by-one reading argv[]
  * Improve SCSI cdb logging format from kernel module
  * Fix typo for mktape in make_vtl_media
  * Simplify building of mktape
  * Clean up white space formatting in source
  * A very basic script to show how to setup LIO iSCSI via pscsi driver
  * Fix a media unload race condition
  * Force shared library and systemd refresh on install
  * bump kernel module version string.
  * Remove use of "use_clustering" in our kernel driver.
  * Correct mhvtl-load-modules.service dependencies.

  This results in replacing mhvtl-1.60_release.tar.xz with
  mhvtl-1.62_release.tar.xz, and removing two patches, no
  longer needed. Removed:
  * mhvtl-systemd-load-modules-cleanup.patch
  * mhvtl-remove-use-of-use_clustering.patch

  Also, updated SPEC-file %build and %install make commands to pass
  in systemd generator directory.

-------------------------------------------------------------------
Sat Mar 30 12:08:09 UTC 2019 - Jan Engelhardt <jengelh@inai.de>

- Reduce dependency on systemd. Make use of %make_install.

-------------------------------------------------------------------
Thu Mar 28 17:35:06 UTC 2019 - Lee Duncan <lduncan@suse.com>

- Update to upstream version 1.60_release from 1.55_release
  * Switch to systemd from init scripts (see bsc#1116023)
  * Create virtual media on post install
  * Update version to 1.6 with introduction of systemd support
  * Don't overwrite config files by default
  * Replace SuSE rpm macros with systemctl command for RPM install/uninstall
  * Update systemd-generators dir based on variable
  * Include ChangeLog in tar ball as time/date string in man pages depend on it
  * Corrected time/date stamp in spec change log
  * Set correct shared lib path
  * Remove empty double quotes in service tmeplates
  This replaces mhvtl-1.53_release.tar.xz with mhvtl-1.60_release.tar.gz,
  This change updates the SPEC file, and itremoves both patches,
  no longer needed:
  * mhvtl-set-lib64-correctly.patch
  * mhvtl-suse-patches.diff.gz
  For kernels 5.0 and newer, this patch was added to patch the KMP:
  * mhvtl-remove-use-of-use_clustering.patch
  And to cleanup systemd dependencies, added:
  * mhvtl-systemd-load-modules-cleanup.patch
  Both of these patches will be submitted upstream, as well.

-------------------------------------------------------------------
Fri Jul 27 07:23:04 UTC 2018 - jengelh@inai.de

- Remove redundant %clean section. Replace unnecessary %__ macro
  indirections. Fix erroneous description (was copy-pasted from
  open-iscsi?)

-------------------------------------------------------------------
Mon Jul 16 18:41:00 UTC 2018 - lduncan@suse.com

- Update SPEC file to correctly handle lib64 vs lib for ppc

-------------------------------------------------------------------
Sat Jun 16 01:21:58 UTC 2018 - lduncan@suse.com

- Add "BuildRequires: modutils" to SPEC file, as required by
  suse-policy-kmp-missing-supplements

- Fix /usr/lib vs /usr/lib64 installation for the two shared
  objects, adding patch:
  * mnvtl--set-lib64-correctly.patch

-------------------------------------------------------------------
Tue May 22 21:59:11 UTC 2018 - lduncan@suse.com

- Initial creation of package, from version 1.5-3_release

-------------------------------------------------------------------

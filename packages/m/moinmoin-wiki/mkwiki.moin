#! /bin/bash

set -eu

if [ $# -ne 1 -o "${1:-x}" = "-h" -o "${1:-x}" = "--help" ]; then
	echo "usage: $0 <destdir>"
	exit 0
fi

DEST=$1

if [ -e "$DEST" ]; then
	echo "$DEST already exists - skipping wiki creation"
else
	mkdir -p "$DEST"
	MOIN=/usr/share/moin
	cp -R $MOIN/data $MOIN/underlay $MOIN/config/wikiconfig.py "$DEST"

	chown -R wwwrun:www "$DEST"
	chmod -R ug+rwX "$DEST"
	chmod -R o-rwx "$DEST"

	echo "Created wiki directory at $DEST"
fi

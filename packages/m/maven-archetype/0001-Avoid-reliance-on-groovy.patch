From b3fb162b5d01b352511a56393cf1c16294601e9e Mon Sep 17 00:00:00 2001
From: Mat Booth <mat.booth@redhat.com>
Date: Thu, 9 Jul 2020 17:13:18 +0100
Subject: [PATCH 1/3] Avoid reliance on groovy

---
 archetype-common/pom.xml                      |  6 -----
 .../DefaultFilesetArchetypeGenerator.java     | 23 +------------------
 2 files changed, 1 insertion(+), 28 deletions(-)

diff --git a/archetype-common/pom.xml b/archetype-common/pom.xml
index 0743131..410d23b 100644
--- a/archetype-common/pom.xml
+++ b/archetype-common/pom.xml
@@ -50,12 +50,6 @@
       <groupId>org.apache.maven.archetype</groupId>
       <artifactId>archetype-descriptor</artifactId>
     </dependency>
-    <dependency>
-      <groupId>org.codehaus.groovy</groupId>
-      <artifactId>groovy-all</artifactId>
-      <version>2.4.16</version>
-      <scope>compile</scope>
-    </dependency>
     <dependency>
       <groupId>org.apache.ivy</groupId>
       <artifactId>ivy</artifactId>
diff --git a/archetype-common/src/main/java/org/apache/maven/archetype/generator/DefaultFilesetArchetypeGenerator.java b/archetype-common/src/main/java/org/apache/maven/archetype/generator/DefaultFilesetArchetypeGenerator.java
index 7e88a95..9b3b3cd 100644
--- a/archetype-common/src/main/java/org/apache/maven/archetype/generator/DefaultFilesetArchetypeGenerator.java
+++ b/archetype-common/src/main/java/org/apache/maven/archetype/generator/DefaultFilesetArchetypeGenerator.java
@@ -19,8 +19,6 @@ package org.apache.maven.archetype.generator;
  * under the License.
  */
 
-import groovy.lang.Binding;
-import groovy.lang.GroovyShell;
 import org.apache.maven.archetype.ArchetypeGenerationRequest;
 import org.apache.maven.archetype.common.ArchetypeArtifactManager;
 import org.apache.maven.archetype.common.ArchetypeFilesResolver;
@@ -210,28 +208,9 @@ public class DefaultFilesetArchetypeGenerator
             String postGenerationScript = archetypeArtifactManager.getPostGenerationScript( archetypeFile );
             if ( postGenerationScript != null )
             {
-                getLogger().info( "Executing " + Constants.ARCHETYPE_POST_GENERATION_SCRIPT
+                getLogger().info( "Skipping " + Constants.ARCHETYPE_POST_GENERATION_SCRIPT
                     + " post-generation script" );
 
-                Binding binding = new Binding();
-
-                final Properties archetypeGeneratorProperties = new Properties();
-                archetypeGeneratorProperties.putAll( System.getProperties() );
-
-                if ( request.getProperties() != null )
-                {
-                    archetypeGeneratorProperties.putAll( request.getProperties() );
-                }
-
-                for ( Map.Entry<Object, Object> entry : archetypeGeneratorProperties.entrySet() )
-                {
-                    binding.setVariable( entry.getKey().toString(), entry.getValue() );
-                }
-
-                binding.setVariable( "request", request );
-
-                GroovyShell shell = new GroovyShell( binding );
-                shell.evaluate( postGenerationScript );
             }
 
             // ----------------------------------------------------------------------
-- 
2.26.2


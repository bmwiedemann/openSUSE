diff -Nur mruby-3.0.0/src/class.c new/src/class.c
--- mruby-3.0.0/src/class.c	2021-03-05 09:07:35.000000000 +0100
+++ new/src/class.c	2022-01-18 09:46:37.881837110 +0100
@@ -339,6 +339,7 @@
 prepare_singleton_class(mrb_state *mrb, struct RBasic *o)
 {
   struct RClass *sc, *c;
+  mrb_assert(o->c);
 
   if (o->c->tt == MRB_TT_SCLASS) return;
   sc = (struct RClass*)mrb_obj_alloc(mrb, MRB_TT_SCLASS, mrb->class_class);
@@ -1649,6 +1650,7 @@
     break;
   }
   obj = mrb_basic_ptr(v);
+  if (obj->c == NULL) return NULL;
   prepare_singleton_class(mrb, obj);
   return obj->c;
 }

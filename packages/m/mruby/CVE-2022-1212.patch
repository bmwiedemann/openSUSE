diff -Nur mruby-3.0.0/src/vm.c new/src/vm.c
--- mruby-3.0.0/src/vm.c	2021-03-05 09:07:35.000000000 +0100
+++ new/src/vm.c	2022-04-26 21:03:08.112400307 +0200
@@ -2109,9 +2109,9 @@
           }
           if (ci->acc < 0) {
             ci = cipop(mrb);
+            mrb->exc = (struct RObject*)break_new(mrb, RBREAK_TAG_BREAK, proc, v);
             mrb_gc_arena_restore(mrb, ai);
             mrb->c->vmexec = FALSE;
-            mrb->exc = (struct RObject*)break_new(mrb, RBREAK_TAG_BREAK, proc, v);
             mrb->jmp = prev_jmp;
             MRB_THROW(prev_jmp);
           }

diff -Nur mruby-3.0.0/src/proc.c new/src/proc.c
--- mruby-3.0.0/src/proc.c	2022-01-18 09:57:00.592669176 +0100
+++ new/src/proc.c	2022-01-18 09:57:44.044870774 +0100
@@ -190,12 +190,12 @@
     /* already initialized proc */
     return;
   }
+  if (!MRB_PROC_CFUNC_P(b) && b->body.irep) {
+    mrb_irep_incref(mrb, (mrb_irep*)b->body.irep);
+  }
   a->flags = b->flags;
   a->body = b->body;
   a->upper = b->upper;
-  if (!MRB_PROC_CFUNC_P(a) && a->body.irep) {
-    mrb_irep_incref(mrb, (mrb_irep*)a->body.irep);
-  }
   a->e.env = b->e.env;
   /* a->e.target_class = a->e.target_class; */
 }

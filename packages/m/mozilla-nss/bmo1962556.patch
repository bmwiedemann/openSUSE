commit ae5fe2c5652185fe58f9a7bb97486388f84ad5f9
Author: Dennis Jackson <djackson@mozilla.com>
Date:   Tue Apr 29 08:07:21 2025 +0000

    Bug 1962556 - Tolerate intermittent failures in ssl_policy_pkix_ocsp. r=nss-reviewers,jschanck
    
    Differential Revision: https://phabricator.services.mozilla.com/D246682

NOTE(Martin Sirringhaus): We get a different error code in OBS:
PR_DIRECTORY_LOOKUP_ERROR                (-5973L)
instead of
PR_CONNECT_RESET_ERROR                   (-5961L)
so I modified the upstreamed patch to grep for both

Index: nss/tests/ssl/ssl.sh
===================================================================
--- nss.orig/tests/ssl/ssl.sh
+++ nss/tests/ssl/ssl.sh
@@ -982,8 +982,8 @@ ssl_policy_pkix_ocsp()
   echo " vfyserv -o wrong.host.badssl.com -d ${P_R_SERVERDIR} 2>&1 | tee ${P_R_SERVERDIR}/vfy.out"
   vfyserv -o wrong.host.badssl.com -d ${P_R_SERVERDIR} 2>&1 | tee ${P_R_SERVERDIR}/vfy.out
   # make sure we have the domain mismatch, not bad signature error
-  echo "grep -E '12276|5961' ${P_R_SERVERDIR}/vfy.out"
-  grep -E '12276|5961' ${P_R_SERVERDIR}/vfy.out
+  echo "grep -E '12276|5961|5973' ${P_R_SERVERDIR}/vfy.out"
+  grep -E '12276|5961|5973' ${P_R_SERVERDIR}/vfy.out
   RET=$?
   html_msg $RET $RET_EXP "${testname}" \
            "produced a returncode of $RET, expected is $RET_EXP"

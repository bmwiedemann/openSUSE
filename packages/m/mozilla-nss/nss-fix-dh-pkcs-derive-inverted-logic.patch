# HG changeset patch
# User M. Sirringhaus <msirringhaus@suse.de>
# Date 1590586654 -7200
#      Wed May 27 15:37:34 2020 +0200
# Node ID 582ed54a5cda147cd5996603d6066817edb687fa
# Parent  ce99bba6375432c55a73c1367f619dfef7c7e9fc
imported patch nss-fix-dh-pkcs-derive-inverted-logic.patch

diff --git a/lib/softoken/pkcs11c.c b/lib/softoken/pkcs11c.c
--- a/lib/softoken/pkcs11c.c
+++ b/lib/softoken/pkcs11c.c
@@ -8316,7 +8316,7 @@
             if (crv == CKR_OK) {
                 rv = KEA_Verify(&dhPublic, &dhPrime, &dhSubPrime);
                 PORT_Free(dhSubPrime.data);
-                if (rv != SECSuccess) {
+                if (rv == PR_FALSE) {
                     crv = CKR_ARGUMENTS_BAD;
                     PORT_Free(dhPrime.data);
                     PORT_Free(dhValue.data);

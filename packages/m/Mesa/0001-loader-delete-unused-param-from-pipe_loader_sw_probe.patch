From 1b1ebd90a5b0edd70e2c548b64aeded9cac3e570 Mon Sep 17 00:00:00 2001
From: Mike Blumenkrantz <michael.blumenkrantz@gmail.com>
Date: Tue, 12 Mar 2024 09:15:11 -0400
Subject: [PATCH 1/9] loader: delete unused param from
 pipe_loader_sw_probe_dri()

---
 src/gallium/auxiliary/pipe-loader/pipe_loader.h    | 3 +--
 src/gallium/auxiliary/pipe-loader/pipe_loader_sw.c | 4 ++--
 src/gallium/frontends/dri/kopper.c                 | 2 +-
 3 files changed, 4 insertions(+), 5 deletions(-)

Index: mesa-24.0.3/src/gallium/auxiliary/pipe-loader/pipe_loader.h
===================================================================
--- mesa-24.0.3.orig/src/gallium/auxiliary/pipe-loader/pipe_loader.h
+++ mesa-24.0.3/src/gallium/auxiliary/pipe-loader/pipe_loader.h
@@ -155,8 +155,7 @@ pipe_loader_sw_probe_dri(struct pipe_loa
  * \sa pipe_loader_probe
  */
 bool
-pipe_loader_vk_probe_dri(struct pipe_loader_device **devs,
-                         const struct drisw_loader_funcs *drisw_lf);
+pipe_loader_vk_probe_dri(struct pipe_loader_device **devs);
 
 #ifdef HAVE_DRISW_KMS
 /**
Index: mesa-24.0.3/src/gallium/auxiliary/pipe-loader/pipe_loader_sw.c
===================================================================
--- mesa-24.0.3.orig/src/gallium/auxiliary/pipe-loader/pipe_loader_sw.c
+++ mesa-24.0.3/src/gallium/auxiliary/pipe-loader/pipe_loader_sw.c
@@ -233,7 +233,7 @@ fail:
 }
 #ifdef HAVE_ZINK
 bool
-pipe_loader_vk_probe_dri(struct pipe_loader_device **devs, const struct drisw_loader_funcs *drisw_lf)
+pipe_loader_vk_probe_dri(struct pipe_loader_device **devs)
 {
    struct pipe_loader_sw_device *sdev = CALLOC_STRUCT(pipe_loader_sw_device);
    int i;
@@ -246,7 +246,7 @@ pipe_loader_vk_probe_dri(struct pipe_loa
 
    for (i = 0; sdev->dd->winsys[i].name; i++) {
       if (strcmp(sdev->dd->winsys[i].name, "dri") == 0) {
-         sdev->ws = sdev->dd->winsys[i].create_winsys_dri(drisw_lf);
+         sdev->ws = sdev->dd->winsys[i].create_winsys_dri(NULL);
          break;
       }
    }
Index: mesa-24.0.3/src/gallium/frontends/dri/kopper.c
===================================================================
--- mesa-24.0.3.orig/src/gallium/frontends/dri/kopper.c
+++ mesa-24.0.3/src/gallium/frontends/dri/kopper.c
@@ -128,7 +128,7 @@ kopper_init_screen(struct dri_screen *sc
    if (screen->fd != -1)
       success = pipe_loader_drm_probe_fd(&screen->dev, screen->fd, false);
    else
-      success = pipe_loader_vk_probe_dri(&screen->dev, NULL);
+      success = pipe_loader_vk_probe_dri(&screen->dev);
 
    if (success)
       pscreen = pipe_loader_create_screen(screen->dev);

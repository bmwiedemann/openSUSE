 src/glx/glx_pbuffer.c |    2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)
Index: mesa-24.3.0-rc1/src/glx/glx_pbuffer.c
===================================================================
--- mesa-24.3.0-rc1.orig/src/glx/glx_pbuffer.c
+++ mesa-24.3.0-rc1/src/glx/glx_pbuffer.c
@@ -338,7 +338,7 @@ __glXGetDrawableAttribute(Display * dpy,
          /* Search the set of returned attributes for the attribute requested by
           * the caller.
           */
-         for (i = 0; i < num_attributes; i++) {
+         for (i = 0; i < num_attributes && i * 2 + 1 < length; i++) {
             if (data[i * 2] == attribute) {
                found = 1;
                *value = data[(i * 2) + 1];

From 4a13272da91f0c3e11c53a12a7bd2792ed92f509 Mon Sep 17 00:00:00 2001
From: llyyr <llyyr.public@gmail.com>
Date: Mon, 23 Sep 2024 23:31:47 +0530
Subject: [PATCH] player/main: guard smtc.h include

also remove defined() since undefined macros are treated as 0.
---
 player/main.c | 7 +++++--
 1 file changed, 5 insertions(+), 2 deletions(-)

diff --git a/player/main.c b/player/main.c
index c6a78dfe316f7..21478a6e5f9ba 100644
--- a/player/main.c
+++ b/player/main.c
@@ -36,7 +36,6 @@
 #include "osdep/threads.h"
 #include "osdep/timer.h"
 #include "osdep/main-fn.h"
-#include "osdep/win32/smtc.h"
 
 #include "common/av_log.h"
 #include "common/codecs.h"
@@ -72,6 +71,10 @@ static const char def_config[] =
 #include "etc/builtin.conf.inc"
 ;
 
+#if HAVE_WIN32_SMTC
+#include "osdep/win32/smtc.h"
+#endif
+
 #if HAVE_COCOA
 #include "osdep/mac/app_bridge.h"
 #endif
@@ -399,7 +402,7 @@ int mp_initialize(struct MPContext *mpctx, char **options)
     cocoa_set_mpv_handle(ctx);
 #endif
 
-#if defined(HAVE_WIN32_SMTC) && HAVE_WIN32_SMTC
+#if HAVE_WIN32_SMTC
     if (opts->media_controls == 2 || (mpctx->is_cli && opts->media_controls == 1))
         mp_smtc_init(mp_new_client(mpctx->clients, "SystemMediaTransportControls"));
 #endif

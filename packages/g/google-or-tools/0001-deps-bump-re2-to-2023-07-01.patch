From c5a2fa1eb673bf652cb9ad4f5049d054b8166e17 Mon Sep 17 00:00:00 2001
From: Corentin Le Molgat <corentinl@google.com>
Date: Wed, 5 Jul 2023 15:13:59 +0200
Subject: [PATCH] deps: bump re2 to 2023-07-01

---
 WORKSPACE                         |  2 +-
 cmake/dependencies/CMakeLists.txt |  4 +--
 ortools/lp_data/lp_parser.cc      |  9 +++---
 patches/BUILD.bazel               |  1 -
 patches/re2-2023-03-01.patch      | 48 -------------------------------
 5 files changed, 7 insertions(+), 57 deletions(-)
 delete mode 100644 patches/re2-2023-03-01.patch

diff --git a/ortools/lp_data/lp_parser.cc b/ortools/lp_data/lp_parser.cc
index 58286306e5b..bd26c019abe 100644
--- a/ortools/lp_data/lp_parser.cc
+++ b/ortools/lp_data/lp_parser.cc
@@ -185,7 +185,7 @@ bool LPParser::ParseIntegerVariablesList(StringPiece line) {
 
 bool LPParser::ParseConstraint(StringPiece constraint) {
   const StatusOr<ParsedConstraint> parsed_constraint_or_status =
-      ::operations_research::glop::ParseConstraint(constraint.as_string());
+      ::operations_research::glop::ParseConstraint(constraint);
   if (!parsed_constraint_or_status.ok()) return false;
   const ParsedConstraint& parsed_constraint =
       parsed_constraint_or_status.value();
@@ -342,10 +342,9 @@ TokenType LPParser::ConsumeToken(StringPiece* sp) {
 
 }  // namespace
 
-StatusOr<ParsedConstraint> ParseConstraint(absl::string_view constraint_view) {
+StatusOr<ParsedConstraint> ParseConstraint(absl::string_view constraint) {
   ParsedConstraint parsed_constraint;
   // Get the name, if present.
-  StringPiece constraint{constraint_view};
   StringPiece constraint_copy{constraint};
   std::string consumed_name;
   Fractional consumed_coeff;
@@ -413,8 +412,8 @@ StatusOr<ParsedConstraint> ParseConstraint(absl::string_view constraint_view) {
     right_bound = consumed_coeff;
     if (ConsumeToken(&constraint, &consumed_name, &consumed_coeff) !=
         TokenType::END) {
-      return absl::InvalidArgumentError(absl::StrCat(
-          "End of input was expected, found: ", constraint.as_string()));
+      return absl::InvalidArgumentError(
+          absl::StrCat("End of input was expected, found: ", constraint));
     }
   }
 

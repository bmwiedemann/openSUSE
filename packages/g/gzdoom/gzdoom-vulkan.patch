From: Jan Engelhardt <jengelh@inai.de>
Date: 2019-04-13 15:02:22.799297208 +0200

Use Vulkan/glslang/spirv system libraries instead of bundled code.

---
 CMakeLists.txt                                     |    4 +---
 src/CMakeLists.txt                                 |    2 +-
 src/common/rendering/vulkan/system/vk_builders.cpp |    4 ++++
 3 files changed, 6 insertions(+), 4 deletions(-)

Index: gzdoom-g4.8.2/CMakeLists.txt
===================================================================
--- gzdoom-g4.8.2.orig/CMakeLists.txt
+++ gzdoom-g4.8.2/CMakeLists.txt
@@ -325,9 +325,7 @@ option(FORCE_INTERNAL_ASMJIT "Use intern
 mark_as_advanced( FORCE_INTERNAL_ASMJIT )
 
 if (HAVE_VULKAN)
-	add_subdirectory( libraries/glslang/glslang)
-	add_subdirectory( libraries/glslang/spirv )
-	add_subdirectory( libraries/glslang/OGLCompilersDLL )
+	include_directories(/usr/include/glslang/Public /usr/include/SPIRV)
 endif()
 
 add_subdirectory( libraries/discordrpc EXCLUDE_FROM_ALL )
Index: gzdoom-g4.8.2/src/CMakeLists.txt
===================================================================
--- gzdoom-g4.8.2.orig/src/CMakeLists.txt
+++ gzdoom-g4.8.2/src/CMakeLists.txt
@@ -368,7 +368,7 @@ add_custom_target( revision_check ALL
 
 set( PROJECT_LIBRARIES ${PROJECT_LIBRARIES} "${ZLIB_LIBRARIES}" "${JPEG_LIBRARIES}" "${BZIP2_LIBRARIES}" "${CMAKE_DL_LIBS}" "${DRPC_LIBRARIES}")
 if (HAVE_VULKAN)
-	set( PROJECT_LIBRARIES ${PROJECT_LIBRARIES} "glslang" "SPIRV" "OGLCompiler")
+	set( PROJECT_LIBRARIES ${PROJECT_LIBRARIES} -lglslang -lSPIRV -lOGLCompiler)
 endif()
 
 # ZMUSIC
Index: gzdoom-g4.8.2/src/common/rendering/vulkan/system/vk_builders.cpp
===================================================================
--- gzdoom-g4.8.2.orig/src/common/rendering/vulkan/system/vk_builders.cpp
+++ gzdoom-g4.8.2/src/common/rendering/vulkan/system/vk_builders.cpp
@@ -25,6 +25,7 @@
 #include "renderstyle.h"
 #include <ShaderLang.h>
 #include <GlslangToSpv.h>
+#include <glslang/build_info.h>
 
 static const TBuiltInResource DefaultTBuiltInResource = {
 	/* .MaxLights = */ 32,
@@ -119,6 +120,9 @@ static const TBuiltInResource DefaultTBu
 	/* .maxTaskWorkGroupSizeY_NV = */ 1,
 	/* .maxTaskWorkGroupSizeZ_NV = */ 1,
 	/* .maxMeshViewCountNV = */ 4,
+#if GLSLANG_VERSION_MAJOR == 11 && GLSLANG_VERSION_MINOR >= 12
+	256, 256, 128, 128, 128, 128, 128, 128, 4,
+#endif
 	/* .maxDualSourceDrawBuffersEXT = */ 1,
 
 	/* .limits = */ {

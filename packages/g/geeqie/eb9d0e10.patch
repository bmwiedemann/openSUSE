From eb9d0e103f92ddec1bf9b113f7d6a91321a19130 Mon Sep 17 00:00:00 2001
From: Julian Hofer <julianhofer@gnome.org>
Date: Sat, 13 Aug 2022 20:56:58 +0200
Subject: [PATCH] Fix appdata and icon installation

- Appdata used invalid tags
- Icon was not installed
---
 org.geeqie.Geeqie.appdata.xml.in              | 9 ++++-----
 src/icons/meson.build                         | 2 ++
 src/icons/svg/{gqview_icon.svg => geeqie.svg} | 0
 src/icons/svg/meson.build                     | 7 +++++++
 4 files changed, 13 insertions(+), 5 deletions(-)
 rename src/icons/svg/{gqview_icon.svg => geeqie.svg} (100%)
 create mode 100644 src/icons/svg/meson.build

diff --git a/org.geeqie.Geeqie.appdata.xml.in b/org.geeqie.Geeqie.appdata.xml.in
index 2c8dbdd5..e52a1986 100644
--- a/org.geeqie.Geeqie.appdata.xml.in
+++ b/org.geeqie.Geeqie.appdata.xml.in
@@ -7,12 +7,12 @@
   <_name>Geeqie</_name>
   <_summary>A lightweight image viewer</_summary>
   <description>
-    <_p>
+    <p>
           Geeqie is a lightweight image viewer for Linux, BSDs and compatibles.
-        </_p>
-    <_p>
+    </p>
+    <p>
           It can be used as a simple, fast, database-free image viewer, but equally it can be used to manage large collections of images.
-        </_p>
+    </p>
   </description>
   <screenshots>
     <screenshot type="default">
@@ -35,4 +35,3 @@
   <update_contact>geeqie@freelists.org</update_contact>
   <translation type="gettext">geeqie</translation>
 </component>
-
diff --git a/src/icons/meson.build b/src/icons/meson.build
index ee55ab3a..55d76268 100644
--- a/src/icons/meson.build
+++ b/src/icons/meson.build
@@ -67,3 +67,5 @@ icons_inline_h = custom_target('icons_inline', output : 'icons_inline.h',
         capture : true)
 
 project_sources += icons_inline_h
+
+subdir('svg')
diff --git a/src/icons/svg/gqview_icon.svg b/src/icons/svg/geeqie.svg
similarity index 100%
rename from src/icons/svg/gqview_icon.svg
rename to src/icons/svg/geeqie.svg
diff --git a/src/icons/svg/meson.build b/src/icons/svg/meson.build
new file mode 100644
index 00000000..12c771eb
--- /dev/null
+++ b/src/icons/svg/meson.build
@@ -0,0 +1,7 @@
+datadir = prefix / get_option('datadir')
+iconsdir = datadir / 'icons'
+
+install_data(
+  'geeqie.svg',
+  install_dir: iconsdir / 'hicolor' / 'scalable' / 'apps',
+)

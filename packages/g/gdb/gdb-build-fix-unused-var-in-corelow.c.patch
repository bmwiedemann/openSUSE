From c179fc89cf61d3d9c58db571d709969bfa566289 Mon Sep 17 00:00:00 2001
From: Tom de Vries <tdevries@suse.de>
Date: Tue, 10 Sep 2024 10:08:29 +0200
Subject: [PATCH] [gdb/build] Fix unused var in corelow.c
MIME-Version: 1.0
Content-Type: text/plain; charset=UTF-8
Content-Transfer-Encoding: 8bit

On x86_64-linux, with gcc 7.5.0 and CFLAGS/CXXFLAGS="-O0 -g -Wall" I ran into
a build breaker:
...
gdb/corelow.c: In member function ‘void mapped_file_info::add(const char*, const char*, const char*, std::vector<mem_range>&&, const bfd_build_id*)’:
gdb/corelow.c:1822:27: error: unused variable ‘it’ [-Werror=unused-variable]
   const auto [it, inserted]
                           ^
...

Fix this by dropping the variable it.

Tested on x86_64-linux.

Reviewed-By: Lancelot Six<lancelot.six@amd.com>
---
 gdb/corelow.c | 4 ++--
 1 file changed, 2 insertions(+), 2 deletions(-)

diff --git a/gdb/corelow.c b/gdb/corelow.c
index 1884075ec67..30b98c2865d 100644
--- a/gdb/corelow.c
+++ b/gdb/corelow.c
@@ -1872,8 +1872,8 @@ mapped_file_info::add (const char *soname,
      parsed, we group the build-id information based on the file name.  As
      a consequence, we should see each EXPECTED_FILENAME value exactly
      once.  This means that each insertion should always succeed.  */
-  const auto [it, inserted]
-    = m_filename_to_build_id_map.emplace (expected_filename, build_id);
+  const auto inserted
+    = m_filename_to_build_id_map.emplace (expected_filename, build_id).second;
   gdb_assert (inserted);
 
   /* Setup the reverse build-id to file name map.  */

base-commit: a7d9abecbc24e3d68746ea5b905eba11913980e1
-- 
2.43.0


From 3d9c3ecda9c68039c309bfb6bfc93830c4a0e20e Mon Sep 17 00:00:00 2001
From: Felix Zhang <fezhang@suse.com>
Date: Mon, 12 Sep 2016 18:00:07 +0800
Subject: [PATCH] more power button actions

---
 data/gsd-enums.h                            | 2 ++
 plugins/media-keys/gsd-media-keys-manager.c | 6 ++++++
 2 files changed, 8 insertions(+)

diff -urp gnome-settings-daemon-3.33.90.orig/data/gsd-enums.h gnome-settings-daemon-3.33.90/data/gsd-enums.h
--- gnome-settings-daemon-3.33.90.orig/data/gsd-enums.h	2019-08-05 18:40:19.000000000 -0500
+++ gnome-settings-daemon-3.33.90/data/gsd-enums.h	2019-08-31 19:45:22.123948132 -0500
@@ -105,6 +105,7 @@ typedef enum
 typedef enum
 {
   GSD_POWER_BUTTON_ACTION_NOTHING,
+  GSD_POWER_BUTTON_ACTION_SHUTDOWN,
   GSD_POWER_BUTTON_ACTION_SUSPEND,
   GSD_POWER_BUTTON_ACTION_HIBERNATE,
   GSD_POWER_BUTTON_ACTION_INTERACTIVE
diff -urp gnome-settings-daemon-3.33.90.orig/plugins/media-keys/gsd-media-keys-manager.c gnome-settings-daemon-3.33.90/plugins/media-keys/gsd-media-keys-manager.c
--- gnome-settings-daemon-3.33.90.orig/plugins/media-keys/gsd-media-keys-manager.c	2019-08-31 19:31:09.939430941 -0500
+++ gnome-settings-daemon-3.33.90/plugins/media-keys/gsd-media-keys-manager.c	2019-08-31 19:45:22.127948152 -0500
@@ -2230,6 +2230,9 @@ do_config_power_button_action (GsdMediaK
 
         action_type = g_settings_get_enum (priv->power_settings, "power-button-action");
         switch (action_type) {
+        case GSD_POWER_BUTTON_ACTION_SHUTDOWN:
+                do_config_power_action (manager, GSD_POWER_ACTION_SHUTDOWN, in_lock_screen);
+                break;
         case GSD_POWER_BUTTON_ACTION_SUSPEND:
                 action = GSD_POWER_ACTION_SUSPEND;
                 break;

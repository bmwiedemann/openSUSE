From a08055f1a18886fdacaf0cba5887b7ff2f687732 Mon Sep 17 00:00:00 2001
From: Adam Fontenot <adam.m.fontenot@gmail.com>
Date: Tue, 19 Jan 2021 13:47:27 +0100
Subject: [PATCH] =?UTF-8?q?Issue=20#6210:=20Subpixel=20font=20rendering=20?=
 =?UTF-8?q?system=20settings=20should=20only=E2=80=A6?=
MIME-Version: 1.0
Content-Type: text/plain; charset=UTF-8
Content-Transfer-Encoding: 8bit

â€¦ apply to GIMP GUI not text layer rendering in image.

Reviewer note: this is the theoretical fix, but it won't work right now
because Cairo explicitly bypasses grayscale antialiasing when system set
subpixel one. Still let's push this first patch, but the issue will be
actually fixed when Cairo will merge my MR too:
https://gitlab.freedesktop.org/cairo/cairo/-/merge_requests/114

(cherry picked from commit 00bbeabaf4d8a434bd64371303ee982fb5403ab6)
---
 app/text/gimptextlayout.c | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

diff --git a/app/text/gimptextlayout.c b/app/text/gimptextlayout.c
index 47beed7705..56c670ea0b 100644
--- a/app/text/gimptextlayout.c
+++ b/app/text/gimptextlayout.c
@@ -701,7 +701,7 @@ gimp_text_get_font_options (GimpText *text)
   cairo_font_options_t *options = cairo_font_options_create ();
 
   cairo_font_options_set_antialias (options, (text->antialias ?
-                                              CAIRO_ANTIALIAS_DEFAULT :
+                                              CAIRO_ANTIALIAS_GRAY :
                                               CAIRO_ANTIALIAS_NONE));
 
   switch (text->hint_style)
-- 
2.33.1


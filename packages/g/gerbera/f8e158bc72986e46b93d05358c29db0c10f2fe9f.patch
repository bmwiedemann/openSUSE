From f8e158bc72986e46b93d05358c29db0c10f2fe9f Mon Sep 17 00:00:00 2001
From: Karlchen <k_straussberger@netzland.net>
Date: Wed, 17 Sep 2025 21:18:49 +0200
Subject: [PATCH] Update to fmt 12.0.0

---
 .github/workflows/publish-deb.yml | 1 -
 ChangeLog.md                      | 1 +
 README.md                         | 4 ++--
 ReleaseNotes.md                   | 3 ++-
 scripts/versions.sh               | 6 +++---
 src/web/config_load.cc            | 4 ++++
 6 files changed, 12 insertions(+), 7 deletions(-)

Index: gerbera-2.6.1/.github/workflows/publish-deb.yml
===================================================================
--- gerbera-2.6.1.orig/.github/workflows/publish-deb.yml
+++ gerbera-2.6.1/.github/workflows/publish-deb.yml
@@ -27,7 +27,6 @@ jobs:
           - "ubuntu:20.04"
           - "ubuntu:22.04"
           - "ubuntu:24.04"
-          - "ubuntu:24.10"
           - "ubuntu:25.04"
           - "debian:bullseye"
           - "debian:bookworm"
Index: gerbera-2.6.1/README.md
===================================================================
--- gerbera-2.6.1.orig/README.md
+++ gerbera-2.6.1/README.md
@@ -60,7 +60,7 @@ sudo make install
 | libiconv            |             |             |                      | Required      | Charset conversion         |          |
 | sqlite3             | 3.7.0       | 3.35.5      | 3.49.1               | Required      | Database storage           |          |
 | zlib                |             |             |                      | Required      | Data compression           |          |
-| [fmtlib]            | 7.1.3       | 9.1.0       | 11.2.0               | Required      | Fast string formatting     |          |
+| [fmtlib]            | 7.1.3       | 11.2.0      | 12.0.0               | Required      | Fast string formatting     |          |
 | [spdlog]            | 1.8.1       | 1.11.0      | 1.15.3               | Required      | Runtime logging            |          |
 | [icu4c]             | 65.1        | 65.1        | 65.1                 | Required      | Transliteration            | Enabled  |
 | [duktape]           | 2.1.0       | 2.6.0       | 2.7.0                | Optional      | Scripting Support          | Enabled  |
@@ -84,7 +84,7 @@ sudo make install
 |---------------------|-------------|-------------|---------------|---------------|--------------------------------|----------|
 | [googletest]        | 1.10.0      | 1.10.0      | 1.17.0        | Optional      | Running tests                  | Disabled |
 | [doxygen]           |             | 1.8.14      | 1.8.14        | Optional      | Building source documentation  | Disabled |
-| [cmake]             | 3.25.0      | 3.31.38     | 4.0.3         | Optional      | Build processing               | Disabled |
+| [cmake]             | 3.25.0      | 3.31.38     | 4.1.1         | Mandatory     | Build processing               | Enabled  |
 
 ## License
 
Index: gerbera-2.6.1/scripts/versions.sh
===================================================================
--- gerbera-2.6.1.orig/scripts/versions.sh
+++ gerbera-2.6.1/scripts/versions.sh
@@ -45,7 +45,7 @@ elif [[ "${GERBERA_ENV-head}" == "defaul
     EXIV2="v0.27.7"
     EXIF="v0.6.24"
     FFMPEGTHUMBNAILER="2.2.2"
-    FMT="9.1.0"
+    FMT="11.2.0"
     GOOGLETEST="1.10.0"
     LASTFM="0.4.0"
     MATROSKA="1.5.2"
@@ -65,7 +65,7 @@ else
     EXIV2="v0.28.5"
     EXIF="v0.6.25"
     FFMPEGTHUMBNAILER="2.2.3"
-    FMT="11.2.0"
+    FMT="12.0.0"
     GOOGLETEST="1.17.0"
     LASTFM="0.4.0"
     MATROSKA="1.7.1"
@@ -76,6 +76,6 @@ else
     WAVPACK="5.8.1"
     TAGLIB="2.1.1"
     JSONCPP="1.9.6"
-    CMAKE="4.0.3"
+    CMAKE="4.1.1"
 
 fi
Index: gerbera-2.6.1/src/web/config_load.cc
===================================================================
--- gerbera-2.6.1.orig/src/web/config_load.cc
+++ gerbera-2.6.1/src/web/config_load.cc
@@ -150,7 +150,11 @@ void Web::ConfigLoad::addNewValue(
 template <typename T>
 void Web::ConfigLoad::setValue(Json::Value& item, const T& value)
 {
+#if FMT_VERSION >= 120000
+    static_assert(fmt::is_formattable<T, fmt::format_context>::value, "T must be formattable");
+#else
     static_assert(fmt::has_formatter<T, fmt::format_context>::value, "T must be formattable");
+#endif
     item[CONFIG_LOAD_VALUE] = fmt::to_string(value);
 }
 

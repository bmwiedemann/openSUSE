Index: git/read-cache.c
===================================================================
--- git.orig/read-cache.c
+++ git/read-cache.c
@@ -1135,10 +1135,13 @@ static int has_dir_name(struct index_sta
 		size_t len;
 
 		for (;;) {
-			if (*--slash == '/')
-				break;
+			slash--;
+
 			if (slash <= ce->name)
 				return retval;
+
+			if (*slash == '/')
+				break;
 		}
 		len = slash - name;
 

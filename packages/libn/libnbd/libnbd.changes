-------------------------------------------------------------------
Tue May 24 16:31:09 UTC 2022 - James Fehlig <jfehlig@suse.com>

- Adjust _service file to coincide with recent manual update to
  version 1.12.2

-------------------------------------------------------------------
Mon May 16 10:35:34 MDT 2022 - carnold@suse.com

- Update to version 1.12.2:
  * Version 1.12.2.
  * Fix for CVE-2022-0485 Silent data corruption when using
    nbdcopy(1).
  * New APIs
    get_pread_initialize
    set_pread_initialize
      Control whether libnbd clears the pread buffer to avoid
      leaking memory contents if the client does not properly
      handle errors. These were added as part of the fix for
      CVE-2022-0485 (Eric Blake).
    get_request_block_size
    set_request_block_size
      Control whether libnbd requests block size constraints from
      the server during negotiation (Eric Blake).
  * Error messages about incorrect URIs in nbd_connect_uri(3) have
    been improved to make common mistakes clearer for the user.
  * New syntax: nbdinfo [ CMD ... ] allowing you to query the
    properties of an NBD server directly.
  * nbdcopy(1) new --queue-size option to control the maximum
    size of the internal buffer (Nir Soffer).
  * nbdcopy(1) now names the source and destination handles to
    make it easier to understand debug output.
  * New OCaml NBD.with_handle helper which ensures that NBD.close
    is always called even if the inner code throws an exception.
  * The OCaml bindings now consistently use the correct types for
    buffer sizes everywhere (Laszlo Ersek).
  * Several improvements and fixes to the golang bindings and
    tests. The golang bindings have been relicensed to LGPLv2+
    like the rest of the library and are now published as a golang
    module at https://libguestfs.org/libnbd (Nir Soffer).
  * The Python bindings no longer crash if you pass None in place
    of a buffer parameter. In addition some memory leaks were fixed
    (Eric Blake).
  * Various memory leaks have been fixed when using the optional
    strict_mode settings (Eric Blake).
  * The performance of the internal vector library has been
    improved greatly and overflow is now handled correctly
    (Nir Soffer, Laszlo Ersek and Eric Blake).
  * Add simple_copy and aio_copy Golang examples (Nir Soffer).
  * Error handling was reviewed and fixed across many of the
    example programs and documentation (Eric Blake, Nir Soffer).
  * Simplify and optimize handling of the extents callback in
    Golang (Nir Soffer).
  * Golang AioBuffer was enhanced, making it safer to use, faster
    and adding documentation (Nir Soffer).
  * Other fixes to Tests, Documentation, and Build.

-------------------------------------------------------------------
Thu May 12 16:25:41 MDT 2022 - carnold@suse.com

- Enable building the ocaml bindings for libnbd.
  virt-v2v has added a dependency on ocaml bindings from libnbd 
  beginning with virt-v2v version 2.0.0.
  libnbd.spec

-------------------------------------------------------------------
Tue Feb 08 16:46:29 UTC 2022 - jfehlig@suse.com

- Update to version 1.10.4:
  * Version 1.10.4.
  * copy: CVE-2022-0485: Fail nbdcopy if NBD read or write fails (bsc#1195636)
  * copy: Pass in dummy variable rather than &errno to callback
  * docs: Clarify how callbacks should handle errors
  * ocaml: tests: Fix error handling
  * python: tests: Fix error handling
  * ocaml/helpers.c: Rearrange Assert_failure check
  * golang: tests: Fix error handling
  * docs: Fix typo in callback docs
  * ocaml: Update comment

-------------------------------------------------------------------
Wed Aug 25 23:00:54 UTC 2021 - jfehlig@suse.com

- Update to version 1.9.3:
  * Version 1.9.3.
  * maint: Modernize configure.ac to silence autoreconf warnings
  * maint: Update to latest ax_pthread.m4
  * copy: Avoid potential divide by zero when source size is zero
  * copy: Test corner case of copying from zero-sized source
  * copy: Fix progress bar
  * Update CI files once more
  * ci: Allow failure when building fedora rawhide container
  * ci: Consolidate refresh scripts
  * macOS: Simple cloexec/nonblock fix
  * info: Require can_cache for info-can.sh
  * CI: Add testing on Alpine
  * Update CI files
  * macOS: Do not use --version_script
  * One more VSOCK include fix
  * m4: Remove *~ on make clean
  * ci: Rework the build script to run check-valgrind properly
  * fuse: move check-valgrind out from condition
  * qemu-storage-daemon 5.2.0 is still broken
  * Version 1.9.2.
  * python: Add missing test file to EXTRA_DIST
  * build: Warn about large stack frames
  * configure: Add a macro to test if compiler -W warning flags work
  * lib/uri.c: nbd_get_uri: Do not translate port name into service
  * python: Implement nbd.aio_connect for AF_UNIX
  * bash: Generate completion files during build
  * info: Add percentage after field in --map --totals
  * info: Add --can|--is options to test for NBD flags
  * info: Add --map --totals sub-mode to display summary of map
  * info: Don't print extra trailing \n after output
  * fuse: Tidy up MODES section of the documentation
  * fuse: Note in docs that read-only server implies -r flag
  * fuse: Improve documentation on the thread model
  * fuse: Update comment as we expect zero support to be present in 5.14
  * copy: Set default request-size to 2**18 (262144 bytes)
  * copy/copy-sparse-no-extents.sh: Set request-size explicitly
  * maint: Untabify configure.ac

-------------------------------------------------------------------
Thu Jul 01 14:37:03 UTC 2021 - jfehlig@suse.com

- Update to version 1.9.1:
  * Version 1.9.1.
  * ci: Update build files
  * ci: Also perform `brew upgrade` on MacOS
  * ci: Only run `make check` on Linux
  * ci: Skip some broken tests/distro combinations
  * ci: Rename build_script.sh to just build.sh
  * ci: Add support for test skipping
  * ci: Some build script fixes
  * ci: Fix run commands in README
  * ci: Add support for FreeBSD-13.0
  * ci: Remove debian-10-clang build
  * ci: Remove cross-compilation targets
  * ci: Change docker driver and archive logs
  * tests: Rename version to get-version
  * tests: Do not use magic parameter for some nbdkit plugins
  * tests: Require cap_sys_admin where root is required
  * tests: Fix port randomisation
  * tests: Enhance fuse probing
  * tests: Clean up qemu-nbd detection
  * tests: Fix hexdump probing
  * interop: Do not test against broken qemu-storage-daemon
  * fuse: Only support defined fallocate modes
  * Include sys/vsock.h if linux/vm_sockets.h is not available
  * info: Avoid ambiguous 'allocated' terminology in --map
  * run: Unset DEBUGINFOD_URLS
  * ci/cirrus: Update system before doing anything else

-------------------------------------------------------------------
Wed Jun 09 19:50:28 UTC 2021 - jfehlig@suse.com

- Update to version 1.8.0:
  * Version 1.8.0.
  * docs: Get release notes ready for a release today
  * copy/copy-file-to-qcow2.sh: Skip this test for old qemu-nbd
  * docs: Put links to release notes in a separate section
  * docs: Add preliminary release notes for libnbd 1.8
  * common/utils: Add test-vector.c (unit test for vectors) from nbdkit
  * copy, fuse, info: Synchronize --help output with manual
  * generator: Update copyright year in generated files.
  * Update README
  * Version 1.7.12.

-------------------------------------------------------------------
Wed Apr 14 01:04:29 UTC 2021 - Ferdinand Thiessen <rpm@fthiessen.de>

- Update to 1.7.7
  * Fixed CVE-2021-20286
  * Fix parsing and construction of IPv6 URIs
  * New API nbd_get_uri to get an NBD URI for a connection
  * Permit "see also" links to nbd_get_error and nbd_get_errno
  * Avoid over-long lines in POD. 
  * Fix reporting of NBD URI support
  * Let exit status reflect any failures during NBD_OPT_INFO
  * Fix page eviction when len < page_size.

-------------------------------------------------------------------
Sun Mar 14 18:31:11 UTC 2021 - Jan Engelhardt <jengelh@inai.de>

- Specfile modernization

-------------------------------------------------------------------
Thu Feb 25 23:25:24 UTC 2021 - James Fehlig <jfehlig@suse.com>

- spec: Only enable system nbd interop tests if
  suse_version >= 1550

-------------------------------------------------------------------
Tue Jan 26 23:36:04 UTC 2021 - jfehlig@suse.com

- Initial packaging of libnbd:
  * Version 1.7.1.
  * sh: Add NOTES section.
  * copy: Update multi-conn documentation.
  * sh: Arrange --opt-mode documentation in alphabetical order.
  * python: Add example.
  * copy: Fix initialization complaint with ancient GCC on RHEL 7.
  * python: Fix Python style error.
  * copy/file-ops.c: Small whitespace fix.
  * copy/copy-nbd-to-sparse-file.sh: Skip test unless nbdkit available.


commit 685f8c34824aa3573e1aaa02e1fe0011946585ef
Author: Ranjit Jhala <jhala@cs.ucsd.edu>
Date:   Wed Aug 5 21:04:03 2020 -0700

    build on stack lts-16.8
---
 src/Language/Haskell/Liquid/UX/DiffCheck.hs | 11 ++++++-----
 1 file changed, 6 insertions(+), 5 deletions(-)

diff --git a/src/Language/Haskell/Liquid/UX/DiffCheck.hs b/src/Language/Haskell/Liquid/UX/DiffCheck.hs
index 911779714..f51778525 100644
--- a/src/Language/Haskell/Liquid/UX/DiffCheck.hs
+++ b/src/Language/Haskell/Liquid/UX/DiffCheck.hs
@@ -366,7 +366,12 @@ lineDiff' new old = (changedLines, lm)
   where
     changedLines  = diffLines 1 diffLineCount
     lm            = foldr setShift IM.empty $ diffShifts diffLineCount
-    diffLineCount = fmap length <$> getGroupedDiff new old
+    diffLineCount = diffMap length <$> getGroupedDiff new old
+
+diffMap :: (a -> b) -> Diff a -> Diff b
+diffMap f (First x)  = First (f x)
+diffMap f (Second x) = Second (f x)
+diffMap f (Both x y) = Both (f x) (f y)
 
 -- | Identifies lines that have changed
 diffLines :: Int        -- ^ Starting line
@@ -389,10 +394,6 @@ diffShifts = go 1 1
     go old new (First n  : d) = go old (new + n) d
     go _   _   []             = []
 
-instance Functor Diff where
-  fmap f (First x)  = First (f x)
-  fmap f (Second x) = Second (f x)
-  fmap f (Both x y) = Both (f x) (f y)
 
 -- | @save@ creates an .saved version of the @target@ file, which will be
 --    used to find what has changed the /next time/ @target@ is checked.

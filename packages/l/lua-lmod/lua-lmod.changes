-------------------------------------------------------------------
Mon Jan 27 10:27:04 UTC 2025 - Egbert Eich <eich@suse.com>

- Add /usr/share/lmod/%{version}/libexec/addto to the `bash`
  Apparmor abstraction to allow it to be executed when setting the
  environment when starting non-interactive shells (boo#1236365).

-------------------------------------------------------------------
Fri Jan  3 12:10:22 UTC 2025 - Egbert Eich <eich@suse.com>

- Update to version 8.7.55:
  * Version 8.7.38
    + Issue #697: Add warning if doing `module use --help`
    + Make `LMOD_IGNORE_CACHE` use "yes/no" env variable setting
      system.
    + Make `module --terse show <module>` do the same as
      `module --loc show <module>`, namely print the location of the
      module.
    + Support for `module --terse spider phdf5/1.12.2` that just
      prints the module in the hierarchy.
    + Move almost almost all `cosmic:value()` calls to inside
      function not at routine top-level.
    + Report build time in UTC when `$SOURCE_DATE_EPOCH` is set.
    + Support for downstream conflicts has been added.
    + Support for dynamic `LMOD_MODULERC` has been added.
   (8.7.39) * Fix busted test for ModuleA.
  * Version 8.7.40
    + Bug fix for prepend/append path when trying to add an empty string.
    + Bug fix for `serializeTbl`: handle empty or single blank
      string as key.
  * Version 8.7.41
    + Added new function `depends_on_any()`.
    + If `$MODULES_AUTO_HANDLING` is set then
      `prereq() -> depends_on()`; prereq_any() -> depends_on_any()`
    + Generate a perl pod format for manpage for `module.1`
    + `ModuleTable` modification: Changes to `$MODULEPATH` are
      stored in an entry.
  * Version 8.7.42
    + Fix setting of `$FPATH` when running bash or ksh shell
      and executing `zsh -l`.
  * Version 8.7.43
    + Support for ksh flag not needed anymore.
  * Version 8.7.44
    + `path2pathA()` keep double delims, Reduce triple delims to double.
  * Version 8.7.45
    + Changing `MName.src`: `l_find_highest_by_key()` to loop over
      all `fileA` entries. Now stoping at first one found rather than
      just looking at `fileA[1]`.
    + Adding `=encoding UTF-8` to pod generation.
  * Version 8.7.46
    + Must only add `KSH_SUPPORT` to zsh when both `$orig_zsh_version`
      and `$zsh_fpath` have non-null values.
  * Version 8.7.47
    + Use correct shell syntax in bash init script.
  * Version 8.7.48
    + Keep previous `varT` when restoring a collection.
      Otherwise the previous modules env vars are lost and therefore
      not purged.
    + Use `__build_FPATH_for_zsh_ksh` to build `FPATH` for both shells.
    + Support for `terse avail` extensions.
  * Version 8.7.49
    + Add support for zsh to handle a non-exported `FPATH` in bash
      init script.
    + Change `MF_Base:processVars` to use `oldT` to know which paths
      from `newA` to prepend or append.
    + Add support for `LMOD_FILE_IGNORE_PATTERNS` in `src/DirTree.lua`.
      This is to ignore files like `.version.1.3` or `.modulerc-1.3.lua`
      etc.
  * Version 8.7.50
    + Emacs lisp integration updated.
    + Use `command -v` instead of checking status `$?`.
    + Change `--hidden_load` to `--hidden-loaded` for TCL change
      `hidden_load` to `hidden_loaded` in Lua.
    + Report `dofile()` usage as an error.
    + Updated `FPATH` support: bash, ksh just add path
      (`init/ksh_funcs`) to `FPATH`.
    + zsh: if `autoload` and `compinit` fail then set `__zsh_fpath`
      with sub-shell.
    + Improve `addto` to not include duplicates in path like
      variables (`PATH`, `FPATH`, .. )
    + Add support for `--dumpname` in `lmod` and `ml`; Update tab
      completions files.
    + Do not reset `BASH_ENV` if already set for `cshrc.in`.
    + Do not reset `BASH_ENV` if already set for profile.in.
    + Support for the functions `hide{}` and `forbid{}`.
  * Version 8.7.51
    + Fix bug in load test.
  * Version 8.7.52
    + Add `MName:isVisible()` so that load hooks can figure out if
      a loaded module is is visible or not.
  * Version 8.7.53
    + Updating docs to include link to `165_debugging_lmod.rst`.
  * Version 8.7.54
    + Remove all `v.file` tests in dealing with `ModuleA`.
    + Use `self.__mpathT[mpath].hiddenT` and `self.__hiddenT` instead
      of merged table for hidden status.
    + Added `mrc:set_display_mode()` before commands.
    + Build reverse maps for `mod2versionT` and `full2aliasesT`
      dynamically
    + Added `MRC:pairsForMRC_aliases` iterator.
    + Removed `MRC:__marged_hiddenT`, `MRC:__marged_forbiddenT`
      and `MRC:__mergedAlias2modT`.
    + Add support for environment variable `LMOD_SHOW_HIDDEN`.
    + Make TCL files have `spider` as mode matching when Lmod is
      in spider mode.
  * Version 8.7.55
    + Add a better test for spaces in front of `#`.
- Replace
  Messages-Remove-message-about-creating-a-consulting-ticket.patch
  by `sed` command.
- Remove Doc-Ugly-workaround-for-bug-in-Sphinx.patch
  as it is relevant pre SLE-15 products only.

-------------------------------------------------------------------
Sat Aug 24 14:40:19 UTC 2024 - Bernhard Wiedemann <bwiedemann@suse.com>

- Update to version 8.7.48:
  * override build date for reproducible builds (boo#1047218)
  * https://github.com/TACC/Lmod/compare/8.7.37...8.7.48

-------------------------------------------------------------------
Mon Apr 15 15:52:30 UTC 2024 - Egbert Eich <eich@suse.com>

-  Update to version 8.7.37:
   * Use the correct mname from Framestack when unregistering a "break"
     module.
   * Ignore backup files (*~ .*.swp etc) files in a modulerc.d directory.
   * Fixed buildVersion_src to deal with (HEAD detached at x.y.z)
   * From 8.7.35 & 8.7.36:
     * Let is-loaded and is-avail set  non-zero exit status. This is different
       from warnings.
     * Must pass in mpathA to isVisible when trying to find hidden modules in
       buildDbT
     * Do not produce a Lua error on a non-existant collection
     * Now use "m_Module_Msgs_close" instead of border so that sites can
       override.
     * Add LMOD_ADMIN_FILE to config report
     * Call build_i18n before calling warnings, errors or messages
     * Allow for multiple hooks.  Note that last one in list sets the result
       value on return
     * Allow io.popen() to be called from a modulefile.
     * Created buildVersion_src to build src/Version.lua when installing Lmod.

-------------------------------------------------------------------
Fri Mar  1 11:15:37 UTC 2024 - pgajdos@suse.com

- Use %patch -P N instead of deprecated %patchN.

-------------------------------------------------------------------
Wed Jan 17 15:14:23 UTC 2024 - Egbert Eich <eich@suse.com>

- Update to version 8.7.34
  * (Again) Cannot use the string ${ZSH_VERSION} in
    $FPATH.  Instead change orig zsh version to current one.
  * Change isFile(fn) to return nil if fn is a broken symlink.
  * Change abspath() to l_abspath() in tools/fileOps.lua
  * Create realpath() to use posix.realpath() if it exists
    otherwise use l_abspath()
  * Implement user request that the Active RC file(s) be realpath()
  * Internally rename complete name to be "complete<name>" and
    unwrap when necessary.
  * Change the current version of zsh with the string
    ${ZSH_VERSION} when builting the init/zsh file.
  * Better handling of zsh shell functions in source_sh().
    Must match "\n}\n" to find end of function.
  * Better name for extension title, remove trailing \n
  * Added support for getenv function in TCL modules
  * Fix bug where the version is very long (like git commit tags)
  * Must delete old tcl2lua.so* files before installing new ones
  * wrap double quotes around any newlines found in env var value
    in bash like shells
  * Unknown TCL module command now produce an error instead of
    being ignored
  * Update zsh and bash tab completion files
  * Added support for "module purge" in a TCL modulefile to unload
    all other modules on load.
  * "module show" now prints the contents of inheritted modules.
  * Added support for "purge()" function in modules to unload all
    other modules on load.
  * Created hook colorize_fullName to allow for sites to control
    how "module list" and "module av"
    prints to the terminal.
  * Make isFile return true for all file types except dir.
  * Now print alias and de-refed module in module list and module
    -t list.
  * Allow -f and --force to be the same option for the lmod
    command (module)
  * Do not use install to copy symbolic links
  * Change $MODULEPATH_INIT to $LMOD_MODULEPATH_INIT
  * Abort configure step if bc is not found
  * Allow users to do "ml -f purge" which is translated to
    "module --force purge"
  * Allow site to use /etc/lmod/.modulespath or $MODULEPATH_INIT
    to set file location of
    .modulespath
  * Switch tcsh/csh module alias to use tcsh/csh instead of shell.
    The dynamic_shell routine does not
    work under MacOS for tcsh/csh correctly.
  * Fix the generation of the manpage to be portable by setting
    LUA_PATH, LUA_CPATH
    to have the system paths and the installed Lmod paths.
    This fixes missing posix and lfs
  * Change default location of SitePackage.lua to be called
    <srctree> so that rt/configDir test passes portably.
  * Undo fixes in end2end.tdesc and rt/common_funcs.sh to unset
    LMOD_FAST_TCL_INTERP
  * Switch to use gsha1sum instead of sha1sum on Darwin.
    (It works better on M1 macs)
  * Created LMOD_USING_FAST_TCL_INTERP cosmic var to report if
    fast tcl interp is active.
  * Allow both pushenv("FOO","") and pushenv("FOO",false) to work.
  * Report SitePackage.lua location if different from "standard"
  * Report the existance of lmod_config.lua and its location
  * Add module-hide and module-forbid to RC2lua.tcl. They are
    currently no-ops.
  * Add support for module --brief list to list only direct user
    loaded modules (stackDepth == 0)
  * Fix Lmod location to /main/ in README.md
  * Add env variable LMOD_DEBUG as another way to turn on
    Lmod debugging.
  * Do not print Global Aliases header when no aliases would
    be printed.
  * Must take barebasename of results from ps -p $PPID -ocomm=
    in dynamic_shell in src/utils.lua Also fix s_shellTbl entry
    for zsh.
    Also handle the case where posix.readlink is not working
  * Do not ignore error when building man_pages
    Wrap pcall when trying to require("tcl2lua")
  * Change MainControl:reportMissingDepModules() to report missing
    dep. modules through LmodWarning()
  * Fix bug where repeating the same directory in the $MODULEPATH
    would cause a loopback and therefore a stack overflow when
    building the spider cache.

-------------------------------------------------------------------
Tue Jul  4 17:08:22 UTC 2023 - Egbert Eich <eich@suse.com>

- Add apparmor bash abstraction for Lmod (bsc#1212837).
- Create an rpmlint file.
- Rename Provides: modules to environment-modules. This way,
  it is compatible with the other provider.
- Stop building on 32 bit.

-------------------------------------------------------------------
Tue Feb  7 19:25:14 UTC 2023 - Egbert Eich <eich@suse.com>

- Match the Lua version and version name suffix of Lua libraries
  in Requires: to what has been used for building. Also set the
  minimal Lua version required by Lmod (bsc#1207970).
- Do not 'Require:' lua interpreter explicitly: this will be
  handled by an auto-generated dependency.
- After a discussion with Dominique (dimstar@opensuse.org)
  he agreed to define the preferred Lua vesion in %%lua_pref
  in the ProjConfig of oS:Factory so that it can be used in
  'BuildRequires:'. Take advantage of this new value (with a
  fallback).

-------------------------------------------------------------------
Fri Jan 13 06:07:14 UTC 2023 - Egbert Eich <eich@suse.com>

- Updated to version 8.7.15:
  * Issue #619: Do not source lmod_bash_aliases when $POSIXLY_CORRECT is set
    (by bash --posix)
  * Issue #620: Dynamically set shell name inside Lmod instead of init/bash.in
  * Added debugging stmts to track down issue when adding loop in MODULEPATH
    when doing a spider.
  * Zsh now gets /path/to/ksh_scripts if KSH_SUPPORT is yes.
  * Issue #620: Honor shell name on command line.  Use "shell"
    when Lmod gets to decide.
  * Fix bug in keyword terse output: Add newline on final entry (Created
    in Lmod 8.4.18).
- Obsoletes:
  issue-620-Delay-setting-of-LMOD_SHELL_PRGM-until-module-is-actually-called.patch

-------------------------------------------------------------------
Thu Jan 12 13:22:34 UTC 2023 - Egbert Eich <eich@suse.com>

- Changing description to make it more clear to users what this tool
  is for wand where it should be installed - and where not.
  Also add Provides: for shell functions set by shell init scripts
  provided with this package.

-------------------------------------------------------------------
Mon Jan  9 19:43:36 UTC 2023 - Egbert Eich <eich@suse.com>

- issue-620-Delay-setting-of-LMOD_SHELL_PRGM-until-module-is-actually-called.patch:
  Since Lmod sets BASH_ENV to /usr/share/lmod/8.7.15/init/bash,
  do not run external commands immediately in this script but only
  when `module` is called for the first time. This prevents errors
  when this script is run during shell init for access restricted
  scripts (apparmor) (boo#1206957).

-------------------------------------------------------------------
Tue Jan  3 13:55:42 UTC 2023 - Egbert Eich <eich@suse.com>

- Update to version 8.7.15:
  User visible changes include:
  * Add option --miniConfig to report configuration differences from default.
  * Move cache file location from ~/.lmod.d/.cache/* to ~/.cache/lmod/*
  * Transitional support for using ~/.config/lmod for collections. Currently collect
    are written to both ~/.lmod.d/ and ~/.config/lmod.
  * setenv and pushenv change local environment when running spider (and avail).
  * Allow bash users to export SUPPORT_KSH=no so that they can avoid bash startup setting FPATH
  * Add --location option to show to write to stderr the file location.
  * Only rebuild spider caches if there are any loaded or pending modules.
    'module avail <name1> <name2> ...' now only prints matching aliases.  Search names are resolved.
  * Print dataT table when there is an Exception.
  * New command added: 'module overview'.
  * Add spiderPathFilter hook so that sites can control what paths are kept or ignored.
  * Added $LMOD_SITE_MODULEPATH support to prepend to MODULEPATH
  * Add support for sh_to_modulefile to support zsh, ksh, bash and tcsh with aliases and shell functions
  * Support for source_sh added. Now support more than one shell script per modulefile.

-------------------------------------------------------------------
Thu Sep 15 11:55:03 UTC 2022 - Stephan Kulow <coolo@suse.com>

- Move latex dependencies to the pdf build flavor

-------------------------------------------------------------------
Wed Jun  9 08:36:10 UTC 2021 - Martin Liška <mliska@suse.cz>

- Add new missing dependency when using Sphinx 4.x.

-------------------------------------------------------------------
Tue Jun  8 11:46:55 UTC 2021 - Egbert Eich <eich@suse.com>

- Adding missing brackets in csh script.

-------------------------------------------------------------------
Thu Jun  3 23:19:40 UTC 2021 - Matej Cepl <mcepl@suse.com>

- Modify generating of /etc/profile.d/lmod.* to allow use of existing
  $MODULEPATH environmental variable (bsc#1159563).

-------------------------------------------------------------------
Fri May  7 13:34:06 UTC 2021 - Egbert Eich <eich@suse.com>

- Move macros out of /etc to the standard rpm macro directory
  (bsc#1185660).
- Remove shebang and execute bit from init scripts.

-------------------------------------------------------------------
Wed Mar 24 06:05:03 UTC 2021 - Egbert Eich <eich@suse.com>

- Update to version 8.4.28:
  For details check: https://github.com/TACC/Lmod/issues/<issueID>
  * Use now converts relative paths to abspath (Issue #505).
  * Allow print statement in modulefiles (Issue #507).
  
-------------------------------------------------------------------
Wed Mar 17 10:37:10 UTC 2021 - Ana Guerrero Lopez <aguerrero@suse.com>

- Update to version 8.4.27:
  * (8.4.21) 
    + Add findLuaProg() or die
  * (8.4.22)
    + Fix luaCmd -> luaprog.
  * (8.4.23) 
    + Fix goto in luaterm pkg.
  * (8.4.24)  
    + Need to quote '?' in csh.
    + Make list of modules from spider skip .version* and .modulerc*
    + analyzeLmodDB now takes a list of all modules so that zero module 
      usage can be reported.
  * (8.4.26)
    + Fix bug with building on Suse linux
    + Allow all paths (but MODULEPATH) to have trailing double slashes.
  * (8.4.27) 
    + Fix default for SHORT_TIME
    + Adding isAvail() function for Lua modulefiles
    + Now reporting that is-avail() is not working for TCL modulefiles

-------------------------------------------------------------------
Tue Feb  9 15:33:51 UTC 2021 - Christian Goll <cgoll@suse.com>

- updated to version 8.4.20 which works with lua54
  * (8.4.20)
    + Adding wV field to MName and MT class (Merged wV branch)
    + This allows users to tell how (if any) default is set.
  * (8.4.19)
    + MasterControl:unsetenv(name) also clears stack if it exists.
    + Issue #490: use old way of following readlink as "readlink -f" is not
      universal.
  * (8.4.18)
    + Issue #481 (and PR #488) are merged in. New configure options to specify
      where lua and luac executables exist (--with-lua= and --with-luac=).
      It is also possible to use --with-luaSuffix=.
      Both --with-lua= and --with-luac= must be specified if one is specified
      The option --with-luaSuffix= can not be used with --with-lua or
      --with-luac
    + PR #489 is merged in. This fixes bug with "module --terse keyword"
  * (8.4.17)
    + If python exists on system use $PYTHON -mjson.tool on the generation
      of *.json files from update_lmod_system_spider_cache_files script.
      Note $PYTHON is found by looking for python3, python or python2
    + Added TCL module function require-fullname to match requireFullName
      in Lua.
    + Do not check $cache_type twice, use $ext = lua for lua like operations
      in update spider cache script.
  * (8.4.16)
    + Issue #483: Added hidden file to spider tests. Showing that it works
      correctly.
    + Fixed bug where providedByT (a.k.a. Extensions) was always
      printed when doing "ml keyword ..."
    + Added lua module function requireFullName()
  * (8.4.15)
    + Issue #480: Fix the try_load() function to ignore failure to be found but
      report broken modules.
  * (8.4.14)
    + Issue #480: make "module try-add <module_name>" ignore failure to be
      found but report broken modules.
  * (8.4.13)
    + Issue #479: Reworked MRC to fill mrcMpathT with mrc entries for each
      directory in $MODULEPATH. Then walk each mpath directory for hidden,
      global aliases, and module aliases
  * (8.4.12)
    + Make --nx only remove extensions from ml avail not spider. Make it a
      configure option.
  * (8.4.11)
    + Issue #476: Move mrcT.mpath to separate table mrcMpathT
    + Issue #477: Support finding real modules names with a version called
      "default"
    + Show extensions from hidden modules when doing (module --show_hidden
      avail)
    + Add option (--nx, --no_extensions) to not print extensions when doing
      "ml avail".
    
-------------------------------------------------------------------
Fri Oct 30 13:39:44 UTC 2020 - Ana Guerrero Lopez <aguerrero@suse.com>

- Update to version 8.4.10:
  * Use LMOD_ALLOW_ROOT_USE to control whether root uses Lmod or not
  * Documentation updates

-------------------------------------------------------------------
Tue Sep 22 10:50:21 UTC 2020 - Ana Guerrero Lopez <aguerrero@suse.com>

- Update to version 8.4.5:
  * Support for Lua 5.4 added.
  * Improved support for ksh and ksh scripts.
  * Improved documentation for software hierarchy and community module collections.

-------------------------------------------------------------------
Sat Mar 28 07:33:25 UTC 2020 - Tomáš Chvátal <tchvatal@suse.com>

- Fix the python3 switch on sphinx to not really pull any py2
  package

-------------------------------------------------------------------
Tue Mar 24 07:42:13 UTC 2020 - Ana Guerrero Lopez <aguerrero@suse.com>

- Update to version 8.3.6:
  * Create findExec shell function to locate commands like ps.
  * Bugfixes.

-------------------------------------------------------------------
Wed Mar 11 15:14:58 UTC 2020 - Ondřej Súkup <mimi.vx@gmail.com>

- python3 based Sphinx

-------------------------------------------------------------------
Fri Feb 21 09:52:42 UTC 2020 - Ana Guerrero Lopez <aguerrero@suse.com>

- Update to version 8.3.1:
  * The function extensions() now takes a string of comma separated names. 
  * Add support for "atleast()" and "between()" functions support a "<" 
    to signify a less than instead of less than or equal to between range.
  * Make "ml - foo" an error.
  * It is now safe to have os.exit(1) in a modulefile. Spider can now 
    handle it.
- Remove obsolete BuildRequires on ohpc.

-------------------------------------------------------------------
Fri Nov 29 08:42:31 UTC 2019 - Ana Guerrero Lopez <aguerrero@suse.com>

- Update to version 8.2.5:
   * Better support for the fish shell including tab completion
   * New function extensions(): This allows for modules like python 
     to report that the extensions numpy and scipy are part of the 
     modules. Users can use "module spider numpy" to find which 
     modules provide numpy etc.
   * Added a new command "clearLmod" which does a module purge and 
     removes all LMOD aliases and environment variables.
   * Remove asking for the absolute path for generating spiderT 
     and dbT. It now only use when building the reverseMapT.
   * Lmod now requires "rx" other access when searching for 
     modulefiles.
   * settarg correctly handles a power9 processor running linux.
- Refresh patch 
  * Messages-Remove-message-about-creating-a-consulting-ticket.patch

-------------------------------------------------------------------
Thu Aug 22 15:54:01 UTC 2019 - Ana Guerrero Lopez <aguerrero@suse.com>

- Update to version 8.1.14: (jsc#SLE-8512)
    * Extended Default feature added: module load intel/17 will find 
      the "best" intel/17.* etc.
    * All hidden files are NOT written to the softwarePage output.
    * Lmod now correctly reports failed to load module "A" in the 
      special case where "ml A B" and A is a prereq of B and A 
      doesn't exist.
    * A meta module takes precedence over a regular module if the 
      meta module occurs in an earlier directory in $MODULEPATH
    * Lmod output only "fills" when the text is more than one line 
      or it is wider than the current width.
    * Embed the TCL interpreter in Lmod when a site allows TCL files
    * "module reset" resets $MODULEPATH to be the system $MODULEPATH
    * Improved tracing of module loads/unloads when --trace is given.
    * Allow MODULERCFILE to be a colon separated list.
- Set --with-fastTCLInterp=no, because this option is not supported 
  with TCL 8.6

-------------------------------------------------------------------
Mon Mar 11 10:01:57 UTC 2019 - Ana Guerrero Lopez <aguerrero@suse.com>

- Remove flavor 'doc-man' building a package only with the lmod manpage
  and move the manpage to lua-lmod.
- Remove the Recommends on lua-lmod-man and add a Provides instead.
- Update the Group tag for lua-lmod-doc to Documentation/Other because
  Documentation/PDF doesn't exist and make the package noarch.
 
-------------------------------------------------------------------
Wed Feb 13 09:58:06 UTC 2019 - Jan Engelhardt <jengelh@inai.de>

- Declare bash-specific nature of build recipe.

-------------------------------------------------------------------
Fri Jan 25 17:09:15 UTC 2019 - eich@suse.com

- Update to 7.8.15:
    * issue #379: Extra space required for shell function definitions
      under bash
    * issue #380: Change DependencyCk mode from load to dependencyCk,
      sType and tcl_mode remain load.
    * Fixed problem with unbound variable __lmod_sh_dbg in module shell
      function definition
    * Add unload state to tracing.
    * Define MCP and mcp earlier in lmod main() so that errors/warning
      found in SitePackage work.
    * issue #383: Use LUA_PATH to evaluate Version.lua instead of
      depending on ./?.lua to be LUA_PATH.
    * Added mgrload function and documentation
    * Fixed unbound variable in bash.in.
    * Fixed bug when ~/.lmod.d/cache was read only.
    * Fixed quote rules for Python, R and CMAKE.
    * issue #390: Added a message when find first rules are used to set
      defaults when NVV is found in both avail and tracing.
    * issue #389: Honor newlines and leading spaces in Nag messages.
    * Allow MODULERCFILE to be a colon separated list.
    * issue #391: Only process the family stack when in the modulefile
      that requested it.
    * Allow MODULERCFILE to be a colon separated list with the priority
      be left to right instead of right to left.
    * Added cc test case for issues with choosing the correct module
      when doing reloadAll()
    * issue #394: Only reload modules when the userName has remained the
      same in mt.
    * Add Lmod version report to --trace output.
    * issue #394: use mname = MName:new("load",mt:userName(sn)) to get
      loadable file
      contrib/tracking_module_usage python scripts have been updated to
      support python2 and python3
- Fix shbang line in scripts.

-------------------------------------------------------------------
Fri Aug 17 19:38:08 UTC 2018 - eich@suse.com

- Update to 7.8.1:
    * Fixed typo in myGlobals.lua about assigning LMOD_DUPLICATE_PATHS
    *  Fixed TARG_TITLE_BAR_PAREN to always have a value, needed for tcsh.
    * Added LMOD_SETTARG_TITLE_BAR=yes to turn on the title bar.
    * Changed from sn-version to sn/version in title bar.
    * Changed the initialization of LMOD_SETTARG_CMD in bash.in and csh.in.
      It is defined to be `:' iff it is undefined.  This allows settarg to work
      in sub-shells.
    * Use spider cache for "module --terse avail" when LMOD_CACHED_LOADS=yes
    * Fix bug with LMOD_SETTARG_CMD and csh.
    * Turn off LMOD_REDIRECT for tcsh
      Settarg now supports C/N/V and N/V/V module layouts.
    * Fixed a bug where sometimes a compiler-mpi dependent module wouldn't
      be found when it should.
    * Fixed issue #321 Changed LMOD_TARGPATHLOC to LMOD_SETTARG_TARG_PATH_LOCATION
      changed LMOD_FULL_SETTARG_SUPPORT to LMOD_SETTARG_FULL_SUPPORT. (Lmod supports both)
    * Fixed issue #322 where non-existant directory would cause problems
    * Fix bug in settarg module for csh.
    * Fix bug in Csh.lua where semicolons inside an alias were removed.  Only remove the
      trailing semicolon.
    * Generate an LmodError() if the cachefile is broken.
    * Do not convert /foo/bar/../baz to /foo/baz.  Leave .. in paths. Fixes issue #324
    * The admin.list (aka, nag mesages) supports Lua regex's.  Responds to issue #326
    * The admin.list now supports multiple targets for the same message (issue #326)
    * Use full path_regularize() on all TCL program files.  Having paths like /a/b/../d
      caused problems for some users when interacting with TCL.
    * Do not look for lua_json.  Just use the one that comes with Lmod.
    * Fix sh_to_modulefile correctly handle bad options (issue #332)
    * Allow pushenv("FOO",false) to clear "FOO" (issue #331)
    * Always use ref counting for MODULEPATH.
    * Change the C-shell output to not use quotes and instead use back slashes to
      quote special characters like $.
    * Better filtering for c-shell output testing
    * Fix bug in sh_to_modulefile
    * Remove definition of SHOST from bash.in.  Recompute it in settarg module.
    * Support relative symlink when trying to find cmd_dir
    * Now get modify time correctly from SpiderCache timestamp file.
    * Issue #346: do not use "ls" to get the list of directories when dealing with .modulepath
    * Issue #347: Just skip parsing "whole" if it is not a string (settarg)
    * Issue #348: Do not double the colon when the original was a single colon
    * Change ml so that ml av --terse is an error.
    * Making the settarg and lmod modulefiles be installed versionless.
    * Issue #353: Fix bug in cshrc.in end -> endif
    * Issue #352: Allow sites to control the prefix completely.
    * luaposix 34.0.4-1 wants to use setfenv() which only exists in Lua 5.1 and not in Lua 5.2+
      so Lmod now requires("posix") outside of strict.
    * Build lua-term in the correct location when --with-siteControlPrefix=yes
    * issue #347: Remove ./?.lua, ./?/init.lua from LUA_PATH and ./?.so from LUA_CPATH
    * issue #357: Add missing semicolons in settarg.version.lua
    * Fixed bug with lib directories not being readable.
    * issue #355: Make LMOD_RC support a colon separated list of possible lmodrc.lua files
    * Make bash, zsh and csh form LMOD_PKG to use <prefix>/lmod/lmod instead of
      <prefix>/lmod/<lmod_version> when allowing sites to completely control prefix (issue #352)
    * issue #359: Lmod can now use the internal version of lfs for installation.
    * issue #361: Support make -j install added.
    * issue #362: Trying to fix problem with RPM builds of Lmod at UGENT.
    * issue #358: Improved error msg when there is a syntax error in a modulefile.
    * issue #365, #366: Fix typo in Makefile about pkgs.
    * Modify end2end test to use build-in lua pkgs only.
    * issue #370: Allow for exact match with fn and fullName w/o regex pattern matching
      added % quoting for '-' in docs.
    * Support for making lmod silence shell debug output (when doing set -xv for bash or zsh)
            The command "make world_update" now marks the latest release as the latest release at
	    github.com/TACC/Lmod
    * The new module command now returns the status from the eval of the lmod command
    * Block .version.version and .modulerc.version files from being included in DirTree
    * Bash like shells now output without double quotes.
    * Fix fish shell output for path and infopath. Fix shell function output for zsh/bash
    * issue #374: convert ~ to $HOME internally.  This allows C-shell users to use ~
      inside a modulefile and have it work when unloading.
    * issue #375: Support for is-loaded and is-avail added.
    * Do not convert LMOD_PKG from /opt/apps/lmod/7.7.35 to /opt/apps/lmod/lmod if the link exists.
    * When building reverseMap also take abspath(path) and store it if different.
    * Now make startup scripts (profile.in, cshrc.in, profile.fish.in) use PKGV instead of PKG so
      that the pre-install create $VERSION files. The install target will convert them to PKG.
    * Check for "g" tools like gbasename, gexpr as well as the regular basename, expr etc.
    * General support for the modulerc files to be written in lua. They have a .lua extension.
    * Bug fix for 7.7.38 where it did not work for Lua 5.1

-------------------------------------------------------------------
Fri Aug 17 18:20:09 UTC 2018 - eich@suse.com

- Change %license to a %my_license macro to be able to
  build for the HPC module on SLE-12.

-------------------------------------------------------------------
Fri Aug 17 18:00:24 UTC 2018 - eich@suse.com

- Move doc and man page building into separate flavors.

-------------------------------------------------------------------
Wed Apr 18 19:53:39 UTC 2018 - eich@suse.com

- use license macro for License file.

-------------------------------------------------------------------
Wed Apr 18 13:07:51 UTC 2018 - jengelh@inai.de

- Replace %__ type macro indirections.
- Update RPM groups, summaries, find|xargs commands.

-------------------------------------------------------------------
Wed Apr 18 05:53:52 UTC 2018 - eich@suse.com

- Avoid conflicting script snippets from 'Modules' and 'lua-lmod'
  in /etc/profiles.d by making sure that both packages cannot be
  installed simultaneously (boo#1089970).

-------------------------------------------------------------------
Mon Oct 16 13:21:53 UTC 2017 - eich@suse.com

- Doc-Ugly-workaround-for-bug-in-Sphinx.patch
  On SLE-12 and Leap 42.x Sphinx generates an incorrect tex file.
  This patch adds ugly code to the documentation Makefile to patch
  it up and work around this problem.

-------------------------------------------------------------------
Sun Oct 10 16:42:51 UTC 2017 - eich@suse.com

- Make lua-lmod Arch-dependent: it hard codes the search path to
  .so plugins used by other Lua packages (boo#1061205).

-------------------------------------------------------------------
Fri Oct  6 12:36:48 UTC 2017 - eich@suse.com

- Update to 7.6:
     1. Support for disable <collection_name>
     2. A marked default is honored even if it is hidden
     3. Support for depends_on() as a better way to handle module dependencies.
   * Lmod 7.5:
     1. Added -T, --trace option to report restore, load, unloads and spider.
     2. Report both global and version aliases with module --terse
     	Add Global Aliases output to module avail if they exist.
     3. Support for isVisibleHook (Thanks @wpoely86!) to control whether
     	a module is hidden or not.
     4. Support for "spider -o spider-json" to set the key "hidden"
      to true or false for each module.
     5. Setting LMOD_EXACT_MATCH=yes also turns off the display of (D) with
      avail.
     6. CMake "shell" added.
     7. Added feature that LMOD_TMOD_FIND_FIRST.  A site can decide to force
        FIND_FIRST instead FIND_BEST for NV module layouts.
     Bug Fixes:
     1. Fix bug where Lmod would be unable to load a module where NV and
        NVV module layouts were mixed.
     2. Fix bug where LMOD_CASE_INDEPENDENT_SORTING=yes wasn't case
        independent when using avail hook.
   * Lmod 7.4:
     1. Using built-in luafilesystem if system version doesn't exist or < 1.6.2
     2. Support for setting LMOD_SYSHOST with configure.
     3. Sites or users can use italic instead of dim for hidden modules
     4. Detailed spider output reports all dependencies hidden or not.
     5. Support for fish shell
     6. Move almost all configuration variables from profile.in to bash.in and
        similarly for tcsh.
     Bug Fixes:
     1. Fixed bug that caused LMOD env vars to be lower cased.
     2. Fixed bug where tcsh/csh exit status was not returned.
     3. bash and zsh tab completions works when LMOD_REDIRECT is yes.
     4. Can now conflict with a version.
     5. Fixed bug with addto a:b:c 
     6. Fixed bugs in computeHashSum, generating softwarePage.
   * Lmod 7.3:
     1. The isloaded() function has been repaired.
     2. Updated French, German and Spanish translations.
     3. Two error message related to missing modules are now available for 
        translations.
   * Lmod 7.2.1:
     1. A test suite for testing the Lmod installation has been added. See
        https://github.com/rtmclay/Lmod_test_suite for details.
     2. Added support for localization of errors and warnings and messages.
     3. Language Translations complete: ES, Partial: FR, ZH, DE
     4. Introduced "errWarnMsgHook" to take advantage of the new message
        handling.
     Bug Fixes:
     1. Several bug fixes related to Spider Cache and LMOD_CACHED_LOADS=1
     2. Repaired zsh tab completion.
     3. Minimize the output of Lmod's BASH_ENV when debugging Bash shell
        scripts.
     4. Allow colons as well as spaces for the path used in the addto command.
     5. Handles module directories that are empty or bad symlink or a .version
        file only.
     6. Fix bug in module describe.
   * Lmod 7.1:
     1. The commands "module --show_hidden avail" and "module --show_hidden"
        list now show "hidden" modules with the (H) property.  Also they are
        displayed as dim.  This works better on black backgrounds.
     2. Added the command "module --config_json" to generate a json output of
        Lmod's configuration.
     3. Add support for env. var. LMOD_SITE_NAME to set a site's name.  This is
        also a configure option.
     Bug Fixes:
     1. Hidden module now will not be marked as default.
     2. Now check permission of a directory before trying to open it.
     3. Lmod now does not pollute the configure time value of LD_LIBRARY_PATH
        and LD_PRELOAD into the users env.
     4. Lmod now handles illegal values of $TERM.
   * Lmod 7.0:
     1. This version support N/V/V. (e.g. fftw/64/3.3.4).  Put a .version file
        in with the "64" directory to tell Lmod where the version starts.
     2. Marking a default in the MODULERC is now supported.
     3. User ~/.modulerc has priority over system MODULERC.
     4. System MODULERC  has priority over marking a default in the module 
     	tree.
     5. Installed Modules can be hidden by "hide-version foo/3.2.1" in any
        modulerc file.
     6. The system spider cache has changed.  Please update your scripts to
        build spiderT.lua instead of moduleT.lua
   * Lmod 6.6:
     1. Now uses the value of LD_PRELOAD and LD_LIBRARY_PATH found at configure
        time to run all TCL progams.
     2. Now uses a custom _module_dir function for tab completion in bash for
        module use path<TAB>. Thanks to Pieter Neerincx!
     3. Support for LMOD_FAMILY_<name>_VERSION added.
     4. If ~/.lmod.d/.cache/invalidated exists then the user cache file(s) are
        ignored. When generating a user cache file ~/.lmod.d/.cache/invalidated
        is deleted.
     Bug Fixes:
     1. Correctly merges spider cache location where there are multiple
        lmodrc.lua files.
     2. Remove leading and trailing blanks for names in setenv, pushenv,
        prepend_path, etc.
     3. ml now generates error for unknown argument that start with a double
        minus. (e.g. ml --vers)
     4. pushenv("name","") fixed when unloading module.
     5. Make sure to regularize MODULEPATH when ingesting it for the first 
     	time.

- lmod.consulting.patch replaced by:
  Messages-Remove-message-about-creating-a-consulting-ticket.patch.
- lmod.site.patch:
  Removed: The site name is now provided by the env variable LMOD_SITE_NAME.
  (FATE#324199).

-------------------------------------------------------------------
Thu Oct  5 18:46:01 UTC 2017 - eich@suse.com

- Fix build for Leap, SLE-12 and SLE-15.
- Remove _service file: the service can be run with
  'osc service run download_files' as well.

-------------------------------------------------------------------
Tue Sep  5 15:48:44 UTC 2017 - eich@suse.com

- Change group of documentation package to Documentation/Other.

-------------------------------------------------------------------
Mon Aug 14 06:03:38 UTC 2017 - eich@suse.com

- Fix group of doc package.
- Change BuildRequires from ohpc to ohpc-macros.

-------------------------------------------------------------------
Thu Aug 10 13:47:18 UTC 2017 - eich@suse.com

- Fix build: add buildrequires for texlive-latexmk, texlive-makeindex and
      	     texlive-varwidth.

-------------------------------------------------------------------
Thu Aug 10 12:52:57 UTC 2017 - eich@suse.com

- Prepare for suse default settings (bsc#1053237).

-------------------------------------------------------------------
Mon Jun 26 08:55:33 UTC 2017 - dmueller@suse.com

- correct buildrequires for building on Leap 42.3 and on SLE15+

-------------------------------------------------------------------
Fri Apr 28 17:49:00 UTC 2017 - eich@suse.com

- Add profile files for bash and csh (bsc#1048964). 

-------------------------------------------------------------------
Fri Apr  7 15:50:53 UTC 2017 - eich@suse.com

- Build and package man page and other documentation, create a separate 
  package for additional documentation (bsc#1032970).

-------------------------------------------------------------------
Thu Feb 16 13:24:51 UTC 2017 - jengelh@inai.de

- Replace redundant %__ macro indirections

-------------------------------------------------------------------
Sat Nov 12 04:28:38 UTC 2016 - eich@suse.com

* Updated to version 6.5.11:
 - All the Lmod programs now resolve any symlinks to the
   actual program before adding to the Lua's package.path
   and package.cpath.
 - Contrib patch: Extend msgHook to LmodError and LmodWarning
 - Now using travis for CI and testing.
 - Configure time option to have Lmod check for magic TCL string in
   modulefiles (#%Module)
 - Lmod now uses a regular expression to match user commands
   to internal commands. For example "av", "ava" or "available"
   will match "avail"
 - Lmod now uses the values of LUA_PATH and LUA_CPATH at
   configuration time.  This way Lmod is safe from user changes
   to these important Lua values.
 - Updated documentation at lmod.readthedocs.org
 - Support for generating xalt_rmapT.json used by XALT.
 - Fixed bug with upcase characters in version file.   
 - It is now possible to configure Lmod to use the spider cache
   when loading (--with-cachedLoads=yes or
   export LMOD_CACHED_LOADS=1 to activate). This is off by
   default. Sites that use this will have to keep their spider
   caches up-to-date or user will not be able to load modules 
   not in the cache.
- It is now possible to configure Lmod to use Legacy Version
  ordering ( --with-legacyOrdering=yes or export
  LMOD_LEGACY_VERSION_ORDERING=1). With legacy ordering 9.0
  is "newer" than 10.0. This is the ordering that Tmod uses.
- Lmod will print admin message (a.k.a nag messages) when   
  doing module whatis <foo> or module help <foo>.  In other 
  words if a nag message would appear with module load <foo>
  then it will also appear when using whatis or help.
- Many improvement in the generation of the lmod database for
  module tracking.
- Numerous bug fixes.

-------------------------------------------------------------------
Mon Oct 17 14:49:13 UTC 2016 - eich@suse.com

- Setting 'download_files' service to mode='localonly'
  and adding source tarball. (Required for Factory).

-------------------------------------------------------------------
Wed Oct 12 17:45:52 UTC 2016 - eich@suse.com

- Initial version of Lmod: 6.0.24

From 222d83ed9144a141030597a6147303b4e71d6b7f Mon Sep 17 00:00:00 2001
From: David Disseldorp <ddiss@suse.de>
Date: Mon, 8 Sep 2025 16:27:58 +1000
Subject: [PATCH] kabi: drop page_counter size assertion for non-SMP

SUSE commit ef34a22779f ("kabi: restore layout of struct page_counter
(jsc#PED-12551).") adds a page_counter == __orig_page_counter size
assertion which fails for non-SMP (e.g. lkl) builds due to
CACHELINE_PADDING, which is does nothing.

Signed-off-by: David Disseldorp <ddiss@suse.de>
---
 include/linux/page_counter.h | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

diff --git a/include/linux/page_counter.h b/include/linux/page_counter.h
index 25221e845d1ed..66acb4204d438 100644
--- a/include/linux/page_counter.h
+++ b/include/linux/page_counter.h
@@ -75,7 +75,7 @@ struct __orig_page_counter {
 	struct page_counter *parent;
 } ____cacheline_internodealigned_in_smp;
 
-#ifndef CONFIG_ARM
+#if !defined(CONFIG_ARM) && defined(CONFIG_SMP)
 static_assert(sizeof(struct __orig_page_counter) == sizeof(struct page_counter));
 #endif
 
-- 
2.51.0


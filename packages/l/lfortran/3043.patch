From b7839664b54f515ed52aa0068d795685e4a6aad1 Mon Sep 17 00:00:00 2001
From: Christoph Junghans <junghans@votca.org>
Date: Thu, 4 Jan 2024 16:00:04 -0700
Subject: [PATCH] cmake: add libm to lfortran_runtime

---
 src/runtime/legacy/CMakeLists.txt | 5 +++++
 1 file changed, 5 insertions(+)

diff --git a/src/runtime/legacy/CMakeLists.txt b/src/runtime/legacy/CMakeLists.txt
index 03ef4f6425..6da9013888 100644
--- a/src/runtime/legacy/CMakeLists.txt
+++ b/src/runtime/legacy/CMakeLists.txt
@@ -2,9 +2,13 @@ set(SRC
     ../../../src/libasr/runtime/lfortran_intrinsics.c
 )
 
+set(MATH_LIBRARIES "m" CACHE STRING "math library")
+mark_as_advanced( MATH_LIBRARIES )
+
 add_library(lfortran_runtime SHARED ${SRC})
 target_include_directories(lfortran_runtime BEFORE PUBLIC ${libasr_SOURCE_DIR}/..)
 target_include_directories(lfortran_runtime BEFORE PUBLIC ${libasr_BINARY_DIR}/..)
+target_link_libraries(lfortran_runtime PRIVATE ${MATH_LIBRARIES})
 set_target_properties(lfortran_runtime PROPERTIES
   VERSION ${PROJECT_VERSION}
   SOVERSION ${PROJECT_VERSION_MAJOR})
@@ -14,6 +18,7 @@ set_target_properties(lfortran_runtime PROPERTIES
 add_library(lfortran_runtime_static STATIC ${SRC})
 target_include_directories(lfortran_runtime_static BEFORE PUBLIC ${libasr_SOURCE_DIR}/..)
 target_include_directories(lfortran_runtime_static BEFORE PUBLIC ${libasr_BINARY_DIR}/..)
+target_link_libraries(lfortran_runtime PRIVATE ${MATH_LIBRARIES})
 set_target_properties(lfortran_runtime_static PROPERTIES
     LIBRARY_OUTPUT_DIRECTORY ..)
 

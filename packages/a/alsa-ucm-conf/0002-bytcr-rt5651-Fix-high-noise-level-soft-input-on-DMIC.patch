From b878413c626a6797d382ae4abed4c3f417eed2bd Mon Sep 17 00:00:00 2001
From: Hans de Goede <hdegoede@redhat.com>
Date: Mon, 8 Jun 2020 22:21:41 +0200
Subject: [PATCH 02/51] bytcr-rt5651: Fix high noise level + soft input on DMIC

The DMIC needs to have the DMIC ASRC enabled, otherwise capturing audio
from it results in mostly capturing noise + the actual recorded voice
very soft in the background of the noise.

This has been tested on a Point of View P1006W v1.0 tablet, which is the
only RT5651 X86 device using a DMIC that I am aware of.

Signed-off-by: Hans de Goede <hdegoede@redhat.com>
Signed-off-by: Jaroslav Kysela <perex@perex.cz>
---
 ucm2/codecs/rt5651/DigitalMic.conf | 2 ++
 1 file changed, 2 insertions(+)

diff --git a/ucm2/codecs/rt5651/DigitalMic.conf b/ucm2/codecs/rt5651/DigitalMic.conf
index aa40c1c2efeb..d21b21d1d2f2 100644
--- a/ucm2/codecs/rt5651/DigitalMic.conf
+++ b/ucm2/codecs/rt5651/DigitalMic.conf
@@ -4,12 +4,14 @@ SectionDevice."Mic" {
 	EnableSequence [
 		cset "name='Stereo1 ADC MIXL ADC2 Switch' on"
 		cset "name='Stereo1 ADC MIXR ADC2 Switch' on"
+		cset "name='DMIC ASRC Switch' on"
 		cset "name='Internal Mic Switch' on"
 	]
 
 	DisableSequence [
 		cset "name='Stereo1 ADC MIXL ADC2 Switch' off"
 		cset "name='Stereo1 ADC MIXR ADC2 Switch' off"
+		cset "name='DMIC ASRC Switch' off"
 		cset "name='Internal Mic Switch' off"
 	]
 
-- 
2.16.4


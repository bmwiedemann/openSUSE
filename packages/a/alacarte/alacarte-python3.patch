From b2af67fd6bc6667343f3850ce981f51af0f5c155 Mon Sep 17 00:00:00 2001
From: e < ýhÏU>
Date: Sat, 9 Sep 2017 19:59:06 -0500
Subject: [PATCH] util.py and acinclude.m4: Support Python 3

---
 .gitignore       | 2 ++
 Alacarte/util.py | 7 +++++++
 acinclude.m4     | 4 ++--
 3 files changed, 11 insertions(+), 2 deletions(-)

diff --git a/Alacarte/util.py b/Alacarte/util.py
index 0d98d56..3bbb943 100644
--- a/Alacarte/util.py
+++ b/Alacarte/util.py
@@ -24,6 +24,13 @@ import gi
 gi.require_version('Gtk', '3.0')
 from gi.repository import Gtk, GdkPixbuf, GMenu, GLib
 
+# Python 2/3 compatibility
+try:
+    basestring
+except NameError:
+    # Must be python3
+    basestring = (str, bytes)
+
 DESKTOP_GROUP = GLib.KEY_FILE_DESKTOP_GROUP
 KEY_FILE_FLAGS = GLib.KeyFileFlags.KEEP_COMMENTS | GLib.KeyFileFlags.KEEP_TRANSLATIONS
 
diff --git a/acinclude.m4 b/acinclude.m4
index 372e0b2..b6eaa4f 100644
--- a/acinclude.m4
+++ b/acinclude.m4
@@ -69,7 +69,7 @@ AC_DEFUN([AM_PATH_PYTHON_VERSION],
   dnl library.
 
   AC_CACHE_CHECK([for $am_display_PYTHON version], [am_cv_python_version],
-    [am_cv_python_version=`$PYTHON -c "import sys; print sys.version[[:3]]"`])
+    [am_cv_python_version=`$PYTHON -c "import sys; print(sys.version[[:3]])"`])
   AC_SUBST([PYTHON_VERSION], [$am_cv_python_version])
 
   dnl Use the values of $prefix and $exec_prefix for the corresponding
@@ -84,7 +84,7 @@ AC_DEFUN([AM_PATH_PYTHON_VERSION],
   dnl to know which OS platform Python thinks this is.
 
   AC_CACHE_CHECK([for $am_display_PYTHON platform], [am_cv_python_platform],
-    [am_cv_python_platform=`$PYTHON -c "import sys; print sys.platform"`])
+    [am_cv_python_platform=`$PYTHON -c "import sys; print(sys.platform)"`])
   AC_SUBST([PYTHON_PLATFORM], [$am_cv_python_platform])
 
 
diff -urp alacarte-3.11.91.orig/configure.ac alacarte-3.11.91/configure.ac
--- alacarte-3.11.91.orig/configure.ac	2014-03-03 07:01:44.000000000 -0600
+++ alacarte-3.11.91/configure.ac	2018-01-14 21:03:34.122761459 -0600
@@ -18,7 +18,7 @@ AC_DEFINE_UNQUOTED(GETTEXT_PACKAGE, "$GE
 AM_GLIB_GNU_GETTEXT
 IT_PROG_INTLTOOL([0.40.0])
 
-AM_PATH_PYTHON_VERSION(2.7, 2.7.0, 2.6, 2.6.0, 2.5, 2.5.0, 2.4, 2.4.0)
+AM_PATH_PYTHON_VERSION(3.7, 3.7.0, 3.6, 3.6.0, 2.7, 2.7.0, 2.6, 2.6.0, 2.5, 2.5.0, 2.4, 2.4.0)
 
 PKG_CHECK_MODULES(ALACARTE, libgnome-menu-3.0 >= 3.5.3 pygobject-3.0)
 
diff -urp alacarte-3.11.91.orig/Alacarte/MainWindow.py alacarte-3.11.91/Alacarte/MainWindow.py
--- alacarte-3.11.91.orig/Alacarte/MainWindow.py	2014-02-27 18:30:39.000000000 -0600
+++ alacarte-3.11.91/Alacarte/MainWindow.py	2018-01-15 13:01:45.176198435 -0600
@@ -239,7 +239,7 @@ class MainWindow(object):
             menu_tree.get_selection().select_path((0,))
         else:
             parent = menus[iter][2]
-	file_name = util.getUniqueFileId('alacarte-made', '.directory')
+        file_name = util.getUniqueFileId('alacarte-made', '.directory')
         file_path = os.path.join(util.getUserDirectoryPath(), file_name)
 
         editor = DirectoryEditor(self.main_window, file_path)

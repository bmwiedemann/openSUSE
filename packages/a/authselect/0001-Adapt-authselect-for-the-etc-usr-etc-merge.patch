From 659865adcc9101a83dc8ff6f49e2c7ff4faa1af7 Mon Sep 17 00:00:00 2001
From: Mathias Homann <Mathias.Homann@opensuse.org>
Date: Mon, 4 Dec 2023 18:17:01 +0100
Subject: [PATCH] Adapt authselect for the /etc - /usr/etc merge

---
 profiles/minimal/nsswitch.conf | 10 +++++-----
 profiles/nis/nsswitch.conf     | 10 +++++-----
 profiles/sssd/nsswitch.conf    | 10 +++++-----
 profiles/winbind/nsswitch.conf | 10 +++++-----
 4 files changed, 20 insertions(+), 20 deletions(-)

diff --git a/profiles/minimal/nsswitch.conf b/profiles/minimal/nsswitch.conf
index 563ba03..60896ca 100644
--- a/profiles/minimal/nsswitch.conf
+++ b/profiles/minimal/nsswitch.conf
@@ -3,14 +3,14 @@ passwd:     files {if "with-altfiles":altfiles }systemd
 shadow:     files
 group:      files {if "with-altfiles":altfiles }systemd
 hosts:      files myhostname {if "with-mdns4" and "with-mdns6":mdns_minimal [NOTFOUND=return] }{if "with-mdns4" and not "with-mdns6":mdns4_minimal [NOTFOUND=return] }{if not "with-mdns4" and "with-mdns6":mdns6_minimal [NOTFOUND=return] }resolve [!UNAVAIL=return] dns
-services:   files
+services:   files usrfiles
 netgroup:   files
 automount:  files
 
 aliases:    files
-ethers:     files
+ethers:     files usrfiles
 gshadow:    files
-networks:   files dns
-protocols:  files
+networks:   files usrfiles dns
+protocols:  files usrfiles
 publickey:  files
-rpc:        files
+rpc:        files usrfiles
diff --git a/profiles/nis/nsswitch.conf b/profiles/nis/nsswitch.conf
index 685f92c..54a2d84 100644
--- a/profiles/nis/nsswitch.conf
+++ b/profiles/nis/nsswitch.conf
@@ -3,14 +3,14 @@ passwd:     files {if "with-altfiles":altfiles }nis systemd
 shadow:     files nis
 group:      files {if "with-altfiles":altfiles }nis systemd
 hosts:      files myhostname {if "with-libvirt":libvirt libvirt_guest }{if "with-mdns4" and "with-mdns6":mdns_minimal [NOTFOUND=return] }{if "with-mdns4" and not "with-mdns6":mdns4_minimal [NOTFOUND=return] }{if not "with-mdns4" and "with-mdns6":mdns6_minimal [NOTFOUND=return] }resolve [!UNAVAIL=return] nis dns
-services:   files nis
+services:   files usrfiles nis
 netgroup:   files nis
 automount:  files nis
 
 aliases:    files nis
-ethers:     files nis
+ethers:     files usrfiles nis
 gshadow:    files nis
-networks:   files nis dns
-protocols:  files nis
+networks:   files usrfiles nis dns
+protocols:  files usrfiles nis
 publickey:  files nis
-rpc:        files nis
+rpc:        files usrfiles nis
diff --git a/profiles/sssd/nsswitch.conf b/profiles/sssd/nsswitch.conf
index 1df2dc0..e3d46b9 100644
--- a/profiles/sssd/nsswitch.conf
+++ b/profiles/sssd/nsswitch.conf
@@ -3,16 +3,16 @@ passwd:     {if "with-files-domain":sss }files {if "with-altfiles":altfiles }{if
 shadow:     files
 group:      {if "with-files-domain":sss }files {if "with-altfiles":altfiles }{if not "with-files-domain":sss }systemd
 hosts:      files myhostname {if "with-libvirt":libvirt libvirt_guest }{if "with-mdns4" and "with-mdns6":mdns_minimal [NOTFOUND=return] }{if "with-mdns4" and not "with-mdns6":mdns4_minimal [NOTFOUND=return] }{if not "with-mdns4" and "with-mdns6":mdns6_minimal [NOTFOUND=return] }resolve [!UNAVAIL=return] dns
-services:   files sss
+services:   files usrfiles sss
 netgroup:   files sss
 sudoers:    files sss {include if "with-sudo"}
 automount:  files sss
 subid:      sss {include if "with-subid"}
 
 aliases:    files
-ethers:     files
+ethers:     files usrfiles
 gshadow:    files
-networks:   files dns
-protocols:  files
+networks:   files usrfiles dns
+protocols:  files usrfiles
 publickey:  files
-rpc:        files
+rpc:        files usrfiles
diff --git a/profiles/winbind/nsswitch.conf b/profiles/winbind/nsswitch.conf
index f0a97e4..897b279 100644
--- a/profiles/winbind/nsswitch.conf
+++ b/profiles/winbind/nsswitch.conf
@@ -3,14 +3,14 @@ passwd:     files {if "with-altfiles":altfiles }winbind systemd
 shadow:     files
 group:      files {if "with-altfiles":altfiles }winbind systemd
 hosts:      files myhostname {if "with-libvirt":libvirt libvirt_guest }{if "with-mdns4" and "with-mdns6":mdns_minimal [NOTFOUND=return] }{if "with-mdns4" and not "with-mdns6":mdns4_minimal [NOTFOUND=return] }{if not "with-mdns4" and "with-mdns6":mdns6_minimal [NOTFOUND=return] }resolve [!UNAVAIL=return] dns
-services:   files
+services:   files usrfiles
 netgroup:   files
 automount:  files
 
 aliases:    files
-ethers:     files
+ethers:     files usrfiles
 gshadow:    files
-networks:   files dns
-protocols:  files
+networks:   files usrfiles dns
+protocols:  files usrfiles
 publickey:  files
-rpc:        files
+rpc:        files usrfiles
-- 
2.43.0


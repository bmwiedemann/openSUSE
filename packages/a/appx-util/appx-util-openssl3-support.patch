From 504dad8ca52a44eb6f3a656368f6708b63f73c10 Mon Sep 17 00:00:00 2001
From: Igor Raits <igor.raits@gmail.com>
Date: Thu, 30 Dec 2021 16:29:07 +0100
Subject: [PATCH] Add support for OpenSSL 3.0

Signed-off-by: Igor Raits <igor.raits@gmail.com>
---
 Sources/Sign.cpp | 5 +++++
 1 file changed, 5 insertions(+)

diff --git a/Sources/Sign.cpp b/Sources/Sign.cpp
index 414bedf..ee3b14e 100644
--- a/Sources/Sign.cpp
+++ b/Sources/Sign.cpp
@@ -13,6 +13,7 @@
 #include <cassert>
 #include <cstdint>
 #include <openssl/asn1t.h>
+#include <openssl/opensslv.h>
 #include <vector>
 
 namespace osinside {
@@ -139,7 +140,11 @@ namespace appx {
         class EncodedASN1
         {
         public:
+#if OPENSSL_VERSION_NUMBER >= 0x30000000L
+           template <typename T, int (*TEncode)(const T *, std::uint8_t **)>
+#else
             template <typename T, int (*TEncode)(T *, std::uint8_t **)>
+#endif
             static EncodedASN1 FromItem(T *item)
             {
                 std::uint8_t *dataRaw = nullptr;

From: Jeff Mahoney <jeffm@suse.com>
Subject: libpt2: Build/API fixes for AVC plugins

 It builds. I have no way to test it.

Signed-off-by: Jeff Mahoney <jeffm@suse.com>
---
 plugins/vidinput_avc/vidinput_avc.cxx |   15 ++++++++++++++-
 1 file changed, 14 insertions(+), 1 deletion(-)

Index: ptlib-2.18.8/plugins/vidinput_avc/vidinput_avc.cxx
===================================================================
--- ptlib-2.18.8.orig/plugins/vidinput_avc/vidinput_avc.cxx
+++ ptlib-2.18.8/plugins/vidinput_avc/vidinput_avc.cxx
@@ -135,6 +135,12 @@ PBoolean PVideoInputDevice_1394AVC::Open
     return false;
   }
   
+  auto &frameWidth = m_frameWidth;
+  auto &frameHeight = m_frameHeight;
+  auto &colourFormat = m_colourFormat;
+  auto &channelNumber = m_channelNumber;
+  auto &videoFormat = m_videoFormat;
+  auto &deviceName = m_deviceName;
   frameWidth = CIFWidth;
   frameHeight = CIFHeight;
   colourFormat = "RGB24";
@@ -401,6 +407,9 @@ bool PVideoInputDevice_1394AVC::Internal
   dv_decode_full_frame(dv, capture_buffer, color_space, pixels, pitches);
   
   // FIXME: this is a manual resize ; the original author wondered about it
+  auto &frameWidth = m_frameWidth;
+  auto &frameHeight = m_frameHeight;
+  auto &converter = m_converter;
   float xRatio = dv->width / (float)frameWidth;
   float yRatio = dv->height/ (float)frameHeight;
   for(uint y = 0; y < frameHeight; y++)
@@ -437,7 +446,7 @@ PBoolean PVideoInputDevice_1394AVC::Test
 
 PBoolean PVideoInputDevice_1394AVC::SetColourFormat(const PString & newFormat)
 {
-  return newFormat == colourFormat;
+  return newFormat == m_colourFormat;
 }
 
 PBoolean PVideoInputDevice_1394AVC::SetFrameSize(unsigned width, unsigned height)
@@ -445,6 +454,10 @@ PBoolean PVideoInputDevice_1394AVC::SetF
   if ( ! ( (width == CIFWidth && height == CIFHeight) ) )
     return false;
 
+  auto &frameWidth = m_frameWidth;
+  auto &frameHeight = m_frameHeight;
+  auto &colourFormat = m_colourFormat;
+  auto &nativeVerticalFlip = m_nativeVerticalFlip;
   frameWidth = width;
   frameHeight = height;
   colourFormat = "RGB24";

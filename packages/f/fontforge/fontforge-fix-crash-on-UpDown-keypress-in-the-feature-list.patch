From aca4f524c6cb14cdc7bc4cd493492a33f5154797 Mon Sep 17 00:00:00 2001
From: Phil Krylov <phil@krylov.eu>
Date: Mon, 17 Nov 2025 19:55:43 +0100
Subject: [PATCH] Metrics view: Fix crash on Up/Down keypress while in the
 feature list (#5683)

---
 fontforgeexe/metricsview.c | 6 +++++-
 1 file changed, 5 insertions(+), 1 deletion(-)

diff --git a/fontforgeexe/metricsview.c b/fontforgeexe/metricsview.c
index 8284673e4..c6d38f410 100644
--- a/fontforgeexe/metricsview.c
+++ b/fontforgeexe/metricsview.c
@@ -4327,8 +4327,12 @@ static void MVChar(MetricsView *mv,GEvent *event)
 	    //      should always move up/down in the list of kerning words.
 	    if( active != mv->text )
 	    {
+		const unichar_t *title = _GGadgetGetTitle(active);
+		if (!title)
+		    return;
+
 		unichar_t *end;
-		double val = u_strtod(_GGadgetGetTitle(active),&end);
+		double val = u_strtod(title,&end);
 		if (isValidInt(end)) {
 		    int dir = ( event->u.chr.keysym == GK_Up || event->u.chr.keysym==GK_KP_Up ) ? 1 : -1;
 		    if( event->u.chr.state&ksm_control && event->u.chr.state&ksm_shift ) {
-- 
2.49.0


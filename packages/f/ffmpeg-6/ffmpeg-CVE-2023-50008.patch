From 5f87a68cf70dafeab2fb89b42e41a4c29053b89b  Mon Sep 17 00:00:00 2001
From: Paul B Mahol <onemda@gmail.com>
Date: Mon Nov 27 12:08:20 2023 +0100
Subject: avfilter/vf_colorcorrect: fix memory leaks
References: https://bugzilla.opensuse.org/1223254
References: CVE-2023-50008

diff -Nura ffmpeg-6.1.1/libavfilter/vf_colorcorrect.c ffmpeg-6.1.1_new/libavfilter/vf_colorcorrect.c
--- ffmpeg-6.1.1/libavfilter/vf_colorcorrect.c	2023-11-11 08:25:17.000000000 +0800
+++ ffmpeg-6.1.1_new/libavfilter/vf_colorcorrect.c	2024-04-25 14:35:29.717468737 +0800
@@ -497,6 +497,8 @@
     ColorCorrectContext *s = ctx->priv;
 
     av_freep(&s->analyzeret);
+    av_freep(&s->uhistogram);
+    av_freep(&s->vhistogram);
 }
 
 static const AVFilterPad colorcorrect_inputs[] = {

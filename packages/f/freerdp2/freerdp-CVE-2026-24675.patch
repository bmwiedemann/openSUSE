From d676518809c319eec15911c705c13536036af2ae Mon Sep 17 00:00:00 2001
From: akallabeth <akallabeth@posteo.net>
Date: Mon, 26 Jan 2026 11:54:56 +0100
Subject: [PATCH] [channels,urbdrc] do not free MsConfig on failure

let the channel handle it later.
---
 channels/urbdrc/client/data_transfer.c | 4 +---
 1 file changed, 1 insertion(+), 3 deletions(-)

diff -urp FreeRDP-3.10.3.orig/channels/urbdrc/client/data_transfer.c FreeRDP-3.10.3/channels/urbdrc/client/data_transfer.c
--- FreeRDP-3.10.3.orig/channels/urbdrc/client/data_transfer.c	2024-12-17 03:06:36.000000000 -0600
+++ FreeRDP-3.10.3/channels/urbdrc/client/data_transfer.c	2026-02-17 19:11:56.838805227 -0600
@@ -577,10 +577,8 @@ static UINT urb_select_interface(IUDEVIC
 	MsConfig = pdev->get_MsConfig(pdev);
 	InterfaceNumber = MsInterface->InterfaceNumber;
 	if (!msusb_msinterface_replace(MsConfig, InterfaceNumber, MsInterface))
-	{
-		msusb_msconfig_free(MsConfig);
 		return ERROR_BAD_CONFIGURATION;
-	}
+
 	/* complete configuration setup */
 	if (!pdev->complete_msconfig_setup(pdev, MsConfig))
 	{

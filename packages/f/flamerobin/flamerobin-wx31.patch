From fa6353f1d6aa4f7ab38134e68c4834157ddab084 Mon Sep 17 00:00:00 2001
From: Popa Adrian Marius <mapopa@gmail.com>
Date: Thu, 31 Mar 2016 18:15:02 +0300
Subject: [PATCH] Fix #3 with deprecated methods in wx3.1

https://github.com/mariuz/flamerobin/issues/3
---
 src/gui/ExecuteSqlFrame.cpp   |  4 ++--
 src/gui/InsertDialog.cpp      |  4 ++--
 src/gui/controls/DataGrid.cpp | 14 +++++++-------
 3 files changed, 11 insertions(+), 11 deletions(-)

diff --git a/src/gui/ExecuteSqlFrame.cpp b/src/gui/ExecuteSqlFrame.cpp
index 6627a78c..31ca2d3b 100644
--- a/src/gui/ExecuteSqlFrame.cpp
+++ b/src/gui/ExecuteSqlFrame.cpp
@@ -1849,8 +1849,8 @@ void ExecuteSqlFrame::OnMenuGridSetFieldToNULL(wxCommandEvent& WXUNUSED(event))
 
         // if visible, update BLOB editor
         if (editBlobDlgM && editBlobDlgM->IsShown()
-            && grid_data->GetCursorColumn() == col
-            && grid_data->GetCursorRow() == row)
+            && grid_data->GetGridCursorCol() == col
+            && grid_data->GetGridCursorRow() == row)
         {
             editBlobDlgM->setBlob(grid_data, dgt, &statementM, row, col, false);
         }
diff --git a/src/gui/InsertDialog.cpp b/src/gui/InsertDialog.cpp
index 315ff4c4..d696d8a9 100644
--- a/src/gui/InsertDialog.cpp
+++ b/src/gui/InsertDialog.cpp
@@ -223,8 +223,8 @@ InsertDialog::InsertDialog(wxWindow* parent, const wxString& tableName,
         gridM->SetCellValue(row, 0, c->getName_());
         gridM->SetCellValue(row, 1, c->getDatatype());
 
-        gridM->SetCellAlignment(
-            def->isNumeric() ? wxALIGN_RIGHT : wxALIGN_LEFT, row, 3);
+        gridM->SetCellAlignment(row, 3, 
+		def->isNumeric() ? wxALIGN_RIGHT : wxALIGN_LEFT, wxALIGN_CENTER);
 
         wxString defaultValue;
         if (c->getDefault(ReturnDomainDefault, defaultValue))
diff --git a/src/gui/controls/DataGrid.cpp b/src/gui/controls/DataGrid.cpp
index c17bb600..04c5943b 100644
--- a/src/gui/controls/DataGrid.cpp
+++ b/src/gui/controls/DataGrid.cpp
@@ -706,9 +706,9 @@ std::vector<bool> DataGrid::getColumnsWithSelectedCells()
 {
     // fully selected rows cause all columns to have selected cells
     if (GetSelectedRows().size() > 0)
-        return std::vector<bool>(GetCols(), true);
+        return std::vector<bool>(GetNumberCols(), true);
 
-    std::vector<bool> ret(GetCols(), false);
+    std::vector<bool> ret(GetNumberCols(), false);
     // first mark all completely selected columns
     wxArrayInt cols(GetSelectedCols());
     for (size_t i = 0; i < cols.size(); i++)
@@ -740,9 +740,9 @@ std::vector<bool> DataGrid::getRowsWithSelectedCells()
 {
     // fully selected columns cause all rows to have selected cells
     if (GetSelectedCols().size() > 0)
-        return std::vector<bool>(GetRows(), true);
+        return std::vector<bool>(GetNumberRows(), true);
 
-    std::vector<bool> ret(GetRows(), false);
+    std::vector<bool> ret(GetNumberRows(), false);
     // first mark all completely selected rows
     wxArrayInt rows(GetSelectedRows());
     for (size_t i = 0; i < rows.size(); i++)
@@ -777,10 +777,10 @@ std::vector<bool> DataGrid::getSelectedCellsInRow(int row)
     for (size_t i = 0; i < rows.size(); i++)
     {
         if (rows[i] == row)
-            return std::vector<bool>(GetCols(), true);
+            return std::vector<bool>(GetNumberCols(), true);
     }
 
-    std::vector<bool> ret(GetCols(), false);
+    std::vector<bool> ret(GetNumberCols(), false);
     // first mark cells of all completely selected columns
     wxArrayInt cols(GetSelectedCols());
     for (size_t i = 0; i < cols.size(); i++)
@@ -833,7 +833,7 @@ wxGridCellCoordsArray DataGrid::getSelectedCells()
     }
 
     if (result.size() == 0)
-        result.Add(wxGridCellCoords(wxGrid::GetCursorRow(),wxGrid::GetCursorColumn()));
+        result.Add(wxGridCellCoords(wxGrid::GetGridCursorRow(),wxGrid::GetGridCursorCol()));
 
     return result;
 }
-- 
2.30.2


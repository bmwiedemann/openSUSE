From 097c917c147661f5378dae8fe3f7e46f43236426 Mon Sep 17 00:00:00 2001
From: Andreas Rheinhardt <andreas.rheinhardt@gmail.com>
Date: Thu, 17 Oct 2019 11:11:55 +0200
Subject: [PATCH] avcodec/ac3enc: Fix memleak

Fixes ticket #8294.

Signed-off-by: Andreas Rheinhardt <andreas.rheinhardt@gmail.com>
---
 libavcodec/ac3enc.c | 5 +++--
 1 file changed, 3 insertions(+), 2 deletions(-)

Index: ffmpeg-5.1.3/libavcodec/ac3enc.c
===================================================================
--- ffmpeg-5.1.3.orig/libavcodec/ac3enc.c
+++ ffmpeg-5.1.3/libavcodec/ac3enc.c
@@ -2204,7 +2204,8 @@ av_cold int ff_ac3_encode_close(AVCodecC
         av_freep(&block->cpl_coord_mant);
     }
 
-    s->mdct_end(s);
+    if (s->mdct_end)
+        s->mdct_end(s);
 
     return 0;
 }

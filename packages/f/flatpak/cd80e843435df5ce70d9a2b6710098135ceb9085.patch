From cd80e843435df5ce70d9a2b6710098135ceb9085 Mon Sep 17 00:00:00 2001
From: Martin Schwenke <martin@meltin.net>
Date: Sun, 20 Jul 2025 15:30:10 +1000
Subject: [PATCH] session-helper: Avoid a memory leak

Apply the fix suggested more than a year ago in:

  https://github.com/flatpak/flatpak/issues/5821#issuecomment-2121673464

Signed-off-by: Martin Schwenke <martin@meltin.net>

Fixes: https://github.com/flatpak/flatpak/issues/5821
---
 session-helper/flatpak-session-helper.c | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

diff --git a/session-helper/flatpak-session-helper.c b/session-helper/flatpak-session-helper.c
index 31e9438437..7cbb5050c5 100644
--- a/session-helper/flatpak-session-helper.c
+++ b/session-helper/flatpak-session-helper.c
@@ -215,7 +215,7 @@ handle_host_command (FlatpakDevelopment    *object,
   gsize i, j, n_fds, n_envs;
   const gint *fds;
   g_autofree FdMapEntry *fd_map = NULL;
-  gchar **env;
+  g_auto(GStrv) env = NULL;
   gint32 max_fd;
 
   if (*arg_cwd_path == 0)

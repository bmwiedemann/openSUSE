--- cups-filters-1.28.17.orig/cupsfilters/ipp.c	2023-01-25 02:41:08.000000000 +0100
+++ cups-filters-1.28.17/cupsfilters/ipp.c	2025-09-17 15:49:58.304141209 +0200
@@ -435,6 +435,14 @@ get_printer_attributes5(http_t *http_pri
 	    ippDelete(response2);
 	  }
 	}
+
+	// Check if the response is valid
+	if (!ippValidateAttributes(response))
+	{
+	  ippDelete(response);
+	  response = NULL;
+	}
+
 	if (have_http == 0) httpClose(http_printer);
 	if (uri) free(uri);
 	return response;

Index: curl-8.18.0/lib/getenv.c
===================================================================
--- curl-8.18.0.orig/lib/getenv.c
+++ curl-8.18.0/lib/getenv.c
@@ -23,6 +23,14 @@
  ***************************************************************************/
 #include "curl_setup.h"
 
+#ifndef HAVE_SECURE_GETENV
+#  ifdef HAVE___SECURE_GETENV
+#    define secure_getenv __secure_getenv
+#  else
+#    error neither secure_getenv nor __secure_getenv is available
+#  endif
+#endif
+
 char *curl_getenv(const char *variable)
 {
 #if defined(CURL_WINDOWS_UWP) || \
@@ -63,7 +71,7 @@ char *curl_getenv(const char *variable)
     /* else rc is bytes needed, try again */
   }
 #else
-  char *env = getenv(variable);
+  char *env = secure_getenv(variable);
   return (env && env[0]) ? curlx_strdup(env) : NULL;
 #endif
 }
Index: curl-8.18.0/configure.ac
===================================================================
--- curl-8.18.0.orig/configure.ac
+++ curl-8.18.0/configure.ac
@@ -5528,6 +5528,8 @@ fi
 
 CURL_PREPARE_CONFIGUREHELP_PM
 
+AC_CHECK_FUNCS([__secure_getenv secure_getenv])
+
 AC_CONFIG_FILES([\
   Makefile \
   docs/Makefile \

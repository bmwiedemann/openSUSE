Index: lib/getenv.c
===================================================================
--- lib/getenv.c.orig
+++ lib/getenv.c
@@ -27,6 +27,14 @@
 
 #include "memdebug.h"
 
+#ifndef HAVE_SECURE_GETENV
+#  ifdef HAVE___SECURE_GETENV
+#    define secure_getenv __secure_getenv
+#  else
+#    error neither secure_getenv nor __secure_getenv is available
+#  endif
+#endif
+
 static char *GetEnv(const char *variable)
 {
 #if defined(_WIN32_WCE) || defined(CURL_WINDOWS_APP)
@@ -66,7 +74,7 @@ static char *GetEnv(const char *variable
     /* else rc is bytes needed, try again */
   }
 #else
-  char *env = getenv(variable);
+  char *env = secure_getenv(variable);
   return (env && env[0])?strdup(env):NULL;
 #endif
 }
Index: configure.ac
===================================================================
--- configure.ac.orig
+++ configure.ac
@@ -4836,6 +4836,8 @@ if test "x$want_curldebug_assumed" = "xy
   ac_configure_args="$ac_configure_args --enable-curldebug"
 fi
 
+AC_CHECK_FUNCS([__secure_getenv secure_getenv])
+
 AC_CONFIG_FILES([Makefile \
            docs/Makefile \
            docs/examples/Makefile \

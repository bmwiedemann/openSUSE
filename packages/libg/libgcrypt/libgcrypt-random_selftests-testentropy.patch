Index: libgcrypt-1.8.2/random/random-drbg.c
===================================================================
--- libgcrypt-1.8.2.orig/random/random-drbg.c
+++ libgcrypt-1.8.2/random/random-drbg.c
@@ -2428,6 +2428,10 @@ drbg_healthcheck_sanity (struct gcry_drb
 
   /* if the following tests fail, it is likely that there is a buffer
    * overflow and we get a SIGSEV */
+  test_data.testentropy = &testentropy;
+  test_data.fail_seed_source = 0;
+  drbg_string_fill (&testentropy, test->entropy, test->entropylen);
+  drbg->test_data = &test_data;
   ret = drbg_instantiate (drbg, NULL, coreref, 1);
   if (ret)
     goto outbuf;

diff -auNr jhead-3.04/makernote.c jhead-3.04-new/makernote.c
--- jhead-3.04/makernote.c	2019-11-22 22:27:34.000000000 +0800
+++ jhead-3.04-new/makernote.c	2021-01-22 11:15:07.425323997 +0800
@@ -5,6 +5,7 @@
 #include "jhead.h"
 
 extern int MotorolaOrder;
+#include <stdint.h>
 
 //--------------------------------------------------------------------------
 // Process exif format directory, as used by Cannon maker note
@@ -64,7 +65,7 @@
             unsigned OffsetVal;
             OffsetVal = Get32u(DirEntry+8);
             // If its bigger than 4 bytes, the dir entry contains an offset.
-            if (OffsetVal+ByteCount > ExifLength){
+            if (OffsetVal > UINT32_MAX - ByteCount || OffsetVal+ByteCount > ExifLength){
                 // Bogus pointer offset and / or bytecount value
                 ErrNonfatal("Illegal value pointer for Exif maker tag %04x", Tag,0);
                 continue;

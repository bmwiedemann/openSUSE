Index: jasper-version-3.0.6/src/app/jasper.c
===================================================================
--- jasper-version-3.0.6.orig/src/app/jasper.c
+++ jasper-version-3.0.6/src/app/jasper.c
@@ -523,6 +523,7 @@ cmdopts_t *cmdopts_parse(int argc, char
 			cmdopts->enable_all_formats = 1;
 			break;
 		default:
+			cmdopts_destroy(cmdopts);
 			badusage();
 			break;
 		}
@@ -541,6 +542,7 @@ cmdopts_t *cmdopts_parse(int argc, char
 
 	if (!cmdopts->outfmt_str && !cmdopts->outfile) {
 		fprintf(stderr, "error: cannot determine output format\n");
+		cmdopts_destroy(cmdopts);
 		badusage();
 	}
 

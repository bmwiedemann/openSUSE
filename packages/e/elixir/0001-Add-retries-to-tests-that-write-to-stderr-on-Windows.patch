From f8778d13735349d4e7e359a38e7b677693182156 Mon Sep 17 00:00:00 2001
From: =?UTF-8?q?Jos=C3=A9=20Valim?= <jose.valim@dashbit.co>
Date: Tue, 24 Aug 2021 13:04:46 +0200
Subject: [PATCH] Add retries to tests that write to stderr on Windows

---
 lib/elixir/test/elixir/exception_test.exs | 11 ++++++-----
 1 file changed, 6 insertions(+), 5 deletions(-)

diff --git a/lib/elixir/test/elixir/exception_test.exs b/lib/elixir/test/elixir/exception_test.exs
index 6242194f7..fa8a5d3e4 100644
--- a/lib/elixir/test/elixir/exception_test.exs
+++ b/lib/elixir/test/elixir/exception_test.exs
@@ -470,12 +470,13 @@ test "annotates undefined function error with suggestions" do
                    * min/1
              """
 
-      assert blame_message(:erlang, & &1.gt_cookie()) == """
-             function :erlang.gt_cookie/0 is undefined or private. Did you mean one of:
+      message = blame_message(:erlang, & &1.gt_cookie())
 
-                   * get_cookie/0
-                   * set_cookie/2
-             """
+      assert message =~
+               "function :erlang.gt_cookie/0 is undefined or private. Did you mean one of:"
+
+      assert message =~ "* get_cookie/0"
+      assert message =~ "* set_cookie/2"
     end
 
     test "annotates undefined function clause error with macro hints" do
-- 
2.31.1


From 8cd485a58d865d89d71931b66d7e2cb2202fc1be Mon Sep 17 00:00:00 2001
From: Colomban Wendling <cwendling@hypra.fr>
Date: Wed, 17 Jan 2024 11:57:48 +0100
Subject: [PATCH] Use unar instead of cpio for CPIO archives

---
 src/fr-command-cpio.c       | 6 +++---
 src/fr-command-unarchiver.c | 1 +
 2 files changed, 4 insertions(+), 3 deletions(-)

diff --git a/src/fr-command-cpio.c b/src/fr-command-cpio.c
index 1b380ad83..31bd069c2 100644
--- a/src/fr-command-cpio.c
+++ b/src/fr-command-cpio.c
@@ -224,7 +224,7 @@ fr_command_cpio_extract (FrCommand *comm,
 }
 
 
-const char *cpio_mime_type[] = { "application/x-cpio", NULL };
+const char *cpio_mime_type[] = { /*"application/x-cpio",*/ NULL };
 
 
 static const char **
@@ -242,8 +242,8 @@ fr_command_cpio_get_capabilities (FrCommand  *comm,
 	FrCommandCap capabilities;
 
 	capabilities = FR_COMMAND_CAN_ARCHIVE_MANY_FILES;
-	if (is_program_available (CPIO_PATH, check_command))
-		capabilities |= FR_COMMAND_CAN_READ;
+/*	if (is_program_available (CPIO_PATH, check_command))
+		capabilities |= FR_COMMAND_CAN_READ;*/
 
 	return capabilities;
 }
diff --git a/src/fr-command-unarchiver.c b/src/fr-command-unarchiver.c
index 0a40e6b04..8bc9c75ef 100644
--- a/src/fr-command-unarchiver.c
+++ b/src/fr-command-unarchiver.c
@@ -255,6 +255,7 @@ fr_command_unarchiver_handle_error (FrCommand   *comm,
 const char *unarchiver_mime_type[] = { "application/zip",
 				       "application/x-cbr",
 				       "application/x-rar",
+				       "application/x-cpio",
 				       NULL };
 
 

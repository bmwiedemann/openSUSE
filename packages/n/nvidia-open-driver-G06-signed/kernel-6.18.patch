--- open-gpu-kernel-modules-580.105.08/kernel-open/nvidia-uvm/uvm_va_range_device_p2p.c.orig	2025-12-03 14:56:18.964338048 +0100
+++ open-gpu-kernel-modules-580.105.08/kernel-open/nvidia-uvm/uvm_va_range_device_p2p.c	2025-12-03 14:59:26.352130997 +0100
@@ -360,7 +360,11 @@ static NV_STATUS alloc_device_p2p_mem(uv
         // a reference to them, so take one now if using DEVICE_COHERENT pages.
         if (gpu->parent->cdmm_enabled) {
             get_page(page);
+#if LINUX_VERSION_CODE >= KERNEL_VERSION(6, 18, 0)
+            get_dev_pagemap(page_to_pfn(page));
+#else
             get_dev_pagemap(page_to_pfn(page), NULL);
+#endif
         }
 #else
         // CDMM P2PDMA will never be enabled for this case

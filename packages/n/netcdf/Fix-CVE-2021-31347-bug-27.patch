From: Egbert Eich <eich@suse.com>
Date: Mon Oct 25 15:53:58 2021 +0200
Subject: Fix CVE-2021-31347 / bug 27
Patch-mainline: Not yet
Git-commit: 095715f1863b32994f824852c8e3e56c152a69d8
References: 

This fixes
 https://sourceforge.net/p/ezxml/bugs/27/

Signed-off-by: Egbert Eich <eich@suse.com>
---
 netcdf-c-4.8.0/libdap4/ezxml.c | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)
diff --git a/netcdf-c-4.8.0/libdap4/ezxml.c b/netcdf-c-4.8.0/libdap4/ezxml.c
index 225bcd8..791a3ab 100644
--- a/libdap4/ezxml.c
+++ b/libdap4/ezxml.c
@@ -588,7 +588,7 @@ ezxml_t ezxml_parse_str(char *s, size_t len)
             for (l = 0; *s && ((! l && *s != '>') || (l && (*s != ']' ||
                  *(s + strspn(s + 1, EZXML_WS) + 1) != '>')));
                  l = (*s == '[') ? 1 : l) s += strcspn(s + 1, "[]>") + 1;
-            if (! *s && e != '>')
+            if (! *s)
                 return ezxml_err(root, d, "unclosed <!DOCTYPE");
             d = (l) ? strchr(d, '[') + 1 : d;
             if (l && ! ezxml_internal_dtd(root, d, s++ - d)) return &root->xml;

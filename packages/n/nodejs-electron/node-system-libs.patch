--- a/third_party/electron_node/BUILD.gn	2022-06-15 16:17:43.423991754 +0200
+++ b/third_party/electron_node/BUILD.gn	2022-06-20 16:24:07.832340077 +0200
@@ -40,6 +40,25 @@
 
   # Allows embedders to override the NODE_MODULE_VERSION define
   node_module_version = ""
+
+  use_system_cares = false
+  use_system_nghttp2 = false
+  use_system_llhttp = false
+  use_system_histogram = false
+}
+
+if (is_linux) {
+ import("//build/config/linux/pkg_config.gni")
+ if(use_system_cares) {
+  pkg_config("cares") {
+    packages = [ "libcares" ]
+  }
+ }
+ if(use_system_nghttp2) {
+  pkg_config("nghttp2") {
+    packages = [ "libnghttp2" ]
+  }
+ }
 }
 
 assert(!node_use_dtrace, "node_use_dtrace not supported in GN")
@@ -182,17 +201,23 @@
 component("node_lib") {
   deps = [
     ":node_js2c",
-    "deps/cares",
-    "deps/histogram",
     "deps/googletest:gtest",
-    "deps/llhttp",
-    "deps/nghttp2",
     "deps/uvwasi",
     "//third_party/zlib",
     "//third_party/brotli:dec",
     "//third_party/brotli:enc",
     "//v8:v8_libplatform",
   ]
+  if(use_system_cares) {
+   configs += [ ":cares" ]
+  } else {
+   deps += [ "deps/cares" ]
+  }
+  if(use_system_nghttp2) {
+   configs += [ ":nghttp2" ]
+  } else {
+   deps += [ "deps/nghttp2" ]
+  }
   public_deps = [
     "deps/uv",
     "//electron:electron_js2c",
@@ -202,6 +227,17 @@
   public_configs = [ ":node_lib_config" ]
   include_dirs = [ "src" ]
   libs = []
+  if(use_system_llhttp) {
+   libs += [ "llhttp" ]
+  } else {
+   deps += [ "deps/llhttp" ]
+  }
+  if(use_system_histogram) {
+   libs += [ "hdr_histogram" ]
+   include_dirs += [ "/usr/include/hdr" ]
+  } else {
+   deps += [ "deps/histogram" ]
+  }
   frameworks = []
   cflags_cc = [
     "-Wno-deprecated-declarations",

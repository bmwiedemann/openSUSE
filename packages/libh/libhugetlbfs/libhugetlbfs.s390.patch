---
 Makefile |   12 ++++++++----
 1 file changed, 8 insertions(+), 4 deletions(-)

Index: libhugetlbfs-2.21/Makefile
===================================================================
--- libhugetlbfs-2.21.orig/Makefile
+++ libhugetlbfs-2.21/Makefile
@@ -87,12 +87,12 @@ else
 ifeq ($(ARCH),ia64)
 CC64 = $(CC)
 TMPLIB64 = lib64
-CFLAGS += -DNO_ELFLINK
+CPPFLAGS += -DNO_ELFLINK
 else
 ifeq ($(ARCH),sparc64)
 CC64 = $(CC) -m64
 TMPLIB64 = lib64
-CFLAGS += -DNO_ELFLINK
+CPPFLAGS += -DNO_ELFLINK
 else
 ifeq ($(ARCH),s390x)
 CC64 = $(CC) -m64
@@ -111,10 +111,15 @@ ELF32 = elf_s390
 TMPLIB32 = lib
 CUSTOM_LDSCRIPTS = no
 else
+ifeq ($(ARCH),s390)
+CC32 = gcc -m31
+ELF32 = elf_s390
+else
 $(error "Unrecognized architecture ($(ARCH))")
 endif
 endif
 endif
+endif
 endif
 endif
 endif

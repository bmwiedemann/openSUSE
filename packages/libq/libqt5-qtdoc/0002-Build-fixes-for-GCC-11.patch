From 896bcb186161c38965bd002b28156a2aab4b4a76 Mon Sep 17 00:00:00 2001
From: Ville Voutilainen <ville.voutilainen@qt.io>
Date: Mon, 18 Jan 2021 09:58:17 +0200
Subject: [PATCH 2/2] Build fixes for GCC 11

Task-number: QTBUG-89977
Change-Id: Ic1b7ddbffb8a0a00f8c621d09a868f1d94a52c21
Reviewed-by: Lars Knoll <lars.knoll@qt.io>
Reviewed-by: Thiago Macieira <thiago.macieira@intel.com>
(cherry picked from commit 813a928c7c3cf98670b6043149880ed5c955efb9)
---
 src/corelib/text/qbytearraymatcher.h     | 2 ++
 src/corelib/tools/qsharedpointer_impl.h  | 3 ---
 src/plugins/platforms/xcb/qxcbwindow.cpp | 2 +-
 3 files changed, 3 insertions(+), 4 deletions(-)

Index: qt-everywhere-src-5.15.5/qtbase/src/corelib/tools/qsharedpointer_impl.h
===================================================================
--- qt-everywhere-src-5.15.5.orig/qtbase/src/corelib/tools/qsharedpointer_impl.h
+++ qt-everywhere-src-5.15.5/qtbase/src/corelib/tools/qsharedpointer_impl.h
@@ -155,9 +155,6 @@ namespace QtSharedPointer {
 #endif
         inline void checkQObjectShared(...) { }
         inline void setQObjectShared(...) { }
-
-        inline void operator delete(void *ptr) { ::operator delete(ptr); }
-        inline void operator delete(void *, void *) { }
     };
     // sizeof(ExternalRefCountData) = 12 (32-bit) / 16 (64-bit)
 
Index: qt-everywhere-src-5.15.5/qtbase/src/plugins/platforms/xcb/qxcbwindow.cpp
===================================================================
--- qt-everywhere-src-5.15.5.orig/qtbase/src/plugins/platforms/xcb/qxcbwindow.cpp
+++ qt-everywhere-src-5.15.5/qtbase/src/plugins/platforms/xcb/qxcbwindow.cpp
@@ -698,7 +698,7 @@ void QXcbWindow::show()
         if (isTransient(window())) {
             const QWindow *tp = window()->transientParent();
             if (tp && tp->handle())
-                transientXcbParent = static_cast<const QXcbWindow *>(tp->handle())->winId();
+                transientXcbParent = tp->handle()->winId();
             // Default to client leader if there is no transient parent, else modal dialogs can
             // be hidden by their parents.
             if (!transientXcbParent)

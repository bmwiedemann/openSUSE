-------------------------------------------------------------------
Thu Mar  2 13:58:30 UTC 2023 - Priyanka Saggu <priyanka.saggu@suse.com>

- Update to version 1.21.14:
  * Release commit for Kubernetes v1.21.14
  * Reject proxy requests to 0.0.0.0 as well
  * etcd-client starts retrying transient errors from the etcd cluster
  * authn: fix cache mutation by AuthenticatedGroupAdder
  * Fix OpenAPI loading error caused by empty APIService
  * Correct event registration for multiple scheduler plugins.
  * Fix: abort nominating a pod that was already scheduled to a node
  * cpu manager policy set to none, no one remove container id from container map, lead memory leak
  * kube-up: use registry.k8s.io for containerd-related jobs
  * Skip updating Endpoints and EndpointSlice if no relevant fields change
  * ipvs: remove port opener
  * iptables: remove port opener
  * Extract containerID from systemd-style cgroupPath in cri_stats_provider And fix test to generate UUID without dash
  * update go.mod for golang.org/x/crypto to v0.0.0-20211202192323-5770296d904e
  * azure_file: try to get secret namespace from ClaimRef
  * azure_file: add namespace tests for InTree to CSI conversion
  * Update Go to 1.16.15
  * cluster/gce: update konnectivity image tags to v0.0.30
  * bump sigs.k8s.io/apiserver-network-proxy/konnectivity-client@v0.0.30
  * fix dryrun when ca file exists
  * fix regression introduced by PR 100320
  * bump k8s.io/utils for inotify fix
  * cronjob_controllerv2: do not filter jobs to be reconciled by labels
  * fix: remove outdated ipv4 route when the corresponding node is deleted
  * Updating EndpointSlice strategy to retain node name in topology until field is set
  * Add PDB selector patch integration test
  * Revert v1beta1 PodDisruptionBudget select patchStrategy
  * kubeadm: fix the bug that 'kubeadm init --dry-run --upload-certs' command failed with 'secret not found' error
  * Mark device as uncertain if unmount device succeeds
  * add namespace in azurefile volumeid
  * fix: azurefile volumeid conflict in csi migration
  * Fix DaemonSet status update retry
  * Enabling kube-proxy metrics on windows kernel mode
  * fix: delete non existing disk issue
  * fix containers order after applying
  * upgrade sigs.k8s.io/structured-merge-diff/v4 to v4.2.1
  * fix: do not delete the lb that does not exist
  * Fix header mutation race in timeout filter
  * Don't set sysctl net.ipv4.vs.conn_reuse_mode for kernels >=5.9
  * kubeadm: remove the restriction that the ca.crt can only contain one certificate
  * flake fix: remove the error handler for cronjob integration test
  * vendor: bump cAdvisor to v0.39.3
  * Fix the leak of vSphere client sessions
  * client-go: Clear the ResourceVersionMatch on paged list calls
  * Update GCE manifest to use konnectivity v0.0.27
  * Update to apiserver-network-proxy v0.0.27
  * Improving performance of EndpointSlice controller metrics cache
  * Mark volume mount as uncertain in case of volume expansion fails
  * mount-utils: Detect potential stale file handle
  * Add GetPossiblyMountedVolumesForPod to let kubelet know all volumes were unmounted
  * Add e2e test for NodeUnstage error cases
  * Skip creating HNS loadbalancer with empty endpoints
  * dependencies: Update golang.org/x/net to v0.0.0-20211209124913-491a49abca63
  * kubeadm: avoid requiring a CA key during kubeconfig expiration checks
  * kubeadm: print the CA of kubeconfig files in "check expiration"
  * kubeadm: validate local etcd certficates during expiration checks
  * publishing-bot/rules: drop rules for release-1.17 branch
  * Ensure deletion of pods in queues and cache
  * kube-scheduler: Increase the duration to expire an assumed pod
  * Skip check for all topology labels when using system default spreading
  * workqueue: fix leak in queue preventing objects from being GCed
  * Update mounter interface in volume manager
  * Ignore 'wait: no child processes' error when calling mount/umount
  * Reduce calls to docker from dockershim for stats
  * Fix concurrent map writes error in kube-apiserver
  * e2e: node: release-1.21: backport findKubeletServiceName
  * node: e2e: add test for the checkpoint recovery
  * devicemanager: checkpoint: support pre-1.20 data
  * fix: remove VMSS and VMSS instances from SLB backend pool only when necessary
  * fix: leave the probe path empty for TCP probes
  * fix: skip instance not found when decoupling vmss from lb
  * Add test for counting inodes correct with hardlinks
  * Get inodes and disk usage via pure go

-------------------------------------------------------------------
Mon Feb  7 16:21:21 UTC 2022 - Dirk MÃ¼ller <dmueller@suse.com>

- avoid bashism in client-common postinstall script (bsc#1195391)

-------------------------------------------------------------------
Wed Dec 08 15:22:24 UTC 2021 - rbrown@suse.com

- Update to version 1.21.7:
  * parameter 'disabled-metrics' is invalid
  * defer close the rotated log open
  * Fixed nil pointer dereference
  * Add tests for checking bind mounts
  * Check subpath file
  * Add check for subpaths
  * Manual cherry pick of kube-openapi changes for release-1.21 Bump kube-openapi against kube-openapi/release-1.21 branch
  * Fixed unit test SELinux support
  * Add shortcut for SELinux detection
  * Don't guess SELinux support on error
  * Use separate pathSpec for local and remote to properly handle cleaning paths
  * [go1.16] Update to go1.16.10
  * Automated cherry pick of #105122: added keys for structured logging (#105138)
  * Update debian, debian-iptables, setcap images to pick up CVEs fixes
  * Fixing how EndpointSlice Mirroring handles Service selector transitions
  * Fix race condition in logging when request times out
  * Remove nodes with Cluster Autoscaler taint from LB backends.
  * Retry detaching FibreChannel volume few times
  * Regenerate vendor/
  * Move error reporting to volume plugins
  * Retry reading /proc/mounts indifinetly in FC and iSCSI volume reconstruction
  * ConsistentRead tries 10 times
  * Bump k8s.io/utils
  * Fix issue in node status updating VolumeAttached list
  * Support cgroupv2 in node problem detector test
  * Update CHANGELOG/CHANGELOG-1.21.md for v1.21.6
  * Fix log spam for du failure on pod etc-hosts metrics
  * Run storage hostpath e2e test client pod as privileged
  * support more than 100 disk mounts on Windows
  * Update to go1.16.9
  * Fix PreferNominatedNode test
  * Verifying the auth headers are set for upgraded aggregated API requests
  * apiserver aggregator upgrade unit test
  * Aggregator uses the regular transport even if the request requires upgrades
  * check log directory for restartCount
  * Copy VolumeSnapshotContent annotations in snapshottable.go test
  * Bump klog to v2.9.0
  * Ignore VMs in vmss delete backend pools
  * aggregate errors when putting vmss
  * fix: skip not found nodes when reconciling LB backend address pools
  * fix: consolidate logs for instance not found error
  * Remove a duplicate StorageClass creation call
  * Bump golang.org/x/text to v0.3.6
  * Revert 102925: Fix Node Resources plugins score when there are pods with no requests
  * e2e scheduling priorities: do not reference control loop variable
  * storege e2etest: Delete restored PVC/Pod in snapshottable
  * tests: Wait for the network connectivity first
  * v1.21: Fix test flake in old svc registry
  * 'New' Event namespace validate failed
  * Update CHANGELOG/CHANGELOG-1.21.md for v1.21.5
  * Refine locking in API Priority and Fairness config controller
  * kube-controller-manager: properly check generic ephemeral volume feature
  * Fix null JSON round tripping
  * Propagate conversion errors
  * integration test
  * fix 104329: check for headless before trying to release the ClusterIPs
  * fix detach disk issue on deleting node
  * fix: ignore the case when comparing azure tags in service annotation
  * fix: ignore the case when updating tags
  * backport metrics grabbing through port-forwarding
  * remove listx from OWNERS_ALIASES
  * Only use dualstack if the node and config supports it
  * Local PV e2e: fix leaked local volumes
  * Add explicit capability for online volume expansion

-------------------------------------------------------------------
Wed Oct  6 15:24:17 UTC 2021 - Dominique Leuenberger <dimstar@opensuse.org>

- Bump disk requirements in _constraints to 12GB. Data based on the
  last successful build consumed storage.

-------------------------------------------------------------------
Thu Sep 16 11:26:27 UTC 2021 - rbrown@suse.com

- Update to version 1.21.5:
  * Update to go1.16.8
  * legacy-cloud-providers: aws: Add support for consuming web identity credentials
  * e2e iperf2 change threshold to 10MBps = 80 Mbps
  * Fix NodeAuthenticator tests in dual stack
  * Fix the key missing issue for structured log
  * Fix a small regression in Service updates
  * Service: Fix semantics for Update wrt allocations
  * Don't prematurely close reflectors in case of slow initialization in watch based manager
  * Fix storage class setup in regional_pd.go
  * backport 104410 to release-1.21
  * pkg/kubelet/cm: use SkipFreezeOnSet
  * vendor: bump runc to 1.0.2
  * Switch to non-deprecated timestamppb.Now()
  * Fix buckets initialization
  * fix: ensure InstanceShutdownByProviderID return false for creating Azure VMs
  * fix: skip case sensitivity when checking Azure NSG rules
  * Keep MakeMountArgSensitive and add a new signature that receives flags
  * Update the unit tests to handle mountFlags
  * Add missing interface method in mount_unsupported.go
  * Pass additional flags to subpath mount to avoid flakes in certain conditions
  * Update CHANGELOG/CHANGELOG-1.21.md for v1.21.4
  * Copy golang license to staging copies
  * delete stale UDP conntrack entries for loadbalancer IPs
  * Set idle and readheader timeouts

-------------------------------------------------------------------
Wed Aug 25 11:29:02 UTC 2021 - rbrown@suse.com

- Update to version 1.21.4:
  * Avoid spurious calls to update/delete validation
  * Update to go1.16.7
  * Fix metrics reporting for the deprecated watch path
  * Update configure-helper.sh
  * Update configure-helper.sh
  * Update configure-helper.sh
  * Fix disruptive subPath test failures
  * Fix: ignore not a VMSS error for VMAS nodes in reconcileBackendPools
  * feat: Provide IPv6 support for internal load balancer
  * Update to using apiserver-network-proxy v1.22
  * Make CSR cleaner tolerate objects with invalid status.certificate
  * disable aufs module
  * Update pd csi driver images to use v1 images (CSINode, CSIDriver, etc)
  * storage e2e: patch in RBAC rules for secrets
  * storage e2e: downgrade hostpath driver
  * storage e2e: disable health check containers
  * storage e2e: automate hostpath YAML updates, hostpath v1.6.2
  * update comments and owners file for pkg/util/removeall
  * kubelet: do not call RemoveAll on volumes directory for orphaned pods
  * Fix panic in master upgrade tests
  * Update CHANGELOG/CHANGELOG-1.21.md for v1.21.3
  * Updated to use konnectivity client v0.0.21, and implemented placeholder context
  * Fix the code is leaking the defaulting between unrelated pod instances
  * Simplify use of the fake dynamic client
  * fix: return empty VMAS name if using standalone VM
  * wait for endpoints to be available
  * Remove extra zone test
  * Fix frameworkImpl.extenders being not set
  * fix: Refresh VM cache when node is not found
  * fix: cleanup outdated routes
  * strip prefix 'v' in coredns version if exists
  * Fix closing of decorated watcher channel on timeout
  * fix: delete non existing disk issue
  * let objects without metadata pass through the managedFields admission controller

-------------------------------------------------------------------
Tue Jul 20 10:51:54 UTC 2021 - Richard Brown <rbrown@suse.com>

- Introduce revert-coredns-image-renaming.patch to correct new
  upstream behaviour

-------------------------------------------------------------------
Mon Jul 19 14:34:08 UTC 2021 - Dominique Leuenberger <dimstar@opensuse.org>

- Drop kubeadm-opensuse-corednsimage.patch: fixed upstream.

-------------------------------------------------------------------
Fri Jul 16 13:08:53 UTC 2021 - rbrown@suse.com

- Update to version 1.21.3:
  * move upgrade test frameworks closer to Describe
  * Update setcap image to buster-v2.0.3
  * Update debian-iptables image to buster-v1.6.5
  * Update debian-base image to buster-v1.8.0
  * Update to go1.16.6
  * Bump SMD to v4.1.2 to pick up #102749 fix
  * generate scheduler merge patches on the pod status instead of the full pod
  * Loadbalancer IngressIP policy should be configured as non-DSR to enable routing mesh by default
  * Fix race in attachdetach tests
  * Fix Node Resources plugins score when there are pods with no requests
  * Do not throw error when we can't get canonical path
  * Update CHANGELOG/CHANGELOG-1.21.md for v1.21.2
  * Remove error wrap from logs
  * client-go: reduce log level of reflector again
  * Update to go1.16.5
  * feat: remove ephemeral-storage etcd requirement
  * endpointslicemirroring controller mirror address status
  * sched: fix a bug that a preemptor pod exists as a phantom
  * Revert "Cleanup portforward streams after their usage"
  * serviceOwnsFrontendIP shouldn't report error when the public IP doesn't match
  * Return UnschedulableAndUnresolvable when looking up volume-related resources returns NotFound error
  * Return UnschedulableAndUnresolvable instead of Error when failing to lookup pvc or storageclass in VolumeZone plugin
  * use subpath for coredns only for default repository
  * (scheduler e2e) Create balanced pods in parallel
  * Fix VolumeAttachment garbage collection for migrated PVs
  * fix error of setting negative value for containerLogMaxSize
  * Update setcap to buster-v2.0.1 and add setcap to dependencies.yaml
  * kubeadm: remove e2e test for ClusterStatus
  * Update etcd image revision
  * Update debian-base to buster-v1.7.0
  * Update debian-iptables to buster-v1.6.1
  * Upgrade konnectivity-client for GRPC connection fixes
  * Respect annotation size limit for SSA last-applied.
  * Remove unnecessary quotes from get-kube scripts
  * Fix expired unit test certs
  * Set cgroups via opencontainer
  * vendor: bump runc to rc95
  * pkg/kubelet/nodeshutdown/systemd: fix for dbus 5.0.4
  * kubelet: reuse manager
  * Azure: avoid setting cached Sku when updating VMSS and VMSS instances
  * Ref counting is only applicable to Remote endpoints
  * Make watch order conformance test reliable
  * Add missing clientset to EBS storage e2e test
  * Update CHANGELOG/CHANGELOG-1.21.md for v1.21.1
  * fixed wrong warning in kube-proxy regarding topology aware hints
  * fix removing pods from podTopologyHints mapping
  * Update cos-gpu-installer image
  * fix: avoid nil-pointer panic when checking the frontend IP configuration
  * Add jitter to lease controller
  * Avoid caching the VMSS instances whose network profile is nil
  * fix: not tagging static public IP
  * Use CSI driver to determine unique name for migrated in-tree plugins
  * chunk target operatation for aws targetGroup
  * Fix watchForLockfileContention memory leak

-------------------------------------------------------------------
Tue May 25 09:03:46 UTC 2021 - Richard Brown <rbrown@suse.com>

- Toggle ip4/ipv6 forwarding sysctls to ensure all devices are
  refreshed [boo#1186125]

-------------------------------------------------------------------
Thu May 20 13:19:09 UTC 2021 - Richard Brown <rbrown@suse.com>

- Restore 90-kubeadm.conf, still needed [boo#1186125] 

-------------------------------------------------------------------
Wed May 19 11:28:32 UTC 2021 - Richard Brown <rbrown@suse.com>

- Stop setting sysctls on kubelet start with `sysctl -a --system`.
  Instead use more specific sysctl calls in kubelet service start.
  [boo#1186125]

-------------------------------------------------------------------
Wed May 19 11:17:58 UTC 2021 - rbrown@suse.com

- Update to version 1.21.1:
  * [go1.16] Update to go1.16.4
  * Automated cherry pick of #101377: Fix validation in kubectl create ingress (#101426)
  * Update tests to use agnhost 2.32
  * Fix EndpointSlice describe panic when an Endpoint doesn't have zone
  * Add test create service with ns
  * Set namespace when using kubectl create service
  * Update pkg/volume/azure_file/azure_provision.go
  * Normalize share name to not include capital letters
  * Extend pod start timeout to 5min for storage subpath configmap test
  * Fix cleanupMountpoint issue for Windows
  * fix: set "host is down" as corrupted mount
  * no watch endpointslice in userpace mode
  * Ensure service deleted when the Azure resource group has been deleted
  * Update Makefile
  * Update dependencies.yaml
  * update debian-base to buster-v1.5.0 for CVEs
  * fix TestMutatingWebhookResetsInvalidManagedFields flakes
  * Updating EndpointSlice validation to match Endpoints validation
  * fix: azure file namespace issue in csi translation
  * pkg/kubelet: improve the node informer sync check
  * Remove Limits from scheduling e2e balanced pod resources
  * Additional CVE-2021-3121 fix
  * Fix RBAC of generic ephemeral volumes controller
  * move filesystem resize code to kubernetes/mount-utils and add need resize function
  * Fix panic when killing container fails
  * Fix startupProbe behaviour changed
  * Fix test
  * [go1.16] Update to go1.16.3
  * Fix Job describe for completion mode
  * Upgrade kustomize-in-kubectl to v4.1.2
  * exec test should not run in Parallel as feature gate is not locked
  * respect ExecProbeTimeout
  * apf: exempt probes /healthz /livez /readyz
  * DelegatingAuthenticationOptions TokenReview request timeout
  * add node handlers to the metaproxier
  * Updating Topology Aware Hints to support "Auto" value for annotation
  * list pod list once to avoid timeout
  * gce configure containerd default_runtime_name
  * Update the containerd runtime binary path - gce
  * Cleanup portforward streams after their usage
  * azure: fix node public IP not able to fetch issues from IMDS
  * Update CHANGELOG/CHANGELOG-1.21.md for v1.21.0
  * e2e test with hostNetwork pods can't run in parallel
  * do not tag user created public IPs

-------------------------------------------------------------------
Mon May 17 12:50:21 UTC 2021 - Richard Brown <rbrown@suse.com>

- Revert remove workaround in 10-kubeadm.conf - still needed [boo#1186125]

-------------------------------------------------------------------
Wed May  5 15:49:22 UTC 2021 - Anthony Rabbito <hello@anthonyrabbito.com>

- Remove workaround in 10-kubeadm.conf for boo#1171770 causing sysctl values to be reset

-------------------------------------------------------------------
Mon Apr 26 09:53:12 UTC 2021 - Richard Brown <rbrown@suse.com>

- Introduce kubeadm-opensuse-corednsimage.patch to correct new
  coredns image name reference introduced in kubernetes 1.21 

-------------------------------------------------------------------
Wed Apr 14 14:54:52 UTC 2021 - Richard Brown <rbrown@suse.com>

- Rebase opensuse-version-checks.patch 

-------------------------------------------------------------------
Tue Apr 13 13:24:22 UTC 2021 - Richard Brown <rbrown@suse.com>

- Initial Package 

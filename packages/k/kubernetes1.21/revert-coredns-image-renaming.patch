From acb6a9c23756c0c6350ab29937b55de289f052ab Mon Sep 17 00:00:00 2001
From: Richard Brown <rbrownccb@opensuse.org>
Date: Tue, 20 Jul 2021 13:00:31 +0200
Subject: [PATCH] Patch openSUSE revert coredns image renaming

---
 cmd/kubeadm/app/images/images.go | 5 -----
 1 file changed, 5 deletions(-)

diff --git a/cmd/kubeadm/app/images/images.go b/cmd/kubeadm/app/images/images.go
index 7ada3b75018..edf087e9c46 100644
--- a/cmd/kubeadm/app/images/images.go
+++ b/cmd/kubeadm/app/images/images.go
@@ -21,7 +21,6 @@ import (
 
 	"k8s.io/klog/v2"
 	kubeadmapi "k8s.io/kubernetes/cmd/kubeadm/app/apis/kubeadm"
-	kubeadmapiv1beta2 "k8s.io/kubernetes/cmd/kubeadm/app/apis/kubeadm/v1beta2"
 	"k8s.io/kubernetes/cmd/kubeadm/app/constants"
 	kubeadmutil "k8s.io/kubernetes/cmd/kubeadm/app/util"
 )
@@ -53,10 +52,6 @@ func GetDNSImage(cfg *kubeadmapi.ClusterConfiguration) string {
 	if cfg.DNS.ImageRepository != "" {
 		dnsImageRepository = cfg.DNS.ImageRepository
 	}
-	// Handle the renaming of the official image from "k8s.gcr.io/coredns" to "k8s.gcr.io/coredns/coredns
-	if dnsImageRepository == kubeadmapiv1beta2.DefaultImageRepository {
-		dnsImageRepository = fmt.Sprintf("%s/coredns", dnsImageRepository)
-	}
 	// DNS uses an imageTag that corresponds to the DNS version matching the Kubernetes version
 	dnsImageTag := constants.GetDNSVersion(cfg.DNS.Type)
 
-- 
2.32.0


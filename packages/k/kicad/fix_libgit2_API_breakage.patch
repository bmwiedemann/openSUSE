From 75c2f17b42fd203f2f255adf16ca6b723631d2f1 Mon Sep 17 00:00:00 2001
From: JamesJCode <13408010-JamesJCode@users.noreply.gitlab.com>
Date: Mon, 28 Oct 2024 20:25:32 +0000
Subject: [PATCH] Fix libgit integration for version >= 1.8.3

The API continues to change...
---
 kicad/project_tree_pane.cpp | 11 ++++++++---
 1 file changed, 8 insertions(+), 3 deletions(-)

diff --git a/kicad/project_tree_pane.cpp b/kicad/project_tree_pane.cpp
index 1b3cd2175c4..5bf388bffff 100644
--- a/kicad/project_tree_pane.cpp
+++ b/kicad/project_tree_pane.cpp
@@ -2310,12 +2310,17 @@ void PROJECT_TREE_PANE::onGitCommit( wxCommandEvent& aEvent )
 
         git_oid oid;
 
-#if( LIBGIT2_VER_MAJOR == 1 && LIBGIT2_VER_MINOR == 8 && LIBGIT2_VER_REVISION < 2 )
+#if ( ( LIBGIT2_VER_MAJOR == 1                                                                     \
+        && ( ( LIBGIT2_VER_MINOR == 8                                                              \
+               && ( LIBGIT2_VER_REVISION < 2 || LIBGIT2_VER_REVISION >= 3 ) )                      \
+             || ( LIBGIT2_VER_MINOR > 8 ) ) )                                                      \
+      || LIBGIT2_VER_MAJOR > 1 )
         // For libgit2 versions 1.8.0, 1.8.1.
-        // This change was reverted for 1.8.2+
+        // This change was reverted for 1.8.2
+        // This change was re-reverted for 1.8.3+
         git_commit* const parents[1] = { parent };
 #else
-        // For libgit2 versions older than 1.8.0
+        // For libgit2 versions older than 1.8.0, or equal to 1.8.2
         const git_commit* parents[1] = { parent };
 #endif
 
-- 
GitLab


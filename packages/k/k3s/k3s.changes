-------------------------------------------------------------------
Thu Apr 29 09:11:09 UTC 2021 - alexandre.vicenzi@suse.com

- Update to version 1.21.0+k3s1:
  * Add support for dual-stack Pod/Service CIDRs and node IP addresses (#3212)
  * mark v1.20.6+k3s1 as stable
  * Update bug_report.md language
  * Update feature_request.md
  * Support .d directory for k3s config file (#3162)
  * Fix service-account-issuer
  * Update to forked protobuf 1.4.3-k3s1
  * Reduce node and service wait times
  * Update Kubernetes to v1.21.0
  * Resolve local retention issue when S3 in use.
  * add hidden attribute to disable flags
  * add etcd s3 secret and access key flags and env vars to secret data
  * Add gzip and zst airgap artifacts
  * Update CoreDNS to version 1.8.3. (#3168)
  * Fix up vagrant provision scripts
  * Bump traefik to v2.4.8
  * Fix CI failures non-deterministic traefik chart repackaging (#3165)
  * delete nocluster file and remove build tag
  * remove hidden attribute from cluster flags and related code
  * Make v1.20.5+k3s1 stable
  * remove duplicated func GetAddresses
  * Update to Kubernetes v1.20.5 (#3094)
  * Replace which with command -v (#3125)
  * AkihiroSuda/containerd-fuse-overlayfs -> containerd/fuse-overlayfs-snapshotter
  * rootless: allow kernel.dmesg_restrict=1
  * rootless: enable resource limitation (requires cgroup v2, systemd)
  * bump up RootlessKit
  * containerd: v1.4.4-k3s1 (#3090)
  * put etcd bootstrap save call in goroutine and update comment
  * Remove unit files after disabling, instead of before
  * remove etcd data dir when etcd is disabled (#3059)
  * registry mirror repository rewrites (#3064)
  * Have Bootstrap Data Stored in etcd at Completed Start (#3038)
  * Define a Controllers and LeaderControllers on the server config (#3043)
  * Don't start up multiple apiserver load balancers
  * Handle loadbalancer port in TIME_WAIT
  * Always use static ports for client load-balancers (#3026)
  * Update GITHUB_URL
  * Update .md files with url and email corrections
  * Mark disable components flags as experimental (#3018)
  * Etcd Snapshot/Restore to/from S3 Compatible Backends (#2902)
  * Suppress test failure due to incompatible server
  * Log clearer error on startup if NPC cannot be started
  * Add script to test server/agent version compatibility
  * change error to warn when removing self from etcd members
  * update dynamiclistener
  * remove etcd member if disable etcd is passed
  * Apply suggestions from code review
  * Update to Traefik 2.4.2 and combine manifests
  * Remove Traefik v1 migration
  * Allow download traefik static file and rename
  * Traefik v2 integration
  * Wait for apiserver to become healthy before starting agent controllers
  * Hide the airgap-extra-registry flag
  * update master to 1.20.4
  * use v1.20.4-k3s1 as stable
  * Update k3s-root to v0.8.1
  * Limit zstd decoder memory
  * Use HasSuffixI utility function
  * Add support for retagging images on load from tarball
  * Add disable flags for control components (#2900)
  * update usage text (#2926)

-------------------------------------------------------------------
Mon Apr 19 10:54:43 UTC 2021 - alexandre.vicenzi@suse.com

- Update to version 1.20.6+k3s1:
  * Update to v1.20.6
  * add cloud controller manager fixes from master
  * Update to v1.20.6
  * Resolve local retention issue when S3 in use.
  * add hidden attribute to disable flags
  * delete nocluster file and remove build tag
  * remove hidden attribute from cluster flags and related code
  * add etcd s3 secret and access key flags and env vars to secret data
  * put etcd bootstrap save call in goroutine and update comment
  * remove duplicate method
  * Have Bootstrap Data Stored in etcd at Completed Start (#3038)
  * Etcd Snapshot/Restore to/from S3 Compatible Backends (#2902)
  * Add ability to perform an etcd on-demand snapshot via cli (#2819)
  * Update to Kubernetes v1.20.5 (#3094)
  * [release 1.20] containerd: v1.4.4-k3s1 (#3086)
  * Define a Controllers and LeaderControllers on the server config (#3053)
  * Suppress test failure due to incompatible server
  * Log clearer error on startup if NPC cannot be started
  * Add script to test server/agent version compatibility
  * [release-1.20] Add disable components flags  (#3019)
  * Update to v1.20.4 (#2960)
  * Update k3s-root to v0.8.1
  * Use appropriate response codes for authn/authz failures
- Bump go version to 1.15

-------------------------------------------------------------------
Wed Apr 14 14:26:22 UTC 2021 - Michal Suchanek <msuchanek@suse.com>

- Add disk size requirement in constraints
- host-local path fixup
  * Refresh cni-bin-dir.patch

-------------------------------------------------------------------
Thu Mar 25 14:25:49 UTC 2021 - Michal Suchanek <msuchanek@suse.com>

- Update to upstream version 1.20.4+k3s1
  * Known Issues
    - K3s servers should always be upgraded before agents. Agents upgraded to
      this release before all servers have been upgraded will fail to start due to
      the issue described at #2996
  * Changes since v1.20.2+k3s2:
    + Upgrade Kubernetes to v1.20.4 (#2960)
    + K3s servers now use appropriate HTTP response codes to node join failures
      caused by incorrect credentials (#2915)
    + ServiceLB now adds IP addresses for all nodes running LB pods to the
      Service ingress IP list (#2909)
    + K3s will now reliably enable CFS quotas when the cpu and cpuacct cgroup
      controllers are comounted (#2911)
    + K3s nodes can now successfully join clusters when the cluster CA
      certificate is trusted by the OS CA bundle (#2743)
    + K3s binary size has been reduced; time to first launch a new version of
      K3s should be reduced as well (#2905)
    + K3s is now compiled with golang 1.15.8, resolving a common source of
      crashes on 32bit arm systems (#2896)
    + Crictl will more reliably locate its config file when run by non-root users (#2894)
    + The K3s systemd unit will successfully start with a missing
      EnvironmentFile (#2886 @AkihiroSuda)
    + The K3s Network Policy Controller has been updated, offering improved
      performance and reliability of network policy enforcement (#2867)
    + K3s containerd now supports AppArmor signal mediation (#2877)
    + The K3s embedded userspace (k3s-root) has been updated to fix several
      BusyBox CVEs and allow use of the fuse-overlayfs snapshotter (#2862 #2847)
    + K3s now supports cgroupv2 (#2844)
    + Several regressions in rootless support have been resolved (#2846)
    + Cadvisor statistics are no longer missing pod labels (#2836)
    + Embedded etcd's Prometheus metrics can now be exposed beyond localhost (#2750 @yuriydzobak)
    + The node.cloudprovider.kubernetes.io/uninitialized taint on new nodes is
      now cleared more reliably (#2843)
    + Embedded etc snapshots can now be performed on-demand (#2819)
    + K3s no longer validates containerd snapshotter functionality when not
      using the embedded containerd (#2800 @sonicaj)
  * Embedded Component Versions
    * Kubernetes	v1.20.4
    * Kine	v0.6.0
    * SQLite	3.33.0
    * Etcd	v3.4.13-k3s1
    * Containerd	v1.4.3-k3s3
    * Flannel	v0.12.0-k3s1
    * Metrics-server	v0.3.6
    * Traefik	v1.7.19
    * CoreDNS	v1.8.0
    * Helm-controller	v0.8.3
    * Local-path-provisioner	v0.0.19
- Refresh cni-bin-dir.patch
- hyperkube no longer available

-------------------------------------------------------------------
Tue Aug  4 11:41:14 UTC 2020 - Dirk Mueller <dmueller@suse.com>

- add conflicts and minimal update-alternatives for new kubectl implementation 

-------------------------------------------------------------------
Mon Aug  3 17:02:25 UTC 2020 - Callum Farmer <callumjfarmer13@gmail.com>

- Fixes for %_libexecdir changing to /usr/libexec (bsc#1174075)

-------------------------------------------------------------------
Thu May  2 12:44:52 UTC 2019 - Duncan Mac-Vicar <dmacvicar@suse.de>

- Update to version 0.4.0
  * Features and Enhancements
    - Update to kubernetes v1.14.1 - Upgraded from Kubernetes
      v1.13.5.
      This Kubernetes upgrade moves pid limiting to beta and is
      enabled by default, which may not be supported by all kernels.
      K3s will auto-detect cgroup pids support and add flags as
      needed if the pids module is not available. [#335]
    - Add --bind-address flag for API server [#214]
      Support custom bind address for kubernetes API server to bind to.
    - Add --cluster-domain flag for custom kubelet and DNS configuration [#267]
      Support configuring custom DNS cluster domains.
    - Add --flannel-iface flag for agent [#72]
      Support custom flannel interface.
    - Add passthrough args [#290]
      Support for overriding k3s default arguments or passing custom
      arguments to Kubernetes processes:
      --kube-apiserver-arg value
        Customized flag for kube-apiserver process
      --kube-scheduler-arg value
        Customized flag for kube-scheduler process
      --kube-controller-arg value
        Customized flag for kube-controller-manager process
      --kubelet-arg value
        (agent) Customized flag for kubelet process
      --kube-proxy-arg value
        (agent) Customized flag for kube-proxy process
    - Initial metrics-server support [#252]
      Configures aggregation layer so metrics server can be launched and
      metrics scraped. Future enhancements will remove need for a
      custom metrics server deployment.
    - Add experimental rootless support
      Provides --rootless flag for running k3s agent as a user.
  * Bug fixes
    - Fixed an issue where k3s may not connect to the API server when using
      proxy settings [#325]
- Changes from Release v0.3.0
  * Features and Enhancements
    - Airgap support with helm and preinstalled images [#166]
      Support static helm charts through the API server and loading
      container images on agents. See our documentation for details
      on how to perform airgap installations.
    - Add --tls-san flag for API server cert validation [#200]
      Support alternate names for cert generation to avoid API cert issues.
    - Add --resolv-conf flag for custom kubelet DNS configuration [#53]
    - Support configuring custom DNS resolvers or using the host system's
      resolv.conf configuration. If the host system's resolv.conf doesn't
      supply any viable resolvers, intelligently fallback to 8.8.8.8
      (Google Public DNS).
    - Update to kubernetes v1.13.5
      This upgrade from v1.13.4 addresses Kubernetes CVE-2019-9946
      and CVE-2019-1002101.
  * Bug fixes
    - Fixed an issue where the k3s service load balancer will not be created
      if the port name is longer than 15 characters #90
    - Fixed an issue where k3s does not ignore empty yaml documents in a
      manfest #222
    - Fixed an issue where k3s may not run with selinux, the installer will now
      add selinux permissions #227
    - Fixed an issue where k3s deployment manifests are created even if
      --no-deploy is specified #230

-------------------------------------------------------------------
Fri Mar 15 18:57:35 UTC 2019 - Jan Engelhardt <jengelh@inai.de>

- Replace the sales pitch in the description by new wording,
  sourced from second block paragraph of k3s's README.md and
  Wikipedia, so as to fulfill the openSUSE description
  recommendations on what k3s is, and how it differs from other
  implementations of its kind.

-------------------------------------------------------------------
Fri Mar 15 10:40:37 UTC 2019 - Guillaume GARDET <guillaume.gardet@opensuse.org>

- Fix 'Conflicts'
- Add 'iptables' requires
- Package hyperkube sepraretly
- Add a workaround for https://github.com/rancher/k3s/issues/231
- Add kubectl and crictl symlinks
- Update description

-------------------------------------------------------------------
Wed Mar 13 22:07:33 UTC 2019 - Guillaume GARDET <guillaume.gardet@opensuse.org>

- Add requires to 'conntrack-tools' and 'runc' as it is needed at
  runtime

-------------------------------------------------------------------
Wed Mar 13 15:07:20 UTC 2019 - Guillaume GARDET <guillaume.gardet@opensuse.org>

- Fix k3s-agent.service as '-u' is not a valid option

-------------------------------------------------------------------
Tue Mar 12 15:02:30 UTC 2019 - Guillaume GARDET <guillaume.gardet@opensuse.org>

- Update to version 0.2.0:
  * Features and Enhancements:
    - Support arbitrary CRI implementations [#107] - Users can now 
    configure k3s to use cri-o and other CRI implementations that 
    are not packaged into k3s.
    - Support for preloading images [#92] - Users can now have node
    agents load docker images from a location on the host at startup,
    eliminating the need to pull images from a remote location.
    - Upgrade to Kubernetes v1.13.4 [#95] - Update to the latest 
    release of Kubernetes.
    - Support k3s on Rancher [#69] - Users can now import k3s 
    clusters into Rancher (supported in Rancher v2.2.0-rc3 and later).
    - Support agent options in server command [#73] - Users can now
    set any of the options available to agents when starting the k3s
    server node.
    - Support the ability to run k3s as non-root user [#38] - User 
    can now run the k3s server as a non-root user.
    - Support the ability to read node token from a file [#98] - Users
    can now have the node-agent read its token from a file rather
    than passing it as a string.
  * Bug fixes:
    - Fixed an issue where preloaded deployment manifests fail to
    deploy if no namespace is specified #151
    - Fixed an issue where changes to helm chart values or 
    values.yaml aren't always triggering an upgrade #187
    - Fixed an issue where nodes with uppercase hostnames hang 
    indefinitely #160
    - Fixed an issue where containerd log level environment variable 
    is not respected #188
    - Fixed an issue where node-token path doesn't resolve for root
    user in agent scripts #189
    - Fixed an issue where traefik is not listed in the --no-deploy 
    flag's help text #186
    - Fixed an issue where changing cluster CIDR was not possible #93
    - Fixed an issue where k3s systemd service should wait until 
    the server is ready #57
    - Fixed an issue where test volume mount e2e fails for k3s 
    image #45
    - Fixed an issue where component status is not accurate #126
    - Fixed an issue where install script fails if wget is not 
    available #48
    - Added the ability to dynamically install the latest release
    of k3s #47

-------------------------------------------------------------------
Mon Mar  4 14:35:14 UTC 2019 - Guillaume GARDET <guillaume.gardet@opensuse.org>

- Add _constraints to avoid 'cannot allocate memory' error seen 
  on aarch64

-------------------------------------------------------------------
Thu Feb 28 07:33:11 UTC 2019 - Duncan Mac-Vicar <dmacvicar@suse.de>

- Initial package - v0.1.0

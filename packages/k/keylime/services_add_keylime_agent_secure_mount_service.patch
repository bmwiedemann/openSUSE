From 8fb134b873a46280350c7e2fecece7ed3e6e1492 Mon Sep 17 00:00:00 2001
From: Alberto Planas <aplanas@suse.com>
Date: Mon, 28 Feb 2022 18:01:55 +0100
Subject: [PATCH] services: add keylime_agent_secure.mount service
MIME-Version: 1.0
Content-Type: text/plain; charset=UTF-8
Content-Transfer-Encoding: 8bit

Add Keylime secure mount for agent from Debian.

Co-authored-by: Utkarsh Gupta <utkarsh@debian.org>
Co-authored-by: Miriam Espa√±a Acebal <miriam.espana@canonical.com>
Signed-off-by: Alberto Planas <aplanas@suse.com>
---
 services/keylime_agent_secure.mount | 12 ++++++++++++
 1 file changed, 12 insertions(+)
 create mode 100644 services/keylime_agent_secure.mount

diff --git a/services/keylime_agent_secure.mount b/services/keylime_agent_secure.mount
new file mode 100644
index 00000000..606b9db1
--- /dev/null
+++ b/services/keylime_agent_secure.mount
@@ -0,0 +1,12 @@
+[Unit]
+Description=Keylime configuration filesystem
+Before=keylime_agent.service
+
+[Mount]
+What=tmpfs
+Where=/var/lib/keylime/secure
+Type=tmpfs
+Options=mode=0700,size=1m,uid=keylime,gid=tss
+
+[Install]
+WantedBy=multi-user.target

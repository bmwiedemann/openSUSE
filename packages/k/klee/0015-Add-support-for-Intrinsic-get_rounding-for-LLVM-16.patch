From: Martin Nowack <m.nowack@imperial.ac.uk>
Date: Mon, 30 Oct 2023 14:53:48 +0000
Subject: Add support for `Intrinsic::get_rounding` for LLVM 16
Patch-mainline: no
References: llvm16

`Intrinsic::flt_rounds` got removed

Signed-off-by: Jiri Slaby <jslaby@suse.cz>
---
 lib/Module/IntrinsicCleaner.cpp | 4 ++++
 1 file changed, 4 insertions(+)

diff --git a/lib/Module/IntrinsicCleaner.cpp b/lib/Module/IntrinsicCleaner.cpp
index 40ff2874..af77ed70 100644
--- a/lib/Module/IntrinsicCleaner.cpp
+++ b/lib/Module/IntrinsicCleaner.cpp
@@ -366,7 +366,11 @@ bool IntrinsicCleanerPass::runOnBasicBlock(BasicBlock &b, Module &M) {
       case Intrinsic::experimental_noalias_scope_decl:
 #endif
       case Intrinsic::floor:
+#if LLVM_VERSION_CODE < LLVM_VERSION(16, 0)
       case Intrinsic::flt_rounds:
+#else
+      case Intrinsic::get_rounding:
+#endif
       case Intrinsic::frameaddress:
       case Intrinsic::get_dynamic_area_offset:
       case Intrinsic::invariant_end:
-- 
2.43.0


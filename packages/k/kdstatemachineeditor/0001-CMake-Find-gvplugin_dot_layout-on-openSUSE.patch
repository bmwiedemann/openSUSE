From 631968d008366eecf9c9cdaf04041d73b9ef29af Mon Sep 17 00:00:00 2001
From: Christophe Marin <christophe@krop.fr>
Date: Sat, 1 Feb 2025 11:11:46 +0100
Subject: [PATCH] CMake - Find gvplugin_dot_layout on openSUSE

KDSME needs the gvplugin_dot_layout plugin to build, but the graphviz spec file
removes the symlinks for libgvplugin_*.

The build system needs a workaround.
---
 cmake/FindGraphviz.cmake | 5 ++++-
 1 file changed, 4 insertions(+), 1 deletion(-)

diff --git a/cmake/FindGraphviz.cmake b/cmake/FindGraphviz.cmake
index c528a03..78c1a90 100644
--- a/cmake/FindGraphviz.cmake
+++ b/cmake/FindGraphviz.cmake
@@ -120,9 +120,12 @@ find_library(
     PATH_SUFFIXES ${GRAPHVIZ_LIB_PATH_SUFFIX} ${_GRAPHVIZ_FIND_OPTS}
 )
 
+# Due to graphviz maintainer decision, the gvplugin_dot_layout symlink is
+# missing in the graphviz package. We need to work around this decision to
+# build kdstatemachineeditor
 find_library(
     GRAPHVIZ_PLUGIN_DOT_LAYOUT_LIBRARY
-    NAMES gvplugin_dot_layout
+    NAMES gvplugin_dot_layout libgvplugin_dot_layout.so.6 libgvplugin_dot_layout.so.8
     HINTS ${_GRAPHVIZ_LIBRARY_DIR}
     PATH_SUFFIXES ${GRAPHVIZ_LIB_PATH_SUFFIX} ${_GRAPHVIZ_FIND_OPTS} graphviz
 )
-- 
2.51.1


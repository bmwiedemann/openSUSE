diff -Nur kitty-0.25.0/kittens/transfer/rsync.c new/kittens/transfer/rsync.c
--- kitty-0.25.0/kittens/transfer/rsync.c	2022-04-11 16:01:45.000000000 +0200
+++ new/kittens/transfer/rsync.c	2022-04-18 14:43:47.391998800 +0200
@@ -6,6 +6,7 @@
  */
 
 #include "data-types.h"
+#include <stdio.h>
 #include <librsync.h>
 
 #define SIGNATURE_CAPSULE "rs_signature_t"
diff -Nur kitty-0.25.0/setup.py new/setup.py
--- kitty-0.25.0/setup.py	2022-04-18 14:44:34.223998795 +0200
+++ new/setup.py	2022-04-18 14:44:19.307998797 +0200
@@ -263,10 +263,11 @@
 def detect_librsync(cc: List[str], cflags: List[str], ldflags: List[str]) -> str:
     if not test_compile(
             cc, *cflags, libraries=('rsync',), ldflags=ldflags, show_stderr=True,
-            src='#include <librsync.h>\nint main(void) { rs_strerror(0); return 0; }'):
+            src='#include <stdio.h>\n#include <librsync.h>\nint main(void) { rs_strerror(0); return 0; }'):
         raise SystemExit('The librsync library is required')
     # check for rs_sig_args() which was added to librsync in Apr 2020 version 2.3.0
     if test_compile(cc, *cflags, libraries=('rsync',), ldflags=ldflags, src='''
+#include <stdio.h>
 #include <librsync.h>
 int main(void) {
     rs_magic_number magic_number = 0;

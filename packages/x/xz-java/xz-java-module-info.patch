--- a/build.xml	2025-07-03 17:34:58.653124868 +0200
+++ b/build.xml	2025-07-03 17:50:13.872136109 +0200
@@ -68,6 +68,16 @@
                includesfile="fileset-src9.txt">
             <compilerarg compiler="modern" line="-Xlint"/>
             <compilerarg compiler="modern" line="-implicit:none"/>
+            <exclude name="**/module-info.java"/>
+        </javac>
+        <javac unless:true="${java8only}"
+               srcdir="." sourcepath="${src9_dir}:${src_dir}"
+               destdir="${classes_dir}"
+               includeAntRuntime="false" debug="${debug}"
+               release="${sourcever9}">
+            <compilerarg compiler="modern" line="-Xlint"/>
+            <compilerarg compiler="modern" line="-implicit:none"/>
+            <include name="**/module-info.java"/>
         </javac>
     </target>
 
@@ -102,7 +112,7 @@
 
         <jar destfile="${jar_dir}/xz.jar" modificationtime="${timestamp}"
              manifest="${manifest_base}">
-            <fileset dir="${classes_dir}" includes="org/tukaani/xz/**"/>
+            <fileset dir="${classes_dir}" includes="org/tukaani/xz/**,**/module-info.class"/>
             <zipfileset prefix="META-INF/versions/9/" dir="${classes9_dir}"
                         unless:true="${java8only}"/>
             <manifest>
@@ -112,6 +122,8 @@
                 <attribute name="Sealed" value="true"/>
                 <attribute name="Multi-Release" value="true"
                            unless:true="${java8only}"/>
+                <attribute name="Automatic-Module-Name" value="org.tukaani.xz"
+                           if:true="${java8only}"/>
                 <!-- Attributes for OSGi bundles: -->
                 <attribute name="Bundle-ManifestVersion" value="2"/>
                 <attribute name="Bundle-SymbolicName" value="org.tukaani.xz"/>

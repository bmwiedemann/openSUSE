From e2c96c5b2c15a15d63273a802cea1df3614966a4 Mon Sep 17 00:00:00 2001
From: Andreas Schwab <schwab@suse.de>
Date: Tue, 23 Apr 2019 12:53:44 +0200
Subject: [PATCH] Fix parallel build

---
 Makefile | 30 +++++++++++++++---------------
 1 file changed, 15 insertions(+), 15 deletions(-)

diff --git a/Makefile b/Makefile
index c3d9984..684dbc2 100644
--- a/Makefile
+++ b/Makefile
@@ -17,16 +17,16 @@ gfxboot.d:
 	mkdir -p ~/.fonts openSUSE/gfxboot/data-boot/ openSUSE/gfxboot/data-install
 	cp gfxboot/SourceSansPro-Light.ttf ~/.fonts
 	for name in back welcome on off glow; do \
-		rsvg-convert raw-theme-drop/$${name}.svg -w 800 -a -o tmp.png; \
-		gm convert -quality 100 -interlace None -colorspace YCbCr -geometry 800x600 -sampling-factor 2x2 tmp.png openSUSE/gfxboot/data-install/$${name}.jpg; \
-		rm tmp.png; \
+		rsvg-convert raw-theme-drop/$${name}.svg -w 800 -a -o tmp-$@.png; \
+		gm convert -quality 100 -interlace None -colorspace YCbCr -geometry 800x600 -sampling-factor 2x2 tmp-$@.png openSUSE/gfxboot/data-install/$${name}.jpg; \
+		rm tmp-$@.png; \
 	done
-	rsvg-convert gfxboot/text.svg -w 114 -a -o tmp.png
-	gm convert -quality 100 -interlace None -colorspace YCbCr -sampling-factor 2x2 tmp.png openSUSE/gfxboot/data-install/text.jpg
-	rm tmp.png
-	rsvg-convert raw-theme-drop/back.svg -w 800 -a -o tmp.png
-	gm convert -quality 100 -interlace None -colorspace YCbCr -geometry 800x600 -sampling-factor 2x2 tmp.png openSUSE/gfxboot/data-boot/back.jpg
-	rm tmp.png
+	rsvg-convert gfxboot/text.svg -w 114 -a -o tmp-$@.png
+	gm convert -quality 100 -interlace None -colorspace YCbCr -sampling-factor 2x2 tmp-$@.png openSUSE/gfxboot/data-install/text.jpg
+	rm tmp-$@.png
+	rsvg-convert raw-theme-drop/back.svg -w 800 -a -o tmp-$@.png
+	gm convert -quality 100 -interlace None -colorspace YCbCr -geometry 800x600 -sampling-factor 2x2 tmp-$@.png openSUSE/gfxboot/data-boot/back.jpg
+	rm tmp-$@.png
 	rm ~/.fonts/SourceSansPro-Light.ttf
 
 gfxboot.d_clean:
@@ -77,9 +77,9 @@ CLEAN_DEPS+=libreoffice.d_clean
 wallpaper.d:
 	mkdir -p openSUSE/wallpapers openSUSE/wallpapers/openSUSEdefault/contents/images
 	for size in 5120x3200 3840x2400 1280x1024 1600x1200 1920x1080 1920x1200 1350x1080 1440x1080; do \
-		rsvg-convert raw-theme-drop/desktop-$${size}.svg -o tmp.png; \
-		gm convert -quality 100 -interlace None -colorspace YCbCr -sampling-factor 2x2 tmp.png openSUSE/wallpapers/openSUSEdefault/contents/images/$${size}.jpg; \
-		rm tmp.png; \
+		rsvg-convert raw-theme-drop/desktop-$${size}.svg -o tmp-$@.png; \
+		gm convert -quality 100 -interlace None -colorspace YCbCr -sampling-factor 2x2 tmp-$@.png openSUSE/wallpapers/openSUSEdefault/contents/images/$${size}.jpg; \
+		rm tmp-$@.png; \
 	done
 	for size in 1600x1200 1920x1200 1920x1080; do \
 		cp wallpapers/default-$${size}.jpg.desktop openSUSE/wallpapers; \
@@ -87,9 +87,9 @@ wallpaper.d:
 		ln -sf openSUSE${VERSION_NO_DOT}-$${size}.jpg openSUSE/wallpapers/default-$${size}.jpg; \
 		ln -sf openSUSEdefault/contents/images/$${size}.jpg openSUSE/wallpapers/openSUSE${VERSION_NO_DOT}-$${size}.jpg; \
 	done
-	rsvg-convert raw-theme-drop/desktop-1920x1200.svg -o tmp.png
-	gm convert -quality 100 -interlace None -colorspace YCbCr -sampling-factor 2x2 tmp.png openSUSE/wallpapers/openSUSEdefault/screenshot.jpg
-	rm tmp.png
+	rsvg-convert raw-theme-drop/desktop-1920x1200.svg -o tmp-$@.png
+	gm convert -quality 100 -interlace None -colorspace YCbCr -sampling-factor 2x2 tmp-$@.png openSUSE/wallpapers/openSUSEdefault/screenshot.jpg
+	rm tmp-$@.png
 	cp -p kde-workspace/metadata.desktop openSUSE/wallpapers/openSUSEdefault/metadata.desktop
 
 wallpaper.d_clean:

diff -uNrp progsreiserfs-0.3.0.5.orig/libdal/file_dal.c progsreiserfs-0.3.0.5/libdal/file_dal.c
--- progsreiserfs-0.3.0.5.orig/libdal/file_dal.c	2004-04-18 22:23:25.000000000 +0200
+++ progsreiserfs-0.3.0.5/libdal/file_dal.c	2005-12-19 17:18:09.902050544 +0100
@@ -38,7 +38,7 @@ static blk_t file_dal_len(dal_t *dal) {
     
 	if (!dal) return 0;
     
-	if ((max_off = lseek64((int)dal->dev, 0, SEEK_END)) == (loff_t)-1)
+	if ((max_off = lseek64((long)dal->dev, 0, SEEK_END)) == (loff_t)-1)
 		return 0;
 	
 	return max_off / dal->blocksize;
@@ -52,12 +52,12 @@ static int file_dal_read(dal_t *dal, voi
     
 	off = (loff_t)block * (loff_t)dal->blocksize;
     
-	if (lseek64((int)dal->dev, off, SEEK_SET) == -1)
+	if (lseek64((long)dal->dev, off, SEEK_SET) == -1)
 		return 0;
 
 	blocklen = (loff_t)count * (loff_t)dal->blocksize;
     
-	if (read((int)dal->dev, buff, blocklen) <= 0)
+	if (read((long)dal->dev, buff, blocklen) <= 0)
 		return 0;
     
 	return 1;
@@ -71,12 +71,12 @@ static int file_dal_write(dal_t *dal, vo
     
 	off = (loff_t)block * (loff_t)dal->blocksize;
     
-	if (lseek64((int)dal->dev, off, SEEK_SET) == -1)
+	if (lseek64((long)dal->dev, off, SEEK_SET) == -1)
 		return 0;
 
 	blocklen = (loff_t)count * (loff_t)dal->blocksize;
     
-	if (write((int)dal->dev, buff, blocklen) <= 0)
+	if (write((long)dal->dev, buff, blocklen) <= 0)
 		return 0;
     
 	return 1;
@@ -86,7 +86,7 @@ static int file_dal_sync(dal_t *dal) {
 
 	if (!dal) return 0;
 	
-	return !fsync((int)dal->dev);
+	return !fsync((long)dal->dev);
 }
 
 static int file_dal_flags(dal_t *dal) {
@@ -143,11 +143,11 @@ dal_t *file_dal_open(const char *dev, si
 }
 
 int file_dal_reopen(dal_t *dal, int flags) {
-	int fd;
+	long fd;
 	
 	if (!dal) return 0;
 
-	close((int)dal->dev);
+	close((long)dal->dev);
     
 	if ((fd = open((char *)dal->data, flags | O_LARGEFILE)) == -1)
 		return 0;
@@ -162,7 +162,7 @@ void file_dal_close(dal_t *dal) {
 
 	if (!dal) return;
 
-	close((int)dal->dev);
+	close((long)dal->dev);
 	dal_free(dal);
 }
 

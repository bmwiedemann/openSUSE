From b4e581f3e3ded8d13065e6c21777eca1f229e53d Mon Sep 17 00:00:00 2001
From: Xisco Fauli <xiscofauli@libreoffice.org>
Date: Tue, 2 Sep 2025 10:42:44 +0200
Subject: [PATCH] poppler: upgrade to 25.09.0

Downloaded from https://poppler.freedesktop.org/poppler-25.09.0.tar.xz

Change-Id: Ic7f3abd64d129543dcdc370816a0d69e5a59be90
Reviewed-on: https://gerrit.libreoffice.org/c/core/+/190513
Tested-by: Jenkins
Reviewed-by: Xisco Fauli <xiscofauli@libreoffice.org>
---
 download.lst                                         |  4 ++--
 external/poppler/poppler-config.patch.1              | 12 ++++++------
 .../source/pdfimport/xpdfwrapper/pdfioutdev_gpl.cxx  | 12 ++++++++++++
 .../source/pdfimport/xpdfwrapper/pdfioutdev_gpl.hxx  |  8 ++++++++
 4 files changed, 28 insertions(+), 8 deletions(-)

Index: libreoffice-25.8.1.1/download.lst
===================================================================
--- libreoffice-25.8.1.1.orig/download.lst
+++ libreoffice-25.8.1.1/download.lst
@@ -584,8 +584,8 @@ LIBTIFF_TARBALL := tiff-4.7.0.tar.xz
 # three static lines
 # so that git cherry-pick
 # will not run into conflicts
-POPPLER_SHA256SUM := 425ed4d4515a093bdcdbbaac6876f20617451edc710df6a4fd6c45dd67eb418d
-POPPLER_TARBALL := poppler-25.08.0.tar.xz
+POPPLER_SHA256SUM := 758abfe0c77108c72d654b291dfbce54964b5315a53028e3875f07ef55ff20a3
+POPPLER_TARBALL := poppler-25.09.0.tar.xz
 POPPLER_DATA_SHA256SUM := c835b640a40ce357e1b83666aabd95edffa24ddddd49b8daff63adb851cdab74
 POPPLER_DATA_TARBALL := poppler-data-0.4.12.tar.gz
 # three static lines
Index: libreoffice-25.8.1.1/external/poppler/poppler-config.patch.1
===================================================================
--- libreoffice-25.8.1.1.orig/external/poppler/poppler-config.patch.1
+++ libreoffice-25.8.1.1/external/poppler/poppler-config.patch.1
@@ -179,7 +179,7 @@ index 0fbd336a..451213f8 100644
 +#define PACKAGE_NAME "poppler"
 +
 +/* Define to the full name and version of this package. */
-+#define PACKAGE_STRING "poppler 25.05.0"
++#define PACKAGE_STRING "poppler 25.09.0"
 +
 +/* Define to the one symbol short name of this package. */
 +#define PACKAGE_TARNAME "poppler"
@@ -188,7 +188,7 @@ index 0fbd336a..451213f8 100644
 +#define PACKAGE_URL ""
 +
 +/* Define to the version of this package. */
-+#define PACKAGE_VERSION "25.05.0"
++#define PACKAGE_VERSION "25.09.0"
 +
 +/* Poppler data dir */
 +#define POPPLER_DATADIR "/usr/local/share/poppler"
@@ -206,7 +206,7 @@ index 0fbd336a..451213f8 100644
 +/* #undef USE_FLOAT */
 +
 +/* Version number of package */
-+#define VERSION "25.05.0"
++#define VERSION "25.09.0"
 +
 +#if defined(__APPLE__)
 +#elif defined (_WIN32)
@@ -290,7 +290,7 @@ index 0fbd336a..451213f8 100644
 +
 +/* Defines the poppler version. */
 +#ifndef POPPLER_VERSION
-+#define POPPLER_VERSION "25.05.0"
++#define POPPLER_VERSION "25.09.0"
 +#endif
 +
 +/* Use single precision arithmetic in the Splash backend */
@@ -437,9 +437,9 @@ index 0fbd336a..451213f8 100644
 +
 +#include "poppler-global.h"
 +
-+#define POPPLER_VERSION "25.05.0"
++#define POPPLER_VERSION "25.09.0"
 +#define POPPLER_VERSION_MAJOR 25
-+#define POPPLER_VERSION_MINOR 5
++#define POPPLER_VERSION_MINOR 9
 +#define POPPLER_VERSION_MICRO 0
 +
 +namespace poppler
Index: libreoffice-25.8.1.1/sdext/source/pdfimport/xpdfwrapper/pdfioutdev_gpl.cxx
===================================================================
--- libreoffice-25.8.1.1.orig/sdext/source/pdfimport/xpdfwrapper/pdfioutdev_gpl.cxx
+++ libreoffice-25.8.1.1/sdext/source/pdfimport/xpdfwrapper/pdfioutdev_gpl.cxx
@@ -1249,11 +1253,19 @@ void PDFOutDev::setSkipImages( bool bSki
 
 #if POPPLER_CHECK_VERSION(21, 3, 0)
 poppler_bool PDFOutDev::tilingPatternFill(GfxState *state, Gfx *, Catalog *,
+#if POPPLER_CHECK_VERSION(25, 9, 0)
+                                          GfxTilingPattern *tPat, const std::array<double, 6> &mat,
+#else
                                           GfxTilingPattern *tPat, const double *mat,
+#endif
                                           int x0, int y0, int x1, int y1,
                                           double xStep, double yStep)
 {
+#if POPPLER_CHECK_VERSION(25, 9, 0)
+    const std::array<double, 4> pBbox = tPat->getBBox();
+#else
     const double *pBbox = tPat->getBBox();
+#endif
     const int nPaintType = tPat->getPaintType();
     Dict *pResDict = tPat->getResDict();
     Object *aStr = tPat->getContentStream();
Index: libreoffice-25.8.1.1/sdext/source/pdfimport/xpdfwrapper/pdfioutdev_gpl.hxx
===================================================================
--- libreoffice-25.8.1.1.orig/sdext/source/pdfimport/xpdfwrapper/pdfioutdev_gpl.hxx
+++ libreoffice-25.8.1.1/sdext/source/pdfimport/xpdfwrapper/pdfioutdev_gpl.hxx
@@ -287,7 +287,11 @@ namespace pdfi
 #if POPPLER_CHECK_VERSION(21, 3, 0)
         poppler_bool useTilingPatternFill() override { return true; };
         poppler_bool tilingPatternFill(GfxState *state, Gfx *gfx, Catalog *cat,
+#if POPPLER_CHECK_VERSION(25, 9, 0)
+                                       GfxTilingPattern *tPat, const std::array<double, 6> &mat,
+#else
                                        GfxTilingPattern *tPat, const double *mat,
+#endif
                                        int x0, int y0, int x1, int y1,
                                        double xStep, double yStep) override;
 #endif

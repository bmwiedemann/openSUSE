From 85a60cfe498f278087edbf88d221929a32e8f2e9 Mon Sep 17 00:00:00 2001
From: =?UTF-8?q?Tom=C3=A1=C5=A1=20Chv=C3=A1tal?= <tchvatal@suse.com>
Date: Mon, 19 Aug 2019 13:30:23 +0200
Subject: [PATCH] Fix buidling with older boost

Change-Id: I49691e8bf708aa9146d5c4f61532e7a215f4ac2d
---
 sw/source/core/layout/calcmove.cxx | 8 ++++++++
 sw/source/core/layout/flowfrm.cxx  | 4 ++++
 2 files changed, 12 insertions(+)

diff --git a/sw/source/core/layout/calcmove.cxx b/sw/source/core/layout/calcmove.cxx
index 1856e6b69d40..ff2befe5d969 100644
--- a/sw/source/core/layout/calcmove.cxx
+++ b/sw/source/core/layout/calcmove.cxx
@@ -409,12 +409,20 @@ void SwFrame::PrepareCursor()
 
         if ( bTab )
         {
+#if BOOST_VERSION < 105600
+            tabGuard.reset(static_cast<SwTabFrame*>(this)); // tdf#125741
+#else
             tabGuard.emplace(static_cast<SwTabFrame*>(this)); // tdf#125741
+#endif
             pThis = static_cast<SwTabFrame*>(this);
         }
         else if (IsRowFrame())
         {
+#if BOOST_VERSION < 105600
+            rowGuard.reset(SwFrameDeleteGuard(this)); // tdf#125741 keep this alive
+#else
             rowGuard.emplace(this); // tdf#125741 keep this alive
+#endif
         }
         else if( IsSctFrame() )
         {
diff --git a/sw/source/core/layout/flowfrm.cxx b/sw/source/core/layout/flowfrm.cxx
index 6c9e61595f23..dbe7d9c7feec 100644
--- a/sw/source/core/layout/flowfrm.cxx
+++ b/sw/source/core/layout/flowfrm.cxx
@@ -2527,7 +2527,11 @@ bool SwFlowFrame::MoveBwd( bool &rbReformat )
                     && pTabFrame->GetFirstNonHeadlineRow() == m_rThis.GetUpper()->GetUpper())
                 {
                     // lock follow-flow-row (similar to sections above)
+#if BOOST_VERSION < 105600
+                    g.reset(SwFrameDeleteGuard(m_rThis.GetUpper()->GetUpper()));
+#else
                     g.emplace(m_rThis.GetUpper()->GetUpper());
+#endif
                     assert(m_rThis.GetUpper()->GetUpper()->IsDeleteForbidden());
                 }
             }
-- 
2.22.0


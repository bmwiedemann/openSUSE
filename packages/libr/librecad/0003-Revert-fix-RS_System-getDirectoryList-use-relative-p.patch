From: Jiri Slaby <jslaby@suse.cz>
Date: Sat, 1 Jan 2022 17:36:28 +0100
Subject: Revert "fix: RS_System::getDirectoryList() - use relative paths for
 AppImage"
Patch-mainline: waiting for fix
References: paths fix

This reverts commit e666fb172e3497dd00435ff435cc6d5177f3b8ee.

Signed-off-by: Jiri Slaby <jslaby@suse.cz>
---
 librecad/src/lib/engine/rs_system.cpp | 20 ++++++++------------
 librecad/src/lib/engine/rs_system.h   |  1 -
 2 files changed, 8 insertions(+), 13 deletions(-)

diff --git a/librecad/src/lib/engine/rs_system.cpp b/librecad/src/lib/engine/rs_system.cpp
index b0a346303038..7437e0d44e2c 100644
--- a/librecad/src/lib/engine/rs_system.cpp
+++ b/librecad/src/lib/engine/rs_system.cpp
@@ -60,7 +60,6 @@ void RS_System::init(const QString& appName, const QString& appVersion,
     else {
         this->appDir = appDir;
     }
-    binDir = QCoreApplication::applicationDirPath();
 
     RS_DEBUG->print("RS_System::init: System %s initialized.", appName.toLatin1().data());
     RS_DEBUG->print("RS_System::init: App dir: %s", appDir.toLatin1().data());
@@ -544,7 +543,7 @@ QStringList RS_System::getFileList(const QString& subDirectory,
 
 /**
  * @return List of all directories in subdirectory 'subDirectory' in
- * all possible LibreCAD directories.
+ * all possible QCad directories.
  */
 QStringList RS_System::getDirectoryList(const QString& _subDirectory) {
     QStringList dirList;
@@ -569,22 +568,19 @@ QStringList RS_System::getDirectoryList(const QString& _subDirectory) {
         }
     }
 
-#ifdef Q_OS_UNIX
-    RS_DEBUG->print( RS_Debug::D_ERROR, "RS_System::getDirectoryList: %s", binDir.toStdString().c_str());
-    // for AppImage use relative paths from executable
-    // from packet manager the executable is in /usr/bin
-    // in AppImage the executable is APPDIR/usr/bin
-    // so this should work for paket manager and AppImage distribution
-    dirList.append( QDir::cleanPath( binDir + "/../share/doc/" + appDirName + "/" + subDirectory));
+    // Ubuntu
+    dirList.append( "/usr/share/doc/" + appDirName + "/" + subDirectory);
 
     // Redhat style:
-    dirList.append( QDir::cleanPath( binDir + "/../share/" + appDirName + "/" + subDirectory));
-#endif
+    dirList.append( "/usr/share/" + appDirName + "/" + subDirectory);
+
+    // Others, RVT April 25, 2011 removed, doesn anybody use that still?
+    // dirList.append("/usr/X11R6/share/" + appDirName + "/" + subDirectory);
 
 #ifdef Q_OS_MAC
     // Apple uses the resource directory
     if (!appDir.isEmpty() && appDir!="/") {
-        dirList.append( QDir::cleanPath( appDir + "/../Resources/" + subDirectory));
+        dirList.append( appDir + "/../Resources/" + subDirectory);
     }
 #endif
 
diff --git a/librecad/src/lib/engine/rs_system.h b/librecad/src/lib/engine/rs_system.h
index 745ffdbde646..cceb46280fc6 100644
--- a/librecad/src/lib/engine/rs_system.h
+++ b/librecad/src/lib/engine/rs_system.h
@@ -197,7 +197,6 @@ protected:
     QString appVersion;
     QString appDirName;
     QString appDir;
-    QString binDir;
 
     QStringList languageList;   //< List of available translations
     bool initialized;
-- 
2.34.1


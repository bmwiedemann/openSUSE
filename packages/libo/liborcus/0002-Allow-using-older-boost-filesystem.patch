From 24e8e72332c5784c3b2a0566ecaae74b7d0a7559 Mon Sep 17 00:00:00 2001
From: =?UTF-8?q?Fridrich=20=C5=A0trba?= <fridrich.strba@bluewin.ch>
Date: Fri, 11 Aug 2023 12:24:26 +0200
Subject: [PATCH 2/3] Allow using older boost::filesystem

---
 src/liborcus/format_detection_test.cpp    | 3 ++-
 src/liborcus/json_structure_tree_test.cpp | 3 ++-
 2 files changed, 4 insertions(+), 2 deletions(-)

diff --git a/src/liborcus/format_detection_test.cpp b/src/liborcus/format_detection_test.cpp
index c62ec8a2..5026624c 100644
--- a/src/liborcus/format_detection_test.cpp
+++ b/src/liborcus/format_detection_test.cpp
@@ -57,8 +57,9 @@ void test_invalids()
         // Bail out silently.
         return;
 
-    for (const fs::path& p : fs::directory_iterator(root_dir))
+    for (fs::directory_iterator itr(root_dir); itr!=fs::directory_iterator(); ++itr)
     {
+        const fs::path& p = itr->path();
         orcus::file_content content(p.string());
         assert(!content.empty());
 
diff --git a/src/liborcus/json_structure_tree_test.cpp b/src/liborcus/json_structure_tree_test.cpp
index d71bb214..0dd899ae 100644
--- a/src/liborcus/json_structure_tree_test.cpp
+++ b/src/liborcus/json_structure_tree_test.cpp
@@ -49,8 +49,9 @@ void test_no_value_nodes()
 {
     fs::path base_dir(SRCDIR"/test/json-structure/no-value-nodes");
 
-    for (const fs::path& p : fs::directory_iterator(base_dir))
+    for (fs::directory_iterator itr(base_dir); itr!=fs::directory_iterator(); ++itr)
     {
+        const fs::path& p = itr->path();
         if (!fs::is_regular_file(p))
             continue;
 
-- 
2.41.0


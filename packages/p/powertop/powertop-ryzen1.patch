From 798eb463d419941fa014ada1f863d769650351c7 Mon Sep 17 00:00:00 2001
From: simewu <simeonwuthier@gmail.com>
Date: Mon, 27 Sep 2021 18:25:45 -0600
Subject: [PATCH] Patch for compatibility with Ryzen processors

---
 src/cpu/cpu.cpp | 6 ++++++
 1 file changed, 6 insertions(+)

diff --git a/src/cpu/cpu.cpp b/src/cpu/cpu.cpp
index a92f111..c09cbc5 100644
--- a/src/cpu/cpu.cpp
+++ b/src/cpu/cpu.cpp
@@ -576,6 +576,12 @@ void report_display_cpu_cstates(void)
 							}
 						}
 					} else {
+						/*
+						 * Patch for compatibility with Ryzen processors
+						 * See https://github.com/fenrus75/powertop/issues/64
+						*/
+						if(idx2 >= core_tbl_size.cols * core_tbl_size.rows) break;
+						
 						tmp_str=string(_core->fill_cstate_name(line, buffer));
 						core_data[idx2]=(tmp_str=="" ? "&nbsp;" : tmp_str);
 						idx2+=1;

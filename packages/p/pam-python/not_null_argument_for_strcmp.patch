--- pam-python-1.0.6/src/pam_python.c	2016-08-27 14:27:10.000000000 +0200
+++ pam-python-1.0.6/src/pam_python.c	2017-10-05 14:06:51.377228092 +0200
@@ -2226,6 +2226,10 @@
     goto error_exit;
   }
   dot = strrchr(user_module_name, '.');
+  #ifndef dot
+   *dot = '\0';
+  #endif
+
   if (dot != 0 || strcmp(dot, ".py") == 0)
     *dot = '\0';
   *user_module = PyModule_New(user_module_name);

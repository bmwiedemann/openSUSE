From 112598d44ee682553c2540b853f9626085b8df2c Mon Sep 17 00:00:00 2001
From: Nicolas Simonds <nisimond@cisco.com>
Date: Wed, 4 Jan 2023 09:11:51 -0800
Subject: [PATCH] Remove vestigial future package from requirements

This package appears to be a holdover from dropping Python 2.x
support, and is no longer needed.

This resolves https://nvd.nist.gov/vuln/detail/CVE-2022-40899

Also update tox.ini to work wirth modern vintages of tox.
---
 requirements.txt          | 1 -
 stestr/repository/file.py | 2 +-
 tox.ini                   | 4 +++-
 3 files changed, 4 insertions(+), 3 deletions(-)

diff --git a/requirements.txt b/requirements.txt
index 26797119..55149fed 100644
--- a/requirements.txt
+++ b/requirements.txt
@@ -1,7 +1,6 @@
 # The order of packages is significant, because pip processes them in the order
 # of appearance. Changing the order has an impact on the overall integration
 # process, which may cause wedges in the gate later.
-future
 pbr!=2.1.0,>=2.0.0,!=4.0.0,!=4.0.1,!=4.0.2,!=4.0.3 # Apache-2.0
 cliff>=2.8.0 # Apache-2.0
 python-subunit>=1.4.0 # Apache-2.0/BSD
diff --git a/stestr/repository/file.py b/stestr/repository/file.py
index 6ecf1ec6..581e45a6 100644
--- a/stestr/repository/file.py
+++ b/stestr/repository/file.py
@@ -19,7 +19,7 @@
 import sys
 import tempfile
 
-from future.moves.dbm import dumb as my_dbm
+from dbm import dumb as my_dbm
 from subunit import TestProtocolClient
 import subunit.v2
 import testtools
diff --git a/tox.ini b/tox.ini
index 3f04e2d1..69b42b34 100644
--- a/tox.ini
+++ b/tox.ini
@@ -7,7 +7,9 @@ skipsdist = True
 usedevelop = True
 install_command = pip install -U --force-reinstall {opts} {packages}
 setenv = VIRTUAL_ENV={envdir}
-whitelist_externals = find
+allowlist_externals =
+    find
+    stestr
 deps = -r{toxinidir}/requirements.txt
        -r{toxinidir}/test-requirements.txt
 commands =

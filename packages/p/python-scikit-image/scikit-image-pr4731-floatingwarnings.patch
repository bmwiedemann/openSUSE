From 9c4c033949582868903edcbcf721a50f0e1eca30 Mon Sep 17 00:00:00 2001
From: rfezzani <rfezzani@gmail.com>
Date: Wed, 20 May 2020 13:04:32 +0200
Subject: [PATCH 1/2] Prevent type convertion to np.floating

---
 skimage/util/dtype.py | 2 ++
 1 file changed, 2 insertions(+)

diff --git a/skimage/util/dtype.py b/skimage/util/dtype.py
index d76fb2c5d8..8e6c00b4bf 100644
--- a/skimage/util/dtype.py
+++ b/skimage/util/dtype.py
@@ -244,6 +244,8 @@ def _convert(image, dtype, force_copy=False, uniform=False):
         if force_copy:
             image = image.copy()
         return image
+    else:
+        dtype = np.float64
 
     if not (dtype_in in _supported_types and dtype_out in _supported_types):
         raise ValueError("Can not convert from {} to {}."

From b0886dbdbf3031e0c13932942892b33c3cbc9b1c Mon Sep 17 00:00:00 2001
From: rfezzani <rfezzani@gmail.com>
Date: Wed, 20 May 2020 23:46:23 +0200
Subject: [PATCH 2/2] Fix conversion to np.floating

---
 skimage/util/dtype.py | 7 ++++---
 1 file changed, 4 insertions(+), 3 deletions(-)

diff --git a/skimage/util/dtype.py b/skimage/util/dtype.py
index 8e6c00b4bf..47dc0a8144 100644
--- a/skimage/util/dtype.py
+++ b/skimage/util/dtype.py
@@ -223,7 +223,10 @@ def _convert(image, dtype, force_copy=False, uniform=False):
     """
     image = np.asarray(image)
     dtypeobj_in = image.dtype
-    dtypeobj_out = np.dtype(dtype)
+    if dtype is np.floating:
+        dtypeobj_out = np.dtype('float64')
+    else:
+        dtypeobj_out = np.dtype(dtype)
     dtype_in = dtypeobj_in.type
     dtype_out = dtypeobj_out.type
     kind_in = dtypeobj_in.kind
@@ -244,8 +247,6 @@ def _convert(image, dtype, force_copy=False, uniform=False):
         if force_copy:
             image = image.copy()
         return image
-    else:
-        dtype = np.float64
 
     if not (dtype_in in _supported_types and dtype_out in _supported_types):
         raise ValueError("Can not convert from {} to {}."

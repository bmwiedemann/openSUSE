From cfeeda14f945e045d67790d176ff9cfc9afac0ff Mon Sep 17 00:00:00 2001
From: Juan Nunez-Iglesias <juan.nunez-iglesias@monash.edu>
Date: Sun, 7 Jul 2019 04:13:24 +1000
Subject: Update exposure for dask and np 1.17 compat

---
 skimage/exposure/exposure.py | 4 ++--
 1 file changed, 2 insertions(+), 2 deletions(-)

diff --git a/skimage/exposure/exposure.py b/skimage/exposure/exposure.py
index 354e00ea15..caa87cb1e9 100644
--- a/skimage/exposure/exposure.py
+++ b/skimage/exposure/exposure.py
@@ -61,8 +61,8 @@
     if source_range not in ['image', 'dtype']:
         raise ValueError('Incorrect value for `source_range` argument: {}'.format(source_range))
     if source_range == 'image':
-        image_min = np.min(image).astype(np.int64)
-        image_max = np.max(image).astype(np.int64)
+        image_min = int(image.min().astype(np.int64))
+        image_max = int(image.max().astype(np.int64))
     elif source_range == 'dtype':
         image_min, image_max = dtype_limits(image, clip_negative=False)
     image, offset = _offset_array(image, image_min, image_max)

From 6e560620fd1913e4953dff0e4a1cd4bf4ae04b37 Mon Sep 17 00:00:00 2001
From: Juan Nunez-Iglesias <juan.nunez-iglesias@monash.edu>
Date: Sun, 7 Jul 2019 07:27:42 -0500
Subject: Skip arraypad TypeError if mode not set in np 1.17+

---
 skimage/util/tests/test_arraypad.py | 4 ++++
 1 file changed, 4 insertions(+)

diff --git a/skimage/util/tests/test_arraypad.py b/skimage/util/tests/test_arraypad.py
index 73ddf4221c..b5b1cd92de 100644
--- a/skimage/util/tests/test_arraypad.py
+++ b/skimage/util/tests/test_arraypad.py
@@ -1,5 +1,7 @@
+from distutils.version import LooseVersion
 
 import numpy as np
+# note: skimage.util.pad is just numpy.pad
 from skimage.util import pad
 
 from skimage._shared import testing
@@ -989,6 +991,8 @@ def test_check_kwarg_not_allowed(self):
         with testing.raises(ValueError):
             pad(arr, 4, mode='mean', reflect_type='odd')
 
+    @testing.skipif(LooseVersion(np.__version__) >= LooseVersion('1.17'),
+                    reason='Error removed in NumPy 1.17')
     def test_mode_not_set(self):
         arr = np.arange(30).reshape(5, 6)
         with testing.raises(TypeError):

From ac6c2052e41462714431946cf13cee28967082b4 Mon Sep 17 00:00:00 2001
From: Hasan Ramezani <hasan.r67@gmail.com>
Date: Mon, 21 Oct 2024 11:58:01 +0200
Subject: [PATCH] Add Python 3.13 support and drop Pyhton 3.8 support (#157)

---
 .github/workflows/test.yml | 6 +++---
 CHANGELOG.md               | 5 +++++
 appveyor.yml               | 3 ++-
 setup.py                   | 4 ++--
 tests/test_jdatetime.py    | 2 +-
 tox.ini                    | 4 ++--
 6 files changed, 15 insertions(+), 9 deletions(-)

diff --git a/.github/workflows/test.yml b/.github/workflows/test.yml
index 1e08035..385b9d4 100644
--- a/.github/workflows/test.yml
+++ b/.github/workflows/test.yml
@@ -12,7 +12,7 @@ jobs:
     strategy:
       matrix:
         os: [ubuntu-latest]
-        python-version: ["3.8", "3.9", "3.10", "3.11", "3.12"]
+        python-version: ["3.9", "3.10", "3.11", "3.12", "3.13"]
     name: OS ${{ matrix.os}} - Python ${{ matrix.python-version }}
     steps:
       - uses: actions/checkout@v2
@@ -37,7 +37,7 @@ jobs:
       - name: Setup python
         uses: actions/setup-python@v2
         with:
-          python-version: "3.8"
+          python-version: "3.9"
           architecture: x64
       - name: Install dependencies
         run: |
@@ -54,7 +54,7 @@ jobs:
       - name: Setup python
         uses: actions/setup-python@v2
         with:
-          python-version: "3.8"
+          python-version: "3.9"
           architecture: x64
       - name: Install dependencies
         run: |
diff --git a/CHANGELOG.md b/CHANGELOG.md
index 87f1734..b0ed6ae 100644
--- a/CHANGELOG.md
+++ b/CHANGELOG.md
@@ -1,5 +1,10 @@
 # Changelog
 
+### Add
+* Drop Python 3.8 support
+* Add support for Python 3.13
+
+
 ## [5.0.0] - 2024-03-26
 
 ### Add
diff --git a/appveyor.yml b/appveyor.yml
index 8652d7f..c3122c7 100644
--- a/appveyor.yml
+++ b/appveyor.yml
@@ -2,7 +2,6 @@ build: false
 
 environment:
   matrix:
-    - PYTHON: "C:\\Python38"
     - PYTHON: "C:\\Python39"
       APPVEYOR_BUILD_WORKER_IMAGE: Visual Studio 2019
     - PYTHON: "C:\\Python310"
@@ -11,6 +10,8 @@ environment:
       APPVEYOR_BUILD_WORKER_IMAGE: Visual Studio 2019
     - PYTHON: "C:\\Python312"
       APPVEYOR_BUILD_WORKER_IMAGE: Visual Studio 2019
+    - PYTHON: "C:\\Python313"
+      APPVEYOR_BUILD_WORKER_IMAGE: Visual Studio 2019
 
 init:
   - "ECHO %PYTHON% %PYTHON_VERSION% %PYTHON_ARCH%"
diff --git a/setup.py b/setup.py
index 3c6c123..8827626 100644
--- a/setup.py
+++ b/setup.py
@@ -14,18 +14,18 @@
     description=("Jalali datetime binding for python"),
     url="https://github.com/slashmili/python-jalali",
     long_description=open('README').read(),
-    python_requires=">=3.8",
+    python_requires=">=3.9",
     install_requires=["jalali-core>=1.0"],
     classifiers=[
         "Intended Audience :: Developers",
         "Intended Audience :: System Administrators",
         "Operating System :: OS Independent",
         "Programming Language :: Python",
-        "Programming Language :: Python :: 3.8",
         "Programming Language :: Python :: 3.9",
         "Programming Language :: Python :: 3.10",
         "Programming Language :: Python :: 3.11",
         "Programming Language :: Python :: 3.12",
+        "Programming Language :: Python :: 3.13",
         "Topic :: Software Development",
     ],
 )
diff --git a/tests/test_jdatetime.py b/tests/test_jdatetime.py
index a9e69ec..76d62fe 100644
--- a/tests/test_jdatetime.py
+++ b/tests/test_jdatetime.py
@@ -645,7 +645,7 @@ def reset_locale(self):
         if platform.system() == 'Windows':
             locale.setlocale(locale.LC_ALL, 'English_United States')
         else:
-            locale.resetlocale()
+            locale.setlocale(locale.LC_ALL, '')
 
     def test_with_fa_locale(self):
         self.set_fa_locale()
diff --git a/tox.ini b/tox.ini
index 73c4000..751b30b 100644
--- a/tox.ini
+++ b/tox.ini
@@ -1,16 +1,16 @@
 [tox]
 envlist =
-    py{38,39,310,311,312}
+    py{39,310,311,312,313}
     flake8
     isort
 
 [gh-actions]
 python =
-    3.8: py38
     3.9: py39
     3.10: py310
     3.11: py311
     3.12: py312
+    3.13: py313
 
 [testenv]
 deps =

From 7d4cbabc5f450ac4d9e228d79778c21805136b2c Mon Sep 17 00:00:00 2001
From: dieter <dieter.maurer@online.de>
Date: Sat, 18 May 2024 07:12:53 +0200
Subject: [PATCH] Fix test failure for Python3.13b1

---
 CHANGES.rst                                       |  3 +++
 .../components/logger/tests/test_logger.py        | 15 +++++++++++++--
 2 files changed, 16 insertions(+), 2 deletions(-)

--- a/src/ZConfig/components/logger/tests/test_logger.py
+++ b/src/ZConfig/components/logger/tests/test_logger.py
@@ -699,8 +699,19 @@ def test_filehandler_reopen_thread_safety(self):
         h = self.handler_factory(fn)
 
         calls = []
-        h.acquire = lambda: calls.append("acquire")
-        h.release = lambda: calls.append("release")
+
+        class _LockMockup:
+            def acquire(*args, **kw):
+                calls.append("acquire")
+
+            __enter__ = acquire
+
+            def release(*args, **kw):
+                calls.append("release")
+
+            __exit__ = release
+
+        h.lock = _LockMockup()
 
         h.reopen()
         self.assertEqual(calls, ["acquire", "release"])

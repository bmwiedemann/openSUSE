From b12a791f6f8fc8a2b920e2ccb2d8ae2dae79dba0 Mon Sep 17 00:00:00 2001
From: Antony Lee <anntzer.lee@gmail.com>
Date: Mon, 20 Jan 2020 08:47:58 +0100
Subject: [PATCH] Fix against use of unicode minus in mpl3.2.

---
 lib/mplcursors/_pick_info.py | 10 ++++++++--
 1 file changed, 8 insertions(+), 2 deletions(-)

Index: mplcursors-0.3/lib/mplcursors/_pick_info.py
===================================================================
--- mplcursors-0.3.orig/lib/mplcursors/_pick_info.py
+++ mplcursors-0.3/lib/mplcursors/_pick_info.py
@@ -632,10 +632,16 @@ def _(sel):
                          for e in err]
                 # We'd normally want to check err.sum() == 0, but that can run
                 # into fp inaccuracies.
-                if len({s.lstrip("+-") for s in err_s}) == 1:
+                signs = "+-\N{MINUS SIGN}"
+                if len({s.lstrip(signs) for s in err_s}) == 1:
                     repl = rf"\1=$\2\\pm{err_s[1]}$\3"
                 else:
-                    err_s = [("+" if not s.startswith(("+", "-")) else "") + s
+                    # Replacing unicode minus by ascii minus don't change the
+                    # rendering as the string is mathtext, but allows keeping
+                    # the same tests across Matplotlib versions that use
+                    # unicode minus and those that don't.
+                    err_s = [("+" if not s.startswith(tuple(signs)) else "")
+                             + s.replace("\N{MINUS SIGN}", "-")
                              for s in err_s]
                     repl = r"\1=$\2_{%s}^{%s}$\3" % tuple(err_s)
                 ann_text = re.sub(f"({dir})=(.*)(\n?)", repl, ann_text)

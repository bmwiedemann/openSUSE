From 179e69774584163a7827b5ee23f1e0096d7eeec3 Mon Sep 17 00:00:00 2001
From: =?UTF-8?q?Michael=20J=C3=A4ger?= <jaeger@mfk.fau.de>
Date: Tue, 29 Aug 2023 16:15:42 +0200
Subject: [PATCH] Fix breaking changes in isspmatrix of scipy >=1.11.0,
 discontinuing compatibility with csc_array

Details see https://github.com/scipy/scipy/pull/18528
---
 sksparse/cholmod.pyx | 4 ++--
 1 file changed, 2 insertions(+), 2 deletions(-)

diff --git a/sksparse/cholmod.pyx b/sksparse/cholmod.pyx
index 861029d..9eceb8c 100644
--- a/sksparse/cholmod.pyx
+++ b/sksparse/cholmod.pyx
@@ -403,12 +403,12 @@ cdef void _error_handler(
         warnings.warn(full_msg, CholmodWarning)
 
 def _check_for_csc(m):
-    if not sparse.isspmatrix_csc(m):
+    if not sparse.isspmatrix_csc(m) or isinstance(m, sparse.csc_array):
         warnings.warn("converting matrix of class %s to CSC format"
                       % (m.__class__.__name__,),
                       CholmodTypeConversionWarning)
         m = m.tocsc()
-    assert sparse.isspmatrix_csc(m)
+    assert sparse.isspmatrix_csc(m) or isinstance(m, sparse.csc_array)
     return m
 
 cdef class Common:

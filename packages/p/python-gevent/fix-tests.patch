From: Antonio Larrosa <alarrosa@suse.com>
Subject: Fix failing tests

- ssl.OP_NO_COMPRESSION is set by default by ssl.
- thread_ident can be represented as a negative hex number now,
  so replace the negative sign with the regex too, and not just the number.
--- a/src/greentest/2.7/test_ssl.py
+++ b/src/greentest/2.7/test_ssl.py
@@ -835,9 +835,10 @@ class ContextTests(unittest.TestCase):
     def test_options(self):
         ctx = ssl.SSLContext(ssl.PROTOCOL_TLSv1)
         # OP_ALL | OP_NO_SSLv2 | OP_NO_SSLv3 is the default value
-        default = (ssl.OP_ALL | ssl.OP_NO_SSLv2 | ssl.OP_NO_SSLv3)
+        default = (ssl.OP_ALL | ssl.OP_NO_SSLv2 | ssl.OP_NO_SSLv3 |
+                   OP_NO_COMPRESSION)
         # SSLContext also enables these by default
-        default |= (OP_NO_COMPRESSION | OP_CIPHER_SERVER_PREFERENCE |
+        default |= (OP_CIPHER_SERVER_PREFERENCE |
                     OP_SINGLE_DH_USE | OP_SINGLE_ECDH_USE |
                     OP_ENABLE_MIDDLEBOX_COMPAT)
         self.assertEqual(default, ctx.options)
--- a/src/gevent/tests/test__util.py
+++ b/src/gevent/tests/test__util.py
@@ -134,7 +134,7 @@ class TestTree(greentest.TestCase):
 
     def _normalize_tree_format(self, value):
         import re
-        hexobj = re.compile('0x[0123456789abcdef]+L?', re.I)
+        hexobj = re.compile('-?0x[0123456789abcdef]+L?', re.I)
         value = hexobj.sub('X', value)
         value = value.replace('epoll', 'select')
         value = value.replace('select', 'default')

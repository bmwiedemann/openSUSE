------------------------------------------------------------------------
r1963 | mabri | 2019-02-03 01:00:23 +0100 (dom 03 de feb de 2019) | 1 línea

Fix (security) issue #39

Index: src/doc/PdfNamesTree.cpp
===================================================================
--- src/doc/PdfNamesTree.cpp	(revisión: 1962)
+++ src/doc/PdfNamesTree.cpp	(revisión: 1963)
@@ -504,7 +504,17 @@
             // convert all strings into names 
             PdfName name( (*it).GetString().GetString() );
             ++it;
-            rDict.AddKey( name, *(it) );
+            // fixes (security) issue #39 in PoDoFo's tracker (sourceforge.net)
+            if ( it == names.end() )
+            {
+                PdfError::LogMessage( eLogSeverity_Warning,
+                                "No reference in /Names array last element in "
+                                "object %lu %lu, possible\nexploit attempt!\n",
+                                pObj->Reference().ObjectNumber(),
+                                pObj->Reference().GenerationNumber() );
+                break;
+            }
+            rDict.AddKey( name, (*it) );
             ++it;
         }
         

------------------------------------------------------------------------

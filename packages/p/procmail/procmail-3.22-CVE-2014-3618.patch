BNC#894999 - VUL-0: procmail: CVE-2014-3618 procmail: Heap-overflow in
   procmail's formail utility when processing specially-crafted email headers
---
 src/formisc.c |    7 ++++---
 1 file changed, 4 insertions(+), 3 deletions(-)

--- src/formisc.c
+++ src/formisc.c	2014-09-04 08:27:31.827152957 +0000
@@ -83,13 +83,14 @@ normal:	   *target++= *start++;
 	   break;
 	case '"':*target++=delim='"';start++;
       }
-     ;{ int i;
-	do
+      {
+	while(*start)						/* anything? */
+	 { int i;
 	   if((i= *target++= *start++)==delim)	 /* corresponding delimiter? */
 	      break;
 	   else if(i=='\\'&&*start)		    /* skip quoted character */
 	      *target++= *start++;
-	while(*start);						/* anything? */
+	 }
       }
      hitspc=2;
    }

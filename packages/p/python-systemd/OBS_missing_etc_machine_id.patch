From 50d1ec8ab8d3333ef1b7cac982155b94c7534c4c Mon Sep 17 00:00:00 2001
From: =?UTF-8?q?Zbigniew=20J=C4=99drzejewski-Szmek?= <zbyszek@in.waw.pl>
Date: Wed, 17 Aug 2022 09:53:25 +0200
Subject: [PATCH] tests: check for errnos that sd_id128_get_machine actually
 returns

Fixes #118.
---
 systemd/test/test_id128.py | 7 ++++---
 1 file changed, 4 insertions(+), 3 deletions(-)

diff --git a/systemd/test/test_id128.py b/systemd/test/test_id128.py
index 146ec73..f5fc65f 100644
--- a/systemd/test/test_id128.py
+++ b/systemd/test/test_id128.py
@@ -6,11 +6,11 @@
 from systemd import id128
 
 @contextlib.contextmanager
-def skip_oserror(code):
+def skip_oserror(*errnos):
     try:
         yield
     except (OSError, IOError) as e:
-        if e.errno == code:
+        if e.errno in errnos:
             pytest.skip()
         raise
 
@@ -29,7 +29,8 @@ def test_get_machine_app_specific():
     a1 = uuid.uuid1()
     a2 = uuid.uuid1()
 
-    with skip_oserror(errno.ENOSYS):
+    # yikes, python2 doesn't know ENOMEDIUM
+    with skip_oserror(errno.ENOENT, 123):
         u1 = id128.get_machine_app_specific(a1)
 
     u2 = id128.get_machine_app_specific(a2)

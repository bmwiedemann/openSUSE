From 361b5f2b6cbc4be9355edebf8f182599966b3816 Mon Sep 17 00:00:00 2001
From: =?UTF-8?q?Corentin=20No=C3=ABl?= <corentin.noel@collabora.com>
Date: Wed, 5 Mar 2025 14:25:01 +0100
Subject: [PATCH] Adapt to uid_t being an available type since Vala 0.56.17

---
 src/Services/UserManager.vala | 4 ++--
 src/Widgets/UserList.vala     | 4 ++--
 2 files changed, 4 insertions(+), 4 deletions(-)

diff --git a/src/Services/UserManager.vala b/src/Services/UserManager.vala
index 39ed51a..fba800c 100644
--- a/src/Services/UserManager.vala
+++ b/src/Services/UserManager.vala
@@ -35,7 +35,7 @@ public class QuickSettings.UserManager : Object {
         }
     }
 
-    public static async UserState get_user_state (uint32 uuid) {
+    public static async UserState get_user_state (uid_t uuid) {
         if (login_proxy == null) {
             yield init_login_proxy ();
         }
@@ -47,7 +47,7 @@ public class QuickSettings.UserManager : Object {
             }
 
             foreach (UserInfo user in users) {
-                if (user.uid == uuid) {
+                if (((uid_t) user.uid) == uuid) {
                     if (user.user_object == null) {
                         return UserState.OFFLINE;
                     }
diff --git a/src/Widgets/UserList.vala b/src/Widgets/UserList.vala
index d70d395..d90c733 100644
--- a/src/Widgets/UserList.vala
+++ b/src/Widgets/UserList.vala
@@ -7,12 +7,12 @@
     public signal void switch_to_guest ();
     public signal void switch_to_user (string username);
 
-    private const uint GUEST_USER_UID = 999;
+    private const uid_t GUEST_USER_UID = 999;
     private const string DM_DBUS_ID = "org.freedesktop.DisplayManager";
 
 
     private SeatInterface? dm_proxy = null;
-    private Gee.HashMap<uint, UserRow> user_map = new Gee.HashMap<uint, UserRow> ();
+    private Gee.HashMap<uid_t?, UserRow> user_map = new Gee.HashMap<uid_t?, UserRow> ();
 
     private Gtk.ListBox listbox;
     private Gtk.Popover? popover;

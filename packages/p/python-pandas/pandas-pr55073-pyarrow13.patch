From 613e9aa49936cd941e631f8d6ec3ea557f94cc30 Mon Sep 17 00:00:00 2001
From: Ben Greiner <code@bnavigator.de>
Date: Fri, 8 Sep 2023 22:33:47 +0200
Subject: [PATCH] Backport PR #55048: COMPAT: bump pyarrow min version for div
 on duration

---
 pandas/compat/__init__.py            | 2 ++
 pandas/compat/pyarrow.py             | 2 ++
 pandas/tests/extension/test_arrow.py | 3 ++-
 3 files changed, 6 insertions(+), 1 deletion(-)

diff --git a/pandas/compat/__init__.py b/pandas/compat/__init__.py
index be0a762642e46..684e9dccdc0f9 100644
--- a/pandas/compat/__init__.py
+++ b/pandas/compat/__init__.py
@@ -30,6 +30,7 @@
     pa_version_under9p0,
     pa_version_under11p0,
     pa_version_under13p0,
+    pa_version_under14p0,
 )
 
 if TYPE_CHECKING:
@@ -186,6 +187,7 @@ def get_bz2_file() -> type[pandas.compat.compressors.BZ2File]:
     "pa_version_under9p0",
     "pa_version_under11p0",
     "pa_version_under13p0",
+    "pa_version_under14p0",
     "IS64",
     "ISMUSL",
     "PY310",
diff --git a/pandas/compat/pyarrow.py b/pandas/compat/pyarrow.py
index 049ce50920e28..12f58be109d98 100644
--- a/pandas/compat/pyarrow.py
+++ b/pandas/compat/pyarrow.py
@@ -15,6 +15,7 @@
     pa_version_under11p0 = _palv < Version("11.0.0")
     pa_version_under12p0 = _palv < Version("12.0.0")
     pa_version_under13p0 = _palv < Version("13.0.0")
+    pa_version_under14p0 = _palv < Version("14.0.0")
 except ImportError:
     pa_version_under7p0 = True
     pa_version_under8p0 = True
@@ -23,3 +24,4 @@
     pa_version_under11p0 = True
     pa_version_under12p0 = True
     pa_version_under13p0 = True
+    pa_version_under14p0 = True
diff --git a/pandas/tests/extension/test_arrow.py b/pandas/tests/extension/test_arrow.py
index ec2ca494b2aa1..d6e75a57f71e7 100644
--- a/pandas/tests/extension/test_arrow.py
+++ b/pandas/tests/extension/test_arrow.py
@@ -40,6 +40,7 @@
     pa_version_under9p0,
     pa_version_under11p0,
     pa_version_under13p0,
+    pa_version_under14p0,
 )
 
 from pandas.core.dtypes.dtypes import (
@@ -951,7 +952,7 @@ def _is_temporal_supported(self, opname, pa_dtype):
                 or (
                     opname
                     in ("__truediv__", "__rtruediv__", "__floordiv__", "__rfloordiv__")
-                    and not pa_version_under13p0
+                    and not pa_version_under14p0
                 )
             )
             and pa.types.is_duration(pa_dtype)

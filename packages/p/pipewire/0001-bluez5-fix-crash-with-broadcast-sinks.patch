From abfec78c51e36885eccd6f63e07706e758557dae Mon Sep 17 00:00:00 2001
From: Pauli Virtanen <pav@iki.fi>
Date: Sat, 12 Oct 2024 13:32:44 +0300
Subject: [PATCH] bluez5: fix crash with broadcast sinks

---
 spa/plugins/bluez5/bluez5-dbus.c | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

diff --git a/spa/plugins/bluez5/bluez5-dbus.c b/spa/plugins/bluez5/bluez5-dbus.c
index 27d21bb9c4..19d365c41a 100644
--- a/spa/plugins/bluez5/bluez5-dbus.c
+++ b/spa/plugins/bluez5/bluez5-dbus.c
@@ -5504,7 +5504,7 @@ static void interface_added(struct spa_bt_monitor *monitor,
 			spa_autofree char *local_endpoint = NULL;
 			/* get local endpoint */
 
-			for (i = 0; monitor->media_codecs; i++) {
+			for (i = 0; monitor->media_codecs[i]; i++) {
 				if (!monitor->media_codecs[i]->bap)
 					continue;
 				if (!is_media_codec_enabled(monitor, monitor->media_codecs[i]))
-- 
GitLab


From 89fab13c77ba35fd617bd77afd29d373e9fbab4d Mon Sep 17 00:00:00 2001
From: Wim Taymans <wtaymans@redhat.com>
Date: Wed, 30 Aug 2023 09:59:37 +0200
Subject: [PATCH] pulse-server: allow monitors when selecting source by index

Fixes #3476
---
 src/modules/module-protocol-pulse/pulse-server.c | 6 +++++-
 1 file changed, 5 insertions(+), 1 deletion(-)

diff --git a/src/modules/module-protocol-pulse/pulse-server.c b/src/modules/module-protocol-pulse/pulse-server.c
index 09e4a8d2ee..593f47da56 100644
--- a/src/modules/module-protocol-pulse/pulse-server.c
+++ b/src/modules/module-protocol-pulse/pulse-server.c
@@ -2505,8 +2505,12 @@ static struct pw_manager_object *find_device(struct client *client,
 				allow_monitor = true;
 			}
 		}
-	} else if (index == SPA_ID_INVALID)
+	} else if (index != SPA_ID_INVALID) {
+		if (!sink)
+			allow_monitor = true;
+	} else {
 		return NULL;
+	}
 
 
 	spa_zero(sel);
-- 
GitLab


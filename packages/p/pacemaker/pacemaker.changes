-------------------------------------------------------------------
Fri Dec 09 10:57:57 UTC 2022 - Yan Gao <ygao@suse.com>

- Update to version 2.1.5+20221208.a3f44794f (Pacemaker-2.1.5):
- libs: Check for NULL in various functions.
- daemons: Check for NULL in attrd_create_attribute.

-------------------------------------------------------------------
Tue Nov 22 18:32:17 UTC 2022 - Yan Gao <ygao@suse.com>

- Update to version 2.1.4+20221122.631339ca5 (Pacemaker-2.1.5-rc3):
- libcrmcommon: Wait for ACKs from the attrd clear failure command.
- daemons: Fix expanding ++ and += in multi-update IPC messages.
- daemons: Add host attr to the children of multi-update IPC messages.
- daemons: Copy all attrs from parent to child in multi-update IPC.

-------------------------------------------------------------------
Mon Nov 21 07:48:41 UTC 2022 - Yan Gao <ygao@suse.com>

- Update to version 2.1.4+20221115.d3699a621 (Pacemaker-2.1.5-rc2):
- tools: quote timestamp in operation history output (bsc#1205279, bsc#1204581)
- tools: Fix setting utilization attrs with crm_attribute.
- cts-cli: add test for text output of crm_resource --list-operations/-O (bsc#1205279, bsc#1204581)
- daemons: Set an attribute on the child of a multi-attr message.
- scheduler: consider roles when blocking colocation dependents
- scheduler: when blocking starts, block children's starts as well

-------------------------------------------------------------------
Thu Nov 10 09:44:31 UTC 2022 - Yan Gao <ygao@suse.com>

- Update to version 2.1.4+20221108.ba419204a:
- tools: crm_resource --constraints now accepts --force
- tools: crm_resource --constraints --recursive
- tools: fix syntax on resetting options in crm_resource (bsc#1198409)

-------------------------------------------------------------------
Wed Nov 02 12:39:52 UTC 2022 - Yan Gao <ygao@suse.com>

- Update to version 2.1.4+20221031.0b3656e85:
- scheduler: prioritize group colocations properly
- scheduler: ignore empty groups in pcmk__add_colocated_node_scores()
- scheduler: properly consider effect of "with group" colocations
- scheduler: ensure group methods handle empty groups
- scheduler: improve error handling when unpacking resources

-------------------------------------------------------------------
Wed Nov 02 12:02:58 UTC 2022 - Yan Gao <ygao@suse.com>

- Update to version 2.1.4+20221024.844c0640d (Pacemaker-2.1.5-rc1):
- fencer: compare fence action names case-sensitively
- fencer: check "on" support when checking whether device can fence
- fencer: improve eligibility logs
- fencer: improve argument validation and variable names

-------------------------------------------------------------------
Thu Oct 13 21:18:48 UTC 2022 - Yan Gao <ygao@suse.com>

- Update to version 2.1.4+20221012.44db4ca5e:
- libpacemaker: Correct sys_from default in pacemakerd_health()
- tools: crm_mon --one-shot fails while pacemaker is shutting down (CLBZ#5501)
- libpacemaker: Fix pacemakerd-health XML output
- libpacemaker: HTML formatter for pacemakerd-health message
- libpacemaker: Memory leak in pcmk_cluster_queries.c:ipc_connect()
- libpacemaker: pacemakerd-health message accepts state
- libpacemaker: Correct default for pinged_buf in pacemakerd_event_cb
- libcrmcommon: Check invalid time value in pacemakerd API reply
- pacemaker-remoted: fix detection of __progname
- libcrmcommon: avoid memory leak in crm_time_subtract()
- fencer: skip "on" in remapped reboot when agent doesn't support it
- fencer: skip "on" in remapped reboot when pcmk_reboot_action="off"

-------------------------------------------------------------------
Tue Oct 11 09:22:56 UTC 2022 - Yan Gao <ygao@suse.com>

- Update to version 2.1.4+20221010.79db170a4:
- controller: connect before updating node attribute list
- controller: log attribute errors correctly

-------------------------------------------------------------------
Mon Oct 10 12:50:21 UTC 2022 - Yan Gao <ygao@suse.com>

- Update to version 2.1.4+20221006.d82151006:
- various: remove support for versioned agent parameters

-------------------------------------------------------------------
Mon Oct 10 12:43:24 UTC 2022 - Yan Gao <ygao@suse.com>

- Update to version 2.1.4+20221006.5cb4f0b94:
- extra: skip ifspeed agent's host check at default check level
- extra: avoid deprecated command-line option in ifspeed agent
- extra: improve messages in ocf:pacemaker:ifspeed agent
- resources: ifspeed iface parameter is not required
- resources: update ifspeed agent to OCF 1.1
- extra: update ifspeed agent to avoid legacy terminology

-------------------------------------------------------------------
Mon Oct 10 11:11:57 UTC 2022 - Yan Gao <ygao@suse.com>

- Update to version 2.1.4+20221005.8c568f599:
- scheduler: improve resource action ordering messages

-------------------------------------------------------------------
Fri Sep 30 12:10:57 UTC 2022 - Yan Gao <ygao@suse.com>

- Update to version 2.1.4+20220929.708e532ba:
- fencer: don't try to free NULL GString
- scheduler: don't demote on expected node
- libcrmcommon: assert on UUID generation failure

-------------------------------------------------------------------
Fri Sep 30 08:34:20 UTC 2022 - Yan Gao <ygao@suse.com>

- Update to version 2.1.4+20220928.4690461db:
- fenced: Add automatic_list devices to unfencing timeout when topology is presents.
- controld: Add missing option descriptions
- libcrmcommon: copy result reason/stdout/stderr correctly
- executor: work around flag value mistake

- Rebase:
  * bug-728579_pacemaker-stonith-dev-id.patch

-------------------------------------------------------------------
Tue Sep 27 13:08:27 UTC 2022 - Stefan Weiberg <sweiberg@suse.com>

- Rename libraries in accordance to the packaging guidelines to
  solve potential migration issue on SLE 15 SP5 (bsc#1203744)

-------------------------------------------------------------------
Thu Sep 22 10:20:16 UTC 2022 - Yan Gao <ygao@suse.com>

- Update to version 2.1.4+20220920.4313595c6:
- controller: add messages when getting agent metadata
- liblrmd: use resource ID for metadata actions when available
- liblrmd: consider invalid agent specification a fatal error
- libcrmcommon: map ENODEV and ENOENT to CRM_EX_NOSUCH
- libstonithd: return CRM_EX_NOSUCH for bad agent namespace
- controller: pre-load agent metadata asynchronously
- controller: improve messages when metadata cache update fails
- controller: add failsafe for no executor connection
- libcrmcommon: deprecate CRM_OP_LRM_QUERY
- controller: ignore CRM_OP_LRM_REFRESH
- fencing: use requested timeout with RHCS metadata actions
- fencing: use a default timeout with metadata and validate

- Rebase:
  * bug-728579_pacemaker-stonith-dev-id.patch

-------------------------------------------------------------------
Thu Sep 22 09:59:45 UTC 2022 - Yan Gao <ygao@suse.com>

- Update to version 2.1.4+20220919.c650a480e:
- libcrmcommon: Ignore non-comment/element nodes in pcmk__xml_log()
- libcrmcommon: Prevent buffer overflow in pcmk__element_xpath() (rh#1822125)
- libpe_status, tools: Show guest node host only with --show-detail (CLBZ#5373)
- libpe_status, tools: Show container node in GuestOnline in crm_mon (CLBZ#5373)

-------------------------------------------------------------------
Thu Sep 22 09:46:41 UTC 2022 - Yan Gao <ygao@suse.com>

- Update to version 2.1.4+20220919.9ba3fcd8a:
- libpe_status,tools: work with -D_TIME_BITS=64

-------------------------------------------------------------------
Thu Sep 22 08:33:17 UTC 2022 - Yan Gao <ygao@suse.com>

- Update to version 2.1.4+20220915.2e7d3dc92:
- tools: Add locked_to= to resources XML output
- schemas: Add locked_to= to resources API schema

-------------------------------------------------------------------
Thu Sep 22 08:20:07 UTC 2022 - Yan Gao <ygao@suse.com>

- Update to version 2.1.4+20220913.76eb273f1:
- schemas: Add schema for crm_error
- libcrmcommon: Bump feature set for crm_error formatted output
- tools: Use formatted output in crm_error

-------------------------------------------------------------------
Thu Sep 22 08:09:49 UTC 2022 - Yan Gao <ygao@suse.com>

- Update to version 2.1.4+20220913.9baec5d68:
- fenced: Skipping devices that don't support the on action.(Fix:CLBZ#5495)

-------------------------------------------------------------------
Thu Sep 22 07:55:01 UTC 2022 - Yan Gao <ygao@suse.com>

- Update to version 2.1.4+20220912.dab392c41:
- libpe_status: Deprecate "collocated" meta attribute for groups
- libpe_status: Deprecate "ordered" meta attribute for groups
- libpacemaker: Deprecate {with-,}rsc-instance in coloc constraints
- libpacemaker: Deprecate {first,then}-instance in order constraints
- schemas: Deprecate pacemaker-next and constraints-next

-------------------------------------------------------------------
Thu Sep 22 07:47:14 UTC 2022 - Yan Gao <ygao@suse.com>

- Update to version 2.1.4+20220912.99c8b14fc:
- controller: Resource reordering doesn't cause transition abort

-------------------------------------------------------------------
Tue Sep 20 15:03:56 UTC 2022 - Yan Gao <ygao@suse.com>

- Update to version 2.1.4+20220912.7bce48ad0:
- libcrmcommon: lower clients-at-exit message to warning
- scheduler: Fix types of arguments to formatted output functions.
- schemas: Make score[-attribute] optional for rules
- schemas: Add missing valid options for duration and date_spec
- schemas: Add missing valid date expr rule options
- tools: Use dynamic widths in crm_error list
- tools: crm_error should use last rc format given
- tools: List all RCs if none are specified for crm_error
- crm_error: Handle negative return code arguments
- scheduler: simplify some messages with node names

- Rebase:
  * bug-943295_pacemaker-lrmd-log-notice.patch

-------------------------------------------------------------------
Tue Sep 20 14:53:15 UTC 2022 - Yan Gao <ygao@suse.com>

- Update to version 2.1.4+20220907.aa8d5599a:
- resources, tools: Drop SystemHealth, ipmiservicelogd, ...

-------------------------------------------------------------------
Tue Sep 20 14:13:08 UTC 2022 - Yan Gao <ygao@suse.com>

- Update to version 2.1.4+20220906.71885fb7c:
- schemas: crm_resource --validate validation fails (rh#2123727)

-------------------------------------------------------------------
Tue Sep 20 12:46:05 UTC 2022 - Yan Gao <ygao@suse.com>

- Update to version 2.1.4+20220901.df90a631e:
- tools: Don't use fprintf in attrd_updater.
- daemons: Don't attempt to update the delay of an unknown attr.
- tools: If -B/-Y is given to attrd_updater, check for -d as well.
- daemons: Initial new server-side IPC support in attrd.
- libpacemaker: Standardize rule check error processing
- libpacemaker: EOPNOTSUPP for date_spec with moon in rule check
- tools: Improve crm_rule invalid date error message
- scheduler: disallow recurring reload-agent, migrate_from, and migrate_to

-------------------------------------------------------------------
Tue Sep 20 12:14:59 UTC 2022 - Yan Gao <ygao@suse.com>

- Update to version 2.1.4+20220831.a81e8740b:
- SysInfo: Validate that min_disk_free contains an integer optionally followed by a unit
- SysInfo: Fix typo
- SysInfo: Implement the reload-agent action
- SysInfo: Add reloadable to appropriate <parameter> entries
- SysInfo: Enumerate appropriate <parameter> values
- SysInfo: Add unique-group to appropriate <parameter> entries
- SysInfo: Remove unique from all <parameter> entries
- SysInfo: Update OCF version to 1.1

-------------------------------------------------------------------
Tue Sep 20 11:56:50 UTC 2022 - Yan Gao <ygao@suse.com>

- Update to version 2.1.4+20220830.68c64fbe1:
- libcrmcommon: Wait for ACKs from the attrd refresh command.

-------------------------------------------------------------------
Tue Sep 20 11:27:37 UTC 2022 - Yan Gao <ygao@suse.com>

- Update to version 2.1.4+20220829.08693870a:
- libcib: cib__signon_query(): NULL-check correct pointer
- libcrmcommon: Out-of-order pcmk__rc_info array
- scheduler: rename pcmk__native_allocate()
- pacemaker-based: update primary terminology in messages and comments

-------------------------------------------------------------------
Tue Sep 20 10:18:10 UTC 2022 - Yan Gao <ygao@suse.com>

- Update to version 2.1.4+20220825.c190d0d37:
- fencer: improve self-fencing logs

- Rebase:
  * bug-728579_pacemaker-stonith-dev-id.patch

-------------------------------------------------------------------
Tue Sep 20 09:41:35 UTC 2022 - Yan Gao <ygao@suse.com>

- Update to version 2.1.4+20220825.b676a8701:
- libcrmcommon: NULL-check pcmk__numeric_strcasecmp()
- libpe_status: Let pe__cmp_node_name() handle NULL values

- Rebase:
  * pacemaker-Wno-format-signedness.patch

-------------------------------------------------------------------
Tue Sep 20 09:20:27 UTC 2022 - Yan Gao <ygao@suse.com>

- Update to version 2.1.4+20220824.ad5b410ae:
- controld: Check all crm_is_true cases for globally-unique
- controld: Update for OCF 1.1
- resources: Use runstatedir in controld RA

- Rebase:
  * bug-977201_pacemaker-controld-self-fencing.patch

-------------------------------------------------------------------
Tue Sep 20 09:03:23 UTC 2022 - Yan Gao <ygao@suse.com>

- Update to version 2.1.4+20220823.7f07bda79:
- fenced: DC node fencing is unconditionally relayed.

-------------------------------------------------------------------
Tue Sep 20 07:20:47 UTC 2022 - Yan Gao <ygao@suse.com>

- Update to version 2.1.4+20220822.367ae2d64:
- libcrmcommon: Validate env option strings

-------------------------------------------------------------------
Tue Sep 20 07:13:15 UTC 2022 - Yan Gao <ygao@suse.com>

- Update to version 2.1.4+20220822.0b28d46b2:
- cts: Reimplement cts-regression in Python
- libcrmcommon: Free the output object if fopen fails.
- libcrmcommon: Set formatters to NULL after freeing it.
- libcrmcommon: Don't allow registering a format with an empty name.
- ClusterMon: Update deprecated -h flag
- ClusterMon: Add OCF_CHECK_LEVEL handling in the validate-all action
- ClusterMon: Update resource-agent version to 1.2
- ClusterMon: Add unique-group to appropriate <parameter> entries
- ClusterMon: Remove unique from all <parameter> entries
- ClusterMon: Update OCF version to 1.1

-------------------------------------------------------------------
Mon Sep 19 15:16:15 UTC 2022 - Yan Gao <ygao@suse.com>

- Update to version 2.1.4+20220817.ad32bc505:
- rpm: Requires python-psutil for cts
- pacemakerd: improve core file limit messages
- fencer: log target consistently
- fencer: improve error-checking of request XML
- fencing: rename fence action IDs

-------------------------------------------------------------------
Mon Sep 19 14:17:41 UTC 2022 - Yan Gao <ygao@suse.com>

- Update to version 2.1.4+20220816.71d8af5c0:
- daemons: Correct an error message.
- libcrmcommon: crm_generate_ra_key should fail if std or key are missing.

-------------------------------------------------------------------
Mon Sep 19 13:45:12 UTC 2022 - Yan Gao <ygao@suse.com>

- Update to version 2.1.4+20220810.b794021e6:
- tools: correct minimum execution status shown by crm_resource -O (bsc#1205279, bsc#1204581)

-------------------------------------------------------------------
Mon Sep 19 13:38:35 UTC 2022 - Yan Gao <ygao@suse.com>

- Update to version 2.1.4+20220808.e445c8a8b:
- libpacemaker: Free the CIB copy in pcmk__status.
- pacemaker: Free the CIB copy in pcmk__output_cluster_status.
- libpacemaker: Free the working set in pcmk__output_cluster_status.
- libcrmcommon: drop DOCTYPE from daemon option meta-data
- pacemakerd: lower level of messages about core file size

-------------------------------------------------------------------
Mon Sep 19 11:25:05 UTC 2022 - Yan Gao <ygao@suse.com>

- Update to version 2.1.4+20220808.799e2c327:
- executor: don't finalize a failed monitor initiation twice

-------------------------------------------------------------------
Mon Sep 19 11:16:33 UTC 2022 - Yan Gao <ygao@suse.com>

- Update to version 2.1.4+20220808.986d22dd5:
- libcrmcommon: Fix an IPC-related memory leak.

-------------------------------------------------------------------
Wed Aug 03 10:47:09 UTC 2022 - Yan Gao <ygao@suse.com>

- Update to version 2.1.4+20220802.1e2d5eacf:
- tools: Restrict ourselves to XML elements in command_query.
- tools: Support regexes with crm_attribute --delete and --update.
- libcrmservice: fix the trace logging about finishing reading stdout/stderr
- scheduler: avoid "left-hand"/"right-hand" terminology in colocation logs

-------------------------------------------------------------------
Wed Aug 03 09:26:28 UTC 2022 - Yan Gao <ygao@suse.com>

- Update to version 2.1.4+20220725.bbb0e1b04:
- tools: Add the -q option back to attrd_updater. (rh#2110452)

-------------------------------------------------------------------
Wed Aug 03 09:22:37 UTC 2022 - Yan Gao <ygao@suse.com>

- Update to version 2.1.4+20220725.90ed6fe66:
- daemons: Fix a bug processing child XML messages in attrd.

-------------------------------------------------------------------
Thu Jul 21 14:36:13 UTC 2022 - Yan Gao <ygao@suse.com>

- Update to version 2.1.4+20220720.51519cdf8:
- HealthCPU: Complete implementation of the reload-agent action
- libcrmcommon: Check for NULL input
- ACLs: bail out early when creating element that'll be denied anyway

-------------------------------------------------------------------
Thu Jul 21 14:25:35 UTC 2022 - Yan Gao <ygao@suse.com>

- Update to version 2.1.4+20220720.a0a66eefe:
- scheduler: calculate digests based on the crm_feature_set version of the cib if there's no corresponding operation history entry
- libpacemaker: correctly find the best operation history entry to calculate digests for
- scheduler,controller: consistently calculate and record secure digest based on all parameters only except private ones
- scheduler: restart a resource configured with extra operation parameters upon changes of any parameters

-------------------------------------------------------------------
Thu Jul 21 12:35:27 UTC 2022 - Yan Gao <ygao@suse.com>

- Update to version 2.1.4+20220720.3b57f9b58:
- scheduler: avoid container ping-pong

- Rebase:
  * pacemaker-nagios-plugin-dir.patch
  * pacemaker-Wno-format-signedness.patch

-------------------------------------------------------------------
Thu Jul 21 12:25:08 UTC 2022 - Yan Gao <ygao@suse.com>

- Update to version 2.1.4+20220719.6bf20e794:
- tools: Fix a segfault in error handling in crm_resource. (clbz#5496)

-------------------------------------------------------------------
Thu Jul 21 12:15:11 UTC 2022 - Yan Gao <ygao@suse.com>

- Update to version 2.1.4+20220718.f11308913:
- do unfencing equally for cluster-nodes & remotes

-------------------------------------------------------------------
Thu Jul 21 12:03:52 UTC 2022 - Yan Gao <ygao@suse.com>

- Update to version 2.1.4+20220714.2ab4412e6:
- HealthCPU: Validate that yellow_limit and red_limit are integers
- HealthCPU: Update resource-agent version to 1.1
- HealthCPU: Add OCF_CHECK_LEVEL handling in the validate-all action
- HealthCPU: Implement the reload-agent action
- HealthCPU: Add reloadable to appropriate <parameter> entries
- HealthCPU: Add unique-group to appropriate <parameter> entries
- HealthCPU: Remove unique from all <parameter> entries
- HealthCPU: Update OCF version to 1.1

-------------------------------------------------------------------
Thu Jul 21 11:58:32 UTC 2022 - Yan Gao <ygao@suse.com>

- Update to version 2.1.4+20220714.cbbaf0b40:
- daemons: Convert schedulerd's hello message into a handler.
- daemons: Convert schedulerd's one message to new IPC handling.
- daemons: Use new IPC handling for unknown schedulerd messages.

-------------------------------------------------------------------
Thu Jul 21 11:31:55 UTC 2022 - Yan Gao <ygao@suse.com>

- Update to version 2.1.4+20220713.b162888bf:
- scheduler: Resolves an issue where STONITH devices cannot be registered.

-------------------------------------------------------------------
Thu Jul 21 11:26:57 UTC 2022 - Yan Gao <ygao@suse.com>

- Update to version 2.1.4+20220712.37b09e240:
- libcrmcommon: Remove double "error:" prefixes from messages.
- daemons: Convert pacemakerd's shutdown message to new IPC handling.
- daemons: Convert pacemakerd's ping message to new IPC handling.
- daemons: Use new IPC handling for some pacemakerd messages.
- scheduler: calculate group promotion scores correctly

-------------------------------------------------------------------
Fri Jul 08 13:38:25 UTC 2022 - Yan Gao <ygao@suse.com>

- Update to version 2.1.4+20220707.4d02a795b:
- controller: log an info instead of a warning for a stonith/shutdown that is unknown to the new DC (bsc#1198715)

-------------------------------------------------------------------
Fri Jul 08 13:33:08 UTC 2022 - Yan Gao <ygao@suse.com>

- Update to version 2.1.4+20220707.5e75c2173:
- schemas: update crm_resource --why schema for new health check
- schemas: simplify crm_resource --why schema
- tools: correct crm_resource --why schema to match actual output
- tools: crm_resource --why now checks node health status
- tools: crm_resource is-managed check should use meta-attribute table
- tools: crm_resource target-role check should use meta-attribute table

-------------------------------------------------------------------
Fri Jul 08 13:25:24 UTC 2022 - Yan Gao <ygao@suse.com>

- Update to version 2.1.4+20220706.6b53629d2:
- libcrmcommon: no need for "Cleaning up memory" message
- libcrmservice: fix log message arguments
- libcrmcommon: don't try to log NULL
- various: improve messages that use pcmk__s()
- fencer: improve topology level validation
- scheduler: improve validation of resource XML
- libcib: validate requests better
- libcrmcommon: validate pacemaker-schedulerd messages better
- libcrmcommon: validate pacemakerd messages better
- libcrmcommon: validate controller IPC messages better
- libcrmcommon: validate attribute manager IPC messages better
- pacemaker-schedulerd: validate IPC messages better
- pacemakerd: validate IPC messages better
- controller: improve logs when routing messages
- controller: validate transition requests better
- controller: validate controller requests better
- controller: validate execution requests better

-------------------------------------------------------------------
Fri Jul 08 13:03:14 UTC 2022 - Yan Gao <ygao@suse.com>

- Update to version 2.1.4+20220705.e7507cee6:
- libstonithd: Add the "Agent not found..." message to formatted output. (rh#2102292)

-------------------------------------------------------------------
Fri Jul 08 12:54:20 UTC 2022 - Yan Gao <ygao@suse.com>

- Update to version 2.1.4+20220705.c6fdc985f:
- attrd: improve dampening logs
- tools: improve error message wording in crm_resource

-------------------------------------------------------------------
Fri Jul 01 06:51:47 UTC 2022 - Yan Gao <ygao@suse.com>

- Update to version 2.1.4+20220630.8b0f865f4:
- Always null-check result in stonith__rhcs_get_metadata (rh#2102292)
- Use failed action result in rhcs_validate and _get_metadata (rh#2102292)
- Use correct boolean in stonith__validate_agent_xml (rh#2102292)

-------------------------------------------------------------------
Wed Jun 29 04:39:29 UTC 2022 - Yan Gao <ygao@suse.com>

- Update to version 2.1.4+20220628.c791e26c4:
- scheduler: don't prefer greater anti-colocation when ordering instances for assignment
- scheduler: compare instance numbers not IDs for assignment order

-------------------------------------------------------------------
Wed Jun 29 04:12:28 UTC 2022 - Yan Gao <ygao@suse.com>

- Update to version 2.1.4+20220628.36c594099:
- daemons: Atomically set certain attrs in controld.

-------------------------------------------------------------------
Wed Jun 29 04:05:17 UTC 2022 - Yan Gao <ygao@suse.com>

- Update to version 2.1.4+20220628.2120dad10:
- cts-scheduler: add missing last-rc-change attributes to the faked lrm_rsc_op entries (bsc#1182313)
- scheduler: a failed migrate_from always matters for the source if the resource has no newer state there (bsc#1182313)
- scheduler: a failed migrate_to always matters for the source if there's no newer non-monitor operation there (bsc#1182313)
- scheduler: use the consistent way to check whether there's any newer non-monitor operation on the source (bsc#1182313)
- cts-scheduler: add missing last-rc-change attributes to the faked lrm_rsc_op entries (bsc#1182313)
- cts-scheduler: update expected output for changes of handling a failed migrate_to (bsc#1182313)
- scheduler: a failed migrate_to always matters for the target if the resource has no newer state there (bsc#1182313)
- scheduler: use the consistent way to check whether resource has newer state on the target (bsc#1182313)
- cts-scheduler: prevent resources from running on multiple nodes due to partial live migration (bsc#1182313)
- scheduler: prevent resources from running on multiple nodes due to partial live migration (bsc#1182313)
- cts-scheduler: update expected output for changes of handling a successful migrate_to (bsc#1182313)
- scheduler: a successful migrate_to no longer matters for the target if any newer probe/monitor indicates the resource was not running there (bsc#1182313)
- scheduler: a successful migrate_to no longer matters for the target if there's any newer non-monitor operation there (bsc#1182313)
- scheduler: a successful migrate_to no longer matters for the source if there's any newer non-monitor operation there (bsc#1182313)
- scheduler: add a parameter to pe__is_newer_op() indicating whether the two operations are on the same node by default (bsc#1182313)
- libpacemaker: record migrate_to/migrate_from separately from last/last_failure lrm_rsc_op entries (bsc#1182313)

-------------------------------------------------------------------
Wed Jun 29 03:54:40 UTC 2022 - Yan Gao <ygao@suse.com>

- Update to version 2.1.4+20220627.812442e7f:
- tools: Don't output "(null)" in crm_attribute's quiet mode. (rh#2099331)

-------------------------------------------------------------------
Wed Jun 22 06:49:16 UTC 2022 - Yan Gao <ygao@suse.com>

- Update to version 2.1.4+20220615.ce53c2c3f:
- libcrmcommon: use proper size for snprintf()
- Allow acl_target and acl_group elements to take a 'name' attribute to use a name different from 'id'
- Add ACL group support
- daemons: Allow setting multiple node attributes.
- libcrmcommon: finish XML for libpacemaker public API function errors
- libcrmcommon: Wait for replies to attrd update messages.
- libstonithd: use case-sensitive comparisons where appropriate
- daemons: Track the minimum attrd protocol version.
- remote: Shutdown if tls goes down while waiting for shutdown all-clear
- libcrmcommon: fix a wrong separator in the .warning CSS declaration (bsc#1196673, bsc#1203367, fate#320759)
- tools: report CRM feature set of nodes by crm_mon (bsc#1196673, bsc#1203367, fate#320759)
- controller: record CRM feature set as a transient attribute (bsc#1196673, bsc#1203367, fate#320759)
- schemas: copy API schemas in preparation for changes (bsc#1196673, bsc#1203367, fate#320759)
- cts-cli: fix too greedy version filter (bsc#1196673, bsc#1203367, fate#320759)
- tools: Support regexes with --query in crm_attribute.
- tools: Support querying all attributes on a given node.
- nls: format of XML-escaped string
- scheduler: do not enforce resource stop if any new probe/monitor indicates the resource was not running on the target of a failed migrate_to (bsc#1196340)
- scheduler: do not enforce resource stop on a rejoined node that was the target of a failed migrate_to (bsc#1196340)
- scheduler: do not enforce resource stop if any new probe/monitor indicates the resource was not running on the target of a failed migrate_to (bsc#1196340)
- scheduler: find_lrm_op() to be able to check against a specified target_rc (bsc#1196340)
- cts-scheduler: fix on_node attribute of lrm_rsc_op entries in the tests (bsc#1196340)
- scheduler: is_newer_op() to be able to compare lrm_rsc_op entries from different nodes (bsc#1196340)
- scheduler: compare ids of lrm_rsc_op entries case-sensitively (bsc#1196340)
- scheduler: functionize comparing which lrm_rsc_op is newer (bsc#1196340)
- scheduler: do not enforce resource stop on a rejoined node that was the target of a failed migrate_to (bsc#1196340)
- tools: Fix deleting by pattern in crm_attribute.
- tools: Use new attrd IPC interface in various tools.
- daemons: Use new IPC interface in pacemaker-controld...
- daemons: Use new IPC interface in pacemaker-attrd...
- tools: Convert attrd_updater to using new attrd IPC.
- Add pacemaker-controld Chinese translation
- fencer: avoid redundant result in XML
- fencing: add device/level description to configuration change notifications
- fencing: always add notification type to client notification data
- fencer: always add device ID to level removal notification
- fencer: always add device ID to level addition notification
- fencer: always add device ID to device addition notification
- fencer: avoid memory leaks when processing topology requests
- tools: respect crm_mon --show-detail for fencing actions
- fenced: Don't ignore CIB updates if stonith-enabled=false
- Fix print spec for unsigned int count
- libcrmcommon: Process the cmdline before saving as a request.
- tools: add more detail to stonith_admin error messages
- daemons: Use formatted output in pacemaker-attrd.
- Convert pacemaker-attrd to use glib for command line.
- tools: Convert iso8601 to using glib for command line.
- libcib: Check for NULL before calling g_ascii_strdown.
- fencing: prefer same delegate when checking equivalent fencing
- fencing: show delegate for later successful fencing actions
- fencer: make completion logs more consistent
- fencer: deprecate stand-alone mode
- tools: stonith_admin should display device/level errors
- executor: improve messages after fencing connection loss
- fencing: delegate shouldn't matter when checking equivalent fencing
- controller: downgrade successful fencing logs to info
- fencer: downgrade topology failure message to info level
- fencer: lower eligibility logs to info level
- fencer: log raw XML at trace level
- fencer: log device only if not null

- Rebase:
  * bug-812269_pacemaker-fencing-device-register-messages.patch

-------------------------------------------------------------------
Tue Jun 21 13:20:12 UTC 2022 - Yan Gao <ygao@suse.com>

- Update to version 2.1.4+20220615.dc6eb4362 (Pacemaker-2.1.4)

-------------------------------------------------------------------
Thu Jun 09 17:12:47 UTC 2022 - Yan Gao <ygao@suse.com>

- Update to version 2.1.3+20220608.d7fce3868:
- libstonithd: pull exit reason directly from history replies
- fencer: assume unknown status from older fencers' history replies
- resources: add SystemHealth parameter to its meta-data
- resources: remove no-longer-relevant DTD reference from meta-data
- resources: typo in HealthSMART meta-data

-------------------------------------------------------------------
Tue Jun 07 10:45:08 UTC 2022 - Yan Gao <ygao@suse.com>

- Update to version 2.1.3+20220603.ea9bebf6c (Pacemaker-2.1.4-rc1):
- fencer: avoid use-after-free with self-fencing and topology
- fencer: get target-by-attribute working again
- libcrmcommon: fix a wrong separator in the .warning CSS declaration
- fencer: avoid memory leaks when processing topology requests
- Fix print spec for unsigned int count
- fencing: delegate shouldn't matter when checking equivalent fencing

-------------------------------------------------------------------
Thu Jun 02 07:38:49 UTC 2022 - Yan Gao <ygao@suse.com>

- Update to version 2.1.3+20220601.da2fd79c8 (Pacemaker-2.1.3)

-------------------------------------------------------------------
Thu May 26 19:24:22 UTC 2022 - Jan Engelhardt <jengelh@inai.de>

- Use the project upstream name for the -devel subpackage
  (rename libpacemaker-devel to pacemaker-devel).
- Drop libpacemaker3-cluster separation, since it double-ships
  a file that is already in libpacemaker3
- Rename libpacemaker3 to pacmekaer-libs following packages like
  xrootd-libs et al so it does not get picked on by rpmlint
  [boo#1191752].

-------------------------------------------------------------------
Thu May 26 18:56:57 UTC 2022 - Yan Gao <ygao@suse.com>

- Update to version 2.1.2+20220526.b387f8972:
- libcrmcommon: avoid memory leak if IPC server fails to run
- nls: format of XML-escaped string

-------------------------------------------------------------------
Thu May 26 18:46:07 UTC 2022 - Yan Gao <ygao@suse.com>

- Update to version 2.1.2+20220518.dff7c3a72 (Pacemaker-2.1.3-rc2):
- schemas: Use fence-event-2.15.rng (rh#2086230)
- scheduler: don't support versioned instance attributes in operations
- schemas: allow Promoted/Unpromoted in crm_resource output

-------------------------------------------------------------------
Thu May 12 07:56:23 UTC 2022 - Yan Gao <ygao@suse.com>

- Update to version 2.1.2+20220511.0bf080da3:
- tools: Set options.command when "attrd_updater -Y" is used.

-------------------------------------------------------------------
Mon May 02 10:01:36 UTC 2022 - Yan Gao <ygao@suse.com>

- Update to version 2.1.2+20220427.c01a90fd2:
- tools: Hook up the verbosity flag in crm_attribute.
- tools: Honor CIB_file when doing node name lookups in crm_attribute.
- tools: Handle a remote node's name differing from its hostname.
- libcrmcommon: Fix a bug in processing multiple IPC messages.
- libcrmcommon: Add EAGAIN as a return code from crm_ipc_read.
- libcrmcommon: Handle IPC ACKs from proxied connections too.
- fenced: Correctly log the total fencing timeout.
- scheduler: make multiple-active="stop_unexpected" actually work
- libcib: Check for NULL before calling g_ascii_strdown.

-------------------------------------------------------------------
Mon May 02 08:44:22 UTC 2022 - Yan Gao <ygao@suse.com>

- Update to version 2.1.2+20220421.a988afd4e (Pacemaker-2.1.3-rc1):
- libpe_status: deprecate node_ping
- fencer: avoid core dump at exit
- fix Chinese garbled
- fencer: don't use constant within translatable string literal
- libcrmcommon: fix NLS issues with option meta-data

-------------------------------------------------------------------
Fri Apr 29 15:42:58 UTC 2022 - Yan Gao <ygao@suse.com>

- Update to version 2.1.2+20220414.8cfa69660:
- tools: set command for `crm_resource -q/--query-xml` before changing any options (bsc#1198409)
- tools: prevent possible crm_resource segfaults if multiple commands are specified (bsc#1198409)
- tools: set commands in crm_resource before changing any options (bsc#1198409)

-------------------------------------------------------------------
Fri Apr 29 15:30:44 UTC 2022 - Yan Gao <ygao@suse.com>

- Update to version 2.1.2+20220412.826f287ac:
- schemas: update some API schemas for node health change
- tools: add node health to crm_mon output
- libpe_status: tweak HTML output for node names
- libcrmcommon: tweak HTML CSS
- libpe_status: show node status components in separate HTML spans
- libpe_status: remove stray space from HTML class name

-------------------------------------------------------------------
Fri Apr 29 13:42:20 UTC 2022 - Yan Gao <ygao@suse.com>

- Update to version 2.1.2+20220412.bd19767c9:
- libcib: Fix handling the return value of cib_internal_op.

-------------------------------------------------------------------
Fri Apr 29 10:43:11 UTC 2022 - Yan Gao <ygao@suse.com>

- Update to version 2.1.2+20220408.6321f6534:
- libcrmcommon: bump feature set for multiple-active=stop_unexpected
- scheduler: implement multiple-active=stop_unexpected
- scheduler: log a warning if invalid value is given for multiple-active

-------------------------------------------------------------------
Fri Apr 29 10:06:55 UTC 2022 - Yan Gao <ygao@suse.com>

- Update to version 2.1.2+20220407.844c3972e:
- scheduler: allow-unhealthy-nodes resource meta-attribute

-------------------------------------------------------------------
Wed Apr 20 12:44:15 UTC 2022 - Yan Gao <ygao@suse.com>

- Update to version 2.1.2+20220407.56d93678c:
- tools: Handle an error case in crm_attribute.
- tools: Convert crm_ticket to using glib for command line.

-------------------------------------------------------------------
Wed Apr 06 11:19:17 UTC 2022 - Yan Gao <ygao@suse.com>

- Update to version 2.1.2+20220405.1ec3db01e:
- schemas: Add host= to crm_attribute schema.
- libpacemaker: Don't output attribute settings for blank strings.
- tools: Override the attribute text message in crm_attribute.
- tools: Use the new attribute message in attrd_updater.
- libpacemaker: Add host to the attribute message.
- tools: Add formatted output boilerplate to attrd_updater.
- fencer: drop useless logs

-------------------------------------------------------------------
Sun Apr  3 07:44:37 UTC 2022 - Stephan Kulow <coolo@suse.com>

- Create libltdl/config before autoreconf to fix an incompatibility
  with autoconf 2.71

-------------------------------------------------------------------
Fri Apr 01 11:35:32 UTC 2022 - Yan Gao <ygao@suse.com>

- Update to version 2.1.2+20220331.1ad8bbddd:
- tools: Fix the -v option to attrd_updater.

-------------------------------------------------------------------
Wed Mar 30 09:22:01 UTC 2022 - Yan Gao <ygao@suse.com>

- Update to version 2.1.2+20220329.efdcb0bbf:
- resources: Add an OCF_RESKEY_dampen parameter to HealthSMART.
- resources: Mark HealthSMART parameters as reloadable.
- resources: Also fix HealthSMART_monitor.
- resources: Fix a bug in init_smart in HealthSMART.
- resources: Fix the stop action in HealthSMART.
- resources: Add an OCF_RESKEY_smartctl parameter to HealthSMART.
- resources: update HealthSMART agent for OCF 1.1

-------------------------------------------------------------------
Tue Mar 29 06:49:24 UTC 2022 - Yan Gao <ygao@suse.com>

- Update to version 2.1.2+20220328.24d87d0b2:
- tools: Do not allow certain operations on clone instances.
- tools: Fix one method of restarting a cloned group.
- tools: Fix restarting clone instances in crm_resource. (rh#1930578)
- tools: If crm_resource is given an invalid node, error.
- tools: Fix one way to restart a cloned primitive.
- tools: Fix restarting implicit bundled resources without a host.
- tools: Fix double free errors in crm_resource.
- tools: Compare host names case insensitively...

-------------------------------------------------------------------
Mon Mar 28 15:43:15 UTC 2022 - Yan Gao <ygao@suse.com>

- Update to version 2.1.2+20220328.2dd22a9d7:
- tools: Update a couple option help strings in attrd_updater.
- Convert attrd_updater to use glib for cmdline handling.

-------------------------------------------------------------------
Thu Mar 24 10:48:40 UTC 2022 - Yan Gao <ygao@suse.com>

- Update to version 2.1.2+20220322.5129e5ca5:
- tools: Add XML schema for the crm_attribute output.
- tools: Fix indentation on crm_attribute help output.
- tools: Finish using formatted output in crm_attribute.
- tools: Switch crm_attribute to use formatted output.
- schemas: Add a schema for the new crm_rule output.
- tools: Allow passing -r to crm_rule more than once.
- tools: crm_rule is no longer experimental.
- tools: Convert crm_rule to formatted output.
- rpm: Remove the coverage support from the spec file.

-------------------------------------------------------------------
Thu Mar 24 10:16:01 UTC 2022 - Yan Gao <ygao@suse.com>

- Update to version 2.1.2+20220309.d007690cb:
- cibadmin to be able to "render" access mode for selected user

-------------------------------------------------------------------
Tue Mar 08 15:49:01 UTC 2022 - Yan Gao <ygao@suse.com>

- Update to version 2.1.2+20220307.022ae2d5f:
- rpm: depend on gettext-tools instead of gettext
- scheduler: Take case into account when finding resources.
- scheduler: improve fencing-related messages

-------------------------------------------------------------------
Mon Mar 07 13:34:25 UTC 2022 - Yan Gao <ygao@suse.com>

- Update to version 2.1.2+20220304.b2c456e77:
- pacemakerd: override locale earlier in start-up
- libcrmcommon: initialize NLS only once
- tools: Fix a corner case in crm_mon outputting.
- tools: Always output to the HTML dest file. (clbz#5492)
- scheduler: shutdown locks apply to group members, not group itself

-------------------------------------------------------------------
Wed Mar 02 13:02:01 UTC 2022 - Yan Gao <ygao@suse.com>

- Update to version 2.1.2+20220301.6981b549a:
- libpacemaker: Fix a segfault in crm_mon.

-------------------------------------------------------------------
Wed Mar 02 12:54:59 UTC 2022 - Yan Gao <ygao@suse.com>

- Update to version 2.1.2+20220301.a5db0024f:
- scheduler: properly set data set flags when scheduling actions
- scheduler: determine cluster status more efficiently

-------------------------------------------------------------------
Wed Mar 02 11:43:06 UTC 2022 - Yan Gao <ygao@suse.com>

- Update to version 2.1.2+20220222.250a6b0d7:
- rpm: add nls option

-------------------------------------------------------------------
Mon Feb 21 12:13:47 UTC 2022 - Yan Gao <ygao@suse.com>

- Update to version 2.1.2+20220217.578a0bc42:
- libpacemaker: Add a public function for one-shot crm_mon mode.

-------------------------------------------------------------------
Thu Feb 17 18:05:59 UTC 2022 - Yan Gao <ygao@suse.com>

- Update to version 2.1.2+20220216.41a118c10:
- NLS: expand translations to all executables
- libcrmcommon: match allocation and free functions
- executor: improve alert completion messages
- libcrmservice: improve exit reasons for timeouts/signals
- libcrmservice,tools: add more detail to exit reasons when available
- controller: don't retry an invalid remote key
- controller,fencer: add more detail to exit reasons when available
- scheduler: improve "friendly" failed action output
- libcrmservice: improve timeout message for alert agents
- fencing: assert that fencing actions are non-recurring
- libcrmservice: check parameter for NULL before dereferencing it
- scheduler: improve messages for action configuration changes

-------------------------------------------------------------------
Thu Feb 17 17:22:45 UTC 2022 - Yan Gao <ygao@suse.com>

- Update to version 2.1.2+20220215.aa3779ec6:
- Add pacemaker(pacemaker-based) resource translatefile

-------------------------------------------------------------------
Thu Feb 17 17:13:59 UTC 2022 - Yan Gao <ygao@suse.com>

- Update to version 2.1.2+20220215.c0ac153b7:
- libcrmcommon: Escape option metadata descriptions. (rh#2050259)
- libcrmservice: Escape systemd agent descriptions. (rh#2050259)

-------------------------------------------------------------------
Thu Feb 17 17:11:27 UTC 2022 - Yan Gao <ygao@suse.com>

- Update to version 2.1.2+20220215.80e43ec90:
- libcrmservice: Additional metadata fix for systemd templates. (rh#2045096)

-------------------------------------------------------------------
Tue Feb 15 12:26:08 UTC 2022 - Yan Gao <ygao@suse.com>

- Update to version 2.1.2+20220214.81e6a29e4:
- daemons: Add a longdesc to the pcmk_host_list parameter.
- daemons: Put shortdesc after longdesc for parameters, too. (rh#2049722)
- resources: Put shortdesc after longdesc in agents. (rh#2049722)

-------------------------------------------------------------------
Tue Feb 08 13:40:56 UTC 2022 - Yan Gao <ygao@suse.com>

- Update to version 2.1.2+20220207.58dccbae0:
- libcommon: avoid race when process checked while going away
- pkg-config: libpacemaker requires libstonithd and libcrmservice.
- scheduler: assert on notification entry memory errors
- scheduler: avoid notification problems if node names are unknown

-------------------------------------------------------------------
Tue Feb 08 11:57:53 UTC 2022 - Yan Gao <ygao@suse.com>

- Update to version 2.1.2+20220126.16c1bab10:
- controller: correctly match "node down" events
- controller: improve meta-data warnings
- scheduler: assert on memory allocation error
- pacemakerd: improve messages for subdaemon handling

-------------------------------------------------------------------
Tue Feb 08 11:47:22 UTC 2022 - Yan Gao <ygao@suse.com>

- Update to version 2.1.2+20220126.57e783b4b:
- libstonithd: avoid controld shutdown hanging
- pacemakerd: have signal-handler take care of lost processes
- scheduler: avoid memory leak when displaying clones

- Rebase:
  * bug-806256_pacemaker-log-level-notice.patch

-------------------------------------------------------------------
Tue Feb 08 11:25:36 UTC 2022 - Yan Gao <ygao@suse.com>

- Update to version 2.1.2+20220120.3f0398825:
- scheduler: implement utilization for bundles
- fencer: reset op result before grabbing new one (rh#1470834)
- schemas: update fence-event API schema for recent change (rh#1470834)
- fencing: display exit reasons with failed fencing events (rh#1470834)
- fencing: return exit reason with fencing history (rh#1470834)
- fencer: track full result in fencing history (rh#1470834)

-------------------------------------------------------------------
Tue Feb 08 08:54:11 UTC 2022 - Yan Gao <ygao@suse.com>

- Update to version 2.1.2+20220119.2c937a4c0:
- ipc_client: use libqb async API for connect
- pacemakerd: keep tracking pacemakerd for liveness
- pacemakerd: tweak systemd unit respawn settings

-------------------------------------------------------------------
Tue Feb 08 08:22:23 UTC 2022 - Yan Gao <ygao@suse.com>

- Update to version 2.1.2+20220119.eec504705:
- libcrmservice: improve exit reason for timeouts (rh#1470834)
- fencing: improve exit reason for fencing timeouts (rh#1470834)
- controller: improve exit reason for internal timeouts (rh#1470834)
- controller,libpacemaker: make history XML creation less chatty (rh#1470834)
- fencing: don't warn if cluster has no watchdog device (rh#1470834)
- libcrmcommon: don't say "Unknown error" (rh#1470834)
- libcrmcommon: improve description for "not connected" status (rh#1470834)

-------------------------------------------------------------------
Fri Feb 04 17:57:25 UTC 2022 - Yan Gao <ygao@suse.com>

- Update to version 2.1.2+20220118.de344dc33:
- tools: Fix the show detail toggle in crm_mon.
- corosync: Repeat corosync_cfg_trackstart
- tools: Handle output format arguments before doing daemonize mode.
- libpacemaker: avoid unnecessary limit on node names

-------------------------------------------------------------------
Fri Feb 04 17:11:56 UTC 2022 - Yan Gao <ygao@suse.com>

- Update to version 2.1.2+20220117.0fb17de37:
- tools: get stonith_admin -T option working again (rh#1470834)
- libpacemaker: compare fence action names case-sensitively
- libpacemaker: return exit reason for fencer connection failures
- tools: display failure reasons for stonith_admin fencing commands
- libpacemaker: improve result for high-level fencing API
- fencing: Don't set stonith action to pending if fork fails

-------------------------------------------------------------------
Fri Feb 04 16:14:08 UTC 2022 - Yan Gao <ygao@suse.com>

- Update to version 2.1.2+20220114.fb2dcedf1:
- controller: compare case-sensitively where appropriate (rh#1470834)
- controller,tools: improve description for fencing alerts/traps (rh#1470834)
- controller: improve messages when handling fencing notifications (rh#1470834)
- controller: compare fencing targets case-insensitively (rh#1470834)
- scheduler: Use the old RC code to log maskable probe failures.

-------------------------------------------------------------------
Fri Feb 04 15:53:57 UTC 2022 - Yan Gao <ygao@suse.com>

- Update to version 2.1.2+20220113.7c94f0367:
- liblrmd: Avoid double-free during notify operation (rh#2039675)

-------------------------------------------------------------------
Fri Feb 04 14:31:35 UTC 2022 - Yan Gao <ygao@suse.com>

- Update to version 2.1.2+20220112.b496b9826:
- low: Remove "formerly called..." text in metadata output.
- tools: Free metadata memory in crm_resource.
- daemons: Use formatted output for metadata in schedulerd.

-------------------------------------------------------------------
Fri Feb 04 13:53:42 UTC 2022 - Yan Gao <ygao@suse.com>

- Update to version 2.1.2+20220112.c894b0aff:
- fencing: add exit reason for results without a callback (rh#1470834)
- executor: set exit reason if no fencer connection (rh#1470834)
- executor: return an error for unsupported fence device actions (rh#1470834)
- executor: don't require a fencer connection for probes (rh#1470834)
- executor: improve result for fence device probes (rh#1470834)
- executor,scheduler: treat "no secrets" fence results as a hard error (rh#1470834)
- executor: use full result from fencer for fence actions (rh#1470834)
- controller: improve fencing result messages (rh#1470834)

-------------------------------------------------------------------
Fri Feb 04 13:27:31 UTC 2022 - Yan Gao <ygao@suse.com>

- Update to version 2.1.2+20220112.69a63fb99:
- scheduler: Handle masked probes in the scheduler. (rh#1506372)
- include: Bump feature set to 3.12.0.
- scheduler: Display the reason why a clone rsc probe failed. (rh#1506372)
- scheduler: Display the reason why a native rsc probe failed. (rh#1506372)
- scheduler: Don't output failed resource probes... (rh#1506372)

-------------------------------------------------------------------
Fri Feb 04 12:42:31 UTC 2022 - Yan Gao <ygao@suse.com>

- Update to version 2.1.2+20220112.08200a00e:
- scheduler: use plural correctly for fail count messages
- libcrmcommon: avoid file resource leak on decompression errors (clbz#5489)

- Rebase:
  * bug-806256_pacemaker-log-level-notice.patch

-------------------------------------------------------------------
Fri Feb 04 12:21:46 UTC 2022 - Yan Gao <ygao@suse.com>

- Update to version 2.1.2+20211223.94ced1fa9:
- fencer: clarify timeout message (rh#1470834)
- fencer: free result memory when processing fencing replies (rh#1470834)
- fencer: restore check for invalid topology level target (rh#1470834)
- fencer: pass full result when sending notifications (rh#1470834)
- fencer: add full result to local replies (rh#1470834)
- fencer: set exit reasons for fencing timeouts (rh#1470834)
- fencer: set exit reason for timeouts waiting for peer replies (rh#1470834)
- fencer: grab and log full result when processing peer fencing replies (rh#1470834)
- fencer: pass full result in replies to requests (rh#1470834)
- fencer: track and log full result when handling requests (rh#1470834)
- fencer: handle topology level unregistration errors better (rh#1470834)
- fencer: handle topology level registration errors better (rh#1470834)
- fencer: pass full result in async command replies (rh#1470834)

-------------------------------------------------------------------
Fri Feb 04 11:24:19 UTC 2022 - Yan Gao <ygao@suse.com>

- Update to version 2.1.2+20211222.90769ae96:
- libpacemaker: catch bugs scheduling actions on unclean nodes

-------------------------------------------------------------------
Fri Feb 04 10:51:30 UTC 2022 - Yan Gao <ygao@suse.com>

- Update to version 2.1.2+20211215.5f767500a:
- fencer: get current time correctly
- Merge:
  * 0001-Fix-fencer-get-current-time-correctly.patch

- Rebase:
  * bug-806256_pacemaker-log-level-notice.patch

-------------------------------------------------------------------
Fri Feb 04 10:38:51 UTC 2022 - Yan Gao <ygao@suse.com>

- Update to version 2.1.2+20211208.e3c53cabb:
- fencer: avoid memory leak when broadcasting history differences

-------------------------------------------------------------------
Fri Feb 04 10:15:06 UTC 2022 - Yan Gao <ygao@suse.com>

- Update to version 2.1.2+20211206.3a6dc7c79:
- scheduler: handle memory errors explicitly for friendly failure output
- resources: use correct syntax in Stateful meta-data (rh#2027370)
- resources: remove DOCTYPE from OCF 1.1-compliant agents
- libcib: deprecate get_object_path() (clbz#5488)
- various: perform XPath searches for CIB element names case-sensitively
- libcib: compare section names case-sensitively for CIB modifications
- controller,libcib,tools: handle CIB XPath searches better

-------------------------------------------------------------------
Fri Feb 04 09:50:42 UTC 2022 - Yan Gao <ygao@suse.com>

- Update to version 2.1.2+20211201.c93f6a460:
- fencer: handle malformed topology level removal requests better (rh#1470834)
- fencer: handle malformed manual confirmation requests better (rh#1470834)
- fencer: return -ETIME for peer fencing timeouts (rh#1470834)
- fencer: improve broadcasting replies for fenced originators (rh#1470834)
- fencer,scheduler: compare fence action names case-sensitively (rh#1470834)

-------------------------------------------------------------------
Thu Feb 03 17:02:58 UTC 2022 - Yan Gao <ygao@suse.com>

- Update to version 2.1.2+20211201.18f4b5d83:
- OCF: controld: Give warning when no-quorum-policy not set as freeze while using DLM (bsc#1129707)
- libcrmservice: Handle systemd service templates. (rh#2003151)

-------------------------------------------------------------------
Thu Feb 03 16:37:12 UTC 2022 - Yan Gao <ygao@suse.com>

- Update to version 2.1.2+20211124.91f4bad83:
- fencing: improve message for callback errors (rh#1470834)
- fencing,executor: improve mapping of legacy return code to execution status (rh#1470834)
- fencing: improve mapping of execution status to legacy return code
- attrd: Change to determine the processing of attrd depending on the section replacement location of CIB.
- based controld: Suppresses unnecessary Election execution.
- based: Makes the replace notification a comparison base for the hash value of the section.
- daemons: Convert schedulerd to the new IPC API.
- daemons: Use formatted output for scheduler help, errors, etc.
- Add a 'name' attribute to acl_target and acl_group elements (rh#1384420)
- libcrmservice: downgrade failed action messages (rh#1470834)
- fencer: improve messages for asynchronous results (rh#1470834)
- fencer: handle dynamic target query failures better (rh#1470834)
- fencing: set exit reason for internal execution errors (rh#1470834)

- Rebase:
  * bug-728579_pacemaker-stonith-dev-id.patch

-------------------------------------------------------------------
Wed Dec 22 13:36:05 UTC 2021 - Yan Gao <ygao@suse.com>

- fencer: get current time correctly
  * 0001-Fix-fencer-get-current-time-correctly.patch

-------------------------------------------------------------------
Wed Dec 22 13:25:51 UTC 2021 - Yan Gao <ygao@suse.com>

- Update to version 2.1.2+20211124.ada5c3b36 (Pacemaker-2.1.2):
- fencer: add missing space to topology message
- controller: handle remote connection start timeouts correctly

-------------------------------------------------------------------
Wed Dec 22 11:24:15 UTC 2021 - Yan Gao <ygao@suse.com>

- Update to version 2.1.1+20211116.8db4569e4 (Pacemaker-2.1.2-rc2):
- fencing: mark state as done if remapped "on" times out
- Fix OCF_RA_INSTALL_DIR Autoconf variable name in pkg-config files
- daemons: Free memory at the end of fail_pending_op.

-------------------------------------------------------------------
Wed Dec 22 11:17:24 UTC 2021 - Yan Gao <ygao@suse.com>

- Update to version 2.1.1+20211104.62c36e2b1 (Pacemaker-2.1.2-rc1):
- Use user_include_exclude_cb in crm_mon more. (clbz#5485)
- Only set default sections in crm_mon once. (clbz#5485)
- fencer: improve messages for dynamic target queries (rh#1470834)
- fencer: consolidate messages for asynchronous results (rh#1470834)
- fencer: log a message when out of memory for dynamic target search (rh#1470834)
- libcrmservice: distinguish local and global configuration errors (rh#1470834)
- libcrmservice: improve messages for pre-execution failures in child (rh#1470834)

-------------------------------------------------------------------
Wed Dec 22 10:35:46 UTC 2021 - Yan Gao <ygao@suse.com>

- Update to version 2.1.1+20211028.70f82d2c0:
- attrd: check election status upon loss of a voter to prevent unexpected pending (bsc#1191676)

-------------------------------------------------------------------
Wed Dec 22 10:23:59 UTC 2021 - Yan Gao <ygao@suse.com>

- Update to version 2.1.1+20211028.7ee8b5bdd:
- tools: select technical or human-friendly output of failed actions (rh#1470834)
- controller,executor: tweak action result messages (rh#1470834)
- install init scripts only if not using systemd
- executor: log execution status and exit reason with results (rh#1470834)
- executor: improve result message (rh#1470834)
- controller: log exit reason with action results (rh#1470834)
- controller: make executor result messages more consistent (rh#1470834)
- daemon metadata: Output OCF-1.1-style metadata for enum options
- libcrmservice: avoid memory leak when checking systemd unit existence
- fencer: avoid memory leak on async execution failure (rh#1470834)
- fencer: report correct code for CIB secret failure (rh#1470834)
- libcrmservice: improve exit codes for child execution failures (rh#1470834)
- cib,pacemakerd,libcrmcommon,libcrmservice: improve child completion logs (rh#1470834)
- executor: map nagios warnings to OCF "degraded" result code (rh#1470834)
- schemas: update crm_resource API schema for --force-* changes (rh#1470834)
- tools: show exit reason for crm_resource --force-* (rh#1470834)
- daemons: Be more careful about restarting subdaemons. (clbz#5225)
- daemons: Re-register UID/GID with corosync on restart.
- tools: handle crm_resource --force-* failures consistently (rh#1470834)
- tools: improve check for supported standards in crm_resource --force-* (rh#1470834)
- tools: map LSB status to OCF correctly with crm_resource --force-check (rh#1470834)
- tools: show detailed message with crm_resource --force-* failure (rh#1470834)
- daemons: Correct which subdaemons need the cluster.
- daemons: Keep track of which daemons need corosync.
- libcrmservice: improve handling of too many nagios parameters (rh#1470834)
- executor,libstonithd,libcrmservice: better error handling for generic actions (rh#1470834)
- libcrmservice: set exit reason for some memory errors when creating action (rh#1470834)
- executor,libcrmservice: set exit reason for invalid arguments (rh#1470834)
- executor: use exit reason from service library when available (rh#1470834)
- libcrmservice: set exit reason for internal errors (rh#1470834)
- tools: avoid double free with crm_resource --force-*
- tools: avoid error message when no stdout
- fencing: improve error handling when executing fence actions (rh#1470834)
- libcrmservice: check for memory errors when creating an action (rh#1470834)
- executor,libcrmservice: don't overwrite execution status from execute_action() (rh#1470834)
- executor,controller,libcrmservice: use PCMK_OCF_UNKNOWN_ERROR for timeouts (rh#1470834)
- libcrmservice: don't assert for mainloop error (rh#1470834)
- libcrmservice: ensure rc/status are set for meta-data failures (rh#1470834)
- libcrmservice: ensure synchronous file action always sets rc and status (rh#1470834)
- libcrmservice: use NAGIOS_STATE_UNKNOWN for internal nagios errors (rh#1470834)
- libcrmservice: use standard-appropriate exit code for signal management failures (rh#1470834)
- libcrmservice: properly detect systemd unit existence (rh#1470834)

- Rebase:
  * bug-728579_pacemaker-stonith-dev-id.patch
  * bug-943295_pacemaker-lrmd-log-notice.patch

-------------------------------------------------------------------
Mon Dec 20 14:35:20 UTC 2021 - Yan Gao <ygao@suse.com>

- Update to version 2.1.1+20210924.be206af22:
- fenced: Change query timeout calculation.
- resources: update HealthIOWait agent for OCF 1.1
- resources: add integer parameter validation to HealthIOWait
- resources: fix HealthIOWait validate action

-------------------------------------------------------------------
Mon Dec 20 12:44:34 UTC 2021 - Yan Gao <ygao@suse.com>

- Update to version 2.1.1+20210923.ce81ff72e:
- tools: Properly display supported output formats in crm_mon.
- libcrmservice: avoid possible use-of-NULL
- libcrmservice: update systemd agent meta-data for OCF 1.1
- libcrmservice: set default execution status for systemd actions to error (rh#1470834)
- libcrmservice: ensure status is set when masking systemd errors (rh#1470834)
- libcrmservice: ensure rc/status are set when parsing systemd results (rh#1470834)
- libcrmservice: ensure execution status is set after parsing status result (rh#1470834)
- libcrmservice: ensure rc/status are set after invoking systemd unit paths (rh#1470834)
- libcrmservice: ensure rc/status are set after systemd LoadUnit calls (rh#1470834)
- libcrmservice: ensure rc/status are set when loading systemd unit (rh#1470834)
- libcrmservice: set rc and status appropriately for systemd timeouts (rh#1470834)
- libcrmservice: handle corner cases when creating action (rh#1470834)
- libcrmservice: always set rc/status when executing files (rh#1470834)
- libcrmservice: always set rc/status when executing systemd actions (rh#1470834)
- libstonithd: check libcrmservice status rather than exit code for timeouts (rh#1470834)
- fencer: avoid assertions in delegate_from_xml()
- scheduler: quote execution status in failed action output (rh#1470834)
- liblrmd: don't mask errors from sending IPC (rh#1470834)
- executor: set exit reason for stonith resource action failures (rh#1470834)
- controller: set exit reason for executor communication timeout (rh#1470834)
- controller: use OCF timeout exit code for executor communication timeout (rh#1470834)
- controller: set exit reason when using synthesize_lrmd_failure() (rh#1470834)
- controller: set exit reason when using fake_op_status() (rh#1470834)
- controller,libpacemaker: set exit reason for internal errors (rh#1470834)

-------------------------------------------------------------------
Mon Dec 20 10:05:39 UTC 2021 - Yan Gao <ygao@suse.com>

- Update to version 2.1.1+20210910.89c5b06a3:
- controller: use "not connected" status for remote execution failure (rh#1470834)
- controller: send error reply if can't initiate action via executor (rh#1470834)
- controller: improve messages for failed resource agent actions (rh#1470834)
- tools: better error message if crm_resource can't create action (rh#1470834)
- controller: set exit reason when remote connection start fails (rh#1470834)
- tools: better error messages for crm_resource executor failures (rh#1470834)
- fenced: add support for mapping pcmk_delay_base pr node
- scheduler: use existing epoch-to-string function in failed action display (rh#1470834)
- scheduler: add exit reason to failed action string only if present (rh#1470834)
- scheduler: add timing details to failed action strings only when available (rh#1470834)
- scheduler: ensure failed action display handles NULL values (rh#1470834)
- fence_watchdog: fix malformed xml in metadata
- fenced: support escaped characters as values in pcmk_host_map
- fenced: Added nanosecond field to operation completion data.
- controller: use sensible message for poke of disconnected executor (rh#1470834)
- controller: improve messages for remote executor connection failure (rh#1470834)
- controller: improve message for failed local executor connection (rh#1470834)
- scheduler: reword "multiply active" message (rh#1470834)
- libcrmcluster: reword initial quorum message (rh#1470834)
- libcrmcluster: downgrade message for CPG messages sent (rh#1470834)
- scheduler: improve migration threshold message (rh#1470834)
- fencer: downgrade reboot remapping to notice
- controller: handle malformed CIB diffs better
- scheduler: avoid memory leak for invalid ordering constraints
- scheduler: improve bad id-ref handling
- scheduler: downgrade inverse ordering failure to warning
- fence_watchdog: fix version output needed for help2man
- rpm: package fence_watchdog in base-package
- watchdog-fencing: Silence warning without node restriction
- tools: If there are no nodes, don't add an extra blank line.
- watchdog-fencing: allow restriction to certain nodes

-------------------------------------------------------------------
Wed Dec  8 14:47:53 UTC 2021 - Yan Gao <ygao@suse.com>

- pacemaker.rpmlintrc: filter out shlib-policy-name-error (bsc#1191776)

-------------------------------------------------------------------
Wed Dec 08 14:14:53 UTC 2021 - Yan Gao <ygao@suse.com>

- Update to version 2.1.1+20210909.77db57872 (Pacemaker-2.1.1):
- liblrmd: avoid segfault on TLS connection errors
- tools: Fix a segfault when calling "crm_simulate -U".
- tools: make exit-code stdout/stderr consistent with --version

-------------------------------------------------------------------
Fri Sep 10 14:17:49 UTC 2021 - Yan Gao <ygao@suse.com>

- Update to version 2.1.0+20210816.c6a4f6e6c (Pacemaker-2.1.1-rc3) :
- crm_resource: translate LSB rc to exit code and fix resources_find_service_class() call
- controller: ensure newly joining node learns the node names of non-DCs (bsc#1180618)
- controller: ensure lost node's transient attributes are cleared without DC (rh#1986998)
 
-------------------------------------------------------------------
Fri Sep 10 14:04:23 UTC 2021 - Yan Gao <ygao@suse.com>

- Update to version 2.1.0+20210806.a64ad221a (Pacemaker-2.1.1-rc2):
- pacemakerd: show correct error message if can't request shutdown
- scheduler: Output the clone header if there are no instances.
- scheduler: Sort brief output of resources.
- scheduler: Fix display of active resources on offline nodes.
- tools: avoid memory leaks in crm_mon
- tools: avoid (insignificant) memory leaks

-------------------------------------------------------------------
Fri Sep 10 13:45:08 UTC 2021 - Yan Gao <ygao@suse.com>

- Update to version 2.1.0+20210727.9e3a841a3 (Pacemaker-2.1.1-rc1):
- scheduler: Fix XML output of cloned groups.
- scheduler: Condense group and clone status in output.
- scheduler: Only output the clone header if necessary.
- scheduler: Mark partially active groups in output.
- scheduler: Tweak resource filtering for groups.
- libcrmcommon: Also allow string arguments that start with a dash.
- tools: Audit command line options.

-------------------------------------------------------------------
Fri Sep 10 11:30:27 UTC 2021 - Yan Gao <ygao@suse.com>

- Update to version 2.1.0+20210721.0bf0e8547:
- scheduler: respect runnable argument when creating pseudo op
- scheduler: pe_order_implies_first should matter if 'then' is required
- scheduler: don't make optional constraints with group members mandatory
- scheduler: avoid invalid transition when group member unmanaged (clbz#5423)

-------------------------------------------------------------------
Fri Sep 10 11:00:25 UTC 2021 - Yan Gao <ygao@suse.com>

- Update to version 2.1.0+20210720.202b37962:
- libcrmcommon: Allow negative numbers as cmdline options.
- tools: The --get-value option does not require an arg.

-------------------------------------------------------------------
Fri Sep 10 10:40:20 UTC 2021 - Yan Gao <ygao@suse.com>

- Update to version 2.1.0+20210716.1ee04e687:
- scheduler: add test for probe of unmanaged resource on pending node (bsc#1188653)
- scheduler: update existing tests for probe scheduling change (bsc#1188653)
- scheduler: don't schedule probes of unmanaged resources on pending nodes (bsc#1188653)

-------------------------------------------------------------------
Fri Sep 10 10:32:53 UTC 2021 - Yan Gao <ygao@suse.com>

- Update to version 2.1.0+20210716.1029946ae:
- crm_resource: report not supported for --force-* w/systemd, upstart, nagios and bundled resources
- Pacemaker Explained: document how fence agent internal timeouts work (clbz#5473)
- Pacemaker Explained: clarify pcmk_host_check default (clbz#5475)
- cluster: Use most up-to-date corosync API calls
- rpm: assume _rundir macro is present

-------------------------------------------------------------------
Thu Sep 09 12:40:48 UTC 2021 - Yan Gao <ygao@suse.com>

- Update to version 2.1.0+20210701.9df198b18:
- libcrmcommon: Correctly handle case-sensitive ids of xml objects when changing a value. (bsc#1187414)

-------------------------------------------------------------------
Thu Sep 09 12:33:10 UTC 2021 - Yan Gao <ygao@suse.com>

- Update to version 2.1.0+20210701.b295080a7:
- scheduler: Fix group-by-node resource HTML output.
- scheduler: Fix list errors in bundle HTML output.
- scheduler: Remove an unnecessary blank line in HTML output.
- scheduler: Remove an unnecessary space in HTML output.

-------------------------------------------------------------------
Thu Sep 09 12:12:51 UTC 2021 - Yan Gao <ygao@suse.com>

- Update to version 2.1.0+20210623.2a6d5ae68:
- cts: Update test files with crm_mon new xml output. (bsc#1187694)
- Increase PCMK__API_VERSION for new crm_mon xml output. (bsc#1187694)
- libpe: Added crm_mon xml output cluster timing settings. (bsc#1187694)

-------------------------------------------------------------------
Thu Sep 09 12:09:27 UTC 2021 - Yan Gao <ygao@suse.com>

- Update to version 2.1.0+20210623.34ef9b169:
- pacemaker-attrd: avoid repeated unfencing of remote nodes (rh#1961857)
- pacemaker-attrd: ensure node ID is only set for attributes when known
- pacemaker-attrd: check for remote nodes in peer update callback
- controller: check whether unfenced node was remote node

-------------------------------------------------------------------
Mon Aug 16 15:45:35 UTC 2021 - Yan Gao <ygao@suse.com>

- Update to version 2.1.0+20210622.485ce3a4d:
- libcrmcommon: Increase PCMK__API_VERSION for new crm_resource output. (rh#1686426)
- tools: Add the node-summary to crm_simulate output. (rh#1686426)

-------------------------------------------------------------------
Mon Aug 16 15:24:26 UTC 2021 - Yan Gao <ygao@suse.com>

- Update to version 2.1.0+20210617.8c0c4eff9:
- Purge remote node attribute when the node is up. (bsc#1186693)
- Merge:
  * bsc#1186693-clean-attrd-attributes-when-remote-node-is-up.patch

-------------------------------------------------------------------
Mon Aug 16 14:57:35 UTC 2021 - Yan Gao <ygao@suse.com>

- Update to version 2.1.0+20210617.1df5eb2c1:
- fenced: Wrong device may be selected when "dynamic-list" is specified. (cl#5474)

-------------------------------------------------------------------
Mon Aug 16 14:45:12 UTC 2021 - Yan Gao <ygao@suse.com>

- Update to version 2.1.0+20210616.dee8cafe5:
- attribute: Add OCF_CHECK_LEVEL handling in the validate-all action
- attribute: Add unique-group to appropriate <parameter> entries
- attribute: Remove unique from all <parameter> entries
- attribute: Update OCF version to 1.1

-------------------------------------------------------------------
Mon Aug 16 13:26:54 UTC 2021 - Yan Gao <ygao@suse.com>

- Update to version 2.1.0+20210609.40b86522a:
- tools: Use the new resource-agent-action message. (rh#1644628)
- tools: Add an output message for resource actions. (rh#1644628)
- tools: Use simple XML lists for resource actions as well. (rh#1644628)
- tools: Add an overridden params output message. (rh#1644628)
- tools: Add an agent-status message for crm_resource. (rh#1644628)
- libcrmcommon: Increase PCMK__API_VERSION for new crm_resource output. (rh#1644628)
- xml: Update the crm_resource schema for XML output. (rh#1644628)
- libcrmcommon: Add OCF_OUTPUT_FORMAT to crm_resource environment. (rh#1644628)

-------------------------------------------------------------------
Mon Aug 16 12:35:21 UTC 2021 - Yan Gao <ygao@suse.com>

- Update to version 2.1.0+20210608.3c1bae500:
- ping: Add OCF_CHECK_LEVEL handling in the validate-all action
- ping: Add a reload-agent action to handle the reloadable parameters
- include: Bump feature set to 3.10.2. (rh#1955792)
- tools: Add OCF_CHECK_LEVEL to crm_resource environment. (rh#1955792)
- ping: Add unique-group to appropriate <parameter> entries
- ping: Remove unique from all <parameter> entries
- ping: Update OCF version to 1.1
- xml: Add schema for pacemakerd.
- include: Bump CRM_FEATURE_SET for new pacemakerd args.
- daemons: Conditionally enable logging in pacemakerd.
- daemons: Output the pacemakerd feature list in XML.
- daemons: Convert pacemakerd to formatted output.
- pacemaker.service: Don't start pacemakerd with -f.
- daemons: Use glib for command line handling in pacemakerd.
- Add verbose debug mode which logs ping and fping output when set
- daemons: Use the new IPC API in pacemakerd for shutdown.
- daemons: Ignore ACK messages in pacemakerd dispatch.

-------------------------------------------------------------------
Mon Jul 19 17:48:58 UTC 2021 - Yan Gao <ygao@suse.com>

- Update to version 2.1.0+20210608.7c3f66070 (Pacemaker-2.1.0):
- schemas: Add "digests" and "digest" elements to digests.rng. (rh#1967087)

-------------------------------------------------------------------
Mon Jul 19 17:32:27 UTC 2021 - Yan Gao <ygao@suse.com>

- Update to version 2.0.5+20210601.b7762381d (Pacemaker-2.1.0-rc3):
- XML: bump API schema version
- tools: get `crm_verify --xml-pipe/-p` working again (bsc#1186576)
- rpm: respect prefix when installing resource agents
- tools: Return ENXIO from show_metadata.
- tools: Return ENOTUNIQ in find_resource_attr.
- executor: log OCF resource agent search path at start-up
- tools: Fix handling certain error codes in crm_resource.
- pcmk__pid_active: Lower the log level when readlink() is EACCES

- Drop obsolete:
  * 0001-Log-libcrmcommon-lower-message-on-reading-proc-file-.patch

-------------------------------------------------------------------
Mon Jul 19 17:01:48 UTC 2021 - Yan Gao <ygao@suse.com>

- Update to version 2.0.5+20210519.4edf50cc9 (Pacemaker-2.1.0-rc2):
- rpm: add option for sbd sync default
- tools: Return the right error codes in crm_resource.
- configure: add --with-sbd-sync-default option
- libcrmcommon: warn if sbd sync environment is invalid
- libcrmcommon: warn if can't get user information for log file
- pacemakerd: don't try to repeat shutdown when disconnecting CFG
- executor,fencer: tell user if additional logfile is unusable
- libcrmcommon: use return code correctly when getting daemon user ID
- rpm: minor clean-up of spec
- rpm: add configuration global for bug URL
- liblrmd: improve messages when loading Pacemaker Remote key
- liblrmd: return sensible value when remote connection fails
- liblrmd: improve failure messages when initializing remote key
- liblrmd: improve failure messages when cacheing remote key
- liblrmd: return sensible code for unsupported executor type
- liblrmd: improve messages for remote reply failures
- liblrmd: use sensible return code for disconnection in remote send/reply
- liblrmd: richer return code when sending remote message
- fencing: register/remove the watchdog device
- crm_resource: improve help text
- libpe_status: Don't output an extraneous header under crm_mon -b.

-------------------------------------------------------------------
Fri Jul 16 14:35:43 UTC 2021 - Yan Gao <ygao@suse.com>

- Update to version 2.0.5+20210427.aa4bdaa2f:
- schedulerd: Correctly calculate priority-fencing-delay from Master resource stop failure.(Fix:#CLBZ5467)

-------------------------------------------------------------------
Fri Jul 16 14:32:18 UTC 2021 - Yan Gao <ygao@suse.com>

- Update to version 2.0.5+20210427.529de7174:
- tools: avoid exception when pcmk_simtimes is used without --verbose
- libcrmcluster: improve CPG validation messages
- libcrmcluster: use more efficient payload length check
- liblrmd: correctly check for out-of-memory condition
- executor: properly initiate quicker fence device monitor
- Fix maint-mode output on curses mode.

-------------------------------------------------------------------
Fri Jul 16 13:42:39 UTC 2021 - Yan Gao <ygao@suse.com>

- Update to version 2.0.5+20210422.d469c6340:
- controller: check for empty OCF version as well as NULL
- libcrmservice: always advertise OCF 1.1 support
- controller: always refresh agent meta-data after start
- controller: info message when agent supports newer OCF 1.x standard
- libcrmcommon: bump feature set for reload-agent support
- libcrmservice: advertise OCF 1.1 support to resource agents
- scheduler: support OCF 1.1 reload-agent action
- controller: support OCF 1.1 reload-agent action
- resources: support OCF 1.1 standard in ocf:pacemaker:remote
- resources: improve Pacemaker Remote meta-data
- controller: log the OCF version supported by a resource agent

-------------------------------------------------------------------
Fri Jul 16 11:49:00 UTC 2021 - Yan Gao <ygao@suse.com>

- Update to version 2.0.5+20210420.e82d2a1bc:
- Convert crm_attribute to use glib for cmdline handling.
- Support "sync-crash" option with PCMK_panic_action
- tools: Don't reference the output object in cmdline processing.
- libcib: revert deprecation of cib_apply_patch_event()
- CIB: allow resource-stickiness default to be set at build time
- rpm: detect when to use --enable-compat-2.0 correctly
- Support "sync-reboot" option with PCMK_panic_action
- tools: Set the output object when running crm_resource --restart.
- pacemakerd,pacemaker-remoted: simplify help URL in systemd unit file
- crm_mon: try to connect CIB while pacemakerd shutting down

- Rebase:
  * bug-995365_pacemaker-cts-restart-systemd-journald.patch
  * pacemaker-cts-StartCmd.patch

-------------------------------------------------------------------
Fri Jul 16 09:47:23 UTC 2021 - Yan Gao <ygao@suse.com>

- Update to version 2.0.5+20210409.6c31efd67:
- libcrmcommon: bump feature set to 3.9.0
- scheduler: provide notify_{,un}promoted_{resource,uname} variables
- schema: add promoted-only to crm_mon API schema
- libpe_status: use "promoted-only" in API schema for bans
- tools: deprecate crm_master
- tools: crm_attribute -p/--promotion option to operate on promotion score
- tools: crm_resource now supports --promoted option
- CIB: allow OCF 1.1 role names in configuration
- scheduler: accept case-insensitive role names in actions in templates
- tools: use OCF 1.1 role names in crm_resource --ban constraints
- scheduler: use OCF 1.1 role names in output
- scheduler: use OCF 1.1 role names in log messages
- scheduler: support OCF 1.1 role names in configuration

-------------------------------------------------------------------
Thu Jul 15 13:28:52 UTC 2021 - Yan Gao <ygao@suse.com>

- Update to version 2.0.5+20210408.c71bd880c:
- tools: crm_simulate --pending is deprecated.
- tools: Make some small changes to the crm_simulate man page.
- controller: correctly handle remote node fencing after Y2038
- controller: correctly handle node shutdowns after Y2038
- libcrmcommon: bump feature set for recent configuration interpretation changes
- tools: constrain node IDs to non-negative values for crm_node -N
- tools: treat invalid error codes as unknown in crm_error
- scheduler: don't treat invalid duration fields as -1
- scheduler: constrain promoted-max and promoted-node-max to non-negative values
- scheduler: constrain clone-max to non-negative values
- scheduler: constrain clone-min to non-negative values
- scheduler: constrain clone-node-max to non-negative values
- all: allow full unsigned int range for PCMK_ipc_buffer
- scheduler: Use default when series max value is out of bounds
- scheduler: handle series max of 0 better
- scheduler: handle exit via signal or main loop similarly
- fencer: use 1 (default) instead of -1 (unlimited) for invalid pcmk_action_limit
- all: constrain minimum when parsing certain internally generated integers
- CIB: constrain remote-tls-port and remote-clear-port to port range
- scheduler: constrain resource priorities and node-health-base to score range
- controller: bound stonith-max-attempts to a minimum of 1
- scheduler: handle last-rc-change values after Y2038
- scheduler: handle ticket last-granted dates after 2038
- all: use default value when a long long integer can't be parsed
- tools: Don't print to stderr if crm_simulate -V is used.

-------------------------------------------------------------------
Thu Jul 15 12:45:07 UTC 2021 - Yan Gao <ygao@suse.com>

- Update to version 2.0.5+20210406.6b23b2bb4:
- Add schema for new crm_simulate options. (rh#1686426)
- tools: Add new options to crm_simulate. (rh#1686426)

-------------------------------------------------------------------
Thu Jul 15 12:34:04 UTC 2021 - Yan Gao <ygao@suse.com>

- Update to version 2.0.5+20210405.43fcdeb35:
- xml: Add schema for new crm_simulate output.
- include: Bump FEATURE_SET for new crm_simulate args.
- scheduler: Use formatted output for node weights.
- tools: Log crm_simulate output for certain cmdlines.
- Use formatted output for scheduler node actions.
- tools: Use formatted output for simulation timings.
- tools: Add the beginnings of formatted output to crm_simulate.

-------------------------------------------------------------------
Thu Jul 15 12:17:34 UTC 2021 - Yan Gao <ygao@suse.com>

- Update to version 2.0.5+20210330.7fa194778:
- libcrmcommon: Allow setting the formatted output log level.
- libcrmcommon: Flush output in text_list_item.

-------------------------------------------------------------------
Thu Jul 15 10:12:36 UTC 2021 - Yan Gao <ygao@suse.com>

- Update to version 2.0.5+20210319.c75f0a34a:
- crm/cib tools: implement CIB_file="-" to accept CIB from stdin
- tools: Promote a couple info messages to errors.

-------------------------------------------------------------------
Sun Mar 21 17:21:29 UTC 2021 - Yan Gao <ygao@suse.com>

- Update to version 2.0.5+20210310.83e765df6:
- controller: re-joined node gets the host names of non-DC nodes (bsc#1180618)
- Merge:
  * bsc#1180618-0001-Fix-crmd-update-crm_peer_cache.patch

-------------------------------------------------------------------
Sun Mar 21 16:05:07 UTC 2021 - Yan Gao <ygao@suse.com>

- Update to version 2.0.5+20210309.90b3e455b:
- Allow the none format in other command line tools.
- scheduler,tools: stop using last-run in CIB status

-------------------------------------------------------------------
Sun Mar 21 15:32:59 UTC 2021 - Yan Gao <ygao@suse.com>

- Update to version 2.0.5+20210302.64e0c771d:
- crm_mon.rng/crm_resource.rng: Change the schema type of 'expected' and 'call' to integer. (rh#1931332)
- Merge:
  * rh#1931332-0003-Med-Change-the-schema-type-of-expected-and-call-to-i.patch
  * rh#1931332-0002-Med-Copy-crm_mon.rng-and-crm_resource.rng-in-prepara.patch
  * rh#1931332-0001-Med-Generate-xml-crm_mon.rng-from-the-contents-of-xm.patch
  * rh#1931332-0000-Feature-xml-Move-resource-related-XML-schema-into-it.patch

-------------------------------------------------------------------
Sun Mar 21 15:13:49 UTC 2021 - Yan Gao <ygao@suse.com>

- Update to version 2.0.5+20210302.f537b60c2:
- fenced: retry getting metadata until we get it
- require glib 2.42.0 or later

-------------------------------------------------------------------
Sun Mar 21 14:39:24 UTC 2021 - Yan Gao <ygao@suse.com>

- Update to version 2.0.5+20210224.63d2fa7c2:
- pacemakerd: downgrade corosync connection loss messages
- libcrmcommon: be consistent with IPC server names in messages
- CIB: deprecate support for can_fail action meta-attribute
- CIB: deprecate remove-after-stop cluster property
- pacemakerd,tools: use high-resolution sleep in a couple of places
- pacemakerd: use high-resolution sleep functions if available
- configure: drop support for --with-acl option
- rpm: update for new legacy links default
- configure: add --with-concurrent-fencing-default option
- scheduler: allow 2.0 compatibility mode for certain output
- include: Bump CRM_FEATURE_SET to 3.7.2.
- tools: Convert crm_verify to use formatted output.
- tools: Use glib for command line handling in crm_verify.

- iso8601: prevent sec overrun before adding up as long long
- Merge:
  * 0001-Fix-iso8601-prevent-sec-overrun-before-adding-up-as-.patch

- crmadmin: tweaks
- scheduler: route monitor cancellations behind moving remote connections correctly
- cluster: try to reconnect with corosync if it goes down

- Rebase:
  * pacemaker-nagios-plugin-dir.patch

-------------------------------------------------------------------
Sat Mar 20 13:53:24 UTC 2021 - Yan Gao <ygao@suse.com>

- Update to version 2.0.5+20210223.dbc27b2ac:
- fencer: optimize merging of fencing history by removing unneeded entries on creation of history diff (bsc#1181744)
- Merge:
  * bsc#1181744-0004-Refactor-fencer-optimize-merging-of-fencing-history-.patch

- fencing: new function stonith_op_state_pending() for checking if a fencing operation is in pending state (bsc#1181744)
- Merge:
  * bsc#1181744-0003-Refactor-fencing-new-function-stonith_op_state_pendi.patch

- fencer: update outdated pending operations according to returned ones from remote peer history (bsc#1181744)
- Merge:
  * bsc#1181744-0002-Fix-fencer-update-outdated-pending-operations-accord.patch

- fencer: broadcast returned fencing operations to update outdated pending ones in remote peer history (bsc#1181744)
- Merge:
  * bsc#1181744-0001-Fix-fencer-broadcast-returned-fencing-operations-to-.patch

-------------------------------------------------------------------
Sat Mar 20 13:45:07 UTC 2021 - Yan Gao <ygao@suse.com>

- Update to version 2.0.5+20210212.a4892ccb5:
- Fix a problem with crm_resource exit code handling.
- Correct output of "crm_resource --locate" in case of clones. (rh#1925681)
- tools: Add newlines to the description string in crm_simulate.
- tools: Straighten out return codes in crm_diff.
- libcrmcommon: Set extra_headers to NULL after freeing it.
- tools: Mark a couple things as volatile in crm_mon.
- tools: Allow other output formats for crm_mon -d.
- libcrmcommon: Try to make sure formatted output is always written.
- libcib, tools: Use the formatted output password prompt.
- libcrmcommon: Add a prompt formatted output message.
- tools, libcrmcommon: Add a progress formatted output message.

-------------------------------------------------------------------
Sat Mar 20 12:38:19 UTC 2021 - Yan Gao <ygao@suse.com>

- Update to version 2.0.5+20210205.46cf48d27:
- execd: Skips merging of canceled fencing monitors.(Fix:#CLBZ5393)
- Merge:
  * 0001-Mid-execd-Skips-merging-of-canceled-fencing-monitors.patch

- crm_mon: detect when run on remote-node

- tools: get cibsecret stash working again
- Merge:
  * 0001-Fix-tools-get-cibsecret-stash-working-again.patch

- fencing: remove any devices that are not installed
- Merge:
  * 0001-Fix-fencing-remove-any-devices-that-are-not-installe.patch

- crm_mon: suppress pacemakerd-status for non-text output
- crm_mon: retry fencer connection as not fatal initially
- tools: Report pacemakerd in state waiting for sbd
- controller,scheduler,CTS: use ":" instead of "::" when displaying provider

-------------------------------------------------------------------
Sat Mar 20 11:53:36 UTC 2021 - Yan Gao <ygao@suse.com>

- Update to version 2.0.5+20210128.7c8114f68:
- scheduler: process remote shutdowns correctly (rh#1898457)
- scheduler: warn if lrm_resource has no ID
- scheduler: warn if node state has no ID or uname

-------------------------------------------------------------------
Fri Mar 19 14:36:46 UTC 2021 - Yan Gao <ygao@suse.com>

- Update to version 2.0.5+20210128.aa41a984d:
- cibsecret: use crmadmin -N (which also lists guest and remote nodes) to get nodes to sync to
- tools: Free --resource=/--node= memory in crm_mon.
- scheduler: Free the result of pe__node_display_name in one place.
- tools: Free command-line related memory.
- libcrmcommon: Don't leak memory in pcmk__cmdline_preproc.
- libcrmcommon: Free the results in various test cases.
- libpe_rules, libcrmcommon: Free the whole xml doc, not just the node.
- crmadmin: use cluster instead of member term and remove pacemaker_remote node type
- crmadmin: list remote/guest nodes and add parameter/variable to choose which node type(s) to list

-------------------------------------------------------------------
Fri Mar 19 13:28:44 UTC 2021 - Yan Gao <ygao@suse.com>

- Update to version 2.0.5+20210121.55598be5e:
- tools: The 'm' key in crm_mon is a cycle, not a toggle.
- tools: Describe interactive crm_mon use in help and man page.
- tools: Attempt to reestablish connections in crm_mon. (rh#1880426, rh#1466875)
- tools: A lack of stonith history is not fatal in crm_mon. (rh#1880426)
- tools: Report if getting fencing history failed in crm_mon.
- tools: Adjust fencing shown indicator in crm_mon.
- corosync: Add cfg_trackstart/stop calls

-------------------------------------------------------------------
Tue Mar 16 17:04:01 UTC 2021 - Yan Gao <ygao@suse.com>

- Update to version 2.0.5+20210114.ad074d869:
- all: use high-resolution timestamps in detail log when available (bsc#1197668)
- CIB: remove cibmon command

-------------------------------------------------------------------
Tue Mar 16 16:41:28 UTC 2021 - Yan Gao <ygao@suse.com>

- Update to version 2.0.5+20210113.a4bbcb033:
- scheduler: implement new critical and influence options (rh#1371576)
- xml: allow colocation constraints to take "influence" option (rh#1371576)

-------------------------------------------------------------------
Tue Mar 16 16:18:32 UTC 2021 - Yan Gao <ygao@suse.com>

- Update to version 2.0.5+20210112.631bb9c89:
- tools: bump feature set for crm_resource --digests (rh#1872376)
- tools: add crm_resource --digests option (rh#1872376)
- tools: handle required node names better in crm_resource

-------------------------------------------------------------------
Tue Mar 16 14:22:22 UTC 2021 - Yan Gao <ygao@suse.com>

- Update to version 2.0.5+20210111.c600d9092:
- Build: tools: make stricter compilers happy
- Build: resources: drop ocf:pacemaker:pingd
- Build: require libqb 0.17.0 or later
- Build: require glib 2.32.0 or later
- Build,Doc,Test: all: drop support for Python 2

- Rebase:
  * pacemaker-Wno-format-signedness.patch

-------------------------------------------------------------------
Tue Mar 16 13:48:17 UTC 2021 - Yan Gao <ygao@suse.com>

- Update to version 2.0.5+20210108.1f1408ca7:
- scheduler: multiple issues with value-source in location rules (rh#1872376)
- tools: respect rules when showing node attributes in crm_mon (rh#1872376)
- scheduler: calculate secure digest properly for node attribute rules (rh#1872376)
- scheduler: treat NULL and empty string the same in literal attribute comparisons (rh#1872376)
- scheduler: don't include timeout in secure digests (rh#1872376)
- scheduler: filter non-private parameters properly for digest (rh#1872376)
- libcrmcommon: compare CRM_meta_ properly (rh#1872376)
- liblrmd: Limit node name addition to proxied attrd update commands (rh#1907726)

- Merge:
  * rh#1907726-0001-Fix-liblrmd-Limit-node-name-addition-to-proxied-attr.patch

-------------------------------------------------------------------
Fri Jan 29 12:42:52 UTC 2021 - Yan Gao <ygao@suse.com>

- pacemakerd: downgrade the warning about SBD_SYNC_RESOURCE_STARTUP to notice (bsc#1180966)
  * bsc#1180966-0001-Log-pacemakerd-downgrade-the-warning-about-SBD_SYNC_.patch

-------------------------------------------------------------------
Thu Jan 28 14:28:18 UTC 2021 - Yan Gao <ygao@suse.com>

- Update to version 2.0.5+20210104.8ae19fdf9:
- attrd: prevent leftover attributes of shutdown node in cib (bsc#1173668)
- Merge:
  * bsc#1173668-0001-Fix-attrd-prevent-leftover-attributes-of-shutdown-no.patch

-------------------------------------------------------------------
Thu Jan 28 14:22:47 UTC 2021 - Yan Gao <ygao@suse.com>

- Update to version 2.0.5+20201218.c67665496:
- books: enable Sphinx build
- books: remove Publican
- xml: Update XML schema for crm_resource changes.
- libpacemaker: Also flatten XML location constraint output.
- libpacemaker: Various small fixes to location-list.
- libpacemaker: Fix printing out location constraints.
- libpacemaker: Correct loop detection in rscs_colocated_with_list.
- libpacemaker: Flatten XML output for colocations.
- libpacemaker: Pass the correct resource to recursive calls.
- tools: Don't display generic lists for colocations and constraints.
- libpacemaker: Change the colocation list headings.
- libpacemaker: Don't show an empty locations list.
- libcrmcluster: properly check CPG payload size
- libcrmcluster: correctly return error for invalid payload size
- libcrmcommon: set errno properly on IPC connection failure
- scheduler: Don't output a resource header with no list.
- libcib: Cleanup at signoff.Fix(CLBZ#5457)
- scheduler: add class back to multiple recovery message
- fencer: standardize fence device references in log messages
- fencer: improve wording of various messages
- fencer: correct order of arguments to a message
- fencer: log operation IDs more consistently
- fencer: log operation state as readable string rather than integer enum value
- fencer: prefer "fencing" to "stonith"
- fencer: use singular or plural correctly in messages
- pacemakerd: improve error message when -S can't connect
- libcrmcommon: improve messages when adding a log file
- libcrmcommon: drop unformatted log message about log permissions (bsc#1190821)
- libcrmcommon: drop unnecessary parent check when adding log file
- daemons: improve client name used in log messages
- ipc_client: Use libqb to get auth data for ipcc connections

- Rebase:
  * bug-806256_pacemaker-log-level-notice.patch
  * bug-728579_pacemaker-stonith-dev-id.patch
  * bug-812269_pacemaker-fencing-device-register-messages.patch

-------------------------------------------------------------------
Mon Jan 25 12:29:58 UTC 2021 - Yan Gao <ygao@suse.com>

- Update to version 2.0.5+20201203.dc64a43f9:
- libpacemaker: add public API functions for cluster queries
- libs: Remove extra whitespace in list_item calls.
- schedulerd: Fixed processing to expand meta_attributes. Fix(#CLBZ:5451)
- scheduler: Fix output of failed actions without an operation_key.
- scheduler: treat missing parameter as NULL in rules with value-source (rh#1872376)
- scheduler: correctly skip dangling id-ref(rh#1872376)
- controld: Retry connection failure when controld is stopped.(Fix:CLBZ#5445)
- travis: run cts-exec with --force-wait option (bsc#1177489)
- cts-exec: add --force-wait/-w option (bsc#1177489)
- cts-fencing: add --force-wait/-w option (bsc#1177489)
- cts-exec: add --timeout/-t option (bsc#1177489)
- cts-fencing: add --timeout/-t option (bsc#1177489)
- cts-exec: optimize exec regression testing via appropriate synchronization with execd (bsc#1177489)
- cts-fencing: optimize fencing regression testing via appropriate synchronization with fenced (bsc#1177489)
- Pacemaker Explained: Explain limitations of node attr expressions. (rh#1891929)
- include: Bump CRM_FEATURE_SET to 3.6.3.
- xml: Add a schema for new crm_resource output.
- tools: Use formatted output for stacks and constraints.
- tools: Use formatted output for resource searching.
- tools: Use formatted output for crm_resource checks.
- tools: Use formatted output for CTS printing in crm_resource.
- scheduler, tools: Add a new node-and-op output message.
- tools: Use formatted output for crm_resource info messages.
- tools: Use formatted output for finding resources.
- tools: Use formatted output for resource output in crm_resource.
- scheduler: Add a message for resource config printing.
- tools: Use formatted output for props, attrs, and metadata.
- liblrmd: Add output messages for agents, providers, and standards.
- tools: Use the existing resource-list message in crm_resource.
- tools: Add an output message for a list of resource names.
- tools: Add the beginnings of formatted output to crm_resource.
- scheduler: filter Pacemaker-supplied stonith parameters from secure hash (rh#1872376)
- scheduler: use same default private parameter list as controller
- libstonithd: improve filtering of Pacemaker-handled parameters
- scheduler: properly compute digest of non-sensitive resource parameters (rh#1872376)
- libcrmcommon: Prevent a segfault in pcmk__cmdline_preproc.
- tools: Save the optarg parameter for --list-ocf-alternatives.
- xml: Add a generic list XML schema file.
- xml: Move resource-related XML schema into its own file.
- libcrmcommon: Automatically lower case XML list names.
- xml: add schema for new crmadmin output
- crmadmin: implement formatted output (bsc#1178865)

- Drop obsolete:
  * bsc#1178865-0001-Fix-crmadmin-printing-DC-quietly-if-needed.patch

-------------------------------------------------------------------
Sun Dec 06 12:32:29 UTC 2020 - Yan Gao <ygao@suse.com>

- Update to version 2.0.5+20201202.ba59be712 (Pacemaker-2.0.5):
- xml: Revert to correct schema for alerts-3.5
- tools: match calloc() with free() in crm_resource
- tools: "Connectivity is lost" may not be displayed even if the ping communication is lost.

-------------------------------------------------------------------
Sun Dec 06 12:22:38 UTC 2020 - Yan Gao <ygao@suse.com>

- Update to version 2.0.4+20201116.ae2c04b54:
- tools: make cibsecret use bash
- fencer: allow peer configuration requests

-------------------------------------------------------------------
Sun Dec 06 12:12:36 UTC 2020 - Yan Gao <ygao@suse.com>

- Update to version 2.0.4+20201027.31aa4f551:
- pacemakerd: handle shutdown requests better
- daemons,libcrmcommon: send status code with client acks
- fencer: restrict certain IPC requests to privileged users (CVE-2020-25654, bsc#1177916)
- pacemakerd: ignore shutdown requests from unprivileged users (CVE-2020-25654, bsc#1177916)
- pacemakerd: check client for NULL before using it
- executor: restrict certain IPC requests to Pacemaker daemons (CVE-2020-25654, bsc#1177916)
- executor: return appropriate error code when no remote support
- executor: mark controller connections to pacemaker-remoted as privileged
- executor: show CRM_OP_REGISTER rc in debug message

-------------------------------------------------------------------
Sun Dec 06 11:54:44 UTC 2020 - Yan Gao <ygao@suse.com>

- Update to version 2.0.4+20201022.354625c62:
- tools: revert some changes in crm_resource NULL checks
- xml: Mark new crm_mon attributes as optional.
- scheduler: fix build when DEFAULT_CONCURRENT_FENCING_TRUE is set

-------------------------------------------------------------------
Sun Dec 06 11:42:57 UTC 2020 - Yan Gao <ygao@suse.com>

- Update to version 2.0.4+20201019.878658661:
- cib: create reply when needed for diff
- cib: only build reply when needed

-------------------------------------------------------------------
Fri Oct 30 13:45:28 UTC 2020 - Yan Gao <ygao@suse.com>

- Update to version 2.0.4+20201014.b0ef36d82:
- cibsecret: read value to set from input (or stdin) if not specified
- libcrmcommon: Don't leak memory in pcmk__cmdline_preproc.
- tools: Don't leak options.xml_file in crm_simulate.
- tools: Prevent a potential memory problem in crm_resource.
- tools: Use glib for cmdline handling in crmadmin.
- tools: Apply resource filtering to failed actions in crm_mon.
- scheduler: require pre-/post-start notifications correctly
- tools: avoid memory leak if crm_mon --include/--exclude have bad syntax
- pacemakerd: change one message so CTS recognizes it
- libcrmcommon: check controller API object for NULL
- fencer: properly deactivate stonith API callbacks
- controld: Avoiding Broken pipe when shutdown.
- Stateful: add ability to return custom rc saved in state file
- Dummy: add ability to return custom rc saved in state file
- Use effective OCF rc-code to avoid increasing failcount for DEGRADED statuses
- tools: Don't display crm_resource error messages twice.
- Accept PCMK_OCF_DEGRADED and PCMK_OCF_DEGRADED_MASTER status codes
- libcrmservice: avoid dangling reference after DBus memory allocation error
- libcrmservice: avoid double logging an error
- libcrmservice: improve DBus log messages
- fenced: Avoiding Broken pipe when shutdown.
- controld: Avoiding Broken pipe when shutdown.
- attrd: Avoiding Broken pipe when shutdown.
- Dont add OCF_RESKEY_ prefix to OCF_CHECK_LEVEL
- controller: recognize reprobe requests correctly again
- tools: allow crm_resource --option to be specified multiple times again
- tools: only create validate parameters table when needed
- tools: use glib types/free in crm_resource where appropriate to GOption
- xml: Add a new schema version for crm_mon.
- scheduler: Display stop-all-resources in cluster options.
- scheduler: Add management status to group output. (rh#1748139)
- scheduler: Change output for disabled clones. (rh#1748139)
- scheduler: Change output for disabled groups. (rh#1748139)
- scheduler: don't select instance to be promoted on a guest that can't run
- fenced: Set the delegate correctly when fencing fails.
- scheduler: improve messages when creating actions
- libcrmcommon: Warn instead of err in scan_ll() (rh#1874391)
- libcrmcommon: Don't always write out a name attribute.
- scheduler, tools: Add a resource-list message.

- Rebase:
  * bug-728579_pacemaker-stonith-dev-id.patch

-------------------------------------------------------------------
Fri Oct 30 13:11:41 UTC 2020 - Yan Gao <ygao@suse.com>

- Update to version 2.0.4+20200820.09f345c49:
- controller, Pacemaker Explained: improve the documentation of `stonith-watchdog-timeout` cluster option (bsc#1174696, bsc#1184557)
- scheduler: improve the documentation of `have-watchdog` cluster option (bsc#1174696, bsc#1184557)
- libpe_status: downgrade the message about the meaning of `have-watchdog=true` to info (bsc#1174696, bsc#1184557)

-------------------------------------------------------------------
Fri Oct 30 13:10:26 UTC 2020 - Yan Gao <ygao@suse.com>

- Update to version 2.0.4+20200820.216d5db57:
- tools: properly detect local node name
- various: improve client flag handling

-Rebase:
  * bug-806256_pacemaker-log-level-notice.patch
  * bug-728579_pacemaker-stonith-dev-id.patch

-------------------------------------------------------------------
Fri Oct 30 11:11:36 UTC 2020 - Yan Gao <ygao@suse.com>

- Update to version 2.0.4+20200819.643f19b71:
- scheduler: update migrate-fail-9 test for migration code change (bsc#1177212, bsc#1182607)
- scheduler: don't schedule a dangling migration stop if one already occurred (bsc#1177212, bsc#1182607)

-------------------------------------------------------------------
Thu Oct 29 10:58:25 UTC 2020 - Yan Gao <ygao@suse.com>

- Update to version 2.0.4+20200819.114974685:
- controld: Log correct timeout for timed-out stonith monitor
- libpe_status: Use pcmk_monitor_timeout as stonith start timeout (rh#1856015)
- crm_mon: Displays completed failed actions as processed.
- libpe_status: Support integer as rule type attribute
- libpe_status: Error-check and expand range of type="number"
- xml: Support integer as rule type attribute
- daemons, lib, tools: Correct comparisons to string functions.
- libcrmcommon: Allow default formatted output message handlers.
- tools: Apply resource filtering to bans.
- tools: Apply resource filtering to --brief option.
- libpe_status: Allow filtering bundled resources.
- libpe_status: Allow filtering cloned resources.
- libpe_status: Allow filtering resource groups.
- libpe_status: Allow filtering primitive resources.
- tools: Add "No active resources" to one case in crm_mon output.
- tools: Allow filtering node history by resource.
- tools: Add --resource= to the crm_mon command line.
- cluster: Close corosync handles when they disconnect (rh#1614166)
- libcrmcommon: Use truly implicit deny for ACLs (rh#1833173)
- libpe_status: Destroy hash table after use
- controld: improve message indicating the RA execution request
- tools: Convert crm_resource to use glib for command line handling.
- Allow logfile perms to be set in sysconfig
- pacemakerd: improve logging when synced with SBD
- pacemakerd: interworking with sbd not using pacemakerd-api
- tools: Add -P to crmadmin to ping via pacemakerd-api
- sbd-integration: sync pacemakerd with sbd
- executor: only send executor notifications to executor clients
- ipc-api: avoid infinite loop when disconnected
- ipc-api: allow calling connect after disconnection
- fencer: don't log assertion if unable to create full request reply
- libcrmcommon: avoid assertion on controller protocol errors
- tools: Add the http-equiv header to crm_mon at the right time.
- tools, libcrmcommon: Reopen the output dest on reset.
- libcrmcommon: Make reset and finish work more similarly. (rh#1857728)
- libcib: Update known_paths
- tools: Update valid scope values for cibadmin --help
- controld: Show action timer plus cluster-delay in action_timer cb (rh#1856035)

- Rebase:
  * bug-943295_pacemaker-lrmd-log-notice.patch

-------------------------------------------------------------------
Tue Aug 25 11:37:48 UTC 2020 - Yan Gao <ygao@suse.com>

- Update to version 2.0.4+20200702.813fdbfdc:
- libcrmcommon: deprecate create_hello_message() as public API (bsc#1170346, rh#1796824)
- pacemakerd: properly conditionalize corosync calls (bsc#1170346, rh#1796824)
- pacemakerd: use existing handle for corosync shutdown (bsc#1170346, rh#1796824)
- pacemakerd: improve messages (bsc#1170346, rh#1796824)
- pacemakerd: functionize removing core file limit (bsc#1170346, rh#1796824)
- pacemakerd: remove unneeded IPC and CPG commands (bsc#1170346, rh#1796824)
- tools: crm_node -l and -p now work from Pacemaker Remote nodes (bsc#1170346, rh#1796824)
- functionize numeric comparisons of strings (bsc#1170346, rh#1796824)
- controller: add new IPC API command for getting node list (bsc#1170346, rh#1796824)

-------------------------------------------------------------------
Tue Aug 25 11:26:47 UTC 2020 - Yan Gao <ygao@suse.com>

- Update to version 2.0.4+20200701.556cef416:
- tools: convert crmadmin to use new controller IPC model (bsc#1170346, rh#1796824)
- tools: remove dead code from crm_node (bsc#1170346, rh#1796824)
- tools: convert crm_node to use new controller IPC model (bsc#1170346, rh#1796824)
- tools: convert crm_resource to use new controller IPC model (bsc#1170346, rh#1796824)
- libcrmcommon: add C API for controller IPC (bsc#1170346, rh#1796824)
- libcrmcommon: new model for daemon IPC API (bsc#1170346, rh#1796824)

-------------------------------------------------------------------
Tue Aug 25 11:05:13 UTC 2020 - Yan Gao <ygao@suse.com>

- Update to version 2.0.4+20200630.107af1896:
- tools, libs: Use pcmk__str_any_of and pcmk__str_all_of.
- libcrmcommon: Add pcmk__str_any_of and pcmk__str_none_of.

-------------------------------------------------------------------
Tue Aug 25 11:01:08 UTC 2020 - Yan Gao <ygao@suse.com>

- Update to version 2.0.4+20200624.67a6a9b31:
- lib, tools: Correct types given to PCMK__OUTPUT_ARGS.

-------------------------------------------------------------------
Mon Aug 24 18:04:07 UTC 2020 - Yan Gao <ygao@suse.com>

- Update to version 2.0.4+20200623.e36fe309d:
- sysconfig: remove outdated reference to wildcards in PCMK_trace_files
- rpm: use https in package URL
- resources: don't check host-specific conditions in attribute validate

-------------------------------------------------------------------
Mon Aug 24 17:49:42 UTC 2020 - Yan Gao <ygao@suse.com>

- Update to version 2.0.4+20200622.c7e75c04b:
- libpacemaker: Don't allow a potential NULL in a format string.

-------------------------------------------------------------------
Mon Aug 24 17:10:48 UTC 2020 - Yan Gao <ygao@suse.com>

- Update to version 2.0.4+20200622.4bb3b23a2:
- libcrmcommon: bump CRM feature set
- scheduler: support "demote" choice for no-quorum-policy option (rh#1837747)
- scheduler: new on-fail="demote" recovery policy for promoted resources (rh#1837747)
- xml: add on-fail="demote" option to resources schema (rh#1837747)
- libpacemaker: check for re-promotes specifically
- libpacemaker: don't force stop when skipping reload of failed resource
- scheduler: disallow on-fail=stop for stop operations

-------------------------------------------------------------------
Mon Aug 24 16:20:06 UTC 2020 - Yan Gao <ygao@suse.com>

- Update to version 2.0.4+20200520.81d4b3976:
- xml: Add rsc_expression and op_expression to the XML schema. (rh#1628701)
- scheduler: Pass rsc_defaults and op_defaults data. (rh#1628701)
- scheduler: Add new rule tests for op_defaults and rsc_defaults. (rh#1628701)

-------------------------------------------------------------------
Mon Aug 24 15:35:51 UTC 2020 - Yan Gao <ygao@suse.com>

- Update to version 2.0.4+20200508.3f6514f01:
- tools: functionize listing nodes from CIB in crmadmin (bsc#1170346, rh#1796824)
- tools: use proper type for glib timeout value in crmadmin (bsc#1170346, rh#1796824)
- tools: handle memory cleanup better in crm_node (bsc#1170346, rh#1796824)
- libcrmcommon: new function for draining and quitting a main loop (bsc#1170346, rh#1796824)
- libcrmcommon: drop generate_hash_key() (bsc#1170346, rh#1796824)
- libcrmcommon: move get_message_xml() and add_message_xml() definition (bsc#1170346, rh#1796824)
- libcrmcommon: separate IPC code into multiple files (bsc#1170346, rh#1796824)
- libcrmcommon: combine IPC internal headers (bsc#1170346, rh#1796824)

-------------------------------------------------------------------
Wed Aug 12 13:45:41 UTC 2020 - Yan Gao <ygao@suse.com>

- rpm: use the user/group ID 90 for haclient/hacluster to be consistent with cluster-glue (bsc#1167171)

-------------------------------------------------------------------
Tue Jul  7 09:47:46 UTC 2020 - Callum Farmer <callumjfarmer13@gmail.com>

- Fixes for %_libexecdir changing to /usr/libexec

-------------------------------------------------------------------
Wed Jun 24 08:19:39 UTC 2020 - Yan Gao <ygao@suse.com>

- Update to version pacemaker-2.0.4+20200616.2deceaa3a (Pacemaker-2.0.4):
- cibsecret: don't use pssh -q option unless supported
- tools: verify newly created CIB connection is not NULL
- tools: check resource separately from managing parameter in cibsecret
- tools: improve cibsecret help

-------------------------------------------------------------------
Thu Jun 18 10:55:19 UTC 2020 - Yan Gao <ygao@suse.com>

- Update to version 2.0.3+20200608.44045c027:
- scheduler: Add the node name back to bundle instances.

-------------------------------------------------------------------
Thu Jun 18 10:54:09 UTC 2020 - Yan Gao <ygao@suse.com>

- Update to version 2.0.3+20200605.0db37d66f:
- rpm: add spec option for enabling CIB secrets
- build: avoid resource-agents as build dependency when cibsecrets are enabled

-------------------------------------------------------------------
Thu Jun 18 10:51:41 UTC 2020 - Yan Gao <ygao@suse.com>

- Update to version 2.0.3+20200603.4ff9c412f:
- based: use crm_exit to free qb-logging

-------------------------------------------------------------------
Thu Jun 18 10:50:12 UTC 2020 - Yan Gao <ygao@suse.com>

- Update to version 2.0.3+20200602.f7f36e8a8:
- libpe_status: Modify filtering of inactive resources.

-------------------------------------------------------------------
Tue Jun 02 07:42:10 UTC 2020 - Yan Gao <ygao@suse.com>

- Update to version 2.0.3+20200527.e67fb5c73:
- rpm: put user-configurable items at top of spec
- tools: free IPC memory after closing connection
- resources: attribute name parameter doesn't have to be unique

-------------------------------------------------------------------
Wed May 20 12:38:55 UTC 2020 - Yan Gao <ygao@suse.com>

- Update to version 2.0.3+20200516.b06fc662e:
- crm_ticket: avoid unnecessary issues with dynamic allocation
- crm_resource: avoid unnecessary issus with dynamic allocation
- crm_mon: NULL output-pointer when buffer is freed
- crm_error: use g_free for a proper match
- libreplace: closedir when bailing out dir traversal
- libcrmcommon: return ENOMEM directly instead of errno
- libcrmcommon: free basename after setting prgname
- silence some false positives static analysis stumbled over
- move bcond_with/without up front for e.g. pcmk_release
- fencer: avoid infinite loop if device is removed during operation

------------------------------------------------------------------
Tue May 12 06:30:23 UTC 2020 - Yan Gao <ygao@suse.com>

- libcrmcommon: lower message on reading proc file to info
  * 0001-Log-libcrmcommon-lower-message-on-reading-proc-file-.patch

-------------------------------------------------------------------
Tue May 12 06:29:28 UTC 2020 - Yan Gao <ygao@suse.com>

- Update to version 2.0.3+20200511.2b248d828:
- tools: get stonith_admin --list-targets working again

-------------------------------------------------------------------
Mon May 11 21:02:36 UTC 2020 - Yan Gao <ygao@suse.com>

- Update to version 2.0.3+20200511.e7d7b1aa5:
- libpe_status: Apply node filtering to clone resource lists.
- tools: Remove an extra space in crm_mon filtered output.
- libpe_status: Don't output unnecessary resource headers.
- libpe_status: Handle filtering of inactive resources.
- tools: Print inactive resources by default with crm_mon xml output.

-------------------------------------------------------------------
Mon May 11 15:07:22 UTC 2020 - Yan Gao <ygao@suse.com>

- Update to version 2.0.3+20200511.a9e085d8c:
- fencer: avoid possible use-of-NULL when parsing metadata (bsc#1171372)
- libstonithd: make the assert message from stonith__device_parameter_flags() more clear (bsc#1171372)

-------------------------------------------------------------------
Fri May 08 07:32:19 UTC 2020 - Yan Gao <ygao@suse.com>

- Update to version 2.0.3+20200507.c8529193e:
- libstonithd: respect `pcmk_host_argument=none` on `validate` (bsc#1171372)
- libstonithd: add `port` or `plug` parameter according to metadata on `validate` if no `pcmk_host_argument` specified (bsc#1171372)
- Pacemaker Explained: update the default value and the description of `pcmk_host_argument` (bsc#1171372)
- fencer: add `port` or `plug` parameter according to metadata for RHCS-style fence-agents (bsc#1171372)
- libstonithd: add function to check supported parameters according to the metadata of a fence agent (bsc#1171372)

-------------------------------------------------------------------
Thu May 07 21:48:11 UTC 2020 - Yan Gao <ygao@suse.com>

- Update to version 2.0.3+20200506.a212e4fa3:
- fenced: Remove relayed stonith operation.(Fix:CLBZ#5401) (bsc#1181744)
- controller: properly detect remote node info requests
- cotrold: Notify tengine of completion of CRM_OP_LRM_DELETE.(Fix:CLBZ:#5424)

-------------------------------------------------------------------
Mon May 04 17:11:07 UTC 2020 - Yan Gao <ygao@suse.com>

- Update to version 2.0.3+20200429.029571144:
- stonith_admin: --delay is an optional option for --fence/--unfence/--reboot commands (jsc#ECO-1611, jsc#SLE-12239, jsc#SLE-12240)
- controller: avoid possible use-of-NULL on logging fencing message (jsc#ECO-1611, jsc#SLE-12239, jsc#SLE-12240)

-------------------------------------------------------------------
Mon May 04 17:08:14 UTC 2020 - Yan Gao <ygao@suse.com>

- Update to version 2.0.3+20200428.f0a4d08c9:
- cib: populate cib_nodes when 'cibadmin -R -scope=configuration'

-------------------------------------------------------------------
Mon May 04 17:03:40 UTC 2020 - Yan Gao <ygao@suse.com>

- Update to version 2.0.3+20200423.01b9bbdbe:
- cts: add `plug` parameter for fence_dummy agent (bsc#1171372)
- libstonithd: `plug` parameter of RHCS-style fence-agents is shown as non-required in the metadata (bsc#1171372)
- libstonithd: `action` parameter of RHCS-style fence-agents is shown as non-required in the metadata (bsc#1171372)
- libstonithd: functionize fudging metadata of RHCS-style agent to make specific parameter non-required (bsc#1171372)

-------------------------------------------------------------------
Mon May 04 16:56:01 UTC 2020 - Yan Gao <ygao@suse.com>

- Update to version 2.0.3+20200423.5194e4a0d:
- libpe_status: Skip summary output of cloned resources.
- tools: Remove yet more extra newlines from crm_mon errors.
- tools: Quitting crm_mon shouldn't be an error.
- tools: Remove an extra log bump in crm_simulate.
- tools: Convert crm_error to use glib for command line handling.
- tools: Fix --html-title= in crm_mon.
- libpe_status: Add space between role and state strings.
- tools: Filter fencing actions using --node=.
- tools: Filter resources using --node= option.
- tools: Filter failed resource actions using --node= option.
- tools: Filter node summary and attributes using --node= option.
- tools: Filter nodes using --node= option.
- tools: Add --node= to the crm_mon command line.

------------------------------------------------------------------
Thu Apr 09 11:48:23 UTC 2020 - Yan Gao <ygao@suse.com>

- Update to version 2.0.3+20200408.cfb1746ec:
- libcrmcluster: use uint64_t type for corosync ringid (membership id) when updating node state (bsc#1168771)

-------------------------------------------------------------------
Thu Apr 09 11:46:28 UTC 2020 - Yan Gao <ygao@suse.com>

- Update to version 2.0.3+20200403.eb73f2237:
- fencer: update cpg_topology_delay test to also verify pcmk_delay_base is added (jsc#ECO-1611, jsc#SLE-12239, jsc#SLE-12240)
- controller: requested priority fencing delay defaults to 0 (jsc#ECO-1611, jsc#SLE-12239, jsc#SLE-12240)
- stonith_admin: --delay option defaults to 0 (jsc#ECO-1611, jsc#SLE-12239, jsc#SLE-12240)
- fencer: any delays from pcmk_delay_base/max are added to requested fencing delay (jsc#ECO-1611, jsc#SLE-12239, jsc#SLE-12240)
- scheduler: do not differentiate the case where all the nodes have equal priority (jsc#ECO-1611, jsc#SLE-12239, jsc#SLE-12240)
- scheduler: priority-fencing-delay defaults to 0 meaning disabled (jsc#ECO-1611, jsc#SLE-12239, jsc#SLE-12240)

-------------------------------------------------------------------
Thu Apr 09 11:42:27 UTC 2020 - Yan Gao <ygao@suse.com>

- Update to version 2.0.3+20200402.0a67b34c5:
- libpacemaker: don't output "0 events found" for stonith history cleanup
- tools: use return codes consistently in stonith_admin
- Use glib for cmdline processing in crm_simulate.
- tools: Only free things in crm_simulate that aren't NULL.

-------------------------------------------------------------------
Thu Apr 09 11:30:56 UTC 2020 - Yan Gao <ygao@suse.com>

- Update to version 2.0.3+20200326.508402483:
- scheduler: don't incorporate dependencies' colocations multiple times
- controller: improve shutdown messages
- tools: make static analysis happy
- xml: Add a new version of the tags schema.
- tools: Apply various fixes to the crm_diff man page.
- libcib: improve messages for CIB sign-on
- libcrmcommon: close logging *after* logging an exit message
- tools: be extra safe with freeing API connections when exiting
- fencer,libstonithd: fix Y2038 issue in fence history

-------------------------------------------------------------------
Thu Apr 09 11:19:36 UTC 2020 - Yan Gao <ygao@suse.com>

- Update to version 2.0.3+20200321.3e73aefb8:
- Pacemaker Explained: document priority-fencing-delay cluster option (jsc#ECO-1611, jsc#SLE-12239, jsc#SLE-12240)
- fencer: add cpg_topology_delay test to verify enforced fencing delay with fencing topology (jsc#ECO-1611, jsc#SLE-12239, jsc#SLE-12240)
- fencer: handle any enforced fencing delay (jsc#ECO-1611, jsc#SLE-12239, jsc#SLE-12240)
- stonith_admin: add --delay option to support enforced fencing delay (jsc#ECO-1611, jsc#SLE-12239, jsc#SLE-12240)
- controller: request fencing with any enforced priority fencing delay (jsc#ECO-1611, jsc#SLE-12239, jsc#SLE-12240)
- libstonithd: introduce fence_with_delay() operation (jsc#ECO-1611, jsc#SLE-12239, jsc#SLE-12240)
- scheduler: add regression test for priority-fencing-delay (jsc#ECO-1611, jsc#SLE-12239, jsc#SLE-12240)
- scheduler: implement priority-fencing-delay (jsc#ECO-1611, jsc#SLE-12239, jsc#SLE-12240)
- scheduler: add priority-fencing-delay cluster option (jsc#ECO-1611, jsc#SLE-12239, jsc#SLE-12240)

-------------------------------------------------------------------
Thu Apr 09 10:16:15 UTC 2020 - Yan Gao <ygao@suse.com>

- Update to version 2.0.3+20200320.e16e5121f:
- tools: Close the channel created with g_io_channel_unix_new.
- libcrmcommon: Don't allocate a ptr array until it's needed.
- tools: Free the result of g_option_context_get_help.
- various: improve configuration warnings and errors
- based: avoid memory leak when reading CIB
- xml: Add a new minor version of the crm_mon schema.
- libstonithd: Report an error getting history in output.
- tools: Use new formatted output return codes in crm_mon.
- tools: Eliminate nested execution of bye() processing and clear data_set.
- tools: Add clear cib connection pointer.
- fix compilation -Werror compilation issue with GCC 10 with s390x
- tools: Print errors to stderr for crm_mon's legacy xml.
- tools:  Rework error reporting and exiting in crm_mon.
- tools: Don't automatically show cluster options in crm_mon.
- tools: Use glib for command line handling in crm_rule.
- tools, lib: Use standard pacemaker return codes in crm_rule.
- tools: Allow crm_rule to check some date_specs.
- tools: Add better error reporting in crm_rule.
- executor: record correct last run and last rc change times
- libcrmcommon,libpe: validate interval specs correctly
- executor: correctly set first run time
- tools: Remove an extra space from last-failed strings in crm_mon.
- tools: Properly close ncurses output in crm_mon.
- controller: don't ack same request twice
- controller: improve message routing messages
- tools: Try to remove blank lines from the end of text output.
- tools: Don't display an empty "Migration Summary" header.
- tools: Handle corner case of printing cluster options.
- xml: Add a new schema version for crm_mon.
- tools: Add an option for printing failed resource actions.
- libcrmcommon, tools: Handle displaying maintenance mode.
- tools: Add more fine grained fencing arguments.
- tools: Conditionalize more output in crm_mon.
- tools: Add a real cluster-options message for text output.
- tools: Add --include= and --exclude= to crm_mon.
- controller: improve client IPC hello validation
- tools: clean up before exiting crm_resource
- libcrmcommon: improve messages when sending IPC request
- libcrmcommon: improve messages for IPC hello creation
- executor: correctly convert nanoseconds to milliseconds
- executor: handle systemd execution times under 1 second
- executor: improve process completion message
- tools: Use formatted output for more errors in crm_mon.

-------------------------------------------------------------------
Thu Mar 19 13:38:11 UTC 2020 - Yan Gao <ygao@suse.com>

- Update to version 2.0.3+20200218.4544c9b82:
- rpm: Run "make check" as part of %check and in travis.

-------------------------------------------------------------------
Thu Mar 19 12:08:26 UTC 2020 - Yan Gao <ygao@suse.com>

- Update to version 2.0.3+20200218.a290911ef:
- libcrmcommon: correctly check configuration options for positive values

-------------------------------------------------------------------
Thu Mar 19 11:26:25 UTC 2020 - Yan Gao <ygao@suse.com>

- Update to version 2.0.3+20200213.68bd2b4da:
- cib_attrs: Fix mismatching deallocation
- controller: clear leaving node's transient attributes even if there is no DC

-------------------------------------------------------------------
Wed Jan 29 09:53:57 UTC 2020 - Yan Gao <ygao@suse.com>

- Update to version 2.0.3+20200128.df6c286d9:
- scheduler: ensure attenuated scores still have some effect
- scheduler: ignore colocation constraints with 0 score

-------------------------------------------------------------------
Tue Jan 28 16:09:11 UTC 2020 - Yan Gao <ygao@suse.com>

- Update to version 2.0.3+20200127.cdf84f849:
- libpe_status: Remove extra colons from operations output.
- libpe_status: correctly check for implicit resource ID collision
- libpe_status: Use the same message for headers and history.
- get ready for implicit -fno-common with upcoming GCC 10 (bsc#1160410)

- Rebase:
  * bug-728579_pacemaker-stonith-dev-id.patch

-------------------------------------------------------------------
Tue Jan 21 12:49:01 UTC 2020 - Yan Gao <ygao@suse.com>

- Update to version 2.0.3+20200116.92a6f7e97:
- controller: bump feature set for shutdown-lock
- scheduler: clear resource history when appropriate
- tools: for down nodes, crm_resource --refresh should clear CIB only
- controller: allow CRM_OP_LRM_DELETE to clear CIB only
- tools: crm_resource resource checks should show shutdown locks
- scheduler: display when a resource is shutdown-locked to a node
- controller: don't clear shutdown locks when node rejoins
- controller: mark shutdown-locked resources in resource history
- scheduler: respect shutdown locks when placing inactive resources
- scheduler: respect shutdown locks when placing active resources
- scheduler: add shutdown lock cluster options
- tools: improve error checking for crm_resource cleanup/fail commands
- tools: improve crm_resource "why" messages
- controller: improve messages when deleting CIB resource history

-------------------------------------------------------------------
Tue Jan 21 11:10:05 UTC 2020 - Yan Gao <ygao@suse.com>

- Update to version 2.0.3+20200116.ea5b06fae:
- rectify thinko possibly behind spurious "process will not die" msg
- tools: Adapt stonith_admin to new return codes.
- libpacemaker: Fix handling of some operation return values.
- tools: Re-enable CGI output from crm_mon.
- tools: Correct sec vs. msec discrepancy in stonith_admin.
- libpe_status: Update the maint mode message for HTML output.
- libpe_status: Use a separate log formatter for cluster options.
- tools: Move --watch-fencing to under "Additional Options".
- libpacemaker: Convert to new return codes.
- libpacemaker: Add higher level stonith functions.
- tools: Handle request being NULL.
- tools: Be sure to free the GError when done with it.

-------------------------------------------------------------------
Fri Jan 10 14:18:35 UTC 2020 - Yan Gao <ygao@suse.com>

- Update to version 2.0.3+20200106.bc6f54495:
- attrd: properly declare global variables as extern in header (bsc#1160410)
- libcrmcommon: introduce new set of return codes

-------------------------------------------------------------------
Fri Jan 10 13:08:03 UTC 2020 - Yan Gao <ygao@suse.com>

- Update to version 2.0.3+20200102.1e3b41f65:
- controller: improve CIB status deletion messages
- controller: improve join messages
- fenced: Clearly log merged STONITH operations.
- iso8601: Fix crm_time_parse_offset() to parse offset with plus sign.
- libcrmcommon: correctly raise detail log line length
- libcrmservice: handle child wait errors appropriately
- libcrmservice: improve messages when waiting for child process

-------------------------------------------------------------------
Thu Dec 05 12:49:59 UTC 2019 - Yan Gao <ygao@suse.com>

- Update to version 2.0.3+20191203.d671faa22:
- scheduler: make sure cluster-wide maintenance-mode=true overrides per-resource settings (bsc#1154881)
- tools: Correct the crm_mon man page.
- pengine: formatted output for log
- libcrmcommon: Add a formatter for logs
- tools: Use glib for cmdline handling in crm_diff.

-------------------------------------------------------------------
Tue Nov 26 09:10:34 UTC 2019 - Yan Gao <ygao@suse.com>

- Update to version 2.0.3+20191125.4b1f869f0 (Pacemaker-2.0.3):
- libcrmcommon: memory leak when comparing time with invalid specification
- scheduler: only add successfully unpacked members as group children
- scheduler: include execution time when logging action failure
- libcrmservice: use "error" instead of "unknown error"
- tools: update blocked description in html output

-------------------------------------------------------------------
Mon Nov 11 09:59:07 UTC 2019 - Yan Gao <ygao@suse.com>

- Update to version 2.0.2+20191108.e39096b5a:
- tools: Print nodes_maintenance in crm_mon.
- libcrmcommon: Use <h3> when outputting a nested list.
- tools: Explain what happens if crm_mon.cgi is run.
- libcrmcommon: Update formatted output help.
- tools: Add a space to "CLUSTER OK: 5nodes online". (bsc#1158180)
- scheduler: count disabled and blocked resources correctly
- scheduler: simplify logging resource info
- libpengine: Correct display of master resources.

-------------------------------------------------------------------
Thu Nov 07 10:57:29 UTC 2019 - Yan Gao <ygao@suse.com>

- Update to version 2.0.2+20191106.eef56dcd6:
- libcrmcommon: Make sure to free the --output-as description.
- libcrmcommon: Rename formatted output cmdline options.
- libcrmcommon: Group all output options together.

-------------------------------------------------------------------
Mon Nov 04 11:08:36 UTC 2019 - Yan Gao <ygao@suse.com>

- Update to version 2.0.2+20191031.1d695899e:
- scheduler: clarify message about when watchdog will be used
- scheduler: properly detect whether guest node is fenceable
- scheduler: initialize unfencing digests to null
- scheduler: improve graph synapse logging

-------------------------------------------------------------------
Tue Oct 29 15:18:03 UTC 2019 - Yan Gao <ygao@suse.com>

- Update to version 2.0.2+20191023.7a12ccbe4:
- tools: Explain TIMESPEC in crm_mon help output.
- tools: crm_mon --interval should understand more formats.
- libcrmservice: don't close descriptors above current limit
- rpm: pacemaker-cts requires pacemaker
- tools: restore ability to show groups in crm_mon console mode
- tools: Deprecated old-style output options in crm_mon.
- cts-scheduler: test "year-2038" only runs for 64bit systems
- fencer: clarify more messages
- tools: don't ignore cib_new() errors in crm_mon
- tools: avoid memory leak in crm_mon when displaying nodes
- libpe_status: avoid memory leak when outputting resources
- libcrmcommon: avoid memory leak when IPC compression fails
- Security: introduce restrictive usage libxslt's security framework
- libcrmservice: try not to spam close() file descriptors
- tools: Support "crm_mon --as-html=<filename>".
- tools: Don't output nodes if they don't have failures.
- tools: Update checks around crm_mon --daemonize.
- libpe_status: Use CSS to style messages.
- tools: Add formatted output messages for resource history.
- tools: Add output messages for operations history.
- tools: Add full output to node messages.
- xml: Add a schema for new crm_mon output.
- tools: Use formatted output for nodes and their attrs.
- tools: Enable formatted output in crm_mon.
- tools: Use formatted output for failed actions.
- tools: Use formatted output for bans and tickets.
- tools: Use formatted output for cluster summary.
- tools: Use formatted output for stonith messages.
- tools: Add cluster summary messages.

- Rebase:
  * bug-806256_pacemaker-log-level-notice.patch

-------------------------------------------------------------------
Wed Oct 16 12:34:13 UTC 2019 - Yan Gao <ygao@suse.com>

- Update to version 2.0.2+20191014.09114c357:
- fencer: improved log messages regarding fencing actions (bsc#1151007)
- cts: ComponentFail: killed corosync doesn't respawn immediatelly.
- fencer: no need to check the length of a non-empty list for pending fencing actions (bsc#1151007)
- tools: crm_attribute should skip attrd if CIB is file
- controller: improve throttle mode messages
- libcrmcommon: improve messages when waiting for child processes
- scheduler: greatly improve efficiency of interval-origin
- tools: improve crm_resource --cleanup/--refresh help text
- fencer: Indicate fencing target in the logs when scheduling and executing fencing command (bsc#1151007)
- fencer: Make sure concurrent fencing commands get triggered to execute (bsc#1151007)
- fencer: Don't let a fencing command with a long delay block any other commands pending on the device (bsc#1151007)
- scheduler: de-duplicate inputs even if not adding to transition graph
- scheduler: check for invalid orderings when applying orderings
- scheduler: improve messages when adding actions to transition graph
- tools: new tool to compare crm_simulate profiling output
- tools: add crm_simulate option to repeat profiling tests
- tools: Use glib for cmdline handling in crm_node.
- fencing: Do not block concurrent fencing actions on a device (bsc#1151007)
- fencing: handle fence meta-data errors better
- libcrmcommon: avoid buffer overflows when converting date to string
- executor: handle remote server socket consistently
- tools: improve help text for crm_resource --validate

- Rebase:
  * bug-728579_pacemaker-stonith-dev-id.patch

-------------------------------------------------------------------
Tue Oct 08 08:40:40 UTC 2019 - Yan Gao <ygao@suse.com>

- Update to version 2.0.2+20190930.7fd98a2c5:
- controller: allow more cluster properties to take ISO 8601 specification
- scheduler: allow failure-timeout to take ISO 8601 interval
- libcrmcommon,tools: handle NULL values better in time handling
- libcrmcommon: allow 24:00:00 time as equivalent to next day's 00:00:00
- libcrmcommon: allow ISO 8601 strings of form "<date>T<time> <offset>"
- libcrmcommon: always mark durations appropriately
- libcrmcommon: look for magic string "epoch" correctly
- libcrmcommon: improve ISO 8601 error handling
- tools: print correct variable in iso8601 error messages
- tools: improve iso8601 error handling
- tools: improve stonith_admin error message
- CIB: improve message when handling op with CIB_file
- tools: correct iso8601 help for -D/-E
- libcrmcommon:  Allow spaces in forced output cmdline args.
- libcrmcommon:  Be more lenient when freeing private data.
- libpe_status: Don't output empty lists in clone sets.
- tools: crm_mon --output-as html should default to stdout.
- tools: Examples in crm_mon should reference new args.
- Pacemaker Remote: allow environment variable file for PID 1
- controller: use dynamic cluster recheck interval
- controller: allow full interval specs for relevant cluster properties
- scheduler: track "recheck by" for nvpair blocks with date/time rules
- scheduler: track "recheck by" for location constraints with date/time rules
- scheduler: add ability to track when date expression evaluation will next change
- scheduler: improve configuration validation for date expressions
- libcrmcommon: improve error messages when parsing date strings
- libpe_status: track "recheck by" for failure timeouts
- libcrmcommon: Accept a single dash on the command line.
- libpe_status: improve messages for expired failures
- libpe_status: check for parameter changes for any unexpired operation
- libpe_status: match last failures more exactly
- libpe_status: warn if user specified negative migration-threshold
- SysInfo: Add support for other units (K, T and P) in SysInfo_megabytes function
- libcrmcommon: Allow printing blank lines with the info message.
- libpe_status: Fix segfaults in pe__bundle_*.
- tools: crm_mon -L does not require an argument.
- all: avoid Year 2038 issues
- libcrmcommon: add XML getter for epoch time values
- libcrmcommon,libcrmcluster: improve usage of timeval with XML
- libcrmcommon: add XML getter and setter for long long values
- libcrmcommon: improve error-checking when parsing integers from XML
- CIB: formally deprecate last-run in operation history XML

-------------------------------------------------------------------
Tue Oct 08 08:30:40 UTC 2019 - Yan Gao <ygao@suse.com>

- Update to version 2.0.2+20190910.f1b697557:
- tools: Re-enable verbosity in crm_mon.
- tools: Don't add extra newlines to curses lists.
- tools: Fix crm_mon -t.
- tools: Don't output two asterisks in curses lists.
- libcrmcommon: Don't output two asterisks in text lists.
- crm_resource: inherit resource attributes

-------------------------------------------------------------------
Wed Sep 11 08:24:34 UTC 2019 - Yan Gao <ygao@suse.com>

- Update to version 2.0.2+20190909.d4e0fef91:
- systemd: use correct name for unit directory variable
- configure: add --with-runstatedir option
- crm_mon: Displays completed fault actions as processed.
- libstonithd: Changing the log level.
- libcrmcommon: reword output options header
- logrotate: use correct name for bundle logs
- Pacemaker Remote: tell systemd not to respawn after fatal failure
- Pacemaker Remote: correctly detect bind/listen failure
- Pacemaker Remote: allow user to specify listen address
- tools: re-enable verbosity in stonith_admin
- rpm: add soft dependency on tar and bzip2
- add truly noarch indirection towards pacemaker schemas
- all: restrict XML children loops to XML elements where appropriate
- libcrmcommon: handle pcmk_strerror(INT_MIN)
- tools: avoid memory leak in crm_mon when displaying help
- pacemakerd: tweak messages for checking for existing instance
- pacemakerd: log a better warning if unable to create /var/run/crm
- libcrmcommon:  Support old-style XML output.
- tools: Add a curses formatter to crm_mon.

-------------------------------------------------------------------
Thu Aug 08 11:10:39 UTC 2019 - Yan Gao <ygao@suse.com>

- Update to version 2.0.2+20190801.122c32115:
- libcib: install cib_types.h
- tools: Use glib for cmdline handling in crm_mon.
- libcrmcommon: Handle no digits in crm_int_helper.
- libcrmcommon: Allow glib cmdline parsing without formatted output.
- extra: calculate #health_disk correctly in SysInfo
- extra: handle run-as-user properly in ClusterMon
- extra: advertise promote and demote in Stateful meta-data
- extra: formally deprecate the ocf:pacemaker:pingd agent
- extra: quote shell variables in agent code where appropriate (bsc#1175557)
- extra: use ":=" where appropriate in agent code

-------------------------------------------------------------------
Tue Jul 30 16:00:17 UTC 2019 - Yan Gao <ygao@suse.com>

- Update to version 2.0.2+20190725.4b4fea3eb:

- Rebase:
  * bug-977201_pacemaker-controld-self-fencing.patch

- libcrmcommon:  Restore getopt behavior in stonith_admin.
- controller: document the cluster-name cluster property
- controller: allow configurable reaction to local node fencing
- pacemakerd: make daemon exit detection messages more consistent
- executor: stonith probes should fail only if previously registered
- libstonithd: handle API creation errors better
- spec: avoid long-broken (in a pristine tree state) "make all"
- controller: panic local host if notified of own fencing
- controller: clear "required" bit when disconnecting scheduler
- libcrmcommon: Remove -q from global cmdline options.
- tools: Allow HTML output in stonith_admin.
- libstonithd: Add HTML support to fencing messages.
- st_client: Reword stonith_event_text.
- controld: Use XML output to check for pending status.
- pengine: formatted output for html
- executor: don't pass /dev/null to resource agents as log
- executor: improve resource registration/unregistration messages
- controller: don't print "successfully started" if not true
- controller: monitor change can arrive in transition it was scheduled in
- controller: improve action result messages
- controller: confirm cancel actions by task key and node UUID
- controller: allow graph update when confirming action
- controller: improve remote RA connection messages

-------------------------------------------------------------------
Mon Jul 15 09:35:42 UTC 2019 - Yan Gao <ygao@suse.com>

- Update to version 2.0.2+20190712.662793aac:
- scheduler: wait for probe actions to complete to prevent unnecessary restart/re-promote of dependent resources (bsc#1130122, bsc#1032511)
- Merge:
  * bsc#1130122-0001-Fix-scheduler-wait-for-probe-actions-to-complete-to-.patch
  * bsc#1130122-0002-Test-scheduler-wait-for-probe-actions-to-complete-to.patch

-------------------------------------------------------------------
Fri Jul 12 13:54:03 UTC 2019 - Yan Gao <ygao@suse.com>

- Update to version 2.0.2+20190711.8a638d418:
- st_client: cleanup token whenever setting api to disconnected
- libcrmcommon: Add a "none" output formatter.
- libcrmcommon: Add a formatted outputter for HTML.
- remote: allow run-time configurable TLS priorities
- pengine: formatted output for text
- scheduler: properly detect dangling migrations (bsc#1177212)
- scheduler: only successful ops count for migration comparisons (bsc#1177212)
- libpe_status: add sanity check when unpacking migration history (bsc#1177212)
- libpe_status: check for stops correctly when unpacking migration (bsc#1177212)
- controller: reset expected reply when disconnecting from scheduler
- cts-scheduler: convert to python
- tools: Use a copy of argv in stonith_admin.
- libcrmcommon: Add a new version message.
- libcrmcommon: Add an error message.
- tools: Convert command line handling in stonith_admin.
- controller: set timeout on scheduler responses
- libcrmcommon: tweak ACL log messages
- libcrmcommon: pengine: formatted output for xml
- libstonithd: improve error checking when sending command
- fencer: don't require API registration for list and status commands (bsc#1148236)
- fencer: improve error checking and log messages for API action requests (bsc#1148236)
- executor: don't cancel stonith monitors when device is not registered
- executor: return error for stonith probes if stonith connection was lost
- libcrmcommon: assert on ACL memory allocation errors
- libcrmcommon: improve ACL messages
- libcrmcommon: avoid use-after-free when enforcing creation ACLs
- controld-fencing: add notice-log for successful fencer-connect (bsc#1181744)
- st_client: make safe to remove notifications from notifications (bsc#1181744)
- attrd: ensure node ID is initialized properly
- tools: avoid unlikely small memory leaks in attrd_updater
- fence-history: resync fence-history after fenced crash (bsc#1181744)
- based: check for writeability of cib.xml.sig alongside cib.xml
- based: make "preventive rename" on CIB access fault path-specific
- fence-history: add notification upon history-synced (bsc#1181744)
- controld-fencing: remove-notifications upon connection-destroy (bsc#1181744)
- fence-history: fail leftover pending-actions after fenced-restart (bsc#1181744)

-------------------------------------------------------------------
Fri Jul 05 10:14:13 UTC 2019 - Yan Gao <ygao@suse.com>

- Update to version 2.0.2+20190614.9f18a420a:

- Rebase:
  * bug-728579_pacemaker-stonith-dev-id.patch

- libpe_status: don't add /var/log mount to bundles if user did
- libpe_status: don't order implied stops relative to a remote connection
- scheduler: remote state is failed if node is shutting down with connection failure
- libpe_status: fail connection resource if remote action gets "not connected"
- libcrmcommon: bump CRM feature set
- controller: use op status, not rc, for execution in invalid state
- controller: use op status, not rc, for executor disconnection
- libpe_status: calculate secure digests for unfencing ops
- Increase STONITH execution start log level to notice
- Fix the log level to notice when the node attribute changes
- libcrmcommon: add stderr source correctly when outputting XML
- tools: stonith_admin --list-targets should show what fencer would use
- Fix monitor's log to match other operation's log level
- controller: don't check join status after remote node appears
- pacemaker-remoted: use different default log if pid 1

-------------------------------------------------------------------
Fri Jun 07 10:39:45 UTC 2019 - Yan Gao <ygao@suse.com>

- Update to version 2.0.2+20190606.73beea82f:
- stonith-ng's function cannot be blocked with CIB updates forever (bsc#1188212)
- libpe_status: offer compile-time option to change concurrent-fencing default
- libstonithd: return proper error code for async stonith action
- various: improve fencer connection messages

- stonith_admin --help: specify the usage of --cleanup (bsc#1135317)
- Merge:
  * bsc#1135317-0001-Low-stonith_admin-help-specify-the-usage-of-cleanup.patch

- pacemaker.service: Add option that does not restart Pacemaker if Corosync stops

- controller: confirm cancel of failed monitors (bsc#1133866)
- Merge:
  * bsc#1133866-0001-Fix-controller-confirm-cancel-of-failed-monitors.patch

- libcrmcommon: return error when applying XML diffs containing unknown operations (bsc#1127716)
- Merge:
  * bsc#1127716-0003-Fix-libcrmcommon-return-error-when-applying-XML-diff.patch

- libcrmcommon: avoid possible use-of-NULL when applying XML diffs (bsc#1127716)
- Merge:
  * bsc#1127716-0002-Fix-libcrmcommon-avoid-possible-use-of-NULL-when-app.patch

- libcrmcommon: correctly apply XML diffs with multiple move/create changes (bsc#1127716)
- Merge:
  * bsc#1127716-0001-Fix-libcrmcommon-correctly-apply-XML-diffs-with-mult.patch

-------------------------------------------------------------------
Fri Jun 07 10:36:55 UTC 2019 - Yan Gao <ygao@suse.com>

- Update to version 2.0.2+20190606.744a30d65 (Pacemaker-2.0.2):
- libcrmcommon: export logfile environment variable if using default
- libstonithd: Change stonith-event XML output.

-------------------------------------------------------------------
Mon May 27 12:07:02 UTC 2019 - Yan Gao <ygao@suse.com>

- Update to version 2.0.1+20190522.660ef6b13:
- fence-lib: regression introduced with fork callback

-------------------------------------------------------------------
Tue May 21 13:00:58 UTC 2019 - Yan Gao <ygao@suse.com>

- Update to version 2.0.1+20190520.dc4103b37:

- Drop obsolete:
  * 0001-Revert-Fix-service-lib-avoid-call-pattern-leading-to.patch
  * 0002-Revert-use-common-service-interface-for-fence-agents.patch

- Rebase:
  * bug-728579_pacemaker-stonith-dev-id.patch

- fence-lib: avoid use-after-free on early failure return
- libcrmcommon: Don't segfault in text_begin_list.

-------------------------------------------------------------------
Wed May 01 07:22:56 UTC 2019 - Yan Gao <ygao@suse.com>

- Update to version 2.0.1+20190430.8e851b084:
- controller: avoid memory leak when duplicate monitor is scheduled
- Merge:
  * 0001-Low-controller-avoid-memory-leak-when-duplicate-moni.patch

- libcrmcommon: return proper code if testing pid is denied (bsc#1131353, bsc#1131356)
- Merge:
  * bsc#1131353-bsc#1131356-0001-Low-libcrmcommon-return-proper-code-if-testing-pid-i.patch

-------------------------------------------------------------------
Tue Apr 30 13:17:22 UTC 2019 - Yan Gao <ygao@suse.com>

- Update to version 2.0.1+20190424.a365fc58d:

- libcrmcommon: avoid use-of-NULL when checking whether process is active (bsc#1131353, bsc#1131356)
- Merge:
  * bsc#1131353-bsc#1131356-0001-Fix-libcrmcommon-avoid-use-of-NULL-when-checking-whe.patch

- daemons: make start-up log messages consistent across all daemons
- executor: downgrade disappeared remote client message to notice
- remote: include channel name in IPC proxy failure message
- fencing: clarify device search messages
- libcrmcluster: improve CPG membership messages
- tools: Use formatted output in stonith_admin.
- libstonithd: Add custom formatting to fencing types.
- libcrmcommon: Add formatted output.
- xml: Add a schema for API results.

-------------------------------------------------------------------
Thu Apr 18 12:07:35 UTC 2019 - Yan Gao <ygao@suse.com>

- Update to version 2.0.1+20190417.13d370ca9:
- controld: fix possible NULL pointer dereference (bsc#1131353, bsc#1131356)
- pacemakerd vs. IPC/procfs confused deputy authenticity issue (CVE-2018-16877, bsc#1131356) (CVE-2018-16878, bsc#1131353)
- libservices: fix use-after-free wrt. alert handling (CVE-2019-3885, bsc#1131357)
- executor: systemd starts should return UNKNOWN_ERROR instead of NOT_RUNNING
- pacemaker-remoted: improve proxy accept failure message
- executor: consider stonith resource stopped only if stop succeeded
- executor: improve stonith operation rc and status mapping
- executor: reschedule recurring stonith monitor if not connected
- executor: put recurring stonith failsafe stop in correct place

-------------------------------------------------------------------
Thu Apr 11 15:32:23 UTC 2019 - Yan Gao <ygao@suse.com>

- Rebase:
  bug-728579_pacemaker-stonith-dev-id.patch

- Revert "use common service interface for fence-agents and RAs" (bsc#1132123)
  * 0002-Revert-use-common-service-interface-for-fence-agents.patch

- Revert "service-lib: avoid call-pattern leading to use-after-free"
  * 0001-Revert-Fix-service-lib-avoid-call-pattern-leading-to.patch

-------------------------------------------------------------------
Tue Apr  9 10:00:32 UTC 2019 - Yan Gao <ygao@suse.com>

- Update to version 2.0.1+20190408.1b68da8e8:
- scheduler: avoid error log in harmless situation
- libcrmcommon: use INT_MIN/INT_MAX instead of -1 for out-of-range integers
- service-lib: avoid call-pattern leading to use-after-free
- libp-i: Renamed to libpacemaker.

-------------------------------------------------------------------
Thu Apr  4 11:13:13 UTC 2019 - Jan Engelhardt <jengelh@inai.de>

- Drop %if..%endif guards around %packages which does not
  affect the build result.

-------------------------------------------------------------------
Thu Apr  4 09:09:49 UTC 2019 - Yan Gao <ygao@suse.com>

- spec: no need to explicitly require the virtual dependency on libqb

-------------------------------------------------------------------
Thu Apr  4 09:05:55 UTC 2019 - Yan Gao <ygao@suse.com>

- Update to version 2.0.1+20190402.e091f4f0c:

- Rebase:
  * bug-728579_pacemaker-stonith-dev-id.patch

- scheduler: one group stop shouldn't make another required
- libcrmcommon: compare_version: drop superfluous heap allocation
- libfencing: enumerate installed RHCS-style agents alpha-sorted
- xml diff'ing: prevent 'id' attribute reordering in "diff-removed"
- libcrmcommon: downplay "Creating RNG parser context" as debug prio
- controller: improve failed recurring action messages (bsc#1133866)
- controller: improve lost action logs
- use common service interface for fence-agents and RAs
- libcrmcommon: allow whitespace in name/value pairs
- libcrmcommon: pcmk_nvpair_t should handle NULL values

-------------------------------------------------------------------
Wed Mar 13 11:19:11 UTC 2019 - Yan Gao <ygao@suse.com>

- Update to version 2.0.1+20190312.059e2e26b:
- spec: move stonith_admin to -cli where it belongs
- tools: Add crm_rule.

-------------------------------------------------------------------
Tue Mar 12 10:41:19 UTC 2019 - Yan Gao <ygao@suse.com>

- Update to version 2.0.1+20190311.e91ee92e5:
- libfencing: Change return type on stonith_agent_exists.
- scheduler: cl#5301 - respect order constraints when relevant resources are being probed (bsc#1117934, bsc#1128374)

-------------------------------------------------------------------
Wed Mar  6 16:34:53 UTC 2019 - Yan Gao <ygao@suse.com>

- Update to version 2.0.1+20190304.1ac166cd3:
- build: Update pkgconfig files for libpe.
- libp-i: Add a pkgconfig file for libp-i.
- libs: Rename libpengine to libpacemaker-internal.
- tools: Add new validate options to crm_resource.
- Add HealthIOWait provider which checks hosts's IOWait
- tools: crm_resource --clear should print out what it does

-------------------------------------------------------------------
Tue Mar  5 13:49:11 UTC 2019 - Yan Gao <ygao@suse.com>

- Update to version 2.0.1+20190304.9e909a5bd (Pacemaker-2.0.1):
- libcrmcommon: complete interrupted live migrations correctly

-------------------------------------------------------------------
Thu Feb 28 11:38:50 UTC 2019 - Yan Gao <ygao@suse.com>

- Update to version 2.0.0+20190225.22ee9a769:
- scheduler: skip all native constraints for unmanaged resources
- scheduler: sort nodes when creating constraints

-------------------------------------------------------------------
Thu Jan 31 08:07:34 UTC 2019 - ygao@suse.com

- Update to version 2.0.0+20190130.57cc9c14b:
- CTS: really don't require nodes to be specified if listing tests (bsc#1114840)
- controller: really avoid closing attrd IPC for temporary failures
- controller: clear election dampening when DC is lost
 
-------------------------------------------------------------------
Mon Jan 28 10:24:10 UTC 2019 - ygao@suse.com

- Update to version 2.0.0+20190125.788ee2c49:
- attrd: clear election dampening when the writer leaves
- libcrmcluster: *really* write only one election storm black box
- attrd: log previous writer *before* clearing it

-------------------------------------------------------------------
Fri Jan 25 14:36:54 UTC 2019 - ygao@suse.com

- Update to version 2.0.0+20190124.c3c9c6e66:
- scheduler: don't order non-DC shutdowns before DC fencing
- scheduler: improve fence action ordering
- scheduler: don't disable waiting for DC fencing
- libcrmservice: cancel DBus call when cancelling systemd/upstart actions
- libcrmservice: null-terminate string *before* printing it
- libcrmservice: improve logs when cleaning up an operation
- spec: add hint about sbd compatibility

-------------------------------------------------------------------
Thu Jan 24 11:24:16 UTC 2019 - ygao@suse.com

- Update to version 2.0.0+20190122.3f993c74f:
- crm_mon: remove duplicity of fence-action-state in xml-output
- cts: temporarily disable any enabled cluster serivces when running remote tests
- cts: service counts as enabled only if it's explicitly enabled

-------------------------------------------------------------------
Mon Jan 14 09:52:35 UTC 2019 - ygao@suse.com

- Update to version 2.0.0+20190111.750c5bd01:
- cts-exec: still run the tests for the other resource classes even without python systemd bindings (bsc#1121808)

-------------------------------------------------------------------
Fri Jan 11 15:57:23 UTC 2019 - ygao@suse.com

- Update to version 2.0.0+20190111.f07d766f3:
- controller: directly acknowledge unrecordable operation results
- resources: clean serialized file on SIGTERM in Dummy
- libcrmcommon: downgrade empty output logging to trace level

-------------------------------------------------------------------
Fri Jan 11 10:11:05 UTC 2019 - ygao@suse.com

- Update to version 2.0.0+20190110.7bbbeb6f6:
- tools: Clear all prefer constraints when performing a move (bsc#1155290)
- tools: Fix moving a resource with a lifetime constraint (bsc#1155290)
- attrd: check for alert changes after CIB is replaced
- attrd: start new election if writer is lost
- attrd: handle shutdown more cleanly (bsc#1173668)
- attrd: don't start a new election when receiving a client update
- attrd: clear lost updates
- attrd: don't delay re-attempted writes unless original failed
- attrd: connect to the CIB before connecting the cluster

-------------------------------------------------------------------
Tue Jan  8 14:38:38 UTC 2019 - ygao@suse.com

- Update to version 2.0.0+20190103.5b36d4e10:
- scheduler: downgrade clone pre-allocation message
- libpe_status: downgrade remote node fence-before-clear message
- libpe_status: improve trace messages when finding actions
- libpe_status: avoid use-after-free when logging at trace level
- libpe_status: avoid double free of stop_needed list
- tools: stonith_admin -I doesn't require an agent
- pacemakerd,libcrmcommon: don't touch kernel.sysrq
- fencing: use next device's name where intended
- tools: Implement crm_resource --expired.
- CTS: ignore monitor failures when testing remote node fencing
- CTS: lower remote connection failure detection time
- attrd: Ignoring delayed updating of attributes when integrating disjointed clusters without stonith.
- pacemakerd: only one active process check needed
- cts: use bash in the pacemaker-cts-dummyd
- cts: clear constraints on cluster nodes (bsc#1121272)
- cts: resume any possibly frozen pacemaker_remoted when cleaning up the test (bsc#1121272)
- cts: simulate failure of pacemaker_remoted by freezing it with SIGSTOP (bsc#1121272)
- scheduler: order resource moves after connection starts
- scheduler: get rid of now-unused stonith_complete pseudo-action
- scheduler: get rid of now-unused all_stopped pseudo-action
- scheduler: order start after particular stonith op
- controller: be more tolerant of malformed executor events
- scheduler: don't send clone notifications to a stopped remote node
- tools: avoid memory leak at failure exit in crm_resource --restart
- controller: improve debug messages for remote connection events
- CTS: don't require nodes to be specified if only listing tests (bsc#1114840)
- tools: Remove extra newlines from crm_resource output.
- tools: Change crm_resource output for attributes.
- cts: set default number of iterations to 1
- crm_report: Add sanitize drbd to remove values of sensitive attributes.
- crm_report: remove deprecated drbd-overview and add drbd configuration
- scheduler: avoid container stop on wrong node
- scheduler: check bundle remote connection actions properly
- scheduler: downgrade addr replacement message
- scheduler: don't trace implicit resource XML
- spec: split -schemas standalone noarch package
- pacemaker-fenced: fix easily plausible NULL pointer dereference
- tools: crm_simulate -P should return consistent exit code
- tools: end crm_ticket error messages with newline
- libcrmcommon: make blackbox logger compatible with newer libqb
- tools: make crm_verify return reliable exit codes
- libpe_status: add constructor/destructor for pe_working_set_t

-------------------------------------------------------------------
Fri Nov  9 12:13:25 UTC 2018 - ygao@suse.com

- Update to version 2.0.0+20181108.62ffcafbc:
- fenced: trigger device-update on resource-defaults changed
- fenced: adhere meta-attributes when triggering device-update

-------------------------------------------------------------------
Thu Nov  8 10:34:21 UTC 2018 - ygao@suse.com

- Update to version 2.0.0+20181105.fb362c0c9:
- scheduler: formally deprecate score in rsc_order
- pacemaker-remote: skip remote_config_check for guest-nodes

-------------------------------------------------------------------
Fri Nov  2 16:05:37 UTC 2018 - ygao@suse.com

- Update to version 2.0.0+20181101.a21fd0099:
- rhbz#1644076 - Ensure the bundle stop/demote notifications are directed to the correct host
- libcrmservice: override removal failure is not a problem
- libcrmcommon,execd: pass remaining timeout to drain function
- tools: log user-specified time correctly in crm_simulate
- libcrmcluster: log microseconds sensibly
- libcrmservice: order systemd resources relative to pacemaker_remote
- scheduler: order guest pseudo-fencing properly after clean-up
- scheduler: avoid unnecessary recovery of cleaned guest nodes
- scheduler: improve bundle address fixing messages
- attrd: record tentative writer only if election not already lost
- attrd: skip election check if peer election op had error
- attrd: disregard lost nodes' election votes
- attrd: improve election messages
- attrd: initialize election before broadcasting protocol
- controller: remove node's vote as soon as it is inactive
- controller: don't register DC input twice
- controller: don't stop election timer for nonexistent election
- controller: improve election messages
- libcrmcluster: don't write more than one election storm black box
- libcrmcluster: only count no-vote if an election is in progress
- libcrmcluster: validate election cluster messages better
- libcrmcluster: improve election log messages

-------------------------------------------------------------------
Tue Oct 16 07:40:06 UTC 2018 - ygao@suse.com

- Update to version 2.0.0+20181012.dc40c8037:
- schedulerd: Improve internal bundle ordering
- execd: Allow the SBD check to be explicitly disabled for bundles

- fenced: Handle fencing requested with nodeid by utilizing the membership cache of known nodes (bsc#1094208, bsc#1107270, bsc#974108)
  * Drop merged bsc-1094208-Refactor-fenced-Handle-fencing-requested-with-nodeid.patch

- controld: able to manually confirm unseen nodes are down (bsc#1094208, bsc#1107270)
  * Drop merged bsc-1094208-Fix-controld-able-to-manually-confirm-unseen-nodes-a.patch

-------------------------------------------------------------------
Fri Oct  5 12:57:16 UTC 2018 - ygao@suse.com

- fenced: Handle fencing requested with nodeid by utilizing the membership cache of known nodes (bsc#1094208, bsc#1107270, bsc#974108)
  * bsc-1094208-Refactor-fenced-Handle-fencing-requested-with-nodeid.patch

- controld: able to manually confirm unseen nodes are down (bsc#1094208, bsc#1107270)
  * bsc-1094208-Fix-controld-able-to-manually-confirm-unseen-nodes-a.patch

-------------------------------------------------------------------
Thu Oct  4 09:35:38 UTC 2018 - ygao@suse.com

- Update to version 2.0.0+20180927.b67d8d0de:
- logrotate: set a maximum size for logs
- tools: ensure crm_resource --force-* commands get stderr messages
- libcrmcommon: properly check whether resource supports parameters
- tools: "return" from crm_mon after calling functions that don't
- alerts: send all MIB OIDs with all SNMP alerts
- resource-agents: add "s"-suffix where missing in metadata
- libcommon: do not write to /proc/sys/kernel/sysrq when unneeded
- pacemaker-based: drop declared, errant option never backed in tree
- crm_mon: don't exit directly from cib_connect on error
- scheduler: honor asymmetric orderings even when restarting
 
-------------------------------------------------------------------
Thu Sep 13 09:59:39 UTC 2018 - ygao@suse.com

- Update to version 2.0.0+20180911.b7803d27c:
- libcrmcommon: allow configurable bounds for DH prime length
- CIB,executor: improve remote server-side messages
- CIB: give more detail when TLS handshake fails
- libcrmcommon: get DH prime bit length from GnuTLS API
- libcrmcommon: improve TLS session initialization failure handling
- CIB: raise exit escalation timer to 10s
- cts,tools: make static analysis happy
- crm_mon: no sense in having --as-xml in daemon-mode
- attrd: Adding the ignore_delay parameter to reduce the number of scans of the attribute hash table.
- crm_mon: rhbz#1625231 - disable fence-history in file-mode

-------------------------------------------------------------------
Thu Sep  6 12:43:10 UTC 2018 - ygao@suse.com

- Update to version 2.0.0+20180831.e41c7d6d6:
- XML: schemas.c: ensure proper upgrade-enter fallback & guard strdup arg
- controller: trigger join after both peer and join notifications
- controller: handle shutdown completion only when needed
- libcrmcluster: reset "when lost" when a peer becomes a member
- libcrmcluster: improve CPG membership messages
- controller: improve membership messages
- stonith-history: keep history recorded within boundaries
- tools: crm_resource -C should wait for all replies (bsc#1140519)
- libcrmcommon: explicitly include stdint.h in util.h (bsc#1108303)
- attrd: improve log messages
- attrd: delay re-attempted writes
- crm_mon: in case of html-output avoid missleading output
- tools: make crm_resource messages tool-agnostic
- scheduler: show promotable clones as "(promotable)" rather than "Master/Slave"
- tools: make crm_resource --lifetime specify rule with local time zone
- crm_mon: rhbz1419548: show standby-node with active resources
- crm_mon: rhbz#1486869 - common language on connection-errors
- avoid possible printf vs. scanf format specifiers disrepancy
- also utilize configured format specifiers serving uint32_t
- configure: fix overkill format specifier serving uint64_t check
- controller: shut down DC if unable to update node attributes
- libcrmcommon: assume unprivileged user if can't get user info
- libcrmcommon,libcib: improve messages when unable to get user info
- Initial podman support
- scheduler: sort node names with leading zeroes
- scheduler: add regression test for anonymous instance numbering
- fenced: g_hash_table_insert has no returnvalue till glib 2.40
- scheduler: sort node names numerically and case-insensitively
- scheduler: Act on clone instances in numerical order
- scheduler: assign anonymous clone instances properly
- scheduler: print pending node if no active node
- scheduler: print clone instances individually when action is pending
- stonith-API: free history reply in client
- controller: avoid error message if node state not known in peer callback
- tools: document crm_master -r option
- stonith_admin: no sense in calling without action option
- fence-API: empty history-query-reply is OK without history-tag
- scheduler: reword messages when finding anonymous clone instances
- scheduler: make inc6 regression test input more sane
- tools: simulation should use same history name as live cluster
- scheduler: avoid unnecessary probe loop for anonymous clones
- scheduler: improve efficiency of checking for clone instance on node
- scheduler: never probe more than a single instance for anonymous clones
- crm_mon: default to showing pending fence actions
- tools: already latest schema is not failure for cibadmin --upgrade
- pacemaker-based: inform originator of CIB upgrade failure
- controller: set exit-reason when faking failure
- crm_mon: default to showing fence-failures
- fence-history: automatically sync history
- crm_mon: use new fence-history notifications
- fence-history: add cleanup & sync & history-notify
- RPM: don't package servicelog-related binaries
- agents: remove references to corosync plugin daemons from controld meta-data
- controller: log variables *after* setting them
- cts-scheduler: add test for forced anonymous clone
- scheduler: clear globally-unique correctly when forcing anonymous
- scheduler: respect lower clone-max for forced anonymous clones
- scheduler: reword force-anonymous message
- scheduler: only some agent standards support unique clones
- controld: No update by already confirmed events.
- Present exec_time in event environment

-------------------------------------------------------------------
Fri Jul 27 14:19:11 UTC 2018 - ygao@suse.com

- Update to version 2.0.0+20180726.3d81c89b8:
- Shutdown corosync after a fatal error
- tools: ipmiservicelogd FTBFS on ppc64le
- tools: notifyServicelogEvent FTBFS on ppc64le
- tools: detect CIB directory correctly
- tools: avoid memory leak when crm_resource checks resource
- controller: avoid any chance of use-of-NULL when doing LRM op
- resources: controld doesn't need to check for corosync 1 plugin
- resources: use correct variable name in Stateful
- cts-scheduler: restore ability to pass arguments to single test run
- resources: use ocf_is_true in SysInfo
- spec: drop superfluous dependency of -libs-devel on -cts
- tools: update URL in crm_simulate help
- crm_mon: rhbz#1461964 - add fence history features (bsc#968055)

-------------------------------------------------------------------
Fri Jul 27 11:23:32 UTC 2018 - ygao@suse.com

- Update to version 2.0.0+20180706.8cf3fe749 (Pacemaker-2.0.0):
- tools: Multiple -V increase debug level (#1526)
- scheduler: clarify multiple-anonymous-instances message
- scheduler: avoid use-after-free when on-fail=block
- controller: add node name to meta-data call environment
- controller: filter certain synthesized failures from CIB
- controller: filter certain action timeouts from CIB
- controller: don't record pending notifies in CIB
- executor: cancel recurring monitors if fence device registration is lost
- controller: avoid memory leak if start-up fails
- XML: schemas.c: fix possible memleak + less magic with numeric constants
- tools: stonith_admin -h/-H options are queries
- libstonithd: avoid memory leak when getting meta-data
- XML: resources-3.1.rng: relaxed schema after tight upgrade enforcement
- XML: schemas.c: take severities of XSLT messages into account properly
- XML: assets/upgrade-2.10-htmldiff.xsl: express message severity visually
- XML: upgrade-2.10{,-leave}.rng: distinguish message severity
- XML: upgrade-2.10-roundtrip.xsl et al.: new tests incl. browser view
- XML: upgrade-2.10.xsl: simplify thanks to diehard assumptions wrt. input
- XML: upgrade-2.10-leave.xsl: post-upgrade output restoring stylesheet
- XML: upgrade-2.10-enter.xsl: pre-upgrade input normalizing stylesheet
- XML: schemas.c: implement & employ full round-trip apply_upgrade
- XML: schemas.c: switch to using add_schema_by_version
- XML: schemas.c: prepare the ground for unfold-transform-refold logic
- XML: schemas.c: crm_schema_init: simplify for/break, call add_schema 1x
- XML: schemas.c: shortcut upgrade transformation when not needed
- st_client, stonith_admin: cleanup memory of stonith-history
- XML: cib_ops.c: make use of cib_verbose flag for RNG/XSLT handling
- XML: xml_internal.h: accept changing priority over particular chunks
- CIB: no schema violating oversimplified patching with @id-ref
- schemas.c: cleanup XSLT extension modules' data and whatnot
- spec: move crm_node to -cli package
- attrd: support removing node by ID
- tools: query controller for crm_node -n
- controller: add CRM_OP_NODE_INFO operation
- xml.c: fix cleaning of own vs. XSLT's XML node's _private load
- xml.c: properly "staticize" or drop eligible functions
- scheduler: print to stdout when appropriate
- tools: treat INFINITY correctly in crm_failcount
- libcrmservice: support mount, path, and timer systemd unit types
- libcrmcluster: avoid use-of-NULL when searching for remote node (bsc#1128772)
- spec: add procps-ng & psmisc dependencies as suitable
- libcrmcommon: lower maximum IPC flush delay to 1.5 seconds
- CTS: fix python3 usage
- libstonithd: show error if agent not found for meta-data call
- fencing: add stonith_admin --validate option
- libstonithd: add client API for device validation
- based_callbacks.c: restore -Werror buildability, avoid truncation
- tools: handle stonith_admin exit codes better
- tools: stonith_admin should print error if stonithd connection fails
- tools: improve stonith meta-data error messages

-------------------------------------------------------------------
Mon Jun  4 12:36:13 UTC 2018 - ygao@suse.com

- Update to version 1.1.18+20180531.63ff11d35:
- scheduler: ensure orphaned recurring monitors have interval set
- scheduler: improve action creation messages
- XML: regression.sh + upgrade-2.10.xsl + test-2: browser-based test drive
- XML: upgrade-2.10.xsl: use namespacing and/or modes for easier mash-ups
- XML: regression.sh + upgrade-detail.xsl: fix minor cosmetic issues
- scheduler: "requires" shouldn't apply to guest node fencing
- libpe_status: handle "requires" properly for anonymous clones
- scheduler: avoid unnecessary delay of start actions
- scheduler: order implicit actions more strictly
- all: prefer appropriate node when multiply active
- libpe_status: find active instances properly according to requires
- libpe_status: handle pending migrations correctly (bsc#1177212)
- tools: correctly check crm_resource --move for master role
- scheduler: update wiki URL in log message
- libcrmcommon: use proper IPC buffer size when reading
- CIB manager: improve notification failure messages
- liblrmd: improve TLS key reading
- XML: upgrade-2.10.xsl: rsc op instance_attrs [2/2]: remaining meta attrs
- XML: upgrade-2.10.xsl: rsc op instance_attrs [1/2]: meta-like requires
- XML: upgrade-2.10.xsl: resource meta_attributes: in-situ exchange
- XML: upgrade-2.10.xsl: simplify "should diagnostics be emitted" decision
- XML: upgrade-2.10.xsl: related commits in "./regression.sh -X" output
- XML: regression.sh + upgrade-2.10.xsl: remove commented out leftovers
- XML: resources-3.0.rng: omit "isolation*" resource meta_attributes
- XML: upgrade-2.10.xsl: normalize indentation of new rsc meta attributes
- executor: give more detail when TLS handshake fails
- fenced: be more paranoid about freeing memory
- cts: use python2/3-compatible comparison

-------------------------------------------------------------------
Fri May 18 18:44:31 UTC 2018 - ygao@suse.com

- Update to version 1.1.18+20180517.adf4d77b8:
- spec: unify quoting in {pre,post}* scriptlets' action soliciting
- spec: add a simple retention of pre-existing log move targets
- libcrmcommon,libcrmcluster,liblrmd: recognize daemons under new names
- XML: upgrade-2.10.xsl: resource meta_attributes: tweak diagnostic msg
- XML: upgrade-2.10.xsl: re-apply on scheduler CTS test cases
- XML: upgrade-2.10.xsl: resource meta_attributes: validity conformance

-------------------------------------------------------------------
Mon May 14 08:54:18 UTC 2018 - ygao@suse.com

- Update to version 1.1.18+20180511.acd8ff5a7:
- execd: avoid memory leak when testing remote key
- cts-scheduler: avoid unsupported usage of requires
- controld: avoid memory leak when synthesizing failure
- XML: upgrade-2.10.xsl: resource meta_attributes: isolation* items
- XML: upgrade-2.10.xsl: make diagnostics more direct wrt. context
- XML: upgrade-2.10.xsl: remaining "marking" space with op meta_attributes
- XML: upgrade-2.10.xsl: simplify 2/2: HelperIdentity, no INNER-RECURSION
- XML: upgrade-2.10.xsl: simplify 1/2: resource instance_attributes
- XML: regression.sh: avoid doubts when tests expected at stdin with '-'
- XML: regression.sh: modularize "XSLT processor", allow substitutes
- tools: improve error messages from crm_resource --move
- tools: use output redirection correctly in crm_standby
- tools: handle multiple values properly in crm_attribute
- tools: bash portability issue in crm_failcount
- libcrmservice: don't consider a cancelled recurring operation as failed
- tools: cibsecret checks pacemaker-controld instead of crmd
- tools: cibsecret --help/--version doesn't require cluster to be running (bsc#1102915)
- spec: package cts-exec-helper with main package instead of -cli
- spec: move old logs after upgrade
- scheduler: improve failed op message
- libcrmservice: find absolute paths when used with "service:"
- libcrmservice: separate LSB-specific code into own source files
- execd: handle systemd actions correctly when used with "service:"

-------------------------------------------------------------------
Wed May  9 10:48:06 UTC 2018 - ygao@suse.com

- Update to version 1.1.18+20180504.70fe3d6e9:
- all: take advantage of new libqb features
- contoller,scheduler: guard hash table deletes (bsc#1136712)
- controller: don't abort after delay if we're no longer DC
- libcrmcommon,pacemakerd: kernel task name is at most 15 characters
- cts: install dummy systemd daemon via helper script
- cts: externalize log watcher script
- Maint: make systemctl react to pacemaker-remote as with underscored one
- make some old daemon references traceable with "man -K OLDNAME"
- io.c: restore -Werror buildability, put conversion specifier last

-------------------------------------------------------------------
Tue May  8 14:28:49 UTC 2018 - ygao@suse.com

- Update to version 1.1.18+20180430.c0d7ba798:
- libcrmcommon: avoid memory leak on failed IPC send
- daemons: add configure option to create links at old daemon names
- controld: rename "crmd-*" cluster options
- all: change log file message format
- daemons: improve connection loss messages
- libcrmcommon: improve connection loss message
- pacemaker_remote: correct documentation URL in systemd unit file
- libcrmcommon: check file/directory writability better
- spec: no more buildroot XML to modify
- cib: rename cib daemon to pacemaker-based
- cts-stonithd: rename cts-stonithd to cts-fencing
- fenced: rename stonith-test to cts-fence-helper
- fencing: rename stonithd to pacemaker-fenced
- rename cts-pengine to cts-scheduler
- pengine: rename pengine daemon to pacemaker-schedulerd
- crmd: rename crmd daemon to pacemaker-controld
- pacemaker-execd: rename pacemaker_remoted to pacemaker-remoted
- rename cts-lrmd to cts-exec
- pacemaker-execd: rename lrmd_test to cts-exec-helper
- lrmd: rename lrmd daemon to pacemaker-execd
- attrd: rename attrd daemon to pacemaker-attrd

-------------------------------------------------------------------
Wed May  2 12:48:53 UTC 2018 - ygao@suse.com

- Update to version 1.1.18+20180430.b12c320f5:
  * XML: upgrade-2.10.xsl: fix "mark space" issue (bsc#1091661)

-------------------------------------------------------------------
Sat Apr 28 21:07:31 UTC 2018 - ygao@suse.com

- Update to version 1.1.18+20180427.a34ccd926:
- crmd: avoid double free after ACL rejection of resource delete
- lib: Changed to lowercase comparison.
- all: correct misspellings
- controld: remove deprecated configdir parameter
- controld: deprecate and ignore configdir parameter
- controld: consistently indent with spaces instead of tabs
- libcrmcommon: don't record pending notify actions as completed
- crmd: improve messages when a node is unexpectedly lost
- cib: improve shutdown messages
- cts-regression: allow specifying to run multiple tests again (bsc#1091360)

-------------------------------------------------------------------
Wed Apr 18 15:36:43 UTC 2018 - ygao@suse.com

- Update to version 1.1.18+20180417.24df451b5:
- alerts: Delete redundant code.
- liblrmd: cast time_t to long long when printing

- cts: separate dummy systemd service into separate files
  * Drop obsolete fate-323526_pacemaker-tests-shebang-python3.patch

- crm_diff: rhbz#1561617 - Ignore attribute placement when comparing in 'cib' mode
- spec: remove reference to long-gone file
- spec: mark -cts & -doc packages as noarch
- spec: fix malformed conditional macros for systemd-less cases
- alerts: Change timestamp of Alert of snmp.

-------------------------------------------------------------------
Thu Apr 12 08:30:58 UTC 2018 - ygao@suse.com

- Update to version 1.1.18+20180411.2f77f4922:
- libcrmcommon: free signal triggers when cleaning up mainloop
- libcrmcommon: fix memory leak in schema workaround
- fencing: avoid memory leaks when freeing remote operation
- fencing: free dynamic memory at stonithd shutdown
- crmd: delete resource from lrmd when appropriate (bsc#1117381)
- Test: rhbz#1565187 - Ensure failures that cause fencing are not removed until after fencing completes
- rhbz#1565187 - Ensure failures that cause fencing are not removed until after fencing completes

-------------------------------------------------------------------
Mon Apr  9 09:19:28 UTC 2018 - ygao@suse.com

- Update to version 1.1.18+20180406.633845120:
- libcrmcommon: add a byte to pid file holder
- attrd,cib,libcrmcommon: avoid %z
- crmd: avoid memory leak when synthesizing operation result
- tools: avoid memory leak on invalid resource
- crmd: log rc code as extended information
- cib: avoid file descriptor leak on temporary file creation
- pengine: avoid redundant test
- libcrmcommon: handle compression failures properly
- libcrmcommon: improve empty string check
- various: improve NULL checks
- libcrmcommon: improve patch xpath searches
- libcrmcommon,tools: use format strings appropriate to variables
- libcrmcommon: use correct argument type for duration
- libcrmcluster: avoid potential use-of-NULL
- libcrmcommon,libstonithd: avoid resource leaks
- tools: get sensor lun in ipmiservicelogd before using it
- schema upgrade: temporary fix to avoid crash on newly present text

-------------------------------------------------------------------
Fri Apr  6 15:39:19 UTC 2018 - ygao@suse.com

- Update to version 1.1.18+20180406.ce623681e:
- fencing: convert fence_legacy to python
- fencing: fix typos in messages

-------------------------------------------------------------------
Fri Apr  6 14:49:31 UTC 2018 - ygao@suse.com

- Update to version 1.1.18+20180406.18fe1cc2b:
- XML: upgrade-2.10.xsl: add transform for automatic upgrades to latest schema
- Log: establish correct character string literals also with qb_logt sink
- pengine: fix swapped warning message arguments leading to segfault (bsc#1090538)
- cts-pengine: add regression test for notifications for unrunnable actions
- cts-pengine: update regression tests for notification changes
- rhbz#1545449 - Do not perform notifications for events we know wont be executed
- bundle: Added add-host option.
- liblrmd: add API function for new lrmd op
- lrmd: add new lrmd op to list recurring ops
- spec: require corosync >= 2.0.0
- crmd,libcrmcommon,libpe_status: guint can't be negative
- xml: Allow local "kind" in resource_set within rsc_order (bsc#1085515)
- Pacemaker Explained: "symmetrical" defaults to "false" for serialize orders (bsc#1085515)
- pengine: "symmetrical" defaults to "false" for serialize orders (bsc#1085515)
- pengine: Avoid potential use-of-NULL in unpack_simple_rsc_order() (bsc#1085515)
- cts-pengine: add new regression test for interval handling
- libpe_status: handle ISO8601 intervals when checking for blocking failures
- pengine: properly cancel recurring monitors
- pengine: improve recurring operation messages
- pengine: check for duplicate intervals properly
- libcrmcommon: avoid misuse of crm_get_msec()
- pengine: treat reconnect_interval more consistently with action intervals
- libpe_status: use default timeout rather than 0 if timeout spec is bad
- libpe_status: use correct default timeout for monitors

-------------------------------------------------------------------
Fri Mar 23 13:19:39 UTC 2018 - ygao@suse.com

- Update to version 1.1.18+20180322.d37067b2a:
- spec: Make sure shadow package is installed before adding user and group

-------------------------------------------------------------------
Tue Mar 13 18:53:03 UTC 2018 - ygao@suse.com

- Update to version 1.1.18+20180313.2c83c6872:
- cts-pengine: add regression test for changing bundle replica count
- libpe_status: handle unique bundle children correctly

-------------------------------------------------------------------
Tue Mar 13 00:46:45 UTC 2018 - ygao@suse.com

- Update to version 1.1.18+20180312.31c732adc:
- spec: make shadow dependency explicit
- spec: drop requirements for bison and flex

-------------------------------------------------------------------
Sat Mar 10 18:37:13 UTC 2018 - ygao@suse.com

- Update to version 1.1.18+20180309.e51687162:
- crmd,liblrmd,libcrmcommon: improve remote node disconnection logs
- libcrmcommon: add function to get text equivalent of client type
- crmd: always write faked failures to CIB whenever possible
- liblrmd: add function to create resource info structure
- crmd: functionize setting fake operation status
- crmd: always assert when operation can't be created
- crmd: avoid core dump if remote connection doesn't exist
- crmd: improve lrmd failure handling
- crmd: return rich error codes from get_lrm_resource()
- crmd: match only executed down events
- crmd: functionize pieces of do_lrm_invoke()
- crmd: don't abort for v2 diff LRM refresh if actions pending
- crmd: validate CIB diffs better

-------------------------------------------------------------------
Wed Mar  7 13:06:04 UTC 2018 - ygao@suse.com

- Update to version 1.1.18+20180305.9cd0f6cb8:
- libcrmcommon: avoid memory leak when schema transform not found
- tools: warn if crm_resource --wait called in mixed-version cluster
- Install /etc/pacemaker directory for storing authkey file (bsc#1082883)

-------------------------------------------------------------------
Wed Feb 28 13:57:19 UTC 2018 - ygao@suse.com

- Update to version 1.1.18+20180226.f788652cf:
- crmd: log transition ID when aborting
- crmd: always log unmatched down events at least at debug level
- pengine: deprecate require-all in rsc_order (fate#324508)
- libpe_status: deprecate stonith-action=poweroff (fate#324508)
- tools: already latest schema is not failure for cibadmin --upgrade
- libcrmcluster: prefer corosync name over ring0_addr (fate#324508)
- spec: add gcc to BuildRequires
- attrd: Synchronize attributes held only on own node.

-------------------------------------------------------------------
Fri Feb 23 04:28:37 UTC 2018 - ygao@suse.com

- Build: Ship cibsecret by pacemaker instead of cluster-glue (bsc#1082456)
  * Drop obsolete pacemaker-cibsecret-tool-temp-disabled.patch

-------------------------------------------------------------------
Tue Feb 20 00:09:50 UTC 2018 - ygao@suse.com

- Update to version 1.1.18+20180216.ae50b7f5d:
- various: improve string allocation
- XML: upgrade-2.10.xsl: re(drop) rsc_colocation/@score-attribute{,-mangle}
- XML: upgrade-*.xsl: bump the validate-with field from within stylesheet
- XML: upgrade-*.xsl: omit XML declaration
- upgrade-*.xsl: don't be picky about comments, PIs, etc.

-------------------------------------------------------------------
Wed Feb 14 04:30:48 UTC 2018 - ygao@suse.com

- Update to version 1.1.18+20180213.965befd59:
- libcrmcommon: use /tmp when creating temporary XML file
- tools: crm_master should always work on node attribute
- tools: crm_resource --cleanup couldn't match clone instances
- tools: crm_resource --refresh should ignore --operation and --interval
- crmd: quorum gain should always cause new transition
- rhbz#1527072 - Correctly observe colocation constraints with bundles in the Master role
- Bug rhbz#1519812 - Prevent notify actions from causing --wait to hang
- libpe_status: recover after failed demote when appropriate
- lrmd: always use most recent remote proxy
- libpe_status: limit resource type check to primitives
- PE: correct mispelled constant
- PE: Ensure stop operations occur after stopped remote connections have been brought up
- PE: Remote connection resources are safe to to require only quorum
- PE: Only allowed nodes need to be considered when ordering resource startup after _all_ recovery
- PE: Ordering bundle child stops/demotes after container fencing causes graph loops
- PE: Passing boolean instead of a pointer

-------------------------------------------------------------------
Sat Feb 10 06:43:16 UTC 2018 - ygao@suse.com

- Update to version 1.1.18+20180209.7acb22379:
- use proper way to make output files executable
- spec: move lrmd_test to cli package
- spec: make log directories owned by cli package
- spec: move all test data into cts package
- pengine: move regression test to cts as cts-pengine
- lrmd: move regression test to cts as cts-lrmd
- fencing: move regression test to cts as cts-stonithd
- tools: move CLI regression test to cts as cts-cli
- rename top-level testing files and move to cts directory
- tools: drop crmadmin -i and -d options (fate#324508)

-------------------------------------------------------------------
Fri Feb  9 00:05:41 UTC 2018 - ygao@suse.com

- Update to version 1.1.18+20180208.f6a261987:
- Feature: crmd: modify feature set handling

-------------------------------------------------------------------
Wed Feb  7 02:12:04 UTC 2018 - ygao@suse.com

- Update to version 1.1.18+20180205.b44c57e35:
- pengine,doc,tools: rename "master score" to "promotion score" (fate#324508)
- libpe_status: rename bundle 'masters' to 'promoted-max' (fate#323415)
- pengine,libpe_status: rename master-{max,node-max} to promoted-* (fate#324508)
- various: merge clone resource type and master/slave resource type (fate#324508)
- attrd,pacemakerd,libcrmcommon: make "Exiting" last message
- don't use corosync logging settings (fate#324508)
- crmd,libpe_rules: drop support for notification-agent/recipient
- tools: improve crm_failcount exit code usage

-------------------------------------------------------------------
Tue Jan 30 00:36:28 UTC 2018 - ygao@suse.com

- Update to version 1.1.18+20180129.c801ab11e:
- allow configuring specific python intepreter version (fate#323526)
  * Drop obsolete fate-323526_pacemaker-pacemaker-configure-AM_PATH_PYTHON-python3.patch

- use auto-configured python executable in python shebangs (fate#323526)
  * Update fate-323526_pacemaker-tests-shebang-python3.patch

- xml: drop score-attribute and score-attribute-mangle
- pengine: avoid misuse of function parameter
- libcrmservice,pacemakerd: improve privilege dropping

-------------------------------------------------------------------
Sat Jan 20 02:40:06 UTC 2018 - ygao@suse.com

- Update to version 1.1.18+20180119.9146c3c20:
- crmd: Avoid double-removal of glib event source on stopping

-------------------------------------------------------------------
Fri Jan 19 00:23:32 UTC 2018 - ygao@suse.com

- Update to version 1.1.18+20180118.9c3f7a49c:
- libcrmcommon: put exit/return handling in own source/header files
- Build: bump build dependencies
- Rebase:
  * pacemaker-Wno-format-signedness.patch

-------------------------------------------------------------------
Thu Jan 18 13:28:17 UTC 2018 - ygao@suse.com

- configure: Check for python3 with AM_PATH_PYTHON (fate#323526)
  * fate-323526_pacemaker-pacemaker-configure-AM_PATH_PYTHON-python3.patch

-------------------------------------------------------------------
Sat Jan 13 11:38:33 UTC 2018 - ygao@suse.com

- Update to version 1.1.18+20180112.bd7115b8c:
- tools: improve help text
- libpe_status: deprecate restart-type and role_after_failure

-------------------------------------------------------------------
Wed Jan 10 05:18:59 UTC 2018 - ygao@suse.com

- Update to version 1.1.18+20180109.57d48a1b1:
- libcluster,libcrmcommon: improve BZ2 error messages
- all: use consistent exit status codes
- libcrmcommon,tools: improve XML write error handling
- stonithd,libcrmcommon: auto-calculate stonith-watchdog-timeout when requested (fate#324508)
- logrotate: switch user when rotating logs

-------------------------------------------------------------------
Tue Jan  9 14:43:27 UTC 2018 - ygao@suse.com

- cts: Operate pacemaker service on startup to prevent triggering StopWhenUnneeded of corosync service
  * pacemaker-cts-StartCmd.patch

-------------------------------------------------------------------
Fri Jan 05 03:16:07 UTC 2018 - ygao@suse.com

- Update to version 1.1.18+20180104.7ba28d854:
- tools: improve crm_standby option handling
- tools: improve crm_standby help and error messages
- tools: improve crm_master option handling
- tools: improve crm_master help and error messages
- tools: remove deprecated stonith_admin option (fate#324508)
- tools: remove deprecated crm_verify option (fate#324508)
- tools: remove deprecated crm_attribute --node-uuid option (fate#324508)
- tools: avoid using deprecated options
- tools: remove deprecated crm_resource options (fate#324508)
- libpe_status: use consistent monitor for implicit remotes
- all: overhaul log locations (fate#324508)

-------------------------------------------------------------------
Wed Jan  3 12:28:59 UTC 2018 - ygao@suse.com

- spec: Switch dependencies from python to python3 (fate#323526)
- tests: Switch shebang from /usr/bin/python to /usr/bin/python3 (fate#323526)
  * fate-323526_pacemaker-tests-shebang-python3.patch

-------------------------------------------------------------------
Tue Jan 02 10:13:35 UTC 2018 - bliu@suse.com

- Update to version 1.1.18+20180101.494eacba4:
- migrate cts to python3 (fate#323526)

-------------------------------------------------------------------
Sat Dec 23 12:03:19 UTC 2017 - ygao@suse.com

- Update to version 1.1.18+20171221.c91a650ec:
- libcrmcommon: drop special handling of pre-1.1.7 failed recurring op history
- libcrmcommon: drop special handling of pre-1.1.4 migration history entries
- crmd: drop support for DCs that don't support throttling
- cib,libcrmcommon: drop support for PCMK_legacy variable

-------------------------------------------------------------------
Fri Dec 22 05:15:12 UTC 2017 - ygao@suse.com

- libcrmcluster: use crm_strdup_printf() instead of calloc()
- attrd: avoid small memory leak at start-up
- systemd unit files: restore DBus dependency
- libcrmservice: avoid memory leak on DBus error
- pengine: validate more function arguments
- Upstream version cs: 098d557cc495944e1b6ebd9d05b819d6da74825e

-------------------------------------------------------------------
Mon Dec 18 13:22:27 UTC 2017 - ygao@suse.com

- libpe_status: drop support for "requires" operation meta-attribute (fate#324508)
- tools: crm_resource --cleanup with no resource specified (bsc#1071503)
- tools: crm_resource --cleanup (bsc#1071503)
- crmd,libpe_status: drop support for legacy option aliases (fate#324508)
- libstonithd,libpe_status: drop support for pcmk_poweroff_action (fate#324508)
- libstonithd,libpe_status: drop support for pcmk_arg_map (fate#324508)
- libstonithd,libpe_status: drop support for pcmk_*_cmd (fate#324508)
- libpe_status,libpe_rules: drop support for default-action-timeout (fate#324508)
- libpe_status: use correct default timeout for probes
- libpe_status: drop support for operation meta-attributes in instance_attributes (fate#324508)
- libpe_status: fix precedence of operation meta-attributes
- libpe_status,libpe_rules: remove support for is-managed-default (fate#324508)
- libpe_status,libpe_rules: drop support for default-resource-stickiness (fate#324508)
- crmd: drop support for LRMD_MAX_CHILDREN environment variable (fate#324508)
- tools: remove crm_mon SMTP support (fate#324508)
- tools: remove crm_mon SNMP support (fate#324508)
- lrmd: remove deprecated -r/--dummy command-line option (fate#324508)
- tools: crm_resource --cleanup for non-primitive resources (bsc#1071503)
- pengine: unfence before probing or starting fence devices
- Upstream version cs: 4528eb3b726197ab077243ab923ed291473f0ed7

-------------------------------------------------------------------
Thu Nov 30 15:50:43 UTC 2017 - ygao@suse.com

- attrd: ensure node name is broadcast at start-up (CLBZ#5330)
- Upstream version cs: 407ded8de381543e71c5b94b3ade296fcfd2c828

-------------------------------------------------------------------
Thu Nov 30 15:43:02 UTC 2017 - ygao@suse.com

- libpe_status: remove support for default-resource-failure-stickiness (fate#324508)
- libpe_status: remove support for resource-failure-stickiness (fate#324508)
- various: remove support for pre-Pacemaker-1.0 CIB XML (fate#324508)
- libpe_status,tools: remove support for legacy ticket state entries (fate#324508)
- various: remove isolation wrapper support (fate#324508)

- systemd unit files: enable TasksMax=infinity (bsc#1028138, bsc#1066710)
  * Drop obsolete bug-1028138_pacemaker-pacemaker.service-TasksMax.patch

- Upstream version cs: 53a3fe14b15b087bbde9ccb524d11d0a413cc6e9

-------------------------------------------------------------------
Wed Nov 29 12:31:43 UTC 2017 - ygao@suse.com

- RA: NodeUtilization RA is now shipped by resource-agents package (bsc#1070347)
  * Drop bug-1015842_pacemaker-NodeUtilization-RA.patch

-------------------------------------------------------------------
Wed Nov 29 12:05:00 UTC 2017 - ygao@suse.com

- crmd: default record-pending to TRUE (fate#324508)
- tools: enable new crm_resource --cleanup/--refresh behavior (fate#324508)
- Upstream version cs: f36ad364748880815bf00151c516a1f2deae2fed

-------------------------------------------------------------------
Thu Nov 23 13:48:52 UTC 2017 - rbrown@suse.com

- Replace references to /var/adm/fillup-templates with new
  %_fillupdir macro (boo#1069468)

-------------------------------------------------------------------
Mon Nov 20 16:20:53 UTC 2017 - ygao@suse.com

- Update to version 1.1.18
- libpe_status: always use default key location with bundles
- attrd,stonithd: more efficient regular expression parsing
- libpe_status: avoid potential NULL dereference
- tools: use proper variable in message from crm_resource -g
- tools: use uber-parent for crm_resource -a/-A
- tools: use g_main_loop_is_running() properly
- libpe_status: monitors are rescheduled, not reloaded
- crmd: determine restart/private digests correctly
- systemd: add TasksMax comment to pacemaker_remote unit (bsc#1028138, bsc#1066710)
- tools: make regression test insensitive to line number changes
- pengine,tools,libpe_status: avoid unnecessary use of pe_find_current

- pacemaker.service: Recommend not to limit tasks (bsc#1028138, bsc#1066710)
  * Update bug-1028138_pacemaker-pacemaker.service-TasksMax.patch

- tools: set the correct OCF_RESOURCE_INSTANCE env when crm_resource --force-* executes RA
- typo: overriden -> overridden
- portability: the difference of time_t values is given by difftime()
- pengine: avoid not-really-possible use-of-NULL
- PE: Have bundles log to stderr so that 'journalctl -M' works (rkt)
- tools: don't expect reply to failed send
- pengine: use newer Pacemaker Remote terminology
- pengine: memory leak when writing graph to file
- tools: don't reinvent the glib wheel
- tools: implement clean-up dry-run correctly
- pengine: avoid potential use-of-NULL
- Update regression test outputs
- PE: Improved logging of reasons for stop/restart actions
- PE: Allow all resources to stop prior to probes completing
- PE: Correctly defer processing of resources inside containers
- crm_resource: Ensure we wait for all messages before exiting
- crm_resource: Have cleanup operate only on failures
- PE: Have bundles log to stderr so that 'docker logs' works
- PE: Resources are allowed to stop before their state is known everywhere
- PE: Use the node we already have and know isnt NULL
- PE: Flag resources that are acting as remote nodes
- crmd: Scale all cib operation timeouts
- PE: Bare metal remotes _can_ run resources now and must be probed
- PE: Bundles only need to wait for other containers on the same node to be probed
- crmd: Scale timeouts with the number of remotes too
- PE: There is no need for port mapping directives when net=host is specified
- PE: Do not always expire failed operations of nested remotes
- PE: Consolidate REMOTE_CONTAINER_HACK logic
- PE: Exclude resources and nodes from the symmetric_default constraint in some circumstances
- crm_resource: Don't cleanup on nodes not meeting the discovery conditions
- PE: Restore the ability to send the transition graph via the disk if it gets too big
- crm_resource: Prevent disconnection from crmd during cleanup
- PE: Do not probe connection resources until the container is active
- PE: Detailed resource information should include connection resource state
- Tools: Allow crm_resource to operate on anonymous clones in unknown states
- tools: Clean up everywhere if we don't know anything about the resource
- crm_resource: See what cleanup would have done for a saved configuration
- PE: Only pass requests for promote/demote flags onto the bundle's child
- Upstream version cs: 2b07d5c5a908998891c3317faa30328c108d3a91 (Pacemaker-1.1.18)

-------------------------------------------------------------------
Thu Nov  2 15:15:06 UTC 2017 - ygao@suse.com

- pengine: if ignoring failure, also ignore migration-threshold
- libcrmcommon,liblrmd,lrmd: improve messages for failed remote sends
- libcrmcommon,lrmd: meaningful error codes when sending remote messages
- libcrmcommon: lower watchdog messages when default
- tools: set meta_timeout env when crm_resource --force-* executes RA
- fencing: don't print event twice with stonith_admin --verbose
- fencing: memory leak in stonith_admin --env
- fencing: improve stonith_admin help
- crmd: hard error if remote start fails due to missing key
- libcrmcommon,liblrmd: report meaningful async connection errors
- libcrmcommon: return meaningful error codes to connection callbacks
- libcrmcommon: async connection callback must get negative error codes
- libcrmcommon,liblrmd: improve remote connection messages
- pacemaker_remote: warn if TLS key can't be read at start-up
- lrmd: tweak TLS listener messages
- pengine: don't probe offline or unclean guest nodes (fate#324441)
- agents: ifspeed - Try to detect interface name from ip address.
- pengine: don't keep unique instances on same node
- pengine: improve messages when assigning resources to nodes
- Upstream version cs: 23be51236edc34477a99d6979bc0e2cc1e1a7684

-------------------------------------------------------------------
Tue Oct 24 10:29:38 UTC 2017 - ygao@suse.com

- libpe_status: avoid use-after-free (again)
- lrmd: don't reject protocol 1.0 clients (bsc#1009076)
- tools: print descriptive messages for OCF exit code
- tools: differentiate trace log level for RAs
- tools: show RAs debug logs only when verbose mode for crm_resource --force-*
- tools: suppress an invalid error message for crm_resource --force-* options
- pengine: don't schedule reload and restart in same transition
- libcrmservice: list systemd agents alphabetically
- libcrmcommon: add function to sort list alphabetically
- pengine: new regression test for unrecoverable remote connection
- libcrmservice: avoid infinite loop on bad DBus reply
- libcrmservice: list systemd unit files, not only active units
- libpe_status: print container type in lowercase when outputting XML
- tools: re-enable crm_resource --lifetime option (CLBZ#5251, bsc#950128)
- libcrmcluster: improve error checking when updating node name
- tools: fix crm_resource --why output when resource and node are specified
- libcrmservice: parse LSB long description correctly
- libcrmservice: follow LSB standard for header block more strictly
- libcommon: Erase old exit_reason
- Upstream version cs: 36d2962a8613322fc43d727d95720d61a47d0138

-------------------------------------------------------------------
Fri Oct 13 12:13:50 UTC 2017 - ygao@suse.com

- crm_mon: error-exit child if execl should return
- crmd: avoid memory leak when caching meta-data
- tools: ensure crm_resource data set is initialized
- libcib: ensure xpath result isn't empty
- tools: missing break statement in attrd_updater
- libcrmcommon: check sscanf() result when parsing schema version
- tools: check sscanf return value when parsing failed op list
- tools: treat bundles with replicas like clones when restarting
- tools: allow crm_resource to be called without arguments
- tools: update regression test for recent message changes
- tools: improve crm_resource --show-metadata error messages (CLBZ#5287)
- libcrmcommon: add functions for using agent specifications
- tools: improve crm_resource help (CLBZ#5251, bsc#950128)
- libcrmcommon: improve cluster option parsing
- Upstream version cs: 27b631162104d90e944cbc107c2d46e983f94ca7

-------------------------------------------------------------------
Fri Oct  6 14:25:23 UTC 2017 - ygao@suse.com

- spec: Disable deprecated crm_mon SNMP/ESMTP support (configure alerts instead)

-------------------------------------------------------------------
Fri Oct  6 14:23:14 UTC 2017 - ygao@suse.com

- pengine: add tests for no-quorum-policy=suicide
- libpe_status: properly detect when nodes should suicide
- libpe_status: always log startup-fencing value
- libpe_status: generalize ability to log warning only once
- pengine: reset loss-policy from fence to stop if no fencing
- pengine: avoid use-of-NULL when unpacking tickets
- tools: ensure crm_resource works if no command is specified
- libpe_status: validate no-quorum-policy=suicide correctly
- tools: use-after-free in crm_diff
- RA: ClusterMon - Correctly handle "update" parameter
- attrd: "peer peer loss" -> "peer loss"
- Tools:Refactored Crm_resource to have proper assignments for require_*
- Upstream version cs: c4a09cfec99570a2509831f4b8974457dcdb1af6

-------------------------------------------------------------------
Fri Sep 29 11:56:01 UTC 2017 - ygao@suse.com

- Log: Reduce verbosity of developer logging
- PE: We most definitely need to probe connection resources
- PE: Ensure the bundle nodes get set with the correct discovery mode
- PE: Implement probing of container remote nodes (fate#324441)
- attrd: Tweak log messages for clarity
- crm_resource: Do not send history erasure commands for nodes where this is none
- PE: Resources in bundles should also respect failcounts
- PE: Do not send notifications to unclean bundles
- PE: Prevent graph loops when fencing the host out from underneath a bundle
- Tools: Allow bundle resources to read/write master scores based on the same logic as attrd (cf34f4c)
- PE: bundle: Send an additional host list when container-attribute-target=host
- PE: Correctly interpret colocation with bundles
- PE/attrd: Allow bundle resources to read/write attributes based on the physical host rather than the container name
- Upstream version cs: 4328c6a65424d1caf9785107664ec1b7fc824664

-------------------------------------------------------------------
Thu Sep 28 10:22:07 UTC 2017 - ygao@suse.com

- Rebase:
  * bug-728579_pacemaker-stonith-dev-id.patch

- Fix: -Wformat-truncation=2: prevent format truncation
- snprintf: use correct signedness in print format specifiers
- snprintf: use sizeof(X) as size + prevent off-by-ones
- crmd,libcrmcommon,libcluster,tools: handle PID as string properly
- tools: use right size for string buffer in fake_transition.c
- crm_resource: fix a memleak
- pengine: sprintf -> snprintf
- libcrmcommon: fix possible infloop in buffer_print
- crm_snprintf_offset like parts: fix off-by-ones
- attrd: improve update messages
- stonithd,lrmd,pengine: spelling/formatting corrections
- build: install ifspeed resource agent
- libcrmservices: avoid assert for HB resource with no parameters
- crmd: re-enable local collection of meta-data for remote nodes
- crmd,pengine,libpe_status,libpe_rules: remove support for versioned attributes
- crmd: avoid memory leak when node state is unknown
- crmd: avoid assert if LRM query fails
- libpe_status: more error checking when unpacking bundles
- libpe_status: bundles now respect PCMK_authkey_location
- libcrmcommon,liblrmd,lrmd: validate PCMK_remote_port
- PE: Bundles: add support for rkt bundle type
- libcrmcommon,libpe_rules: unpack new alert filter syntax
- xml: allow specifying alertable events
- Fix: a proper calculation of a speed in case of hfi1 for ifspeed RA.
- pengine: detect proper clone name at startup
- pengine: don't ignore permanent master scores at startup
- pengine: handle resource migrating behind a migrating remote connection
- stonith-ng: advertise pcmk_on_action via metadata
- liblrmd: Make sure the operation of a remote resource returns if setup of the key fails (bsc#1053463)
- libcrmcommon,pengine: improve log messages
- PE: only print to stdout if run from command line
- crmd: eliminate size restriction on node state xpath
- pengine: add regression test for remote connect interval wait
- pengine: re-enable unrecoverable remote fencing
- pengine: Make sure calculated resource scores are consistent on different architectures (bsc#1054389)
- PE: Allow resources inside bundles to receive notifications
- PE: Update unfencing device change test output
- attrd,crmd: erase attributes at attrd start-up, not first join
- attrd: accept connections only after CIB connection is active
- attrd: make CIB connection function self-contained
- attrd: improve messages
- stonith-ng: make fencing-device reappear properly after reenabling
- crmd: don't need meta-data after resource is deleted
- crmd: only get meta-data for OCF and stonith agents
- libcrmcommon: generate agent key without :: if no provider
- pengine: avoid fence loop for remote nodes
- attrd: don't log error if CIB doesn't have an alerts section
- PE: Only retrigger unfencing on nodes that ran operations with the old parameters
- PE: Output resource changes in a friendlier format
- PE: Attempt to indicate why resources are changing state
- Mechanism for recording why an action is required
- Support unfencing of remote nodes
- PE: Ignore optional unfencing events and report the fencing type
- Upstream version cs: 20cffae1e9c64217339173c197edac8612ad02b9

-------------------------------------------------------------------
Mon Jul 31 09:40:31 UTC 2017 - ygao@suse.com

- logging: ensure blackbox gets generated on arithmetic error
- crm_mon: overcome crm_system_name no longer influenced with argv
- crm_mon: make CGI bail out on suspicious arguments
- crm_mon: make CGI bail out properly and w/o help screen
- crm_mon: canonical casing of Content-Type CGI header field
- libcrmcommon: handle schema versions properly
- attrd: don't reconnect to lrmd if already connected
- PE: Ensure nested container connections run on the same host
- crmd: send alerts via lrmd
- lrmd: execute alerts as cluster daemon user
- libservices: add ability to specify user to run an action
- libcrmcommon: improve user lookup messages
- extra: correct ClusterMon metadata
- attrd: avoid memory leak when disconnecting from lrmd
- attrd,tools: avoid memory leaks from use of crm_itoa()
- attrd: be consistent about attr/host logging
- attrd: delay lrmd connect until needed
- attrd: add timestamp to alert just when needed
- attrd: improve log messages
- libcrmcommon,libpe_rules: avoid crash when alerts section has comments
- libcrmcommon: add API call for next named XML child
- liblrmd: only set environment variables with a value
- attrd,liblrmd: handle adding env var at head of list
- lrmd: drain alerts at shutdown
- attrd,lrmd: generate alert sequence number in lrmd
- liblrmd: better trace message when creating command
- stonith-ng: avoid double-free of pending-ops in free_device
- crmd: log correct feature set revision
- PE: update start-failure-is-fatal help
- cib: avoid unnecessary memory allocation
- stonith-ng: add pcmk_delay_base as static base-delay (fate#324488)
- XML: upgrade-1.3.xsl: be explicit about non 1:1 wrt. ACL @attributes
- enable upgrade XSLTs to use <xsl:message> meaningfully
- Tools: Added option of --why/Y to crm_resource to inform the status of resources if running or not
- various: fix spelling in messages and comments
- cib: reword trace message
- PE: Prevent use-after-free when creating bundle constraints
- add versioned operations support
- TE: don't bump counters when action or synapse is invalid
- obtain metadata in CRMd via async call
- tools: add version options for cibsecret
- alerts: Support of meta attributes(kind, attribute_name).
- attrd,lrmd,lib: Addition of the transmission function of the attribute alert to attrd.
- extra: Change alert_xxx.sh.sample for attribute alerts.
- extra: Change PCMK-MIB.txt for attribute alerts.
- XML: upgrade-1.3.xsl: simplify branching
- XML: upgrade-1.3.xsl: drop superfluous branching
- XML: upgrade-1.3.xsl: simplify "weak identity" transform rules
- XML: upgrade-1.3.xsl: easy simplifications + redundant declarations drop
- re-enable versioned attributes
- Upstream version cs: d134f83b4f0188f6d7cd381c8cdda1a2a7c38bd5

-------------------------------------------------------------------
Wed Jul 19 14:06:09 UTC 2017 - ygao@suse.com

- Update to version 1.1.17
- PE: Ensure unrecoverable remote nodes are fenced even if no resources can run on them
- iso8601: strftime needs fully populated struct tm (bsc#1058844)
- crmd: abort transition whenever we lose quorum
- PE: Ensure bundle nodes and child resources are correctly cleaned up
- PE: Generic ordering for anything with bundles
- PE: Default to non-interleaved bundle ordering for safety
- PE: Functional inter-bundle ordering when either side has no child
- PE: Basic inter-bundle ordering when both sides have children
- PE: Implement bundle ordering
- libpe_status: properly disallow other resources from bundle nodes
- libcib: get remoteness correctly from node status
- libpe_status: avoid memory leaks when creating bundle remote resource
- libpe_status: disallow resources on bundle nodes
- pengine: make checks a little safer
- PE: Clones within bundles may also have notifications enabled
- PE: Correctly implement pe_order_implies_first_printed
- PE: Do not re-add a node's default score for each location constraint
- PE: Bundle location constraints should only apply to the IP and docker resources
- PE: Bundles: Allow clones to be colocated with bundles
- PE: Bundles: Implement colocation of primitives and groups with bundles
- cib,libcib: support option for IPC eviction threshold
- libcib: correctly search for v2 patchset changes
- libcib: always use current values when unpacking config
- libcrmcluster: fix spelling error in error message
- crmd: DC should update stonith fail count before aborting transition
- cib: Broadcasts of cib changes should always pass ACLs check (bsc#1042054)
- Upstream version cs: b36b869ca8fe74caa077c286304f653f0be117ef (Pacemaker-1.1.17)

-------------------------------------------------------------------
Fri Jun  2 12:58:32 UTC 2017 - ygao@suse.com

- pengine,libpe_status: revisit fencing messages
- PE: Improve logging of node fencing and shutdown
- PE: Fence unrecoverable remote nodes with no resources
- libpe_status: propagate multiple-active=block for bundles
- libpe_status: set parent for bundle components
- attrd: broadcast local overrides of sync'ed attributes
- crmd: attribute write-out not needed with atomic attrd
- PE: Prevent use-after-free when creating bundle constraints
- PE: Ensure remote nodes are fenced when the connection cannot be recovered
- PE: Improved fencing logging
- PE: Assume resources on remote nodes do not need to be restarted until absolutely necessary
- PE: Correctly compare a point with NULL instead of FALSE
- libpe_status: correctly flag remote connection resources
- pengine: improve internal bundle constraints
- pengine: re-phrase trace log for internal constraints
- libpe_status: set #kind to "container" for bundle nodes
- pengine,libpengine: avoid potential use-of-NULL
- pengine: avoid use-of-NULL in bundle without primitive
- libpengine: don't double score when adding first allowed node
- pengine: improve detection of invalid constraints
- PE: Prevent use-of-NULL when expanding containers
- PE: Partially restore 62ed004 to ensure remote connections are available before attempting resource recovery
- stonith-ng: Trigger on constraints added to cib (bsc#1042374)
- Upstream version cs: e47bd5bc77a3d1b38589b3716f5112ed39329e7b

-------------------------------------------------------------------
Mon May 15 12:41:35 UTC 2017 - ygao@suse.com

- RA: NodeUtilization - Use xl if available (bsc#1015842)
  * Drop obsolete:
    ** bug-1015842_pacemaker-NodeUtilization-RA-1.patch
    ** bug-1015842_pacemaker-NodeUtilization-RA-2.patch
    ** bug-1015842_pacemaker-NodeUtilization-RA-3.patch
  * Add bug-1015842_pacemaker-NodeUtilization-RA.patch

- Drop obsolete pacemaker-lrmd.h-include-libxml.patch

- lrmd,pengine: remove versioned parameters from documentation and tests
- lrmd,pengine: don't support versioned attributes by default
- Containers: Relax docker/remote colocation constraint when appropriate
- Containers: Ensure remote resources are only allocated to full cluster nodes
- lrmd: Ensure verbosity options are handled after crm_log_init()
- pengine: unmanage guest-container puts guest in maintenance
- pengine: unique ids for meta-attributes of guest-connection
- pengine: update regression tests for probes of guest-connections
- pengine: have guest-node connection-resources probed
- crmd: clean up throttle memory on exit
- libcib: avoid use-after-free when deleting CIB connection
- systemd unit files: add dependency on resource-agents-deps
- pengine: Allow use of resource params and meta-params in location rules
- libcrmcommon: avoid evicting IPC client if messages spike briefly
- libcrmcommon: don't delay next flush by more than 5 seconds
- libcib: downgrade ACL status message to trace
- crmd: don't destroy election structure twice
- crmd: avoid use-after-free when disconnecting from CIB
- libcib: functionize destroying op callback table
- crmd,libcrmcommon: update throttle when CPUs are hot-plugged
- crmd: remove I/O load checks
- libcrmcommon: add function to get number of CPU cores
- crmd: functionize checking throttle thresholds
- crmd: functionize setting throttle load target
- CTS: update corosync fail patterns
- crmd: check correct timer for being started
- crmd: improve fencing result message
- lrmd: Have pacemaker-remote reap zombies if it is running as pid 1
- pengine: add test for per-op fail count
- libcrmcommon: filter attributes with '#' from XML fields
- extra: Dummy stop shouldn't fail if monitor is in progress
- extra: use whitespace consistently in Dummy
- crmd: don't fence old DC if it's shutting down as soon-to-be DC joins
- crmd: avoid DC sending offer to itself twice
- crmd: don't restart transition if no fence devices
- crmd: skip restart at (not above) stonith-max-attempts
- crmd: allow clearing all stonith fail counts
- crmd: track stonith fail counts on all nodes
- crmd: forget stonith failures when forgetting node
- crmd: consider target when checking stonith failures
- crmd: check for too many stonith failures only when aborting for that reason
- PE: Remote: Allow remote nodes that start containers with pacemaker remote inside
- fencing: ignore empty 'action' parameter in fence devices
- crmd: fix remove attr_id from update_attr_delegate()
- Fix log showing the node status so that it is easily distinguishable from other logs
- crmd: don't abandon fencing after one "no devices" failure
- libcrmcommon: more useful message if can't open dump file
- libcib: use new convenience function for sanitizing ID
- libpe_status: implement active check for bundles
- tools: update crm_mon RNG schema for bundles
- crmd: add set_join_state()
- crmd: fix line wrapping
- crmd: update_attr_delegate() instead of set_standby()
- PE: Containers: Allow custom docker run commands
- logrotate: rotate pacemaker logs inside bundled containers
- libpe_status: improve bundle docker defaults
- tools: crm_resource should free result if re-running function returns one
- libpe_status: avoid memory leak when counting failures
- crmd: remove functions from crmd_utils.c
- PE: Containers: Ensure replicas_per_host=1 is respected during rediscovery and startup
- libcib: change the format of the state id in set_standby()
- PE: Containers: Allow the internal and external ports to optionally differ
- PE: Containers: Allow custom control ports when using the machine's local address
- crmd: set_standby in first_join
- PE: Bundles: Better support for net=host, allow the pacemaker-remote port to change
- Remote: Allow the port to listen on to be specified on the commandline
- libpe_status: allow more than 254 containers in a bundle
- crmd,liblrmd: handle crmd-local proxy requests properly
- common: Prevention of the double definition.
- pacemaker_remoted: Allow compilation with glib older 2.36
- PE: Containers: Default 'replicas' to the same number of 'masters'
- PE: Containers: Correctly find the right anonymous child resource running in a container
- PE: Clone: Simplified allocation function
- PE: Contaienrs: Better checks when assuming a container will start
- PE: Preferred nodes are only accepted if their scores are equal to the otherwise best candidate
- PE: Containers: Remove containers on termination by default
- PE: Container: Add support for non-default docker networks and supplying external IPs to container resources
- PE: Containers: Allow specifiying the maximum number of peers per host
- PE: Containers: Force a sane hostname
- PE: Containers: Add support for nic and netmask parameters
- PE: container: Parse network and mount options
- PE: Allow the graph to assume container nodes will come up and schedule actions for it
- PE: Force node scores for containerized resources
- PE: Basic allocation of containers
- Core: Track the line number of callers of crm_(set|clear)_bit
- xml: Correctly find the first child element
- PE: Basic container parsing and expansion (fate#323415)
- PE: Correctly test for clone functionality
- Improve recovery when demote fails with OCF_NOT_RUNNING
- Upstream version cs: ce86684f5d0672791e9fd3043a84f0931cdd97ea

-------------------------------------------------------------------
Thu Mar 23 16:02:22 UTC 2017 - ygao@suse.com

- libcrmcluster,crmd: log join phase as text rather than integer
- pacemaker-remote: pacemaker_remoted shutdown while unmanaged
- tools: disable agent stdout/stderr for crm_resource --validate
- tools: Add "--validate" command to crm_resource
- tools: crm_resource should set OCF_RESKEY_crm_feature_set
- tools: make crm_failcount compatible with per-operation failcounts
- tools: support clearing failure of a single operation with crm_resource -C
- crmd: support clearing failure of a single operation
- crmd: make clearing last failure more efficient
- attrd,libcrmcommon: support clearing failure of a single operation
- attrd,crmd,libraries,tools: track resource failures per-operation
- tools: support crm_failcount -q as advertised
- Upstream version cs: 77ea74d01bcb6b7100e1c7acab0e66e79aceaf8b

-------------------------------------------------------------------
Fri Mar 17 16:10:49 UTC 2017 - ygao@suse.com

- NodeUtilization: Never set hv_memory to a negative value (bsc#1015842)
  * bug-1015842_pacemaker-NodeUtilization-RA-3.patch

- NodeUtilization: Fix mixed indentation, set executable bit (bsc#1015842)
  * bug-1015842_pacemaker-NodeUtilization-RA-2.patch

- RA: NodeUtilization - Use xl if available (bsc#1015842)
  * Drop obsolete bug-1015842_pacemaker-NodeUtilization-RA.patch
  * Add bug-1015842_pacemaker-NodeUtilization-RA-1.patch

-------------------------------------------------------------------
Fri Mar 17 11:07:49 UTC 2017 - ygao@suse.com

- spec: Merge the SLE and Factory versions
  * enable_fatal_warnings=0

-------------------------------------------------------------------
Thu Mar 16 14:25:19 UTC 2017 - ygao@suse.com

- crmd: new cluster option stonith-max-attempts with default value 10 (fate#323417)
- crmd: Change of the log level and addition of uuid.
- crmd: use new attrd op to clear fail counts
- tools: crm_resource -C should clear last-failure
- libcrmcommon: add API for new attrd clear-failure operation
- attrd: add more detail to legacy attrd messages
- attrd: add API for clearing failures
- Upstream version cs: e55d506cc390f0a0335b4ec6e365ea89da30b6b1

-------------------------------------------------------------------
Mon Mar 13 13:46:36 UTC 2017 - ygao@suse.com

- pacemaker.service: Add presetting TasksMax=4915 (bsc#1028138)
  * bug-1028138_pacemaker-pacemaker.service-TasksMax.patch

-------------------------------------------------------------------
Tue Mar  7 00:01:15 UTC 2017 - ygao@suse.com

- Build: lrmd: Include libxml/tree.h in lrmd.h
  * pacemaker-lrmd.h-include-libxml.patch

-------------------------------------------------------------------
Mon Mar  6 22:58:46 UTC 2017 - ygao@suse.com

- libfencing,fencing: properly remap "action" in configuration
- libservices: ensure recurring actions table is created before using
- libservices: improve error messages when creating operation
- libservices: properly detect in-flight systemd/upstart ops when kicking
- libservices: properly cancel in-flight systemd/upstart op
- libservices: handle in-flight case first when cancelling an operation
- libservices: prevent use-after-free when freeing an operation
- libservices: ensure completed ops aren't on blocked ops list
- libcrmcommon: assert if can't generate operation key
- libcrmcommon: improve remote connection polling messages
- crmd: clear failure only for requested node
- crmd: improve message when clearing failures
- pengine,libpe_status: make failcount clearing messages more helpful
- pengine,libpe_status: don't clear same fail-count twice
- cib: properly mark variable as volatile
- libcib: avoid memory leak in query_node_uuid()
- tools: avoid NULL dereference in crm_resource debug message
- cib,libcrmcommon,lrmd: handle IP addresses better in messages
- tools: crm_attribute should prefer node name from environment
- libcrmcommon: Correctly delete XML comments according to their positions (bsc#1024037)
- libcrmcommon: Correctly compare XML comments to prevent crmd from getting into infinite election loop (bsc#1024037)
- crmd,libcrmcluster: minor log message improvements
- tools: avoid deprecated function in notifyServicelogEvent
- libcrmcommon,pengine,tools: pass local node name to resource agents
- use callback instead of sync call
- libcib: make querying node uuid more efficient
- tools: allow regular expression with crm_attribute
- attrd: support regular expressions in legacy attrd
- attrd: support Pacemaker Remote node attributes in legacy attrd
- use status scope to start node in standby mode
- attrd: ignore unsupported requests in legacy attrd
- attrd,crmd: implement peer remove requests in legacy attrd
- crmd: don't clear remote node transient attributes unnecessarily
- crm_mon: protect against non-standard or failing asctime
- libservices(sync): partially prevent killing foreign process
- libservices (sync): ensure no zombie is left behind
- cib: improve re-sync handling
- tools: implement crm_failcount command-line options correctly
- tools: use correct regular expression for fail counts in crm_resource
- cib: never disable legacy mode with corosync 1 stacks
- cib: improve warning when legacy diff fails
- libcrmcommon: ensure filename is not NULL before opening
- crmd: be more resilient when checking an LRM command's "from"
- crmd: improve crmd's LRM-related log messages
- tools: properly ignore version with crm_diff --no-version (bsc#888726)
- Ability to start node in standby (fate#323416)
- Upstream version cs: a7825f4f0a8db272d1ce0b1f93e8044cbcaa5144

-------------------------------------------------------------------
Mon Mar  6 13:04:16 UTC 2017 - ygao@suse.com

- libservices: properly watch writable DBus handles
- tools: don't reference hidden parameter in crm_resource help text
- Alert: Set SNMP_PERSISTENT_DIR directory for the snmp-trap tool.
- dbus: Prevent lrmd from hanging on dbus calls (bsc#1015264)
- spec: add %check to run a subset of tests on rpmbuild
- crmd: update cache status for guest node whose host is fenced
- pengine: consider guest node unclean if its host is unclean
- pengine: create a pseudo-fence for guest node recovery
- pengine: guest node fencing doesn't require stonith enabled
- pengine: remove unnecessary assert
- mcp: Correction of the difference in access permission setting.
- stonith_admin: Addition of the list-targets option.
- stonith: Check for missing params in new device and dup
- libservices: treat systemd service reloading as OK (bsc#1059187)
- crmd: increase severity when fencing didn't happen (bsc#1011240)
- rng: Create resources-2.7.rng to update template class validation
- libcrmcommon: Don't report error if the output file isn't syncable
- crmd: bump feature set
- pengine: disable migration for versioned resources
- add versioned parameters support
- Upstream version cs: 2817a2081e9e70e7412f0d0a253495611afab55e

-------------------------------------------------------------------
Mon Mar  6 12:58:37 UTC 2017 - ygao@suse.com

- wd: Fix to not compare NULL when environment variable is not set
- mcp,pacemaker_remote: order after time-sync

- configure: fix fouled parameter expansion
  * Drop obsolete pacemaker-configure-systemd-detection.patch

- xml: rng: Keep score-attribute{,-mangle} in the existing RelaxNG schema files for graceful upgrades
- Upstream version cs: 94ff4df51a55cc30d01843ea11b3292bac755432 (Pacemaker-1.1.16)

-------------------------------------------------------------------
Mon Mar  6 12:57:23 UTC 2017 - ygao@suse.com

- RA: NodeUtilization - Use xl if available (bsc#1015842)
  * bug-1015842_pacemaker-NodeUtilization-RA.patch

-------------------------------------------------------------------
Mon Mar  6 12:53:50 UTC 2017 - ygao@suse.com

- spec: Prevent overwriting existing sysconfig files by conditionally running %fillup_only (bsc#1022807, bsc#980341)

-------------------------------------------------------------------
Mon Mar  6 12:52:25 UTC 2017 - ygao@suse.com

- spec: cts brings an RA that needs python-systemd

-------------------------------------------------------------------
Wed Feb 22 15:39:36 UTC 2017 - dimstar@opensuse.org

- Explicitly own %{_defaultdocdir}/%{name}.

-------------------------------------------------------------------
Tue Nov  8 10:21:00 UTC 2016 - ygao@suse.com

- Revert "Build: configure: make systemd detection akin to + before Upstart one"
  * pacemaker-configure-systemd-detection.patch

- libcrmcommon: fix CVE-2016-7035 (improper IPC guarding) (bsc#1007433)
- sysconfig: minor tweaks (typo, wording)
- various: issues discovered via valgrind and coverity
- attrd_updater: fix usage of HAVE_ATOMIC_ATTRD
- Upstream version cs: b6f251a13fadca0cb74702b0c007a55275c8ea09

-------------------------------------------------------------------
Fri Oct 21 09:35:01 UTC 2016 - ygao@suse.com

- Rebase:
  * pacemaker-NodeUtilization-RA.patch

- extra: add resource agent for managing a node attribute
- crmd: cl#5185 - Record pending operations in the CIB before they are performed (bsc#1003565)
- ClusterMon: fix to avoid matching other process with the same PID
- mcp: improve comments for sysconfig options
- spec: require libqb >= 0.13.0
- tools: crm_standby --version/--help should work without cluster
- spec: reorganize so %pre etc. blocks are self-contained
- spec: require python >= 2.6
- spec: comment better
- libpengine: ensure child is not null before looking up value
- libpengine: only log startup-fencing warning once
- Upstream version cs: 722276c442bf023931842313bfe0dfb7d90a7c15

-------------------------------------------------------------------
Mon Sep 26 10:51:34 UTC 2016 - ygao@suse.com

- pacemaker.service: do not mistakenly suggest killing fenced
- pacemaker.spec: consume "systemdunitdir" via %_unitdir
- libcrmcommon: report errors consistently when waiting for data on connection (bsc#986644)
- libservices: use DBusError API properly
- remote: Correctly calculate the remaining timeouts when receiving messages (bsc#986644)
- libfencing: report added node ID correctly
- crm_mon: Do not call setenv with null value
- pacemaker_remote: allow remote clients to timeout/reconnect
- pengine: Do not fence a maintenance node if it shuts down cleanly (bsc#1000743)
- install README in doc instead of now-removed AUTHORS file
- ping: Avoid temporary files for fping check (bsc#987348)
- all: clarify licensing and copyrights
- schemas.c: treat CIB with unrecognized validate-with better
- schemas.c: avoid downgrade validate-with in a corner case
- xml.c: better info in cli_config_update on no validation success
- fix infloop when no schema validates on update_validation
- xml.c: internal self-or-less reference inflicted infloop guard
- crmd: Resend the shutdown request if the DC forgets
- ping: Avoid temp files in fping_check  (bsc#987348)
- crmd: Ensure the R_SHUTDOWN is set whenever we ask the DC to shut us down
- crmd: clear remote node operation history only when it comes up
- libcib,libfencing,libtransition: handle memory allocation errors without CRM_CHECK()
- tools: make crm_mon XML schema handle resources with multiple active
- tools: make crm_mon resources section more consistent
- crmd: bump feature set
- pengine: set OCF_RESKEY_CRM_meta_notify_active_* for multistate resources
- LSB init: try to be a little more compliant
- pengine: avoid null dereference in new same-node ordering option
- lrmd,libcluster: ensure g_hash_table_foreach() is never passed a null table
- crmd: don't log warning if abort_unless_down() can't find down event
- lib: Correction of the deletion of the notice registration.
- stonithd: Correction of the wrong connection process name.
- crmd: Keep a state of LRMD in the DC node latest.
- pengine: avoid transition loop for start-then-stop + unfencing
- libpengine: allow pe_order_same_node option for constraints
- pengine: avoid sisyphean score-attribute-mangled parsing
- xml: score-attribute{,-mangle} has no meaning for rsc_colocation
- Upstream version cs: 4cce2b26f6f468c342adb24bf74234a12a0070c2

-------------------------------------------------------------------
Fri Aug 26 16:20:25 UTC 2016 - ygao@suse.com

- cts: Restart systemd-journald with "systemctl restart systemd-journald.socket" (bsc#995365)
  * bug-995365_pacemaker-cts-restart-systemd-journald.patch

-------------------------------------------------------------------
Fri Jul  8 09:58:46 UTC 2016 - ygao@suse.com

- libcrmcommon: properly handle XML comments when comparing v2 patchset diffs
- crmd: don't abort transitions for CIB comment changes
- libcrmcommon: log XML comments correctly
- libcrmcommon: remove extraneous format specifier from log message
- crm_mon: Avoid logging errors for any CIB changes that we don't care about (bsc#986931)
- crmd: When node load was reduced, crmd carries out a feasible action.
- Upstream version cs: 58fef06198fef17873d0d2e2d0cc5c7db73c5724

-------------------------------------------------------------------
Fri Jul  1 23:10:54 UTC 2016 - ygao@suse.com

- ping: Log sensible error when /tmp is full (bsc#987348)
- crm_mon: Do not log errors for the known CIB changes that should be ignored (bsc#986931)
- logging: Enable synchronous logging when blackboxes are enabled
- libpengine: print target role and blocked status in XML output
- tools: add maintenance mode and disabled/blocked resources to crm_mon XML/HTML output
- tools: break up long lines in crm_mon console output
- libservices: include socket units when listing all systemd agents
- fencing: fence_legacy - Search capable devices by querying them through "list" action for cluster-glue stonith agents (bsc#986265)
- extra: correct quoting of timestamp-format in alert-snmp-example
- pengine,tools: Display pending resource state by default when it's available (bsc#986201)
- rng: Allow rsc-pattern in locations for version 2.6
- pengine: Expand regexp references in location constraints
- pengine: Allow to set base score for progressive node health strategy
- systemd: Allow unit names ending in .socket.
- watchdog: Correction to do to change action of the system reboot by fail_fast
- Upstream version cs: 630d0d112092042b6f79c2a02bb442e82fee93ec

-------------------------------------------------------------------
Thu Jun 30 13:16:25 UTC 2016 - tchvatal@suse.com

- Remove conditionals that are not really needed as they always kept
  the values
- Remove the cman conditional as we do not even have the dependencies
  to build with it in OBS
- Convert deps to pkgconfig style ones and remove deps that are
  not mentioned by the testsuite or the configure.ac

-------------------------------------------------------------------
Wed Jun 22 12:25:47 UTC 2016 - ygao@suse.com

- Update to version 1.1.15
- crmd: mention that graceful remote shutdowns may cause connection failures (bsc#981489)
- alerts - drop 5min timeout to 30s since it is configurable now
- Bug bz#5292 - crmd: wait for alerts to finish
- libais,libcluster,libcrmcommon,liblrmd: don't use %z specifier
- alerts: ensure sample alert agents handle undefined recipient
- tools: crm_resource -T option should not be hidden anymore
- PE: Correctly update the dependant actions of un-runnable clones
- alerts: make timestamp-format-string work properly if strftime-escape is the last character
- extra: make alert-file-example cope with spaces in timeformat-string
- attrd,ipc: Prevent possible segfault on exit (bsc#986056)
- alerts: fix SMTP recipient defaulting
- tools: properly handle crm_resource --restart with a resource in a group
- tools: don't assume all resources restart on same node with crm_resource --restart
- tools: avoid memory leaks in crm_resource --restart
- tools: remember any existing target-role when doing crm_resource --restart
- tools: correctly count starting resources when doing crm_resource --restart
- Upstream version cs: e174ec84857e087210b9dacee3318f8203176129 (Pacemaker-1.1.15)

-------------------------------------------------------------------
Tue Jun 14 11:35:04 UTC 2016 - tchvatal@suse.com

- Clean-up with spec-cleaner
- Drop heartbeat conditions, no heartbeat around
- Sort CMAN conditionals to be actually logical
- Run fdupes to not waste so much space
- Add logrotate to reqs of pacemaker-cli
- Cleanup rpmlintrc to contain only bare needed minimum
- Run basic sanity check in %check phase

-------------------------------------------------------------------
Tue Jun 14 11:09:45 UTC 2016 - tchvatal@suse.com

- Drop sysvinit support we now run on sle12+ only
- Cleanup the define conditionals that are never used
- Drop profiling and coverage options it is not enabled by default
  and better to run separately

-------------------------------------------------------------------
Mon Jun 13 10:31:52 UTC 2016 - ygao@suse.com

- libcrmcommon: really ensure crm_time_t structure is fully initialized by API calls
- extra: correct syntax error in sample alert script
- crmd: avoid timeout on older peers when cancelling a resource operation
- crmd: use proper resource agent name when caching metadata
- crmd: avoid memory leak when sending fencing alert
- liblrmd: avoid memory leak when closing or deleting lrmd connections
- extra: improve determination of successful monitors in SNMP alert script
- tools: avoid memory leak when crm_mon unpacks constraints
- pengine: avoid use-after-free with location constraint + sets + templates
- pengine: better error handling when unpacking sets in location constraints
- pengine: avoid memory leak when invalid constraint involves set
- Build: rename sample alert scripts and install them in datadir
- pengine : Correction of the record judgment of the failed information.
- Upstream version cs: dd46368eead0d756735216a4bc765466b99274fc

-------------------------------------------------------------------
Tue Jun  7 08:40:25 UTC 2016 - ygao@suse.com

- alert-helpers: some fixes in pcmk_smtp_helper.sh
- libpengine: log message when stonith disabled, not enabled
- pengine: only set unfencing constraints once
- tools: don't require node to be known to crm_resource when deleting attribute
- libcrmcommon: ensure crm_time_t structure is fully initialized by API calls
- attrd: don't leak memory when returning due to malformed update request
- crmd: always free result of crm_itoa()
- xml: adapt crm_mon.rng per recent reorder of the summary elements
- Upstream version cs: 1a05449500f015414b6df68b6d4feb64b713f533

-------------------------------------------------------------------
Fri Jun  3 12:07:19 UTC 2016 - ygao@suse.com

- Rebase:
  * bug-977201_pacemaker-controld-self-fencing.patch

- pengine: properly order stop actions relative to stonith
- crm_resource: don't pretend that target-role:started would prevent promotion
- crm_mon: consistently print ms resource state
- controld: use "stonith_admin -H '*' -V" (bsc#977201)
- stonith_admin: allow -H '*' to show history for all nodes (bsc#977201)
- controld: fix "[: -eq: unary operator expected" issue from PR 1022 (bsc#977201)
- extra: Support of the task designation of a resource and the fencing.
- extra: Change pcmk_snmp_helper.sh (2).
- Upstream version cs: 6a8c1e9d35c65cbfd4019cfe797cb7bb9dfd4322

-------------------------------------------------------------------
Sun May 29 20:06:12 UTC 2016 - ygao@suse.com

- controld: Prevent unwanted self-fencing if "stateful_merge_wait" state of dlm is not available (bsc#977201)
  * bug-977201_pacemaker-controld-self-fencing.patch

-------------------------------------------------------------------
Sun May 29 14:44:18 UTC 2016 - ygao@suse.com

- libservices: clean up non-signalfd code paths
- spec: fence_pcmk only eligible for Pacemaker+CMAN
- crmd: Acknowledge cancellation operations for remote connection resources (bsc#976865)
- controld: improve DLM check with stateful_merge_wait (bsc#977201)
- attrd, libcrmcommon: validate attrd requests better
- crmd: clear remote node transient attributes on disconnect (bsc#981489)
- Revert "Fix: attrd: Correctly implement mass removal of a node's attributes" (bsc#981489)
- crm_mon: Fix time formatting on x32
- resources: use OCF version tagging correctly
- libcommon: crm_procfs_pid_of() would always return last /proc entry checked
- crmd: correctly dig into cib-query-answer if alerts section is present timestamp-format defaults to "%H:%M:%S.%06N"
- crmd: Take start-delay into account for the timeout of the action timer (bsc#977258)
- libservices: make systemd override file world-readable to avoid log warning
- libcrmcommon: correct directory name in log message
- Log: make crmd messages more user-friendly
- Log: make messages in common quorum/fencing situations more user-friendly
- Log: make shutdown messages more user-friendly
- pengine: lf#2560/lf#2588 - Correctly set the environment variable "OCF_RESKEY_CRM_meta_timeout" when "start-delay" is configured (bsc#977258)
- Log: make operation messages more user-friendly
- Log: make startup messages more user-friendly
- services: Correctly clean up service actions for non-dbus case
- uninitialized use of nano_digits
- attrd: Update also dampens when synchronizing attributes (bsc#977846)
- Upstream version cs: 389294fd1ebefddad67fff51306f585b758ca860

-------------------------------------------------------------------
Wed May  4 10:38:16 UTC 2016 - ygao@suse.com

- Rebase:
  * pacemaker-Wno-format-signedness.patch

- RA: SysInfo - Reset the node attribute "#health_disk" to "green" when there's sufficient free disk (bsc#975079)
- pengine: Organize order of actions for slave resources in anti-colocations (bsc#977800)
- attrd: Fix the synchronization of attributes (bsc#977846)
- pengine: Organize order of actions for master resources in anti-colocations (bsc#977800)
- pengine: Respect asymmetrical ordering when trying to move resources (bsc#977675)
- fencing: Record the last known names of nodes to make sure fencing requested with nodeid works (bsc#974108)
- crmd: first implementation of integrated multi-agent, multi-target alerting mechanism (fate#320855)
- ping resource: Use fping6 for IPv6 hosts (bsc#976271)
- pengine: Consider resource failed if any of the configured monitor operations failed (bsc#972187)
- ping resource: avoid undefined func w/ OCF_FUNCTIONS=/dev/null
- spec: make Publican docs not depend on pre-existing packages
- cib/fencing: Set status callback before connecting to cluster (bsc#974108)
- xml: use spaces instead of tabs in schema files
- extra: Support of the dampen change by RA.
- Upstream version cs: 9e382568ac3cd54c222496501088ab3fc158b2e2

-------------------------------------------------------------------
Thu Mar 24 17:26:44 UTC 2016 - ygao@suse.com

- crmd: update cluster state in CIB after fencing an unseen node
- crmd: don't abort transition for expected remote node shutdown
- libtransition: potential memory leak if unpacking action fails
- Upstream version cs: 5a6cdd11b4f93b4d55e1b2654078018c339931d4

-------------------------------------------------------------------
Thu Mar 17 10:04:23 UTC 2016 - ygao@suse.com

- attrd: crash on exit if initialization fails
- build: fix scalability regression
- pengine: Suppress assert if a stateful clone is not being demoted/stopped (bsc#971129)
- attrd: Support of the dampen change by attrd.
- PE: Correctly handle the ordering of demote actions for failed and moving containers
- Upstream version cs: d076e9dbf9827f7801c89c6d635df370aeca5e90

-------------------------------------------------------------------
Mon Mar  7 15:07:27 UTC 2016 - ygao@suse.com

- crmd,tools: Set attributes for remote nodes directly into cib if it's legacy attrd (bsc#967775)
- libcib: Correctly determine the node type (bsc#967775)
- resources: match agents' default for globally_unique to pacemaker's
- crm_mon: Help admins identify why resources are not being started or responding to commands
- PE: Memory leak
- crm_resource: Prevent segfault when --resource is not correctly supplied for --restart command
- Build: Create CRM_CORE_DIR during installation
- Upstream version cs: eb89393a82eb41ff50d041b91765ccac52e873e0

-------------------------------------------------------------------
Mon Feb 29 11:53:36 UTC 2016 - ygao@suse.com

- cpg: Ensure group name is never unset
- remote: Simplify calls to accept() and inet_ntop() by using "struct sockaddr_storage" (bsc#964183)
- remote: cl#5269 - Notify other clients of a new connection only if the handshake has completed (bsc#967388, bsc#1002767, CVE-2016-7797)
- remote: Correctly display the IP address of the remote client (bsc#964183)
- spec: declare also BSD license as suitable
- libservices: Add error handling for pipe() failed.
- libservices: Check resource agent is executable or not before pipe open.
- crmd: Prevent use-after-free when an unexpected remote client takes over (bsc#964183)
- pacemakerd: Correction of the stonithd process judgment of pacemakerd.
- crmd: Do not turn on stonith-watchdog-timeout automatically if SBD is detected
- remote: Correctly check for SBD configuration consistency
- resources: Fix state file metadata in Dummy, Stateful and HealthCPU resource agents
- systemd: Modified so that the cluster to stop before the rsyslog
- common: Correctly locate sbd via its pidfile
- common: Assume processes are active if we get EACCESS
- Fencing: Simplify watchdog integration
- crmd: Only poopulate stonith-watchdog-timeout if SBD is active
- remote: Ensure SBD is consistently configured on remote nodes
- remote: Allow cluster and remote LRM API versions to diverge (bsc#1009076)
- cib: Do not send notifications when the dryrun flag is present
- Upstream version cs: cf67796823c4429714857411e614cfacfbc59d89

-------------------------------------------------------------------
Mon Feb 15 09:31:25 UTC 2016 - ygao@suse.com

- crm_shadow: fix broken --display command
- ipc: Respect the parameter of pick_ipc_buffer() but don't let it affect the global value
- libcluster: crm_peer_uname() should return NULL if uuid is invalid
- remote: recover from remote node fencing more quickly
- crmd: update node state for migrated pacemaker_remote nodes
- crmd: update node state for stopped pacemaker_remote nodes
- crmd: update node state for started pacemaker_remote nodes
- crmd: add new message type for updating pacemaker_remote node state
- libcluster: set remote peer cache state based on CIB node state
- libcluster: send notifications when pacemaker_remote nodes are started
- crmd: report pacemaker_remote node state in CIB status section
- Upstream version cs: c851a117bc77bdefe15181a7d753f1aed867cde6

-------------------------------------------------------------------
Thu Feb 11 13:28:13 UTC 2016 - ygao@suse.com

- spec: Move the common directories under /var/lib/pacemaker into pacemaker-cli package
- liblrmd: Prevent potential use-after-free (bsc#964183)
- crmd: Disconnect the relevant remote proxies as well when disconnecting a remote node (bsc#964183)
- crmd: Prevent potential use-after-free (bsc#964183)
- liblrmd: Prevent potential use-after-free issues (bsc#964183)
- PE: Fix conditions for internal sanity check (bsc#971129)
- attrd: ensure remote nodes are in correct peer cache (bsc#981489)
- crmd: set remote flag when gracefully shutting down remote nodes (bsc#981489)
- fencing: Correctly track active stonith actions (bsc#938545)
- fencing: Functionize adding and removing active pids of device (bsc#938545)
- crm_shadow: Do not invoke shells with --noprofile option other than bash (bsc#961392)
- lib/common: check return value of dlsym() and not dlerror()
- lib/ipc: allow PCMK_ipc_buffer to be smaller than default max sizes
- lib/services: use self-pipe sigchld handling when signalfd isn't available
- spec: associate subpackage with correct licenses
- spec: rely on system-wide RPM macros if available
- spec: C++ compiler is not something currently needed
- RHBZ#1286316: Do an ordered shutdown of systemd resources
- header == NULL when parsing compressed message
- attrd: Correctly implement mass removal of a node's attributes (bsc#981489)
- attrd: Hook up the client name so we can track requests
- crmd: Set the shutdown transient attribute in response to LRMD_IPC_OP_SHUTDOWN_REQ from remote nodes (bsc#981489)
- PE: Honor the shutdown transient attributes for remote nodes (bsc#981489)
- pacemaker_remote: support graceful stops (bsc#981489)
- crmd: support graceful pacemaker_remote stops (bsc#981489)
- lrmd,liblrmd: add lrmd IPC operations for requesting and acknowledging shutdown (bsc#981489)
- fencing: Support concurrent fencing actions on each device (bsc#938545)
- pengine: Support concurrent fencing (bsc#938545)
- Upstream version cs: c54f10440a7bba5a1491ea8506925c7d6d9ca2a3

-------------------------------------------------------------------
Thu Jan 21 15:11:39 UTC 2016 - ygao@suse.com

- Update to version 1.1.14
- fencing: free only after last usage   makes coverity happy
- crmd: 0 is a valid fd   makes coverity happy
- tools: crm_resource compile issue
- crm_resource --list-agents: don't print uninitialized memory
- extra: update SNMP MIB with new pacemakerTrap OID containing pacemakerNotificationTrap
- fencing, libfencing: remap fence agent error codes before async callback (bsc#962309)
- libfencing: topology is not used
- fencing: topology is not used
- libcrmcommon: when caching attrd connection, cache connection flags as well
- cts: Plugin-based cluster has its own PacemakerUp pattern
- Upstream version cs: 70404b0e5ecbe5e51d07c6c2233eea640cbd720a (Pacemaker-1.1.14)

-------------------------------------------------------------------
Fri Dec 18 17:48:52 UTC 2015 - ygao@suse.com

- Rebase:
  * bug-806256_pacemaker-log-level-notice.patch
  * bug-728579_pacemaker-stonith-dev-id.patch

- core: Mistake of the parameter order.
- RHBZ#1287315: stonithd: Trigger cib_devices_update in case of deletion of just an attribute
- CLBZ#5253: stonithd: Do not intermingle stdout & stderr coming from stonith-RAs (bsc#962309)
- resources: allow for top output with or without percent sign in HealthCPU
- controld: Return error when DLM status is wait fencing (RHBZ#1268313)
- crmd: Don't update cluster/peer CIB fields when processing stonith results
- Upstream version cs: e16447de89d25db3b3578c7e080c1a4c2f85806f

-------------------------------------------------------------------
Wed Dec  2 11:55:11 UTC 2015 - ygao@suse.com

- ping: Clarify the description of host_list parameter in ping metadata (bsc#956459)
- systemd: Prevent segfaul when logging failed operations
- systemd: The underlying systemd calls default to 90s for their timeouts
- cib: Do not terminate due to badly behaving clients
- Correctly check for recycled PIDs in crm_pid_active
- crmd: Consider only fence and shutdown transition events to be "down" events
- pengine: Support of multiple-active=block for resource groups (bsc#942491)
- crmd: use 300s timeout with notification scripts, not 300ms
- stonith_admin: add ability to target topology by pattern or attribute
- fencing,libfencing: add API support for targeting topology by pattern or attribute
- Upstream version cs: a7d6e6b56fd2779a07970df7de4e0fb0b22742d3

-------------------------------------------------------------------
Mon Nov 16 17:49:49 UTC 2015 - ygao@suse.com

- crm_report: Call "crm report" if available (bsc#950483)

-------------------------------------------------------------------
Thu Nov 12 11:18:49 UTC 2015 - ygao@suse.com

- fencing: crm_resource --show-metadata drops documentation strings for fencing agents (bsc#950375)
- Upstream version cs: 6f22ad7312b703289da5d24e918a78117a0825e1

-------------------------------------------------------------------
Thu Nov  5 22:51:27 UTC 2015 - ygao@suse.com

- CTS: add "try except" to deal with errors that raw_input gets EOFError and add "--yes" to skip interaction (bsc#953192)
- Upstream version cs: 577898dc4ac1efdb5989a996cb5f9ac60ed2eb7a

-------------------------------------------------------------------
Wed Nov  4 11:42:56 UTC 2015 - ygao@suse.com

- crm_resource: Correctly clean up all children for anonymous cloned groups (bsc#950128)
- services: Directly add operations into in-flight list in the execution functions (bsc#952874)
- systemd: Return PCMK_OCF_UNKNOWN_ERROR instead of PCMK_OCF_NOT_INSTALLED for uncertain errors on LoadUnit (bsc#952884)
- systemd: Return FALSE for systemd_mask_error() if it only maps an error instead of masking one (bsc#952884)
- dbus: Correctly return the result for pcmk_dbus_find_error() no matter if there's a DBusError passed in (bsc#952884)
- services: Prevent potential use-after-free when trying to add an operation into in-flight list (bsc#952874)
- systemd: Directly return an error if the connection to System DBus is closed (bsc#952874)
- services: Correctly determine if operations are in-flight (bsc#952874)
- systemd: Reconnect to System DBus if the connection is closed (bsc#931271)
- lrmd: Finalize all pending and recurring operations when cleaning up a resource (bsc#950450)
- fencing: don't poke peers when remote node status changes
- attrd: don't try to communicate with attrd on a remote node
- libcluster,crmd: never update join info or processes for remote nodes
- cib: Increased paranoia when peer updates fail to apply in compatability mode
- crmd: do not accept remote peer data as enough for startup
- crmd: remote nodes can't be DC so never add them to stonith cleanup list
- libcluster: never autoreap from remote peer cache
- crmd: improve generation of node state
- CTS: get Reattach test working again and up-to-date (bsc#953192)
- libcommon: Ignore CDATA of metadata of the resource.
- cib: Downgrade the log message on forwarding CRM_OP_NOOP requests from INFO to DEBUG (bsc#949267)

- fencing: Return a provider for the internal fencing agent "#watchdog" instead of logging an error (bsc#949441)
  * Drop bug-949441_pacemaker-fencing-provider-internal.patch which has been merged upstream

- Upstream version cs: 7bd00f3f3010bc10d13b87e2ff501b597ea6ca03

-------------------------------------------------------------------
Thu Oct  8 10:31:45 UTC 2015 - ygao@suse.com

- fencing: Return a provider for the internal fencing agent "#watchdog" instead of logging an error (bsc#949441)
  * bug-949441_pacemaker-fencing-provider-internal.patch

- spec: Move the normal resource agents into pacemaker-cli package (bsc#947197)
- spec: Move logrotate configuration file into pacemaker-cli package (bsc#947197)
- spec: Move attrd_updater, crm_attribute and crm_master into pacemaker-cli package (bsc#947197)
- spec: Move xml schema files and PCMK-MIB.txt into pacemaker-cli package (bsc#947197)

-------------------------------------------------------------------
Thu Oct  8 10:29:54 UTC 2015 - ygao@suse.com

- crm_resource: Correctly observe --force when deleting and updating attributes (bsc#948197)
- crm_resource: Correctly delete existing meta attributes regardless of their position in the heirarchy (bsc#948197)
- fencing,libfencing: use level tag consistently in internal XML
- crm_resource: Correctly update existing meta attributes regardless of their position in the heirarchy (bsc#948197)
- crmd: properly detect CIB update failures for remote nodes
- cibadmin: Prevent potential use-of-NULL in print_xml_output() (bsc#947180)
- Fencing: The device list is expected to be comma separated
- Tools: Do not send command lines to syslog (bsc#986676)
- Tools: Repair the logging of 'interesting' command-lines
- PE: resolve memory leak
- libfencing: make topology level removal compatible with latest stonithd API
- fencing: parse from correct XML location when registering/unregistering topology
- tools: improve error handling when modifying configuration
- crmd,libcrmcommon,libservices,tools: potential memory leaks (bsc#948197)
- crmd,fencing: avoid potential null dereference in string searches
- typo: OPSTIONS -> OPTIONS in crm_mon.sysconfig
- cib: Check if the configuration changes with cib_config_changed() only for v1 diffs (bsc#946224)
- liblrmd: don't print error if remote key environment variable unset
- libcib: properly handle temporary file
- libcrmcommon: better validation of environment variable value
- crmd: avoid potential null dereference
- libcib: potential user input overflow
- controld: replace bashism
- PE: drop probe_complete actions
- PE: Allow resources to start and stop as soon as their state is known on all nodes
- Fencing: Correctly construct simple topologies with stonith_admin
- Fencing: Correctly remove topologies and detect invalid entries

- remote: Revise a misleading message in the ocf:pacemaker:remote resource agent (bsc#946332, bsc#967383)
  * Drop bug-946332_pacemaker-resource-agent-remote-message.patch which has been merged upstream

- remote: Correctly display the usage of the ocf:pacemaker:remote resource agent (bsc#946332, bsc#967383)
  * Drop bug-946332_pacemaker-resource-agent-remote-usage.patch which has been merged upstream

- libcib: find_nvpair_attr_delegate: check buffer overflow
- libcib: find_nvpair_attr_delegate: check alloc failure
- Upstream version cs: 7906df92a713052db1edae851579ea229d8a5393

-------------------------------------------------------------------
Fri Sep 18 08:22:19 UTC 2015 - ygao@suse.com

- remote: Revise a misleading message in the ocf:pacemaker:remote resource agent (bsc#946332, bsc#967383)
  * bug-946332_pacemaker-resource-agent-remote-message.patch

- remote: Correctly display the usage of the ocf:pacemaker:remote resource agent (bsc#946332, bsc#967383)
  * bug-946332_pacemaker-resource-agent-remote-usage.patch

-------------------------------------------------------------------
Thu Sep 17 09:26:52 UTC 2015 - ygao@suse.com

- crm_resource: Allow the resource configuration to be modified for --force-{check,start,..} calls
- Fencing: Correctly parse 'by-attribute' fencing levels
- Fencing: Use dedicated fields for fencing level patterns and attribute matching
- pacemaker_remote: memory leak in ipc_proxy_dispatch()
- crmd: don't add node ID to proxied remote node requests for attrd
- membership: Safely autoreap nodes without code duplication
- PE: Resolve memory leak
- pacemakerd: Do not forget about nodes that leave the cluster
- corosync: Display node state and quorum data if available
- crmd: Implement reliable event notifications
- extra: Added snmp trap of type "NOTIFICATION-TYPE" to MIB and snmp helper script
- Date: Correctly set time from seconds-since-epoch
- PE: Bug cl#5247 - Imply resources running on a container are stopped when the container is stopped
- Upstream version cs: 20c2178f076ff32fdf9ba9a467c193b8dac2f9e5

-------------------------------------------------------------------
Wed Sep  9 13:24:17 UTC 2015 - ygao@suse.com

- lrmd: Upgrade start/finish log tags from INFO to NOTICE (bsc#943295)
  * bug-943295_pacemaker-lrmd-log-notice.patch

-------------------------------------------------------------------
Fri Aug 28 11:49:26 UTC 2015 - ygao@suse.com

- services: Reduce severity of noisy log messages (bsc#943319)
- xml: Mark xml nodes as dirty if any children move (bsc#942382)
- pengine: The failed action of the resource that occurred in shutdown is not displayed.
- tools: memory leak in crm_resource
- crm_resource: Correctly check if a resource is unmanaged or has a target-role
- fencing: add ability to target by attribute
- crmd: Resolve memory leak in remote_proxy_cb()
- ipc: Do not constantly increase suggested size for PCMK_ipc_buffer every time we find it's insufficient (bsc#940992)
- Upstream version cs: e8888b98cd7dbdfb986c1a46bdb4b113b96e914f

-------------------------------------------------------------------
Thu Aug 13 12:56:09 UTC 2015 - ygao@suse.com

- crm_resource: Indicate common reasons why a resource may not start after a cleanup
- pengine: Ensure fencing of the DC precedes the STONITH_DONE operation
- crm_resource: Compensate for -C and -p being called with the child resource for clones
- ipc: Fix output formats (bsc#940992)
- fencing: ensure "required"/"automatic" only apply to "on" actions
- fencing: Remove unnecessary casts (bsc#940711)
- crm_simulate: Prevent segfault on arches with 64bit time_t (bsc#940711)
- ipc: Correctly compare values for the size of ipc buffer and prevent suggesting a negative value when it's insufficient (bsc#940992)
- xml: Reduce severity of noisy log message (bsc#950551)
- crm_resource: Correctly clean up failcounts for inactive anonymous clones
- crmd: Avoid cancelling transitions when we tell nodes to shutdown
- systemd: drop legacy SysVStartPriority from service units
- crm: Set the attribute from remote node.
- Upstream version cs: 4ad07f5f464c84b80c739922bd9fd708e8d36e5a

-------------------------------------------------------------------
Thu Jul 30 09:46:31 UTC 2015 - ygao@suse.com

- dbus: Remove redundant ref/unref of pending call records
- stonithd: potential device list corruption
- cib: don't destroy peer cache in peer status callback
- systemd: Ensure pending structs are correctly unreferenced
- systemd: Track pending operations so they can be safely cancelled
- crmd: memory leak in CIB callbacks
- attrd: memory leak in legacy attrd's CIB callback
- attrd: memory leak in CIB callback
- libcib: allow free function for user data supplied to CIB callbacks
- xml: Prevent use-of-NULL in crm_xml_dump()
- crm_mon: Memory leaks
- Upstream version cs: 3fb7f71bf9ca2a3d6e1187fa3b74c7841d6af5a7

-------------------------------------------------------------------
Wed Jul 22 10:22:39 UTC 2015 - ygao@suse.com

- pengine: properly handle blocked clone actions
- pengine: Correctly bypass fencing for resources that do not require it
- libservices: potential memory leaks when executing systemd actions
- libservices: memory leak in DBus-related log messages
- crmd: memory leaks in recurring operation history
- pengine: Addtion of the clone resource clone-min metadata option
- Upstream version cs: 3d781d3fe61504c841e3c89b2e8ccff8195d4af6

-------------------------------------------------------------------
Mon Jul 20 08:46:38 UTC 2015 - ygao@suse.com

- Rebase bug-806256_pacemaker-log-level-notice.patch

- Build: Update version numbers to 1.1.13 in version.m4 and sample spec file
- fencing: Broadcast uname as soon as a peer's state has changed (bsc#938410)
- fencing: remap sequential topology reboots to all-off-then-all-on
- fencing: remap sequential topology reboots to off
- fencing: support remapping reboots when processing fencing query results
- fencing: treat remapped reboots as reboots when appropriate
- fencing: support remapping reboots in fencing query results
- crmd: check for errors when searching for CIB daemon's load file
- libcib,libfencing,tools: memory leaks from xmlGetNodePath()
- attrd: use-after-free in attrd_client_update()
- fencing: memory leak when searching for a target's fencing topology
- lrmd: memory leak when freeing command structure
- libcluster: work around peer cache destruction in client status callbacks
- fencing: add support for operation phases to device properties
- fencing: add support for operation phases
- crmd: Do not enforce restart for resources that support reload and don't support any unique parameters
- crmd: Do not enforce restart for changes of non-unique parameters
- cts: change the stack from openais (white-tank) to corosync (plugin v0) in set_stack of environment.py (bsc#936149)
- Upstream version cs: bd8c4b5a30c9cacd0257fe50ab50d3a6436db42a

-------------------------------------------------------------------
Fri Jul 10 14:03:00 UTC 2015 - ygao@suse.com

- crmd: Make resource_supports_action() really general
- crmd: Remove a duplicate invocation of snprintf()
- pengine: clear failures after reconnect_interval expires
- RA: Prevent an error message on stopping "Dummy" resource
- PE: Ignore comment blocks when unpacking the cib
- fencing: use "off" timeout when remapping "reboot" to "off"
- fencing: do not set call options twice in query
- crmd: don't synthesize op failures during shutdown
- lrmd: prevent double free after unregistering stonith device for monitoring (bsc#1035822)
- libcommon: crm_ipc_get_fd() must set errno on error
- PE: Record the execution date in PE files so we can re-use it in crm_simulate
- pengine: allow guest remote nodes using containers/vms to be nested in a group resource
- pengine: Resolve memory leak in expand_notification_data()
- cib: Prevent use-after-free and return -EINVAL when attempting to delete the whole "/cib" (bsc#934609)
- cib: Prevent use-after-free when invoking "cibadmin --delete-all --xpath" (bsc#934609)
- crmd: Prevent segfault when erasing resources from disconnected remote nodes
- pengine: do not timeout remote node recurring monitor op failure until after fencing
- crmd: No need to re-process actions we've already marked as failed
- crmd: All pseduo ops must be allowed to complete
- crm_simulate: Optionally include action IDs in the dot graph
- fencing: properly decide whether a topology fencing device has been found
- fencing: properly sort peers by number of fencing devices found
- crmd: Record actions in the CIB as failed if we cannot execute them
- pengine: do not stop notify a fenced node that the rscs on the fenced node stopped
- pengine: fixes segfault in pengine when fencing remote node
- remote: do not fail operations because of a migration
- remote: handle merging duplicate recurring monitors for connection rsc
- pengine: cl#5235 - Prevent graph loops that can be introduced by "load_stopped -> migrate_to" ordering
- PE: Exclude nodes which don't match any exclusive discovery rules
- Log: improve IPC connection error messages
- Log: make syslog less noisy
- lrmd: cancel currently pending STONITH op if stonithd connection is lost
- fencing: Correct the all_topology_devices_found() implementation
- crmd: Pre-emptively fail in-flight actions when lrmd connections fail
- PE: Include a list of all and available nodes with notifications
- lrmd: set recv timeout upper bound for tls connections
- services: prevent recurring monitors from colliding with other operations
- crmd: handle resources named the same as cluster nodes
- crmd: make actions incompletable after remote-node fails
- crm_simulate: Correctly invoke the policy engine library
- libcluster: overhaul peer cache management
- crmd: Prevent use-of-NULL
- crm_report: Enable password sanitizing by default
- PE: Keep the size of the secure list small in the cib
- PE: Reduce noise when sanitized policy engine files are replayed
- attrd: handle removals of cluster peers and remote peers consistently
- libcluster: avoid possibility of invalidating a hash table iterator
- membership: Ensure peer cache management supports all stacks
- libcluster: do not re-add peer entries for exiting nodes
- PE: Skip unrunnable actions when one-or-more is in effect
- PE: Ensure recurring monitor operations are cancelled when clone instances are de-allocated
- systemd: No need to trigger assert if cannot obtain an unit (bsc#931271)
- dbus: Use operation timeout for dbus reply timeout (bsc#931271)
- fencing: correct choice of fencing topology level
- crm_shadow: Fix "crm_shadow --diff" (bsc#931166)
- cib: Calculate and add digest for a patchset after accepting changes for the target xml (bsc#931114)
- remote: enable reloads for select remote connection options
- crmd: fence remote node after connection failure only once
- remote: reconnect_delay option for remote nodes to delay reconnect after fence
- tools: ignore stderr from crm_mon when running via systemd
- xml: update RelaxNG schema for crm_mon XML output
- Fencing: Correctly handle changes to the fencing topology
- fencing: Allow complex configurations to apply to multiple hosts
- tools: Update regression tests for ACL fixes
- tools: improve failed actions display in crm_mon
- tools: implement printing tickets in crm_mon HTML/XML output
- tools: implement printing negative location constraints in crm_mon HTML/XML output
- tools: implement printing operations and failcounts in crm_mon HTML/XML output
- tools: implement printing node attributes in crm_mon HTML/XML output
- tools: improve cluster summary display in crm_mon
- tools: improve guest node output in crm_mon
- tools: prettify plaintext output
- tools: prettify crm_mon HTML output
- tools: prettify crm_mon --simple-status output
- crm_report: Allow log file discovery to be disabled
- crm_resource: Support debugging promote and demote operations
- fencing: Allow semi-colon delimiter for pcmk_host_list
- Upstream version cs: ef86b494a411ce920eb18b9b6541a3a0425a41e0

-------------------------------------------------------------------
Fri Jul 10 11:06:45 UTC 2015 - ygao@suse.com

- Update to version 1.1.13
- Build: Update library versions
- Build: Move new struct members to the end for backwards compatibility
- Fencing: Gracefully handle invalid metadata from agents
- Upstream version cs: 6052cd16c2f455809f8088af76ce86483bf98353 (Pacemaker-1.1.13)

-------------------------------------------------------------------
Wed Jun  3 14:40:55 UTC 2015 - ygao@suse.com

- pengine: cl#5130 - Only check the capacities of the nodes that are allowed to run the resource (FATE#313105)
- cib: Correctly add "update-origin", "update-client" and "update-user" attributes for cib (bsc#931177)
- fencing : Correction of the log output of the practice node of stonith.
- Upstream version cs: a0449d443fa5c834207def5fe36a117a53c334d6

-------------------------------------------------------------------
Mon May 18 08:23:52 UTC 2015 - ygao@suse.com

- xml: Correctly create v1 patchsets when deleting attributes (bsc#931170)
- xml: Prevent potential use-of-NULL (bsc#929960)
- Upstream version cs: 677f53216662d121a47b4c7683ec3749c614437e

-------------------------------------------------------------------
Fri May 15 13:07:29 UTC 2015 - ygao@suse.com

- cib: No need to enforce cib digests for v2 diffs in legacy mode (bsc#929960)
- cib: Ability to upgrade cib validation schema in legacy mode (bsc#929960)
- xml: Do not dump deleted attributes (bsc#929960)
- cib: Revert d153b86 to instantly get cib synchronized in legacy mode (bsc#929960)
- cib: Enable cib legacy mode for plugin-based clusters (bsc#929960)
- Build: CRM_STATE_DIR is created dynamically when needed
- Tools: Repair expected output for ACLs
- Build: Prevent rpm packaging conflicts
- pengine: cl#5130 - Choose nodes capable of running all the colocated utilization resources (FATE#313105)
  * Drop obsolete pacemaker-colocated-utilization.patch

- Upstream version cs: 0b79da3e73fe2ced8b9602aa59d55873d857b3e7

-------------------------------------------------------------------
Mon May 11 10:51:23 UTC 2015 - ygao@suse.com

- crmd/pengine: implement on-fail=ignore without allow-fail (bsc#981731)
- pengine: Prevent use-after-free in sort_rsc_process_order() (bsc#930368)
- crmd: Prevent the old version of DC from being fenced when it shuts down for rolling-upgrade (bsc#929955)
- xml: Fix upgrade-1.3.xsl to correctly transform ACL rules with "attribute" (bsc#929681)
- crmd/pengine: handle on-fail=ignore properly (bsc#981731)
- crmd: respect start-failure-is-fatal even for artifically injected events (bsc#981731)
- crmd: don't update fail count twice for same failure (bsc#950450, bsc#981731)
- crmd: report operation rc as advertised instead of status (bsc#981731)
- xml: add RelaxNG schema for crm_mon XML output
- Upstream version cs: c9ad9cd503f071391efe17d3c45d578d6f152acd

-------------------------------------------------------------------
Wed May  6 09:57:05 UTC 2015 - ygao@suse.com

- pengine: process rsc parameters during unpack (bsc#929842)
- pengine: handle setting container attribute in the correct location (bsc#929842)
- lrmd: move isolation wrappers to hidden directory (bsc#929842)
- mainloop: resolves race condition mainloop poll involving modification of ipc connections (bsc#929835)
- Upstream version cs: f47ea56b4ec23c7d8e0c129535a9b49cdbd80482

-------------------------------------------------------------------
Thu Apr 30 11:31:46 UTC 2015 - ygao@suse.com

- fencing: Correctly make args for fencing agents (bsc#925751)
- fence_legacy: Avoid passing 'port' to cluster-glue agents (bsc#925751)
- corosync: Bug cl#5232 - Somewhat gracefully handle nodes with invalid UUIDs
- HealthSMART: OCF_RESKEY_drives could contain multiple values
- pengine: restart master instances on instance attribute changes
- spec: move report.common and report.collector to cli package
- pengine: only kill process group on timeout when on-fail does not equal block.
- lrmd: Hint to child processes that using sd_notify is not required (bsc#956626)
- Agents: Fix the HealthSMART metadata
- make targetted reprobe for remote node work, crm_resource -C -N <remote node>
- crmd: include remote nodes when forcing cluster wide resource reprobe
- crm_mon: Support of the start from systemd of crm_mon
- Upstream version cs: 195559d47b0e9186b5d131981f6f7fee96ecad76

-------------------------------------------------------------------
Mon Apr 13 08:57:35 UTC 2015 - ygao@suse.com

- Rebase:
  * pacemaker-NodeUtilization-RA.patch

- docker-wrapper: per resource logging of lrmd and remote client tool
- pengine: Avoid trailing whitespaces when printing resource state
- pengine: cl#5207 - Display "UNCLEAN" for resources running on unclean offline nodes
- docker-wrapper: add reuse option for presistent containers
- docker-wrapper: only override exit reason if docker daemon is inactive
- pengine: handle isolated resource scenario, cloned group of isolated resources
- pengine: handle cloned isolated resources in a sane way
- crm_report: More patterns for finding logs on non-DC nodes
- lrmd: Use original timestamps when reporting multi-step systemd operations
- lrmd: report original timeout when systemd operation completes
- systemd: improve unit files
- PE: Turn off legacy unpacking of resource options into the meta hashtable
- acl: Do not delay evaluation of added nodes in some situations (bsc#927828: CVE-2015-1867)
- docker-wrapper: add demote, promote, and notify actions for multistate rsc
- docker-wrapper: properly forward key value pairs during isolation
- attrd: fixes double free in attrd legacy
- lrmd: do not let isolation wrappers inherit the wrapper attribute, or it makes a loop
- pengine: pass node name of pcmk host into isolated resources
- lrmd: isolation wrappers are moved from containers to isolation OCF namepace
- pengine: Fix colocation with unmanaged resources
- stonith-ng: Correctly track node state
- stonith-ng: No reply is needed for CRM_OP_RM_NODE_CACHE
- crm_resource: Fix output format of the warning from --force-start
- crm_resource: Display the locations of all anonymous clone children when supplying the children's common ID (bsc#870339)
- cib: Correctly track node state
- Upstream version cs: 7a2e3ae6b736621933b24f4cdc9ea260021d878d

-------------------------------------------------------------------
Fri Mar 27 15:09:25 UTC 2015 - ygao@suse.com

- Rebase:
  * bug-806256_pacemaker-log-level-notice.patch
  * pacemaker-NodeUtilization-RA.patch
  * pacemaker-colocated-utilization.patch

- crmd: All peers need to track node shutdown requests (bsc#917625)
- crmd: Cached copies of transient attributes cease to be valid once a node leaves the membership (bsc#917625)
- crmd: Wait for all pending operations to complete before poking the policy engine
- lrmd: preserve exit reason string when isolation wrappers are in use
- docker-wrapper: properly separate docker and resource specific attributes
- docker-wrapper: set authkey file permissions and properly set container 'node name' during start
- systemd: Trick systemd into not stopping our services before us during shutdown (bsc#913251)
- mcp: Allow a configurable delay when debugging shutdown issues
- systemd: Kindly ask dbus NOT to kill the process if the dbus connection fails (bsc#931271)
- systemd: Tell systemd not to take DBus down from underneath us (bsc#913251)
- cib: Correctly set up signal handlers
- PE: Do not record duplicate copies of the failed actions
- lrmd: enable ipc proxy for docker-wrapper privileged mode
- lrmd: properly handle poke requests in lrmd client when using ipc
- spec: add docker-wrapper directory to spec file
- pengine: disable migrations for resources with isolation containers
- pengine: disable reloading of resources within isolated container wrappers
- pengine: ability to launch resources in isolated containers
- extra: docker container tech wrapper script for pcmk remote
- tools: crm_mon prints Stopped clones only if --inactive was specified
- tools: display node names more consistently in crm_mon output
- tools: Improve crm_mon output with certain option combinations
- tools: make crm_mon last updated header consistent across formats
- remote: pcmk remote client tool for use with container wrapper script
- crmd: Reset stonith failcount to recover transitioner when the node rejoins (bsc#921102)
- systemd: fix crash caused when canceling in-flight operation
- Upstream version cs: 3e93bc1dd6c1c3f2ee101f754567aa007b24bb5e

-------------------------------------------------------------------
Fri Mar 13 09:38:52 UTC 2015 - ygao@suse.com

- PE: Support non-actionable degraded mode for OCF
- lrmd, services: interpret LSB status codes properly
- tools: add crm_resource --wait option
- tools: attrd_updater supports --query and --all options
- attrd: attrd supports queries
- pengine: remove unnecessary whitespace from notify environment variables
- tools: free allocated memory correctly in crm_resource
- attrd: properly write attributes for peers once uuid is discovered
- cib: assignment where comparison intended
- attrd: only send ack for recognized operations
- attrd: make each client operation handler its own function
- tools: attrd_updater supports private attributes
- attrd supports private attributes (not written to CIB)
- pengine: Reschedule specific monitors when resource definitions have changed (bsc#914761)
- pengine: Resolve memory leaks (bsc#914761)
- Upstream version cs: e32080b460f81486b85d08ec958582b3e72d858c

-------------------------------------------------------------------
Fri Feb 27 09:44:50 UTC 2015 - ygao@suse.com

- properly record stop args after reload
- pengine: Do not reschedule monitors that are no longer needed while resource definitions have changed (bsc#914761)
- Build: Fix building when heartbeat support is disabled
- fencing: cl#5134 - Support random fencing delay to avoid double fencing (FATE#317136, FATE#318381, bsc#970733)
- extra: Use crm_simulate for the showscores script
- attrd: refresh should force an immediate write-out of all attributes
- service: Leave synchronous calls to be free'd by the caller
- service: Additional pointer safety
- crmd: Add "on_node" attribute for *_last_failure_0 lrm resource operations (bsc#918839)
- crm_mon: Fill CRM_notify_node in traps with node's uname rather than node's id if possible (bsc#918839)
- pengine: ensure if B is colocated with A, B can never run without A
- cib: automatically update .sig files in file backends when clients update live CIB
- cib: file-based backends now detect whether file is live CIB
- lrmd: add back support for class heartbeat agents
- lrmd: provide fake meta data for ra class heartbeat
- crm_resource: Use-after-free when restarting a resource
- cli: Ensure subsequent unknown long options are correctly detected
- crmd: Bug rhbz#1181824 - Ensure the DC can be reliably fenced
- attrd_updater: Allow attributes to be set for other nodes
- native_print: report target-role as well
- membership: fix crm_update_peer_proc to NOT ignore flags if partially set
- crmd: don't trigger a stonith_reconnect if no longer required
- Upstream version cs: fa1311a0159588385f24cd8c3530233f4b90f3a9

-------------------------------------------------------------------
Tue Feb 24 12:26:27 UTC 2015 - rguenther@suse.com

- Add pacemaker-Wno-format-signedness.patch to disable
  -Wformat-signedness added by GCC 5 and enabled by -Wformat=2

-------------------------------------------------------------------
Fri Jan 30 10:37:57 UTC 2015 - ygao@suse.com

- pengine: Handle ordering between stateful and migratable resources (bsc#881160)
- crmd: Check "watchdog" daemon option before setting "have-watchdog" property
- crmd: Correctly add the local option that validates against schema for pengine to calculate
- Upstream version cs: 3021d731fdeba29e1136c117a62f3201785be6ea

-------------------------------------------------------------------
Fri Jan 16 12:44:34 UTC 2015 - ygao@suse.com

- crm_standby: update accepted options to match documentation
- cts: Fix bashisms in LSBDummy script
- pengine: fixes pengine crash with orphaned remote node connection resource
- PE: Do not aggregate children in a pending state into the started/stopped/etc lists
- acl: Correctly implement the 'reference' acl directive
- Upstream version cs: 03ec61210c82471161f6cf3366e8afc30d737d67

-------------------------------------------------------------------
Mon Jan 12 11:05:14 UTC 2015 - ygao@suse.com

- pengine: imply stop in container node resources when host node is fenced
- Build: Fix building if ncurses doesn't provide pkg-config files
- xml: Do not change the ordering of properties when applying v1 cib diffs
- xml: Do not prune leaves from v1 cib diffs that are being created with digests
- Upstream version cs: 4109f1539a625bfa3e884d19ab2fc42d7a4daec4

-------------------------------------------------------------------
Fri Jan  9 12:10:09 UTC 2015 - ygao@suse.com

- xml: add 'require-all' to xml schema for constraints
- pengine: require-all feature for ordered clones
- xml: Ensure ACLs are reapplied before calculating what a replace operation changed
- cib: Ensure file-based backends treat '-o section' consistently with the native backend
- crmd: resolves memory leak in crmd.
- pacemakerd: resolves memory leak of xml structure in pacemakerd
- ipc: use server enforced buffer during ipc client send
- pengine: do not recording pending migrate_to ops for pacemaker remote
- crmd: never stop recurring monitor ops for pcmk remote during incomplete migration
- pengine: prefer migration target for remote node connections
- pengine: properly handle ordering during remote connection partial migration
- crmd: Ensure remote connection resources timeout properly during 'migrate_from' action
- crmd: gracefully handle remote node disconnects during op execution
- pengine: Fence baremetal remote when recurring monitor op fails
- crmd: Handle remote connection failures while executing ops on remote connection
- remote: Treat recv msg timeout as a disconnect
- pengine: properly recover remote-nodes when cluster-node proxy goes offline
- systemd: Correctly handle long running stop actions (bsc#948989)
- crm_resource: Include group members when calculating the next timeout
- crm_resource: Ensure --restart sets/clears meta attributes
- crm_resource: Clean up memory in --restart error paths
- Build: Use a wrapper for realloc() which calls abort when we run out of memory
- services: Prevent potential use-of-NULL
- crm_resource: Memory leak in error paths
- crmd: Mistake of the set of the variable.
- Upstream version cs: d0139e9a00c32b9bc1d7d206d6210126045b49be

-------------------------------------------------------------------
Fri Nov 21 15:38:57 UTC 2014 - ygao@suse.com

- crm_node: Correctly remove nodes from the CIB by nodeid
- fencing: Allow nodes to be purged from the member cache
- xml: cl#5231 - Unset the deleted attributes in the resulting diffs (bsc#905641, bsc#967254)
- fencing: stonith -l option for custom log
- cib: Avoid nodeid conflicts we don't care about
- Membership: Detect and resolve nodes that change their ID
- attrd: Simplify how node deletions happen
- attrd: Clean out the node cache when requested by the admin
- crm_resource: Allow resource restart operations to be node specific
- crm_resource: Implement --timeout for resource restart operations
- crm_resource: Calculate how long to wait for a restart based on the resource timeouts
- crm_resource: Implement an intelligent restart capability
- crm_failcount: Better error reporting when no resource is specified
- cib: tls sock cleanup for remote cib connections
- Upstream version cs: 7dd90226e10035340d6707d9fd2b04f2e0141194

-------------------------------------------------------------------
Fri Nov 14 09:44:03 UTC 2014 - ygao@suse.com

- pengine: make resource-discovery work with location rules
- services: Conditionally clean up services actions
- Upstream version cs: 5093c095c5f517ab58375b2b69ecfc5516c86b5b

-------------------------------------------------------------------
Fri Nov 14 08:58:40 UTC 2014 - dimstar@opensuse.org

- Drop conditional BuildRequires of system-devel: it was required
  one line lower unconditionally.
- Replace remaining systemd-devel BuildRequires with
  pkgconfig(systemd).

-------------------------------------------------------------------
Mon Nov 10 11:36:27 UTC 2014 - ygao@suse.com

- pengine: exclusive discovery implies rsc is only allowed on exclusive subset of nodes
- dbus: handle dispatch queue when multiple replies need to be processed
- dbus ref count leaks
- dbus: Ensure both the read and write queues get dispatched
- systemd: Ensure failed monitor operations always return
- Perform systemd reloads asynchronously
- Upstream version cs: cd7c9abbcfc620aa84194ee07aade142240db15a

-------------------------------------------------------------------
Tue Oct 28 14:21:58 UTC 2014 - ygao@suse.com

- watchdog: Allow startup without sbd
- service: Prevent potential use-of-NULL in metadata lookups
- dbus: Fail gracefully if malloc fails
- crmd: Prevent use-of-NULL during reprobe
- crmd: Correctly obtain SBD_WATCHDOG_TIMEOUT from the environment
- pengine: add #kind=remote for baremetal remote-nodes
- Officially support the resource-discovery attribute for location constraints
- xml: fix xml.c memleak in "missing upgrade XSLT" case
- Prefer to inherit the  watchdog timeout from SBD
- stonith-ng: Correctly observe the watchdog completion timeout
- sbd: Attempt to locate sbd via its pid file
- Fencing: If configured, wait stonith-watchdog-timer seconds for self-fencing to complete
- Resolve some potential issues spotted by clang and coverity
- PE: Watchdog integration is sufficient for fencing
- Fencing: Correctly wait for self-fencing to occur when the watchdog is in use
- Fencing: Ensure the hostlist parameter is set for watchdog agents
- crm_resource: Allow -M location to be reinforced with -f even if rsc is already on node
- mcp: Turn on sbd integration if pacemakerd finds it running
- pengine: Fix the behaviors of multi-state resources with asymmetrical ordering (bsc#899403)
- lrmd: Prevent glib assert triggered by timers being removed from mainloop more than once
- cib: Improved tracing of callbacks
- Upstream version cs: a9c81774b89f21f990be255f9862446d1a38afee

-------------------------------------------------------------------
Fri Oct 17 12:55:03 UTC 2014 - ygao@suse.com

- remote: advertise default port correctly, further adjust default timeout periods
- remote: report timestamps for remote connection resource operations
- pengine: allow remote-nodes to be placed in maintenance mode
- xml: Prevent assert errors in crm_element_value() on applying a patch without version information (bsc#900296)
- pengine: prevent disabling rsc discovery per node in certain situations
- crm_resource: avoid deletion of lrm cache on node with resource discovery disabled.
- pengine: per-node control over resource discovery
- mainloop: fix potential segfault for fd = 0
- ping: Correct metadata for attempts parameter (bsc#899324)
- ping: Pass extra options to fping (bsc#899324)
- ping: Remove incorrectly advertised migrate_to|migrate_from (bsc#899324)
- ping: Add use_fping parameter (bsc#899324)
- ping: Correctly advertise multiplier default (bsc#899324)
- pengine: resource discovery mode for location constraints
- cib: Ensure upgrade operations from a non-DC get an acknowledgement
- lrmd: cancel pending async connection during disconnect
- systemd: Ensure we don't call dbus_message_unref() with NULL
- systemd: Perform monitor operations without blocking
- dbus: Notice when dbus connections get disabled
- pengine: allow baremetal remote-nodes to recover without requiring fencing when cluster-node fails
- crmd: do not remove connection resources during re-probe
- pengine: only fence baremetal remote when connection can fails or can not be recovered
- ipc: properly allocate server enforced buffer size on client
- remote: advertise more reasonable timeout periods for remote-nodes connections
- crmd: properly update job limit for baremetal remote-nodes
- crmd: Remote-node throttle jobs count towards cluster-node hosting conneciton rsc
- crmd: Ensure throttle_mode() does something on Linux
- systemd: Perform actions asynchronously (bsc#956500)
- crm_attribute: Correctly update config options when -o crm_config is specified
- crmd: Fixes crash when remote connection migration fails
- pengine: fixes segfault caused by malformed log warning
- Allow fail-counts to be removed en-mass when the new attrd is in operation
- fencing: Use the correct define for origin
- fencing: Reject actions for devices that haven't been explicitly registered yet
- cts : change default cluster stack from openais to corosync (bsc#894871)
- crm_resource: Ensure fail-counts are purged when we redetect the state of all resources
- corosync: Avoid unnecessary repeated CMAP API calls (bsc#870771)
- cib: Do not update on disk backups if we're just querying them
- mcp: Allow orphan children to initiate node panic via SIGQUIT
- Support machine panics for some kinds of errors (via sbd if available)
- Fencing: Allow the cluster to recover resources if the watchdog is in use
- crmd: If configured, trigger the watchdog immediately if we loose quorum and no-quorum-policy=suicide
- crmd: Ensure a watchdog device is in use if stonith-watchdog-timeout is configured
- Fencing: Advertise the watchdog device for fencing operations
- PE: Allow natural ordering of colocation sets
- stonith-ng: Reset mainloop source IDs after removing them
- Fencing: Force 'stonith-ng' as the system name
- crm_mon: Repair notification delivery when the v2 patch format is in use (bsc#909286)
- mcp: Teach pacemakerd to ignore SIGHUP

- Rebase bug-806256_pacemaker-log-level-notice.patch

- Upstream version cs: 28aee948cebd51305a2cdc3ec4f94252ce975655

-------------------------------------------------------------------
Fri Sep  5 07:33:50 UTC 2014 - ygao@suse.com

- cluster: Invoke crm_remove_conflicting_peer() only when the new node's uname is being assigned in the node cache (bnc#870771)
- mcp: set environment variable which the cluster-glue module needs
- services: Refector services os execute function
- Upstream version cs: 266d5c2484716111616bcd0f32d9b94bc49baa77

-------------------------------------------------------------------
Wed Aug 27 11:27:38 UTC 2014 - ygao@suse.com

- logging: correctly initialized default log file (bnc#883567)
- Upstream version cs: 362f181a387e0a0a9f04e0da84d6c5906d71dd20

-------------------------------------------------------------------
Mon Aug 18 08:02:31 UTC 2014 - ygao@suse.com

- crm_resource: Print a clear message if the attribute is not found for the resource (bnc#890400)
- lrmd: fix rescheduling of systemd monitor op during start
- services: restore SIGPIPE default behavior for child processes
- lrmd: prevent \n from being printed in exit reason output
- lrmd: pass exit reason prefix to ocf scripts as env variable
- Upstream version cs: dad4cebccdb5a4bcdb8fb94e676f6df006ac0846

-------------------------------------------------------------------
Thu Aug  7 06:47:29 UTC 2014 - ygao@suse.com

- crm_diff: Support generating a difference without versions details if --no-version/-u is supplied (bnc#888726)
- crmd: When container's host is fenced, cancel in-flight operations
- crm_mon: add exit reason to resource failure output
- lrmd: store failed operation exit reason in cib
- Upstream version cs: 1040002ecc1a0dfec9f0561f79936cbe64d716db

-------------------------------------------------------------------
Mon Jul 28 05:26:26 UTC 2014 - ygao@suse.com

- Bug rhbz#1067544 - Tools: Correctly handle --ban, --move and --locate for master/slave groups
- lrmd: Log with the correct personality
- mainloop: implement gio_poll_dispatch_mod
- Upstream version cs: 483f48a1921241f1f5976a100a171785dc327192

-------------------------------------------------------------------
Tue Jul 22 05:10:09 UTC 2014 - ygao@suse.com

- Update to version 1.1.12
- Log: Turn off the default log file if a real one is specified
- Log: Do not unconditionally send crm_perror output to stderr
- Log: allows the user to specify a log level that is output to syslog
- Upstream version cs: 561c4cfda1b09b31b60fd5f73644ee05348f41fb (1.1.12)

-------------------------------------------------------------------
Thu Jul 17 06:09:01 UTC 2014 - ygao@suse.com

- logrotate: maxsize is not supported by older versions (bnc#883567)
- Tools: Non-daemons shouldn't abort just because xml parsing failed
- Log: Default to emitting CRIT messages only until logging is fully configured
- Logging: Bootstrap daemon logging before processing arguments but configure it afterwards (bnc#883567)
- dbus: Return 'null' if we cannot connect via dbus
- Upstream version cs: 026944ebfad7c4b2da5a6864a9d763bf37e0e088

-------------------------------------------------------------------
Thu Jul 10 10:02:09 UTC 2014 - ygao@suse.com

- systemd: Ensure the retry logic is also exercised for the 'service' class
- crm_simulate: Remove resource states and transient attributes when a node is marked as down
- crm_verify: Perform a full set of calculations whenever the status section is present (bnc#886479)
- PE: Correctly warn when resources require fencing but fencing is disabled (bnc#886479)
- PE: Always use pe_fence_node to mark nodes as unclean
- lrmd: Handle systemd reporting 'done' before a resource is actually stopped
- Upstream version cs: c468fa06483152c29529f81aa0b5ccf37da8b2af

-------------------------------------------------------------------
Thu Jul  3 05:41:16 UTC 2014 - ygao@suse.com

- attrd: Remove offline nodes from node cache for "peer-remove" requests (bnc#870771)
- membership: Prevent use-after-free in reap_crm_member() (bnc#870771)
- cluster: Remove unknown offline nodes with conflicting unames from node cache (bnc#870771)
- crmd: Remove state of unknown nodes with conflicting unames from CIB (bnc#870771)
- Upstream version cs: 440da7f59ac4bed16a0289e33f04d2635b335c70

-------------------------------------------------------------------
Tue Jul  1 08:03:50 UTC 2014 - ygao@suse.com

- extra: Add logrotate configuration file for /var/log/pacemaker.log (bnc#883567)
- PE: Correctly detect empty tags
- xml: Ensure realloc didn't fail
- crmd: Only write fence_averride if open() returns a positive file descriptor
- tools: Non-recurring memory leak
- PE: Potential use-of-NULL
- ipc: Buffer size cannot be negative
- xml: Prevent possible array underflow
- mcp: Let daemons know when they have been respawned by the mcp
- cts: fix RemoteBaremetal step2 move resource action failed issue
- PE: Correctly observe requires=nothing
- crmd: Remove unknown nodes with conflicting unames from CIB (bnc#883240)
- controld: Return OCF_ERR_INSTALLED instead of OCF_NOT_INSTALLED (bnc#883729)
- lrmd: Prevent OCF agents from logging to random files due to "value" of setenv() being NULL (bnc#883524)
- cts: fix shutdown pattern not found issue
- Fix: ignore SIGPIPE with gnutls is in use
- crmd: avoid double free caused by nested hash table removal
- crm_report: Correctly detect large files
- cib: cl#5222 - Prevent assert in xml_calculate_changes() on performing cib operations (bnc#881575)
- Upstream version cs: c3f1a7f8912f3d6d17497dd8af0b69fe0708b2b1

-------------------------------------------------------------------
Fri Jun 13 03:16:29 UTC 2014 - ygao@suse.com

- Bug cl#5219 - PE: Allow unrelated resources with a common colocation target to remain promoted (bnc#899175)
- Bug cl#5222 - Enable legacy mode whenever a broadcast update is detected (bnc#881575)
- xml: Prevent incorrect xml diffs from corrupting the cib (bnc#878362)
- mainloop: implement gio_poll_dispatch_mod
- cluster: Prevent search of unames from attempting to create node entries for unknown nodes (bnc#881884)
- Upstream version cs: 97629ded958f76652350569a54303b3cd25d1d7e

-------------------------------------------------------------------
Wed Jun 11 05:44:21 UTC 2014 - ygao@suse.com

- crm_report: Gracefully handle rediculously large logfiles
- Bug cl#5222 - cib: Repair rolling update capability (bnc#881575)
- cib: Use a better option name for enabling the legacy cib diff code (cl#5222, bnc#881575)
- remote: clear remote-node status correctly
- pengine: properly handle fencing of container remote-nodes when the container is orphaned
- remote: Handle request/response ipc proxy correctly
- cib: Prevent assert on sending cib sync requests (cl#5222, bnc#881575)
- crm_simulate: Clean up temporary shadow files on exit (bnc#879934)
- pengine: cl#5200 - Before migrating utilization-using resources to a node, take off the load that will no longer run there if it's not introducing transition loop
  (Rework cl#5044, lf#2599, bnc#695440)
- Fencing: Cache metadata lookups to avoid repeated blocking during device registration
- pengine: properly place resource within a container when container is a remote-node.
- mainloop: Better handle the killing of processes in the act of exiting
- services: Remove cancelled recurring ops from internal lists as early as possible (bnc#888586)
- services: Remove file descriptors from mainloop as soon as we have drained them (bnc#888586)
- pengine: Don't report a resource as restarting when it is a moving multistate resource
- pengine: avoid assert by searching for stop action on correct node during LogActions
- Upstream version cs: 734e6b538b0a037f9e7d0709f450bd664f26c332

-------------------------------------------------------------------
Mon Jun  2 03:17:54 UTC 2014 - ygao@suse.com

- cib: Drop the message serverity now that the cause is well understood
- crmd: Avoid spamming the cib by triggering a transition only once per non-status change
- Upstream version cs: 559f733e8818a96085134cd2a34efc280c512a2a

-------------------------------------------------------------------
Thu May 29 10:38:11 UTC 2014 - ygao@suse.com

- pengine: Prevent possible segfault (bnc#880258)
- attrd: Ensure attribute dampening is always observed
- Bug cl#5213 - Limit the scope of the previous commit to the masters role
- membership: Avoid duplicate peer entries in the peer cache
- Bug cl#5184 - Ensure pending probes that ultimately fail are correctly updated (bnc#804763, bnc#879034)
- Upstream version cs: 9776707a6232f25812009145fafa8a64c5b53910

-------------------------------------------------------------------
Tue May 27 09:39:48 UTC 2014 - ygao@suse.com

- Rebase:
  * pacemaker-colocated-utilization.patch

- Bug cl#5213 - Ensure role colocation with -INFINITY is enforced
- pengine: Mark unrunnable stop actions as "blocked" and show the correct current locations (bnc#878662)
- pengine: Block restart of resources if any dependent resource in a group is unmanaged (bnc#878662)
- systemd: Try to handle dbus actions that complete prior to configuring a callback
- mainloop: Canceling in-flight operations should not fail if child process has already exited.
- Bug rhbz#1097457 - Limit the scope of the previous fix and include a helpful comment
- Bug cl#5212 - Do not promote instances when quorum is lots and no-quorum-policy=freeze
- Bug rhbz#1097457 - Prevent invalid transition when resource are ordered to start after the container they're started in
- Fix: fix small memory leaks
- Upstream version cs: 25ebca2b83df9263aedb944ea4eeb53468e90e83

-------------------------------------------------------------------
Fri May 23 07:33:51 UTC 2014 - jsegitz@novell.com

- added necessary macros for systemd files

-------------------------------------------------------------------
Mon May 12 09:20:16 UTC 2014 - ygao@suse.com

- pengine: Use "#site-name" in rules for setting site-specific instance attributes
- pengine: Use "#cluster-name" in rules for setting cluster-specific instance attributes (FATE#316118)
- crmd: Set "cluster-name" property to corosync's "cluster_name" by default for corosync-2 (FATE#316118)
- pengine: Fixed so that it could change while a setup of "startup-fencing" starts.
- crmd: Use correctly signed inputs to sscanf()
- PE: Correctly handle origin offsets in the future
- iso8601: Different logic is needed when logging and calculating durations
- xml: Do not prune meaningful leaves from v1 patchsets
- Upstream version cs: da5aaab97ca5b7858f2aac98107a1a7ffc3e4252

-------------------------------------------------------------------
Thu May  8 11:30:57 CEST 2014 - ro@suse.de

- use _rundir macro

-------------------------------------------------------------------
Mon May  5 07:42:25 UTC 2014 - ygao@suse.com

- Rebase:
  * pacemaker-NodeUtilization-RA.patch
  * pacemaker-colocated-utilization.patch

- xml: Clean up schema list at exit
- pengine: Support site-specific instance attributes based on rules for stretch cluster
- pengine: Support cluster-specific instance attributes based on rules (FATE#316118)
- crmd: Ensure crm_config options are re-read on updates
- Resolve all clang analyser defects
- xml: Check all available schemas when doing upgrades
- Changes to the ACL schema to support nodes and unix groups
- tools: Allow crm_shadow to create older configuration versions
- xml: Prevent use-after-free when comparing two xml documents
- cib: Resolve memory leaks in query paths
- xml: Correctly subtract xml with v1 patchsets
- fencing: Advertise support for reboot/on/off in the metadata for legacy agents
- fencing: default to 'off' when agent does not advertise 'reboot' in metadata
- fencing: Execute all required fencing devices regardless of what topology level they are at
- fencing: Fence using all required devices
- fencing: fixed so that change of <resources> could be handled correctly.
- Upstream version cs: 42ae0e3cb50bb9e19dba7d1ad1ea69255bef5370

-------------------------------------------------------------------
Wed Apr 16 06:38:45 UTC 2014 - ygao@suse.com

- pengine: Fix memory leak in expand_tags_in_sets()
- PE: Memory leak
- PE: Do not initiate fencing for unclean nodes when fencing is disabled
- crm_node: Only remove the named resource from the cib
- pengine: Support site-specific instance attributes based on rules (FATE#316118)
- pengine: Ignore failure-timeout only if the failed operation has on-fail="block" (bnc#871175)
- Upstream version cs: f7859e2e06c8cf320482c3e4b447ddbe0a96fe83

-------------------------------------------------------------------
Mon Apr 14 06:10:25 UTC 2014 - ygao@suse.com

- pengine: Support cib object tags (FATE#315101)
- crmd: Correctly detect changes of ticket state (bnc#872794)
- Upstream version cs: 3f7ec44b51825898e3e30784ca4df09e3f45bf40

-------------------------------------------------------------------
Fri Apr 11 15:07:26 UTC 2014 - ygao@suse.com

- Rebase:
  * bug-812269_pacemaker-fencing-device-register-messages.patch

- Build: Update versions in configure.ac and sample spec file
- fencing: Do not unregister/register all stonith devices on every resource agent change
- PE: Unfencing is based on device probes, there is no need to unfence when normal resources are found active
- pengine: handles edge case where container order constraints are not honored during migration
- pengine: Allow container nodes to migrate with connection resource
- xml: Resolve memory leak when logging xml blobs
- PE: Do not unfence nodes that are offline, unclean or shutting down
- PE: Ensure unfencing only happens once, even if the transition is interrupted
- crmd: Actions can only be executed if their pre-requisits completed successfully
- crmd: Do not erase the status section for unfenced nodes
- Fencing: Correctly record which peer performed the fencing operation
- lrmd: Expose logging variables expected by OCF agents
- logging: Simplify processing of logging directives
- logging: daemons always get a log file, unless explicitly set to configured 'none'
- PE: Ensure unfencing occurs before fencing devices are (re-)probed
- fencing: Filter self-fencing at the peers to allow unfencing to work correctly
- fencing: Automatically switch from 'list' to 'status' to 'static-list' if those actions are not advertised in the metadata
- lrmd: Provide stderr output from agents if available, otherwise fall back to stdout
- fencing: properly detect new fencing devices for v2 cib updates
- acl: Prevent use-of-NULL
- cts: automatically determine whether to run RemoteBaremetal (bnc#856353)
- pengine: Correctly search failcount (bnc#880520)
- Upstream version cs: ff74a591e670dbdb86f7cddeec989167de521216

-------------------------------------------------------------------
Wed Apr  9 04:41:38 UTC 2014 - ygao@suse.com

- pengine: Support id-ref in nvpair with optional "name" (FATE#316118)
  Drop the patches that have been merged upstream:
  * pacemaker-pengine-nvpair-id-ref.patch
  * pacemaker-pengine-nvpair-id-ref-test.patch
- Upstream version cs: 6442c5a67cdd4cbaeedb2c532e0dc0667a79c202

-------------------------------------------------------------------
Tue Apr  8 13:34:59 UTC 2014 - ygao@suse.com

- xml: INFINITY could overflow for 16-bit ints - explicitly cast it
- xml: Correctly determine the lowest allowed schema version
- xml: Construct the table of supported schemas
- cib: All schema upgrade requests must go via the DC
- cib: Determine the best value of validate-with if one is not supplied
- acl: Ensure known users are not able to read the cib by default
- xml: Add missing schema file
- Upstream version cs: d9fbba56804a7a7bcceaa5d4b7e29e3f15fc0e59

-------------------------------------------------------------------
Fri Apr  4 10:46:58 UTC 2014 - ygao@suse.com

- crmd: Correctly react to successful unfencing operations
- PE: Delay unfencing until after we know the state of all resources that require unfencing
- PE: Fencing devices default to only requiring quorum in order to start
- PE: Automatically re-unfence a node if the fencing device definition changes
- pengine: Only report 'migrate' in transition summary if migration is actually taking place
- crm_node: Set correct subsystem in node rm cache msg
- crm_node: Prevent use-after-free in tools_remove_node_cache()
- crmd: make resource ID case sensitive
- fencing: Correction of the registration from a difference.
- crm_report: Add support for ISO8601 time format in logs (bnc#870886)
- PE: Potential memory leak
- xml: Support resources that require unfencing
- crmd: make node_state erase correctly
- xml: Add the ability to have lightweight schema revisions
- xml: Split up the RelaxNG schema files so they're easier to version individually
- crm_get_msec: prevent integer overflow
- corosync: Reduce log severity for a redundant message (bnc#870624)
- attrd: Reduce log severity for normal messages (bnc#870624)
- cib: When data was old, it fixed so that the newest cib might not be acquired.
- crm_attribute: Default --lifetime to forever when using --node (bnc#870696)
- Upstream version cs: 76579e813b5aaa1972d400055233519f58bbc0c6

-------------------------------------------------------------------
Mon Mar 31 07:19:00 UTC 2014 - ygao@suse.com

- pengine: Do not fence remote-node entries left over in the node section that have no connection rsc
- pengine: properly handle remote-node without connection resource.
- xml: Update xml validation to allow '<node type=remote />'
- cib: allow setting permanent remote-node attributes
- Upstream version cs: d63eaf41fa8173de3e29873d0461bfb888b83b37

-------------------------------------------------------------------
Fri Mar 28 07:52:07 UTC 2014 - ygao@suse.com

- xml: Allow first-acl-match-wins semantics to be supported if desired
- crm_report: extract additional DLM lockspace data
- xml: If validate-with is missing, we find the most recent schema that accepts it and go from there
- tools: fix "crm_shadow --reset <name>"
- controld: Remove '-q 0' from default dlm_controld arguments
- acl: Authenticate pacemaker-remote requests with the node name as the client
- controld: Verify killall is available on resource start
- Prevent use-of-NULL spotted by coverity
- crmd: Correctly detect changes to the configuration root
- crmd: Fenced nodes that return prior to an election do not need to have their status section reset
- xml: Do not log deleted attributes
- xml: Correctly mark the parent's of deleted attributes as dirty
- crm_diff: Allow the generation of xml patchsets without digests
- crmd: Prevent memory leak when accepting a new DC
- xml: Find the minimal set of changes when part of a document is replaced
- xml: Create the correct diff when only part of a document is changed
- Upstream version cs: 61e95e4864be0301be528874eed65266f4e62cf0

-------------------------------------------------------------------
Fri Mar 21 05:51:05 UTC 2014 - ygao@suse.com

- pengine: fixes invalid transition caused by clones with more than 10 instances
- services_action_cancel: Interpret return code from mainloop_child_kill() correctly
- fencing: make hashtable mapping hostname->alias case insensitive for hostname
- attrd: Make hostname hashtable case insensitive
- membership: make caching peers by uname case insensitive
- crmd: make lrm_state hash table not case sensitive
- lrmd: clean up the agent's entire process group
- xml: Enable resource sets in location constraints for 1.2 schema (bnc#867880)
- Upstream version cs: 8bee850bb95ee01dcba03038ddfd65d22e195cf6

-------------------------------------------------------------------
Thu Mar 13 10:44:49 UTC 2014 - ygao@suse.com

- Drop obsolete bug-792124_pacemaker-stonith-monitor-log.patch

-------------------------------------------------------------------
Thu Mar 13 09:38:46 UTC 2014 - ygao@suse.com

- mainloop: Fixes use after free in process monitor code
- lrmd: Cancel recurring operations before stop action is executed
- lrmd: Merge duplicate recurring monitor operations
- services: Do not allow duplicate recurring op entries
- crmd: Ack pending operations that were cancelled due to rsc deletion (bsc#1035822)
- crm_mon: Add failures to --as-xml output
- cib: Check if on-disk cib is corrupt in the separate on_disk_cib_corrupt() rather than in validate_on_disk_cib() (bnc#866618)
- crmd: Do not start timers for already completed operations
- acl: Read access must be explicitly granted
- xml: Better move detection logic for xml nodes
- cib: Do not disable cib disk writes if on-disk cib is corrupt (bnc#866618)
- xml: Correctly calculate the adjusted offset of xml elements
- crm_diff: Mirror how the cib operates for better testing
- cib: Ingore patch failures if we already have their contents
- cib: Prevent use-after-free when cleaning up after query operations
- xml: Mark the parents of a partial replace as dirty
- xml: Correctly enforce ACLs after a replace operation
- cib: Do not try to use an empty value for CIB_shadow
- crm_resource: Gracefully handle -EACCESS when querying the cib
- xml: Correctly observe ACLs when creating filtered copies of xml documents
- xml: Only test write permissions for attributes that are being changed
- xml: Always allow new scaffolding - node with no attributes or only an id field
- cib: Memory leaks caused by ACLs returning filtered copies
- xml: Set flags to indicate when updates were rejected by an ACL
- cib: Respect the CIB_user environment variable for ACLs
- xml: Unpack and apply ACLs when tracking changes
- cib: Implement CIB_file-mode ACLs for testing
- remote: Enable migration support for baremetal connection resources by default
- cibadmin: Allow priviliged clients to perform tasks as unpriviliged users
- cibadmin: Remove dangerous commands that exposed unnecessary implementation internal details
- cibadmin: Purge legacy command options deprecated since 2008 to make the short-forms available for new options
- cib: Include a request with file-mode cib actions for the acl code to interrogate
- cib: Switch over completely to the new ACL code
- xml: Allow new objects to be created provided they subseqently match a configured ACL
- cib: Use the new acl filtering functionality
- xml: Support the creation of filtered copies based on ACLs
- xml: Convert all ACLs to xpaths during unpack
- xml: Add ACL flags for xpath selectors when tracking is enabled
- cib: ACL improvements
- cib: Simplify ACL handling for read-only cib queries
- cib: Check ACLs prior to making the update instead of parsing the diff afterwards
- cib: Default ACL support to on
- Upstream version cs: 38c5972cd284ea6627b3309b619dad4d27442ab0

-------------------------------------------------------------------
Mon Mar  3 11:42:04 UTC 2014 - ygao@suse.com

- Add symlinks rcpacemaker and rcpacemaker_remote to /usr/bin/service (bnc#866057)

-------------------------------------------------------------------
Mon Mar  3 09:32:30 UTC 2014 - ygao@suse.com

- Rebase bug-812269_pacemaker-fencing-device-register-messages.patch

-------------------------------------------------------------------
Mon Mar  3 07:40:22 UTC 2014 - ygao@suse.com

- xml: Memory leak when free'ing xml documents
- systemd: Prevent use-of-NULL when determining if an agent exists
- xml: Fix segfault in TRACKING_CHANGES() (bnc#865345)
- PE: Memory leak when updating cancel operations
- xml: Prevent memory leak in xml _private field
- pengine: Performance increase, stack allocated score2char
- crm_report: Only gather dlm data if dlm_controld is running
- Fix: memory leak found by valgrind was corrected.
- Fencing: Add the ability to call stonith_api_time() from stonith_admin
- Fencing: Pass the correct options when looking up the history by node name
- cib: Ensure 'cibadmin -R/--replace' commands get replies
- xml: Correctly initialize and find v1-style patch version numbers
- crm_mon: Add -R switch to show clone details
- Build: Install compatibility.h
- fencing: Teach stonith-ng about finding device and topology changes in the v2 patch format
- crm_report: Additional dlm detail
- crm_report: Allow ssh alternatives to be used
- crmd: Correctly recognise operation cancellations we initiated
- crmd: Improved logging of transition cancellations
- crmd: Correctly detect lrm refreshes
- crmd: Ignore 'move' operations to the cib, we only care about content changes
- PE: Ensure instance numbers are preserved for cloned templates
- Bug cl#5196 - PE: Check values after expanding templates
- crm_mon: Ensure resource attributes have been unpacked before displaying connectivity data
- Upstream version cs: ca8234daf2bbb2d0fd2fb47cdbb6667f892081bb

-------------------------------------------------------------------
Mon Mar  3 06:14:23 UTC 2014 - ygao@suse.com

- pengine: Support id-ref in nvpair with optional "name" (FATE#316118)
  * pacemaker-pengine-nvpair-id-ref.patch
  * pacemaker-pengine-nvpair-id-ref-test.patch

-------------------------------------------------------------------
Fri Feb 21 07:05:40 UTC 2014 - ygao@suse.com

- controld: Do not consider the dlm up until the address list is present
- pengine: Support per-resource maintenance mode (bnc#863071)
- pengine: cl#5187 - Prevent resources in an anti-colocation from even temporarily running on a same node (bnc#856135, bnc#862319)
- controld: handling startup fencing within the controld agent, not the dlm
- Upstream version cs: 0b7d85a159cc92e00ebded65c9a33edce7ba1c22

-------------------------------------------------------------------
Fri Feb 21 06:44:59 UTC 2014 - ygao@suse.com

- cib: Erasing the cib is an admin action, bump the admin_epoch instead
- mcp: Tell systemd not to respawn us if we exit with rc=100
- crm_mon: Allow the file created by --as-html to be world readable
- crmd: Do not overwrite existing node state when fencing completes
- PE: Default sequential to TRUE for resource sets for consistency with colocation sets
- Bug rhbz#1036631 - Stop members of cloned groups when dependancies are stopped
- PE: Ensure stop actions are viable when reporting what will happen to a resource
- xml: Consolidate patchset logging and apply functionality
- cib: Validate that everyone still sees the same configuration once all updates have completed
- cib: Validate clients are correctly applying v2-style diffs at most once a minute
- xml: Allow both patch formats to include and validate an xml digest
- election: If an error occurrs in crm_uptime(), compare as {0,0}
- xml: Correctly compare the current feature set when determining which patch format to use
- crmd: Support failcount processing with the new patch format
- crmd: Handle patchset directives that change the configuration top-level
- cib: Make patchset validation a run-time switch
- cib: Implement zero-copy status update
- cib: Enable the more efficient xml patchset format
- crmd: Add support for parsing resource operations in the v2 patch format
- xml: New function for calculating patchset version details
- cib: Auto-detect which patchset format to use
- xml: Allow the source of xml library errors to be traced
- cib: Send all r/w operations via the cluster connection and have all nodes process them
- xml: Use an optimized xpath search function for applying patch sets
- xml: Use the new patch application code path
- xml: Detect changes in global replace operations
- xml: allow either patch format to be created and applied automatically
- xml: Create a more robust diff format
- xml: Track changes to xml trees as they happen
- Upstream version cs: 0d3f74a5caa7e0f7d1f5ccc97e0d2d018ed8bdfc

-------------------------------------------------------------------
Thu Feb 20 12:56:39 UTC 2014 - ygao@suse.com

- Update to version 1.1.11
- Drop the patches that have been merged upstream:
  * pacemaker-display-pending-ops.patch
  * pacemaker-crm_mon-brief.patch

- pengine: Prevent memory leak on handling pending state
- crmd: Prevent message relay from attempting to create node entries for unknown nodes (bnc#862383)
- attrd: Support "--refresh" command of attrd_updater
- crmd: Prevent manual fencing confirmations from attempting to create node entries for unknown nodes (bnc#860169)
- Upstream version cs: 3ca8c3bf87057339c9f2a55cd137db8c9c9922f0

-------------------------------------------------------------------
Sat Feb  8 14:00:23 UTC 2014 - ygao@suse.com

- ipc: Convince clang that our casting is intended (bnc#845525)
  * Drop pacemaker-Wno-cast-align.patch which has been merged upstream
- cib: Use the correctly typed enum value during initialization
- Build: Add dbus as an rpm dependancy
- Fix: Bug rhbz#1057697 - Use native DBus library for systemd async support to avoid problematic use of threads
- remote: Fail remote-node connection rsc monitor ops early on unexpected disconnect
- tools: Return error when attempting to delete an unspecified attribute
- remote: Allow baremetal remote-node connection resources to migrate
- lrmd: Send event alerting estabilished clients that a new client connection is created.
- Fix: Bug rhbz#1057697 - Use native DBus library for systemd support to avoid problematic use of threads
- xml: Fix segfault in find_entity()
- Upstream version cs: 6290953f2b035a92a8f093973b94c5cf38b79cd9

-------------------------------------------------------------------
Tue Jan 28 04:00:43 UTC 2014 - ygao@suse.com

- pengine: Free memory allocated by find_actions()
- cib: Fix remote cib based on TLS
- Upstream version cs: f3eeaf49d1fb7bca713ecbbc819aef51650d26ef

-------------------------------------------------------------------
Tue Jan 28 03:47:02 UTC 2014 - ygao@suse.com

- stonith: Drop the severity of log for recoverable condition (bnc#857779)
  * Update bug-812269_pacemaker-fencing-device-register-messages.patch

-------------------------------------------------------------------
Sat Jan 25 06:22:21 UTC 2014 - ygao@suse.com

- Build: Suppress -Wcast-align warnings/errors on arm and ppc64le (bnc#845525)
  * Update pacemaker-Wno-cast-align.patch

-------------------------------------------------------------------
Sat Jan 25 01:22:06 UTC 2014 - ygao@suse.com

- services: Do not block synced service executions
- Upstream version cs: 96cd1941308be48fdf1e827b88ebd9410cf2010a

-------------------------------------------------------------------
Fri Jan 24 08:51:31 UTC 2014 - ygao@suse.com

- crm_mon: Display brief output if "-b/--brief" is supplied or 'b' is toggled (FATE#314757)
  * Add pacemaker-crm_mon-brief.patch
- tools: Display pending state in crm_mon/crm_resource/crm_simulate if --pending/-j is supplied (cl#5178) (FATE#315159)
  * Add pacemaker-display-pending-ops.patch

-------------------------------------------------------------------
Mon Jan 20 09:55:26 UTC 2014 - ygao@suse.com

- Drop the obsolete patch (bnc#857779):
  * bug-812269_pacemaker-fencing-update-cib.patch

-------------------------------------------------------------------
Mon Jan 20 09:47:13 UTC 2014 - ygao@suse.com

- crm_report: Force grep to interpret logs as text
- pengine: Force record pending for migrate_to actions
- pengine: cl#5186 - Avoid running rsc on two nodes when node is fenced during migration
- cluster: Fix segfault on removing a node (bnc#858745)
- services: Reset the scheduling policy and priority for lrmd's children without replying on SCHED_RESET_ON_FORK (bnc#858857)
- fencing: Update stonith device list only if stonith is enabled (bnc#857779)
- services: Correctly reset the nice value for lrmd's children (bnc#858857)
- pengine: Correctly perform partial migrations when node's uname is not equal to the id.
- fencing: Immediately fail remote fencing operation on peer timeout
- cl#5055: Improved migration support.
- stonith_admin: Ensure pointers passed to sscanf() are properly initialized
- Fix: Prevent potential use-of-NULL
- crmd: Prevent memory leak in error paths
- services: Fixes segfault associated with cancelling in-flight recurring operations. (bnc#859923)
- pengine: cl#5174 - Allow resource sets and templates for location constraints (FATE#315158)
- Upstream version cs: a3cda7619e71399d54f209296aebf3ba713a0bf4

-------------------------------------------------------------------
Sat Jan 11 11:35:16 UTC 2014 - ygao@suse.com

- crmd: Change the default value of node-action-limit
- crm_ticket: Support multiple modifications for a ticket in an atomic operation (bnc#855099)
- Upstream version cs: 3e8930190b8b53565ef4ca3fa00006c41511be9f

-------------------------------------------------------------------
Thu Jan  9 16:30:35 UTC 2014 - ygao@suse.com

- ipc: fix memory leak for failed ipc client connections. (bnc#857779)
- pacemakerd: Fixed a problem that only pacemakerd did not inherit the logfacility of corosync.conf.
- pengine: Fixes memory leak in regex pattern matching code for constraints.
- crm_attribute: Do not swallow hostname lookup failures
- crmd: Avoid deleting the 'shutdown' attribute
- Upstream version cs: ad10acb1c4d668befd7ea1d39312356223d86615

-------------------------------------------------------------------
Wed Dec 11 18:28:52 UTC 2013 - ygao@suse.com

- cts: Install cib_xml.py (bnc#854926)
- report: Add support for xz compressed logs (bnc#854060)
- attrd: Memory leak
- crm_mon: Fix overflow on SMTP subject line
- Upstream version cs: 65bb87eadcf6dfd9b5cd6030ec318579fd4fe7c8

-------------------------------------------------------------------
Thu Dec  5 11:11:40 UTC 2013 - ygao@suse.com

- Fix: Removes unnecessary newlines in crm_resource -O output (bnc#853651)
- Upstream version cs: 93a37bf6ea4dcaea8fe7462442ee01019ec167c5

-------------------------------------------------------------------
Thu Nov 28 13:06:59 UTC 2013 - ygao@suse.com

- crmd: Memory leak
- Upstream version cs: ce5d77c6038a0a0294d4cae238169c458ba03b72

-------------------------------------------------------------------
Mon Nov 25 15:21:14 UTC 2013 - ygao@suse.com

- pengine: Recover unexpectedly running container nodes.
- pengine: Disable container node probes due to constraint conflicts
- ipc: Have the ipc server enforce a minimum buffer size all clients must use.
- Bug cl#5181 - corosync: Ensure node IDs are written to the CIB as unsigned integers
- Upstream version cs: f57ad6c17624c0cbfc58c46f0bad7e28453506bb

-------------------------------------------------------------------
Tue Nov 19 14:12:00 UTC 2013 - ygao@suse.com

- Update pacemaker-colocated-utilization.patch
  * pengine: Do not check the allocation of resources during a colocation preview (bnc#849595)

-------------------------------------------------------------------
Tue Nov 19 13:45:56 UTC 2013 - ygao@suse.com

- election: Correctly hook up the timeout callback
- crmd: Improve throttling response on clusters of single core machines (bnc#838358)
- fencing: Wait until all possible replies are recieved before continuing with unverified devices
- Bug cl#5179 - Corosync: Attempt to retrieve a peer's node name if it is not already known
- Core: Allow blackbox logging to be disabled with SIGUSR2
- PE: Correctly handle demotion of grouped masters that are partially demoted
- crmd: When the DC gracefully shuts down, record the new expected state into the cib
- crmd: When a peer expectedly shuts down, record the new join and expected states into the cib
- attrd: Memory leak
- attrd: Do something sane when older non-atomic versions send us messages
- crmd: Correctly observe the configured batch-limit (bnc#838358)
- attrd: Improve compatibility with older attrd versions
- controld: Use the correct variant of dlm_controld for corosync-2 clusters
- lrmd: Correctly calculate metadata for the 'service' class
- crmd: Prevent over-polling of throttle inputs (bnc#838358)
- crmd: Enable cluster-wide throttling when the cib heavily exceeds its target load (bnc#838358)
- Upstream version cs: 5a69be5ff56ec7fa66bcf9c2069af6211e4ebc98

-------------------------------------------------------------------
Thu Nov 14 07:19:28 UTC 2013 - ygao@suse.com

- crmd: Send the first throttle update (bnc#838358)
- Upstream version cs: 2383f6c469bfb31da9efa8e4dd626de049e808c6

-------------------------------------------------------------------
Sun Nov 10 00:43:46 UTC 2013 - ygao@suse.com

- Rebase:
  * bug-806256_pacemaker-log-level-notice.patch

- Drop the obsolete patch:
  * bug-800323_pacemaker-crm_mon-save-cib.patch

- Probe for baremetal remote-node connection resources.
- remote: Add support for ipv6 into pacemaker_remote daemon
- election/fencing: Fix the casts that would result in incorrect values for big-endian systems (bnc#842915)
- Fencing: Apply correct score to the resource of group
- crm_resource: Wait for the correct number of replies when cleaning up resources (bnc#842204)
- cpg: Only process one message at a time to allow other priority jobs to be performed
- remote: Handle endian changes between client and server and improve forward compatibility
- crmd: A more reliable method of looking up migration options (bnc#838358)
- crmd: Allow non-CIB based throttling to be disabled (bnc#838358)
- crmd: Honor load thresholds lower than the cib maximum (bnc#838358)
- crmd: Tell the DC our job limit instead of the number of cores (bnc#838358)
- crmd: Track the CIB's CPU usage (bnc#838358)
- crmd: Fold the enforcement of migration-limit into the throttling code (bnc#838358)
- crmd: Don't start throttling until we're over the target threshold (bnc#838358)
- crmd: Do not send throttle updates to versions that don't support them (bnc#838358)
- ipc: Use the higher of the configured buffer size or the default
- crmd: Tweak the throttling threshold multipliers (bnc#838358)
- crmd: Simplify option processing for throttling options (bnc#838358)
- crmd: Simplify the logic for calculating the number of available cores (bnc#838358)
- crmd: Make the per-node action limit directly configurable in the CIB (bnc#838358)
- crmd: Tweak the throttling code based on migration-limit and/or LRMD_MAX_CHILDREN (bnc#838358)
- crmd: Slow down recovery on nodes with IO load (bnc#838358)
- crmd: Make the utilization limit configurable (bnc#838358)
- crmd: Use the load on our peers to know how many jobs to send them (bnc#838358)
- crmd: Notify peers of our relative load (bnc#838358)
- remote: Properly version the remote connection protocol
- crmd: Track CPU usage on cluster nodes (bnc#838358)
- ipc: Consolidate client/server flags and add version field to header
- ipc: Suppress asserts for proxied connections
- crmd: Do not block on proxied calls from pacemaker_remoted
- lrmd: Do not interrogate NULL replies from the server
- crm_mon: Reduce flickering in interactive mode
- fencing: Ignore changes to non-fencing resources
- cli: Do not enabled blackbox for cli tools
- crm_resource: Wait for all replies when cleaning up resources (bnc#842204)
- crm_mon: Correctly show the queued and exec times for an action
- crmd: Correctly update expected state when the previous DC shuts down
- crm_resource: Observe --master modifier for --move
- PE: Location constraints with role=Started should prevent masters from running at all
- Upstream version cs: 907f52608e97b4f280690618342e1377f184b554

-------------------------------------------------------------------
Tue Oct 22 15:03:31 UTC 2013 - schwab@suse.de

- Disable -Wcast-align on problematic files (bnc#845525)

-------------------------------------------------------------------
Tue Oct 22 10:50:29 UTC 2013 - ygao@suse.com

- iso8601: Prevent dates from jumping backwards a day in some timezones
- crm_master: Avoid sending redundant "--node" options to crm_attribute (bnc#846360)
- ipc: Client buffer size must never fall below our max read size
- ipc: Ensure buffer environment variable is read before setting max buffer len
- fencing: Deep copy current topology level list on remote op
- Upstream version cs: afdce1faecf82c778ed81eb5eb9b7518d36a1160

-------------------------------------------------------------------
Thu Oct 17 06:43:26 UTC 2013 - ygao@suse.com

- crm_resource: Wait for a reply for each request to crmd (bnc#842204)
- Upstream version cs: 7afb87c8caa96d3c1ed9a353ae6061023a729fd4

-------------------------------------------------------------------
Wed Oct 16 02:46:19 UTC 2013 - ygao@suse.com

- Cluster: On cluster signoff, make sure that the g_source gets disconnected.
- crmd: Using PCMK_ipc_buffer variable for remote-node proxy
- plugin: Reset the scheduling policy of daemons to SCHED_OTHER with nice value -10 (bnc#843647)
- ipc: Compress msgs based on client's actual max send size
- pengine: Do not probe for connection resources
- Upstream version cs: 490e695539630cfc158c5967a99237659fac5f30

-------------------------------------------------------------------
Thu Oct  3 01:58:54 UTC 2013 - ygao@suse.com

- fencing: Allow fencing for node after topology entries are deleted
- fencing: Do not broadcast suicide if the on action is being executed
- remote: Option to enable/disable probes on container resource remote-nodes
- lrmd: Correctly cancel monitor actions for lsb/systemd/service resources on cleaning up (bnc#842471)
- services: Fix the executing of synchronous actions
- Upstream version cs: 728ec77851540f9ce64ee1b1269d967841571b25

-------------------------------------------------------------------
Sun Sep 29 05:12:24 UTC 2013 - ygao@suse.com

- PE: Add a special attribute for distinguishing between real nodes and containers in constraint rules
- PE: Allow location constraints to take a regex pattern to match against resource IDs
- Bug rhbz#1011618 - Consistently use 'Slave' as the role for unpromoted master/slave resources
- cibadmin: Report errors during sign-off
- Fencing: Observe pcmk_host_list during automatic unfencing
- services: Prevent use-of-NULL when executing service actions
- crm_resource: Provide a meaningful error if --master is used for primitives and groups
- ipc: Raise the default buffer size to 128k (bnc#838358)
- Upstream version cs: ecd44e642db3b65ee83aceed0e93376894a58c47

-------------------------------------------------------------------
Wed Sep 25 06:37:41 UTC 2013 - lmb@suse.com

- plugin: stonith-ng needs membership updates (bnc#841010)
- controld: allow the stonith-enabled check to be overridden
  (bnc#842186, fate#315195)
- attrd: Avoid infinite write loop for unknown peers
- tools: Detect orphaned remote-nodes when setting attributes
- controld: don't start dlm if stonith-enabled is false (bnc#842186, fate#315195)
- pengine: Probe container nodes
- crmd: Tell attrd when remote-node is disconnected
- attrd: Give remote-nodes ability to set attributes with attrd
- Upstream version cs: c68919f46bbaa96ec4ff2c770f82588280277fe6

-------------------------------------------------------------------
Wed Sep 25 06:19:58 UTC 2013 - lmb@suse.com

- crmd: Expose "expected-quorum-votes" option in the metadata only for plugin-based clusters
- decode_transition_key: Older systems do not support '%ms' in
  sscanf
- cib: Guard against overly long user specified strings
- crm_shadow: Simplify prompt generation and impose a sane limit on
  length
- fencing: Skip empty notifications from the cib
- election: Do not update state when ACKs arrive
- cib: Additional logging for invalid diff updates
- cib: Correctly check for archived configuration files
- crmd: Reliably detect and act on reprobe operations from the policy
  engine
- crm_mon: Do not display duplicates of failed actions
- crm_node: Display partition output in sorted order
- cib: Allow values to be added/updated and removed in a single update
- attrd: Use the truely atomic version where CPG is used for cluster communication
- attrd: Untested reimplementation of a truely atomic attrd
- election: Track the election state and allow it to be queried
- crm_resource: Handle --ban for master/slave resources as advertised
  (rhbz#902407)
- xml: Location constraints are allowed to specify a role
- Review and refresh all patches to apply without fuzz.
- Upstream version cs: 144c2fc4b2f50623cbc87bf20788717e0b058a38

-------------------------------------------------------------------
Tue Sep 24 13:27:53 UTC 2013 - ygao@suse.com

- Rebase:
  * bug-728579_pacemaker-stonith-dev-id.patch
  * bug-806256_pacemaker-log-level-notice.patch
  * bug-812269_pacemaker-fencing-device-register-messages.patch

- Drop the patches that have been merged upstream:
  * pacemaker-node-maintenance.patch
  * pacemaker-node-maintenance-tests.patch
  * pacemaker-crmd-pending-delete.patch
  * pacemaker-resource.patch

- Drop the obsolete patches:
  * pacemaker-cts-startcmd.patch
  * pacemaker-disable-listing-fence-agents.patch
  * pacemaker-daemon-symlinks.patch
  * pacemaker-ptest-build.patch
  * pacemaker-lrmd-remote-disabled.patch
  * bug-815447_pacemaker-cib-strip-text-nodes.patch
  * bug-809635_pacemaker-xml-digest.patch

- Drop the obsolete source:
  * heartbeat-doc-1.0.tar.gz

-------------------------------------------------------------------
Tue Sep 17 08:48:47 UTC 2013 - ygao@suse.com

- spec: Recommends fence-agents and sbd

-------------------------------------------------------------------
Tue Sep 10 02:21:32 UTC 2013 - ygao@suse.com

- pengine: Properly handle orphaned multistate resources living on remote-nodes
- pengine: Map orphaned container fillers to container resource during shutdown to preserve ordering
- pengine: Do not attempt to probe resources on remote-nodes that are shutting down
- cib: Prevent potential double free in get_remote_uuid
- pengine: Properly shutdown orphaned remote connection resources
- crmd: Populate remote peer cache when building new cib
- crmd: Clear remote-node status AFTER start completes, not before.
- pengine: Probe resources on baremetal remote-nodes
- crmd: Remote-node fencing glue
- pengine: Allow fencing of baremetal remote nodes
- crmd: Cache baremetal remote-nodes
- tools: Fixes formatting of remote-nodes in crm_mon and crm_simulate
- Upstream version cs: d9bb7632492b1f91a300fb43e9ad8a262a8f2928

-------------------------------------------------------------------
Wed Sep  4 07:10:20 UTC 2013 - ygao@suse.com

- cib: Support XML comments in diffs (bnc#836965)
- Upstream version cs: 5d0a2239543bd5003444af4a16780ac47fd37079

-------------------------------------------------------------------
Mon Sep  2 11:24:55 UTC 2013 - ygao@suse.com

- crm_mon: add --hide-headers option to hide all headers
- pengine: Order demote/promote of resources on remote nodes to happen only once the connection is up
- tools: clear ncurses screen when crm_mon cannot connect
- crmd: Invalid formatting of log message causes crash
- remote: Properly handle expected late replies when TLS transport is in use.
- cluster: Allow remote-nodes to be cached
- Upstream version cs: a4eb44fd075e8cb8608f5e45522cade45658ff98

-------------------------------------------------------------------
Wed Aug 21 05:08:44 UTC 2013 - ygao@suse.com

- Fencing: Support agents that need the host to be unfenced at startup
- cpg: Correctly set the group name length
- pengine: Distinguish between the agent being missing and something the agent needs being missing (bnc#833374)
- crmd: Prevent PCMK_LRM_OP_NOT_INSTALLED for being mapped to PCMK_LRM_OP_ERROR
- Bug cl#5171 - PE: Don't prevent clones from running due to dependant resources
- services: Correctly invoke callbacks for aborted operations
- services: Preserve errno when handling exec failres least it be reset as a side-effect of other calls
- services: Prevent use-of-NULL in g_error_free
- services: Detect missing agents and permission errors before forking
- lrmd: Do not overwrite any existing operation status error
- crmd: Correcty update the history cache when recurring ops change their return code
- PE: Correctly account for the location preferences of things colocated with a group
- crmd: Gracefully handle actions that cannot be initiated
- crm_simulate: Do not complain about CRM_OP_REPROBE actions
- PE: Gracefully handle bad values for XML_ATTR_TRANSITION_MAGIC
- crm_mon: Correctly extract alternate name for pingd attributes
- Fix: Prevent use-of-NULL when ping resources do not define a host list
- Fix: Gracefully handle -ECHILD from waitpid() in crm_abort()
- Fix: Command-line tools should stop after an assertion failure
- systemd: Prevent glib assertion - only call g_error_free() with non-NULL arguments
- Upstream version cs: 4f672bc85eefd33e2fb09b601bb8ec1510645468

-------------------------------------------------------------------
Mon Aug  5 06:04:07 UTC 2013 - ygao@suse.com

- crmd: Don't add node_state to cib, if we have not seen or fenced this node yet
- PE: Do not allow colocation with blocked clone instances
- PE: Do not re-allocate clone instances that are blocked in the Stopped state
- fence_legacy: stonithd now handles killing the process group for us
- Fencing: On timeout, clean up the agent's entire process group
- fencing: Put all fencing agent processes into their own process group
- crmd: Prevent crash by passing log arguments in the correct order
- PE: Do not restart resources that depend on unmanaged resources
- crmd: Prevent recurring monitors being cancelled due to notify operations
- mcp: Fix so that only pacemakerd restarts, at the time of pacemakerd failure
- mcp: Support PCMK_fail_fast to reboot a machine at the time of process (subsystem) failure
- cpg: Ensure the CPG group is always null-terminated
- Upstream version cs: ac7aa1c94f317fc1d4024fbc09b012bc9f1b229e

-------------------------------------------------------------------
Fri Jul 26 02:49:48 UTC 2013 - ygao@suse.com

- Update to version 1.1.10
- crm_resource: Allow options to be set recursively
- cib: Correctly read back archived configurations if the primary is corrupted
- mainloop: Hand the channel off to g_io_watch and forget it.
- mainloop: Force removal of ipc fd in dispatch_del callback
- crmd: Clean up handling of pending operations at shutdown and improve logging
- Bug cl#5161 - crmd: Prevent memory leak in operation cache
- cib: Ensure we set up hacluster's groups in stand-alone mode
- Upstream version cs: 368c72641139785ec5981813f311fae8cd1410f3 (1.1.10)

-------------------------------------------------------------------
Mon Jul 22 05:28:01 UTC 2013 - ygao@suse.com

- cpg: Correctly free sent messages (bnc#853675, bnc#856018)
- crm_resource: Present an error if an admin tries to --force-start an already active resource
- cluster: Correctly construct the header for compressed messages (bnc#851951, bnc#856018)
- PE: Re-allow ordering constraints with fencing devices now that it is safe to do so
- cl#5170 - Correctly support on-fail=block for clones
- PE: Do the right thing when admins specify the internal resource instead of the clone
- fencing: Correctly detect existing device entries when registering a new one
- crm_node: Return 0 if --remove passed
- remove the mainloop_trigger that are no longer needed.
- corosync: Ensure removed peers are erased from all caches
- cluster: Detect and warn about node names with capitals
- Upstream version cs: 9abe6876d50ff2879f17b08dfa1500817a7fbeba

-------------------------------------------------------------------
Thu Jul 11 00:30:44 UTC 2013 - ygao@suse.com

- crmd: Prevent messages for remote crmd clients from being relayed to wrong daemons

-------------------------------------------------------------------
Wed Jul 10 12:43:46 UTC 2013 - ygao@suse.com

- lrmd: Prevent use-of-NULL in client library
- Upstream version cs: 9d656180294770e39deced79a134d4cf531b8159

-------------------------------------------------------------------
Wed Jul 10 08:33:31 UTC 2013 - ygao@suse.com

- Bug cl#5168 - Prevent clones from being bounced around the cluster due to location constraints
- Upstream version cs: 90b8afe77ab8a3ff2fd30826187fd7726aab4f04

-------------------------------------------------------------------
Tue Jul  9 14:32:31 UTC 2013 - ygao@suse.com

- crm_mon: Bug cl#5167 - Only print "stopped" node list for incomplete clone sets
- Upstream version cs: d16f4c56b120c5ae761680cfb4d98922a185c6c2

-------------------------------------------------------------------
Thu Jul  4 14:09:36 UTC 2013 - ygao@suse.com

- Fix: memory leak when used score2char()
- Fencing: Avoid hashtable lookups in NULL
- Fencing: Force use of the calculated command for support ops
- Bug cl#5157 - Allow migration in the absence of some colocation constraints
- PE: Detect constraints with inappropriate actions (ie. promote for a clone)
- PE: Do the right thing when admins specify the internal resource instead of the clone
- Fencing: User-defined arguments always trump calculated ones
- cluster: Correctly remove duplicate peer entries
- Upstream version cs: 0dc3203917438057ab476a0f0aac4a1c8e27f97a

-------------------------------------------------------------------
Wed Jul  3 02:32:22 UTC 2013 - ygao@suse.com

- plugin: Fix memory leaks
- Upstream version cs: 5053ba656a854bdf4eacaf7d43b0dce1b7e58b9d

-------------------------------------------------------------------
Tue Jul  2 04:14:55 UTC 2013 - ygao@suse.com

- plugin: Handle messages in the common way in the plugin dispatch function by default
- Upstream version cs: 704f45e36594018358b0ea9d578291af1d52196e

-------------------------------------------------------------------
Sat Jun 29 18:02:34 UTC 2013 - lmb@suse.com

- plugin: Fix small memory leak

-------------------------------------------------------------------
Wed Jun 26 10:20:03 UTC 2013 - ygao@suse.com

- plugin: Change the function declaration in the plugin header
- crm_mon --neg-location drbd-fence-by-handler
- crm_mon -A: print_attr_msg needs to lookup paramters, not meta
- crm_mon -A: fix memleak, add g_free_list(attr_list)
- crmd: CID#1036761 Dereference null return value
- Corosync: CIB#1036763 Dereference before null check
- Tools: CID#1036764 Unused pointer value, CID#1036762 Resource leak
- Tools: CID#1036760 Truncated stdio return value
- PE: Delete the old resource state on every node whenever the resource type is changed (bnc#822233)
- Upstream version cs: 61e4b8f62b109ca5b910efd38c7e79ef403030fd

-------------------------------------------------------------------
Fri Jun 21 04:44:12 UTC 2013 - ygao@suse.com

- crmd: Ensure operations for cleaned up resources don't block recovery (bnc#825536)
- logging: If SIGTRAP is sent before tracing is turned on, turn it on
- membership: Correctly merge partial entries in the peer cache
- attrd: Fixes deleted attributes during dc election
- crmd: Stop trying to fence when no devices exist capable of fencing a node
- PE: Allow active nodes in our current membership to be fenced without quorum
- PE: If fencing is unavailable or disabled, block further recovery for resources that fail to stop
- crm_resource: Avoid whitespace in transition keys when cleaning up and failing resources (bnc#851308)
- crmd: Everyone who gets a fencing notification should mark the node as down (bnc#842915)
- crmd: Initiate node shutdown if another node claims to have successfully fenced us (bnc#842915)
- crm_resource: Correctly implement --master
- crm_resource: Support OCF tracing when using --force-(check|start|stop)
- lrmd: Make lrmd and pacemaker_remoted in charge of setting up rsc state folder
- Allow uuid retrieval for nodes with no known name
- crmd: Update the status section with details of nodes for which we only know the nodeid
- crm_error: Add the ability to list and print error symbols
- crmd: Further improve clean shutdowns
- Core: Ensure the blackbox is saved on abnormal program termination
- crm_mon: Implement the ability to change the display options during operation.
- Upstream version cs: 6ea4b7ef34ce6e17f53f69d87a404d334db5d837

-------------------------------------------------------------------
Wed Jun 19 08:45:46 UTC 2013 - ygao@suse.com

- xml: Purge diff markers even if there's no digest (bnc#824097)

-------------------------------------------------------------------
Wed Jun 19 08:32:15 UTC 2013 - ygao@suse.com

- crmd: Prevent use-of-NULL during emergency shutdown
- crmd: Ensure all membership operations can complete while trying to cancel a transition
- Repair handling of attrd_update_delegate() return codes
- attrd: Correctly detect successful invocation of attrd_update()
- Convert all exit codes to positive errno values
- crm_attribute: Send details on duplicate values to stdout
- crm_attribute: Return the actual error code rather than the negative of it
- crm_resource: Implement the --master option for the --move,--ban,--clear commands
- crm_resource: Make --move without --host a true alias for --ban without --host
- crm_resource: Implement --ban for moving resources away from nodes and --clear (replaces --unmove)
- cib: Allow multiple children to be removed from the object root (eg. constraints)
- crmd: Prevent use-after-free now that mainloop terminates naturally
- mainloop: Saner ordering of reference counting events in mainloop_destroy_trigger()
- Correctly calculate crm_system_name
- Core: Tolerate NULL in mainloop_destroy_trigger()
- crmd: Allow mainloop to terminate naturally on graceful shutdown
- crmd: Use standard error codes on exit
- Ensure anything we free at shutdown is set to NULL too
- Ensure crm_system_name is cleaned up at exit for valgrind
- crmd: Ensure timers are stopped at exit
- Fencing: Ensure API object is consistently free'd
- Clean up internal mainloop structures at exit
- Core: Correctly unreference GSource inputs
- crmd: Clean up more memory before exit
- crmd: Do not get stuck in S_POLICY_ENGINE if a node we couldn't fence returns
- Upstream version cs: 47ed85ac6f4a9ac353945ae8bc4d7cea98b7cb7a

-------------------------------------------------------------------
Tue May 28 08:50:43 UTC 2013 - ygao@suse.com

- PE: Mark unrunnable stop actions as "blocked" (bnc#816511)
- crm_resource: Do not crash when calling --force-start on an invalid resource
- ping: Ensure OCF_RESKEY_failure_score has a value (bnc#831327)
- PE: Unlink pengine output files before writing.
- Fencing: Restore the ability to manually confirm that fencing completed (bnc#843699)
- Fix: Resolve several memory leaks and improper dereferencing of pointers
- PE: cl#5155 - Block the stop of resources if any depending resource is unmanaged (bnc#816511)
- crmd: Insert async failures so that they appear in the correct order
- cl#5151 - Ensure node names are consistently compared without case
- crmd: Block after 10 failed fencing regardless of crmd-transition-delay
- PE: Re-initiate _active_ recurring monitors that previously failed but have timed out
- cl#5133 - PE: Correctly observe on-fail=block for failed demote operation
- PE: Suppress meaningless IDs when displaying anonymous clone status
- PE: Display a list of nodes on which stopped anonymous clones are not active instead of meaningless clone IDs
- PE: Correctly handle resources that recover before we operate on them
- Core: Detect child processes that terminate before our SIGCHLD handler is installed
- Upstream version cs: 674e69854a0ce4636ee54e123e45b1612c8f1fd5

-------------------------------------------------------------------
Thu May  9 14:58:19 UTC 2013 - ygao@suse.com

- crmd: Do not record pending delete operations in the CIB

-------------------------------------------------------------------
Sat May  4 01:31:38 UTC 2013 - ygao@suse.com

- cib: Strip text nodes on writing CIB to disk (bnc#815447, bnc#809635)
- xml: Use xmlNodeDump() from libxml2 when calculating digest (bnc#809635)

-------------------------------------------------------------------
Fri May  3 08:35:25 UTC 2013 - ygao@suse.com

- PE: Ensure per-node resource parameters are used during probes
- cl#5154 - Do not expire failures when on-fail=block is present
- Upstream version cs: 2db99f16fe9b19a6320db62755f0f28ced8efe00

-------------------------------------------------------------------
Thu May  2 03:59:20 UTC 2013 - ygao@suse.com

- cl#5153 - Correctly display clone failcounts in crm_mon
- crmd: Simplify the logic for resetting node status in the CIB after fencing events (bnc#812913)
- crmd: cl#5152 - Correctly clean up fenced nodes during membership changes (bnc#812913)
- ipc: Reference the correct type when inspecting IPC messages
- Core: Ensure the last field in transition keys is 36 characters
- crm_mon: Check if a process can be daemonized before forking so the parent can report an error
- crm_mon: Ensure stale pid files are updated when a new process is started
- extra: add failure_score parameter into ping RA
- crm_resource: Allow --cleanup without a resource name
- Upstream version cs: 3297085490c2fe0af25fc805d2b53123da877f7a

-------------------------------------------------------------------
Thu Apr 18 08:08:51 UTC 2013 - ygao@suse.com

- fencing: Drop the severity of the messages on registering a stonith device (bnc#812269)

-------------------------------------------------------------------
Thu Apr 18 07:09:27 UTC 2013 - ygao@suse.com

- crmd: Ensure we return to a stable state if there have been too many fencing failures
- fencing: Prevent empty call-id during notification processing
- crm_resource: Make --refresh and --reprobe an alias for --cleanup [--resource name]
- crmd: Indicate completion of refresh to callers
- crmd: Indicate completion of re-probe to callers
- crm_resource: Allow individual resources to be reprobed
- ipc: Allow unpriviliged clients to clean up after server failures
- crmd: Only performa dry run for deletions if built with ACL support
- Upstream version cs: a92f3a0e327da2af171856c979fb8eaa00122534

-------------------------------------------------------------------
Wed Apr 17 05:34:18 UTC 2013 - ygao@suse.com

- crmd: Fixes hash table assert when resetting stonith failures
- crmd: Fixes memleak in failure cleanup
- crmd: Do not update fail-count and last-failure for old failures (bnc#804003)
- tools: cibadmin - Do not log for query commands by default (bnc#813045)
- services: Fix signal FD leak
- Upstream version cs: d63c13cbcde7663cfae9bb412583ad11914b6acc

-------------------------------------------------------------------
Thu Apr  4 03:42:40 UTC 2013 - ygao@suse.com

- tools: crm_mon - Prevent segfault on reconnecting cib (bnc#813131)

-------------------------------------------------------------------
Mon Apr  1 10:27:14 UTC 2013 - ygao@suse.com

- Fix: tools: crm_mon - Print a timing field only if its value is non-zero (bnc#809313)

-------------------------------------------------------------------
Mon Apr  1 07:44:56 UTC 2013 - ygao@suse.com

- tools: crm_mon - Save relevant cib XML into /tmp/cmon.* files if refreshing fails (bnc#800323)

-------------------------------------------------------------------
Fri Mar 29 08:06:16 UTC 2013 - ygao@suse.com

- fencing: Directly query the full cib on updating the cib cache (bnc#812269)

-------------------------------------------------------------------
Fri Mar 29 03:33:25 UTC 2013 - ygao@suse.com

- cib: Use unique error codes for write_cib_contents()
- Fix: Ensure custom error codes are less than 256
- corosync: cl#5148 - Correctly remove a node that used to have a different nodeid (bnc#805278)
- Upstream version cs: e8caee88c9e078fccf98a9da05543b73d4696f04

-------------------------------------------------------------------
Thu Mar 28 16:55:11 UTC 2013 - ygao@suse.com

- services: Improve the performance of synchronous actions (bnc#803969)

-------------------------------------------------------------------
Wed Mar 27 14:11:11 UTC 2013 - ygao@suse.com

- lrmd: Change the default directory for nagios plugins (bnc#812005)

-------------------------------------------------------------------
Wed Mar 27 08:00:17 UTC 2013 - ygao@suse.com

- xml: Prevent lockups by setting a more reliable buffer allocation strategy
- fencing: Fix memory leaks and invalid read
- fencing: Correctly unpack device parameters before using them
- lrmd: Avoid memory leak in resources_action_create()
- Skip WNOHANG when waiting after sending SIGKILL to child processes
- fencing: Fail the operation once all peers have been exhausted
- Fix several use-after-free and use-of-NULL
- fencing: Correctly filter devices when no nodes are configured yet
- ipc: Restore the ability for members of the haclient group to connect to the cluster
- Fencing: Re-use the policy engine libraries for filtering devices
- Upstream version cs: c7910371a5ada346fe7d1e1872ec9a40570018e6

-------------------------------------------------------------------
Mon Mar 25 03:05:54 UTC 2013 - ygao@suse.com

- corosync: Support "crm_node --remove" with a node name for corosync plugin (bnc#805278)
- Fix memory leaks in stonithd, crmd and lrmd
- services: Close the reading pipes when a synchronous action is finished
- Doc: Pacemaker Explained: Add nagios resource class
- Upstream version cs: cb7b3f48dea9eb1b6825242da2ef507887b409cc

-------------------------------------------------------------------
Tue Mar 12 11:39:23 UTC 2013 - ygao@suse.com

- Log: Change some messages to notice level (bnc#806256)

-------------------------------------------------------------------
Mon Mar 11 10:49:35 UTC 2013 - ygao@suse.com

- xml: Support nagios resource class in the 1.2 schema
- xml: Support resource container in the 1.2 schema

-------------------------------------------------------------------
Fri Mar  8 11:37:17 UTC 2013 - ygao@suse.com

- Update to version 1.1.9
- fencing: Only initiate topology based fencing if all topology queries have arrived
  AND we are still in the query phase
- fencing: Don't delay execution if all topology queries have arrived
- crmd: Bug cl#5144 - Do not updated the expected status of failed nodes (bnc#807824)
- Core: Support PCMK_logpriority to set syslog priority
- Upstream version cs: 2a917ddb9d1a01f47db84b17468413522d63ddfa

-------------------------------------------------------------------
Fri Mar  1 10:31:54 UTC 2013 - coolo@suse.com

- update license to new format

-------------------------------------------------------------------
Sat Jul 28 14:21:29 UTC 2012 - aj@suse.de

- Include sys/resource.h for getrlimit etc.

-------------------------------------------------------------------
Wed Jun  6 08:15:34 UTC 2012 - ygao@suse.com

- Core: Revert to the original process flags for the support of
  rolling-upgrade
- PE: Bug cl#5059 - Use the correct action's status when calculating
  required actions for interleaved clones
- Upstream version cs: 61a079313275f3e9d0e85671f62c721d32ce3563

-------------------------------------------------------------------
Mon May 21 11:46:15 UTC 2012 - badshah400@gmail.com

- Use BuildRequires: libgnutls-devel instead of gnutls-devel for
  Factory in keeping with gnutls package naming changes.

-------------------------------------------------------------------
Fri Apr 20 07:14:26 UTC 2012 - ygao@suse.com

- corosync: Determine node state for plugin based cluster types
- tools: crm_node - Test stack membership only when displaying
  partition members
- Overhaul the way peers are determined to be sufficiently active
- PE: Observe the promotion score of probed resources
- crmd: Detect when peers have an incorrectly set process list
- corosync: Detect when the first corosync has not yet formed and
  handle it gracefully
- Corosync: Move deprecated corosync variants to their own file
- Upstream version cs: 4c8b599e6d79499f28f8178988d65fd33e0d9b24

-------------------------------------------------------------------
Thu Apr 19 12:22:14 UTC 2012 - ygao@suse.com

- Update to version 1.1.7
- crmd: cl#5057 - Restart sub-systems correctly (bnc#755671)
- corosync: Fix compilation when libqb is not available
- pengine: cl#5058 - Fixes issue with on-fail option on operation
  being ignored.
- tools: rhbz#754216 - Make crm_mon --as-xml option default to
  --one-shot mode
- cts: cl#5047 - Suppress cts badnews output related to fencing
  when fencing is expected.
- crmd: cl#5053 - Fixes fail-count not being updated properly.
- crmd: cl#5051 - Fixes file leak in pe ipc connection initialization.
- Tools: crm_simulate - Correctly detect status sections with
  duplicate node_state entries
- crmd: Detect when the quorum API isn't configured for corosync 2.0
- RA: controld - use the correct dlm_controld when membership comes
  from corosync directly
- Core: Fix the logging of XML and conditional corefile creation
  by asserts
- pengine: cl#5045 - Better handling of interrupted migrations.
- Build: rhbz#805147 - Use default value for HB_DAEMON_DIR define
  when clusterglue does not provide one.
- cib: Even with no peers, we still need to wait for connected
  clients to disconnect
- corosync: Fix complation warning when corosync doesn't use libqb
- cib: Determine when there are no peers to respond to our shutdown
  request and exit
- cib: Correctly shutdown in the presence of peers without relying
  on timers
- Corosync: Correctly disconnect from corosync variants
- cib: Ensure no additional messages are processed after we begin
  terminating
- Corosync: Reset connection variables after disconnect
- Core: Correctly track the length of a string without reading from
  uninitialzied memory (valgrind)
- PE: Fix memory leak in order_rsc_sets (valgrind)
- Tools: Fix memory leak in crm_simulate (valgrind)
- PE: Correctly locate crm_simulate for automated regression tests
- Core: Use the default schema location when PCMK_schema_directory
  is defined but empty
- PE: Correctly migrate a resource that has just migrated
- pengine: cl#5025 - Automatically clear failures when resource
  configuration changes.
- Fix a number of potential problems reported by coverity
- crmd: Also purge fencing results when we enter S_NOT_DC
- crmd: Correctly determine when a node can suicide with fencing
- PE: Bug rhbz#799070 - Report resources as active in crm_mon if
  they are located on an unclean node
- Upstream version cs: 023d3b183e77cfdb3699080b26d98ca4bc534c57

-------------------------------------------------------------------
Wed Apr 18 06:30:14 UTC 2012 - ygao@suse.com

- PE: Support of referencing resource templates in resource sets (bnc#729634)
- stonith: A "start" operation of a stonith resource does a "monitor" on the
  device beyond registering it
- PE: More validations on configurations related to resource templates
- Core: Bug cl#5027 - Fix compilation when libqb is not available
- PE: cl#5002 - increment_clone() does not terminate on invalid input
- PE: Indicate the difference between resources that are restarting
  and reloading
- crmd: Leave it up to the PE to decide which ops can/cannot be reload
- PE: Detect reloads of previously migrated resources
- Core: Bug cl#5016 - Prevent failures in recurring ops from being lost
- crmd: Bug cl#5015 - Remove the failed operation as well as the
  resulting fail-count and last-failure attributes
- Fencing: Supress errors when listing all registered devices
- PE: Reload of a resource no longer causes a restart of dependant resources
- Fencing: Implement support for advanced fencing topologies:
  eg. kdump || (network && disk) || power
- Fencing: Add support for fencing levels to the admin tool
- Fencing: Prevent duplicate free and uninitialized pointers
- Fencing: Correctly remove the fencing levels when requested
- Fencing: Not all devices might be running locally when creating a
  fencing level
- cib: Don't halt disk writes if the previous digest is missing
- Cluster: Hook up the callbacks to the corosync quorum notifications
- Corosync: Correctly extract the node id from membership udpates
- Core: Ensure signals are handled eventually in the absense of timer
  sources or IPC messages
- Corosync: Default to using the nodeid as the node's uuid (instead of uname)
- corosync: Consistently set the correct uuid with get_node_uuid()
- Fencing: Standardize on /one/ method for clients to request members
  be fenced
- Core: Strip text nodes from on disk xml files (bnc#769910)
- Tools: Implement crm_node functionality for native corosync
- corosync: Hook up CPG membership
- fencing: More gracefully handle failed 'list' operations for devices
  that only support a single connection
- corosync: Unset the process list when nodes dissappear on us
- corosync: Correctly infer lost members from the quorum API
- crmd: Election - perform the age comparison only once
- crmd: Remove rusage differences of less than a second from election
  calculations
- PE: Ensure post-migration stop actions occur before node shutdown
- fencing: Correctly remove a single fencing level for a target
- fencing: Add the fencing topology section to the 1.1 configuration schema
- corosync: Ensure we catch nodes that leave the membership, even
  if the ringid doesn't change
- corosync: Treat CS_ERR_QUEUE_FULL the same as CS_ERR_TRY_AGAIN
- crmd: Fast-track shutdown if we couldn't request it via attrd
- tools: Bug rhbz#754216 - Add XML as an output option to crm_mon
- Core: Correctly determine when an XML file should be decompressed
- corosync: Remove deprecated member of the CFG API
- fencing: Provide enough data to construct an entry in the node's
  fencing history
- pengine: cl#5014, Prevent asymmetrical order constraints from causing
  resource stops
- pengine: cl#5007, Fixes use of colocation constraints with multi-state
  resources
- PE: Bug cl#5038 - Prevent restart of anonymous clones when clone-max
  decreases
- PE: Bug rhbz#789397 - Failcount and related info should be reset
  or removed when the resource is deleted
- fencing: fence_legacy - Drop spurilous host argument from status query (bnc#750512)
- pengine: Bug cl#5000 - Implements ability to create rsc_order
  constraint sets such that A can start after (B || C) has started.
- Fencing: fence_legacy - Ensure port is available as an environment
  variable when calling monitor (bnc#750512)
- PE: Bug cl#5028 - Unmanaged services should block shutdown unless
  in maintainence mode (bnc#738882)
- Fix coverity defects in pengine, cib, stonith-ng and crm_resource
- Fix use-after-free in crmd, stonith-ng and crm_simulate
- Fix use-of-NULL in libcrmcluster and stonith-ng
- Fix segfaults in stonith-ng and xml.c
- Upstream version cs: 1e8a96ae55d6022f7036434b537938a1fa75a700

-------------------------------------------------------------------
Thu Mar 29 07:39:30 UTC 2012 - lmb@novell.com

- Add provides to identify support level for tickets (bnc#752241)

-------------------------------------------------------------------
Mon Mar 26 04:43:35 UTC 2012 - ygao@suse.com

- Resolve coverity RESOURCE_LEAK, REVERSE_INULL and UNREACHABLE defects

-------------------------------------------------------------------
Sun Mar 25 14:46:13 UTC 2012 - ygao@suse.com

- Tools: crm_simulate - Support to grant/revoke/standby/activate
  tickets from the new ticket state section (bnc#752241)

-------------------------------------------------------------------
Sun Mar 25 09:03:42 UTC 2012 - ygao@suse.com

- Tools: Add crm_ticket to be profiled by valgrind
- Tools: crm_ticket - Display the tickets that are referenced in
  rsc_ticket constraints but have never been granted yet (bnc#752241)
- Tools: crm_mon - Support to display tickets (bnc#752242)

-------------------------------------------------------------------
Sat Mar 24 10:51:24 UTC 2012 - ygao@suse.com

- PE: Move the ticket state section to
  "/cib/status/tickets/ticket_state" (bnc#752241)
- PE: Support to make tickets standby for relinquishing tickets
  gracefully (bnc#752241)
- Tools: Implement a new crm_ticket (bnc#752241)
- Tools: Update CLI regression tests for the new crm_ticket
- Tools: Add CLI regression tests for ticket standby state
- PE: Update regression tests for the new ticket state section
- PE: Support to make tickets standby for relinquishing tickets
  gracefully (regression tests)

-------------------------------------------------------------------
Tue Mar 20 10:11:52 UTC 2012 - ygao@suse.com

- Tools: crm_ticket - Granting/revoking tickets need user to confirm
  unless "--force" option is used (bnc#752269)

-------------------------------------------------------------------
Tue Mar 13 09:28:38 UTC 2012 - ygao@suse.com

- Tools: Implement the support of granting/revoking tickets for
  crm_simulate (bnc#752241)

-------------------------------------------------------------------
Tue Jan 17 05:33:09 UTC 2012 - ygao@suse.com

- Core: Move several new fields since v1.1.6 to the end of the data
  types for ABI compliance
- stonith: Default to 20s timeout for start and monitor operations of
  stonith resources which is same as "default-action-timeout" (bnc#733337)
- Tools: ptest - Fix "-X, --xml-text" option to handle a XML string as its
  argument (bnc#736212)
- cib: Fix segfault caused by destroying an already freed hash table (cl#5023)
- stonith: Expose IDs of stonith resources to stonith agents through
  "$CRM_meta_st_device_id" environment variable (bnc#728579)

-------------------------------------------------------------------
Mon Jan  9 08:26:22 UTC 2012 - tserong@suse.com

- Only include glib.h in plugin.h (don't directly use glib/ghash.h)

-------------------------------------------------------------------
Fri Dec 16 04:42:38 UTC 2011 - tserong@suse.com

- RA: add NodeUtilization
- stonith-ng: export stonith resource name to stonith agents
- crmd: Send out all of the meta parameters to lrmd for stop actions
  (bnc#715501)
- RA: Fix the metadata of HealthSMART and SysInfo RAs
- stonith: Longer default timeout/interval of operations for stonith
  resources
- Doc: many proof-reading improvements
- stonith: Fix the stonith timeout issue (cl#5009, bnc#727498)
- update the license information in pacemaker.spec (bnc#726795)
- xml: Add rsc_ticket support into "pacemaker-1.2" schema
- xml: Add resource template support into "pacemaker-1.2" schema
- tools: Avoid problems caused by differences between node name and
  uname -n
- PE: Resolve memory leak when retrieving failure counts
- Stonith: Implement a manual override for when nodes are known to be
  safely off
- PE: Implement limit number of concurrent live migrations (FATE#310118)
- PE: Implement referencing templates in constraints
- PE: Move master based on failure of colocated group
- Fencing: Support admin configurable timeouts for API operations
- Fencing: Support checking in-progress operations for all nodes
- don't package crm shell code
- add Requires: crmsh
- Build man pages and html versions (bnc#723680)
- Shell: template support
- Upstream version cs: b988976485d15cb702c9307df55512d323831a5e

-------------------------------------------------------------------
Sun Nov 20 06:47:28 UTC 2011 - coolo@suse.com

- add libtool as buildrequire to avoid implicit dependency

-------------------------------------------------------------------
Tue Sep 20 14:27:47 UTC 2011 - tserong@suse.com

- Upgrade to 1.1.6.
- PE: Demote from Master does not clear previous errors
- crmd: Prevent secondary DC fencing resulting from CIB updates
  that are lost due to elections
- crmd: Log duplicate DC detection as a WARNING not ERROR
- crmd: Bug lf#2632 - Correctly handle nodes that return faster
  than stonith (bnc#710314)
- Core: Treat GNUTLS_E_UNEXPECTED_PACKET_LENGTH as normal
  termination of a TLS session
- cib: Call gnutls_bye() and shutdown() when disconnecting from
  remote TLS connections
- cib: Remove disconnected remote connections from mainloop
- cib: Attempt a graceful sign-off for remote TLS connections
- Core: Ensure there is sufficient space for EOS when building
  short-form option strings (prevents segfault)
- Core: Fix variable expansion in pkg-config files
- PE: Resolve memory leak reported by valgrind
- PE: Fix memory leak for re-allocated resources reported by
  valgrind
- PE: Improve the merging with template's operations
- crmd: Allow nodes to fence themselves if they're the last one
  standing (lf#2584)
- stonith: Add an API call for listing installed agents
- stonith: Allow the fencing history to be queried
- stonith: Ensure completed operations are recorded as such in
  the history
- stonith: Support --quiet to display just the seconds since
  epoch at which a node was last shot
- stonith: Serialize actions for a given device
- stonith: Add missing entries to stonith_error2string() (missing
  error messages)
- Shell: geo-cluster support commands
- Shell: support for rsc_ticket
- Shell: let the pager decide how to handle output smaller than
  terminal
- Shell: look for log segments with more care and don't throw
  exception on seek (bnc#713939)
- Shell: several history improvements
- tools: crm_attribute - Update tickets directly to cib instead
  of through attrd
- Shell: support for LRM secrets in resource level
- Shell: enable removal of unmanaged resources (bnc#696506)
- Shell: add crm execute directory to the PATH if not already present (bnc#712605)
- Shell: update log patterns for history
- Shell: relax transition acceptance in history
- tools: crm_simulate - Send logging to stdout when additional detail is
  requested so that grep works as intended
- PE: Prevent services being active if dependancies on clones are not
  satisfied (bnc#707150)
- PE: Prevent resource shuffling when the 'utilization' placement
  strategy is used
- PE: Implement resource template
- fencing: Add support for --reboot to stonith_admin
- Fencing: Downgrade an error message for a valid scenario
- crmd: Ensure we do not attempt to perform action on failed nodes
  (bnc#703236, lf#2612)
- Fencing: admin - Disable stderr logging by default
- Fencing: Fix use-of-NULL by g_hash_table_lookup
- Tools: Correctly log corosync node IDs (lf#2621)
- pacemaker:ping: Incorporate fping functionality from Dan Urist
- crmd: Recurring actions shouldn't cause the last non-recurring action
  to be forgotten
- crmd: Do not wait for actions that were pending on dead nodes
- crmd: Cancel timers for actions that were pending on dead nodes
- PE: Correctly recognise which recurring operations are currently
  active
- PE: Ensure role is preserved for unmanaged resources
- PE: Ensure unmanaged resources have the correct role set so the
  correct monitor operation is chosen
- PE: Implement cluster ticket and deadman
- Build: Add crm_ticket into spec file
- Tools: crm_attribute - No need to determine the node for tickets
  management
- Tools: crm_mon crm_resource - Display the "operation_key" instead of
  the operation "id" if available (bnc#707201)
- CTS improvements.
- Shell: reimplement the history latest command (bnc#710958)
- Shell: Don't limit to last hour when examining hb_reports
- Shell: improve capture log slices for transitions (bnc#710907)
- Shell: allow specifying PE files as relative paths in order to
  disambiguate between PE inputs with the same number (bnc#710655)
- Shell: remove peinputs "get" and "list" subcommands, just use 'v' for the
  long listing (bnc#711060)
- Shell: remove transition "show" subcommand, if there is no subcommand
  it is assumed that the user wants to do "show" (bnc#711060)
- Shell: detect (and ignore) empty transitions
- Shell: review transition interface (bnc#710655)
- Fencing: Improved pcmk_host_map parsing
- Fencing: Consolidate pcmk_host_map into run_stonith_agent so that it
  is applied consistently
- Shell: Update regression tests for new stonith metadata
- pengine: Correctly determine the state of multi-state resources with a
  partial operation history
- Core: Cancelled and pending operations do not count as failed
- PE: Ensure restarts due to definition changes cause the start action
  to be re-issued not probes
- Fencing: Prevent use-of-NULL by g_hash_table_lookup
- Shell: Install support for pssh
- PE: Support of monitor op with role="Stopped"
- Shell: improve logic for when to use the pager
- Shell: don't print error on Broken pipe
- cib: Record and display the originator details of CIB changes for
  schema "pacemaker-1.2"
- crmd: Display the name and vlaue of the transient attribute(s) that
  caused a new transition
- stonith: Correctly handle synchronous calls
- PE: A demote operation is implied by the stonith operation (lf#2606)
- PE: Group migration after failures and non-default utilization
  policies (lf#2613, lf#2619)
- Shell: Include log file querying tools and "history" extension.
- Significant number of fixes for issues reported by Coverity.
- ais: Handle IPC error before checking for NULL data (bnc#702907)
- PE: save PE inputs again (bnc#703723)
- PE: Before migrating an utilization-using resource to a node, take off
  the load which will no longer run there (lf#2599, bnc#695440)
- cib: Record and display the originator details of CIB changes
- cib: Update "cib-last-written" for live CIB on a config change
- cib: Filter out unnecessary "update-*" fields on digest calculating
- doc: man page for crm
- cib: Check the validation version before adding the originator details
  of a CIB change
- PE: Don't log resource states unless debug is on
- Shell: implement -w,--wait option to wait for the transition to finish
- crmd: Store only the last and last failed operation in the CIB
- Core: Use pre-glib2-2.28 version of g_str_hash to ensure consistent
  score calculation for clone instances
- Shell: repair template list command
- PE: Optimize the placement strategy and handle stickiness for
  utilization-based placement correctly (bnc#669686)
- Shell: print error instead of warning and exit with 1 if a resource
  cannot be deleted (bnc#680401)
- Tools: attrd - Do not initiate updates for deleted attributes
- Tools: Make progress when attrd_updater is called repeatedly within
  the dampen interval but with the same value (lf#2528)
- tools: Do not pass bash specific switches to other SHELLs (lf#2556)
- crmd: Watch for config option changes from the CIB even if we're not
  the DC (lf#2509)
- PE: Prevent shuffling by choosing the correct clone instance to stop
  (lf#2574)
- PE: Avoid group restart when clone (re)starts on an unrelated node
  (lf#2581, bnc#681595)
- PE: Set reasonable default limits for the number of input files saved
- tools: Do not recursively look for resource meta attributes (lf#2563)
- PE: Do not write out duplicated input files (lf#2582)
- cib: Use SIGPIPE for re-enabling disk writes after an error (lf#2229)
- crmd: Fail actions that were scheduled for a failed/fenced node
  (lf#2559)
- Fencing: Clean up the metadata creation
- Stonith: Allow the fencing agent operations to be overridden on a
  per-device basis (lf#2557)
- Tools: crm_resource - Indicate master/slave state when querying the
  parent resource (lf#2477)
- Tools: crm_mon - Display the true number of configured resources
  (lf#2549)
- RA: Fix handling of 'devices' in the HealthSMART agent
- Shell: print warning if start or stop interval is not zero
- Shell: Check for violations of uniqueness for instance parameters
  during commit
- PE: Indicate resource failures even if on-fail="ignore"
- ais: Ensure we drain the corosync queue of messages when glib tells us
  there is input
- crmd: Catch fence operations that claim to succeed but did not really
- Core: Use pre-glib2-2.28 version of g_str_hash to ensure consistent
  score calculation for clone instances
- Shell: repair template list command
- Shell: node clearstate must flush LRM state too (bnc#653795)
- Upstream version cs: 9971ebba4494 (release 1.1.6)

-------------------------------------------------------------------
Fri Aug  5 06:09:30 UTC 2011 - tserong@novell.com

- Fix rpmlint non-ghost-in-var-run check (bnc#710272)

-------------------------------------------------------------------
Wed Feb  9 12:03:57 UTC 2011 - tserong@novell.com

- PE: Consolidate logging for resources active on multiple nodes
- PE: More accurate logging of restarts and recovery for master/slave
  resources
- PE: target-role alone is not sufficient to promote resources (lf#2544)
- ais: Ensure that process death is communicated to peer nodes (lf#2550)
- PE: Certain stop operations require STONITH, could overload the
  batch-limit otherwise (lf#2551, bnc#669229)
- PE: Suppress unnecssary assertion failure message (lf#2558,
  bnc#670983)
- Shell: Do not print XML for permission denied errors
- ACL: Support access control on "cleanup"
- crmd: Cancel recurring operations while we're still connected to the
  lrmd
- crmd: Suppress an ERROR by teaching fsa_action2string() about complex
  actions
- crmd: ACL: Prohibit non-privileged users to "fail" resources
- Core: Do not store last-run for recurring operations, since it is
  misleading
- Shell: fix logic for not printing the default monitor depth
- Doc: Add ACL documentation
- Upstream version cs: ecb6baaf7fc0

-------------------------------------------------------------------
Tue Feb  8 13:24:24 UTC 2011 - tserong@novell.com

- Upgrade from 1.1.2.1 to 1.1.5.  Note that the following changelog
  entries cover changes made in versions 1.1.3 and 1.1.4 as well.
- crmd: Cancel recurring operations while we're still connected to the
  lrmd
- crmd: Suppress an ERROR by teaching fsa_action2string() about complex
  actions
- PE: Consolidate logging for resources active on multiple nodes
- PE: More accurate logging of restarts and recovery for master/slave
  resources
- PE: target-role alone is not sufficient to promote resources (lf#2544)
- ais: Ensure that process death is communicated to peer nodes (lf#2550)
- PE: Certain stop operations require STONITH, could overload the
  batch-limit otherwise (lf#2551, bnc#669229)
- Shell: Do not print XML for permission denied errors
- Doc: Add ACL documentation
- Core: Do not store last-run for recurring operations, since it is
  misleading
- crmd: Purge status for resourcs that no longer live in the LRMd
  (lf#2536)
- Stonith: Teach stonith_admin to automagically obtain the current node
  attributes for the target from the CIB
- tools: Prevent use-of-NULL in crm_simulate (lf#2527)
- ACL: Convert uid directly with strtol() for avoiding unnecessary error
  logs
- Tools: Make unmanaged resources stand out in crm_simulate graphs
- PE: Correctly reconstruct the status of anonymous cloned groups
  (lf#2508)
- Core: Correctly parse the resource name from notificiation action IDs
  (lf#2511)
- crmd: Indicate the interval for the timer that just expired
- crmd: Reschedule the PE_START action if its not already running when
  we try to use it
- crmd: Ensure notify variables are accurate for stop operations
  (lf#2545)
- crmd: Implement reprobe natively in the crmd to avoid transition loops
  (lf#2533)
- crmd: Cancel recurring monitor ops at shutdown (lf#2309)
- PE: Don't imply colocation requirements when applying ordering
  constraints with clones (lf#2493)
- PE: Protect against constraints that require stonith devices to stop
  before 'normal' ones (lf#2529)
- PE: Prevent unstable clone placement by factoring in the current
  node's score before all others (lf#2544)
- Tools: Suport cibadmin --empty for creating a minimal CIB
- PE: Do not override configured clone stickiness values (lf#2445)
- PE: Avoid relying on stickness for stable clone placement (lf#2445)
- Shell: work around lrmd/lrmadmin blocking when not run as root or
  hacluster
- Shell: more lazy help system initialization
- Access control list support for pacemaker's shell and CIB.
- PE: Prevent segfault by validating the contents of ordering sets
  (lf#2495)
- PE: Prevent use-after-free resulting from unintended recursion when
  chosing a node to promote master/slave resources
- PE: Avoid flooding the logs with errors for orphan resources
  (lf#2518)
- cib: Add "enable-acl" property
- Shell: don't create empty optional sections (bnc#665131)
- xml: Add ACL support into pacemaker-1.2 and 1.1 schemata.
- RA: HealthSMART: Several fixes.
- RA: SysInfo: Allow a list of filesystems/devices to be queried for
  free space
- RA: ClusterMon: htmlfile is not mandatory (lf#2512)
- Shell: merge properties and rsc/op_defaults on load update (lf#2454)
- stonith: use ST_DEVICEID for short description
- Shell: combine crmd and PE meta-data (lf#2373,2419)
- PE: Only update the node's promotion score if the resource is active
  there
- PE: Only use the promotion score from the current clone instance
- Shell: ask for confirmation for node fence and clearstate (bnc#642268)
- Shell: insert sleep between stop and start in resource restart
- stonith: remove unnecessary logging
- Shell: fix exception when HOME is not set
- Shell: Allow creation of an empty shadow CIB ("cib new ... empty")
- Shell: Allow cibstatus to create new node status entries.
- Shell: fix rsc/op_defaults edit
- Shell: repair management of cloned groups
- Shell: wait for the stop transition to finish before invoking start in
  the resource restart command (lf#2516)
- PE: Correct target_rc for probes of inactive resources
- Tools: Prevent crm_resource commands from being lost due to the use of
  cib_scope_local
- PE: Prevent use-of-NULL resulting from variable shadowing spotted by
  Coverity
- Shell: allow adding node attributes in configure when the attributes
  set doesn't already exist
- Core: Repair reference to child-of-child after removal of
  xml_child_iter_filter from get_message_xml()
- Core: Remove extra calls to xmlCleanupParser resulting in use-after-free
- Core: Reinstate the logic that skips past non-XML_ELEMENT_NODE children
- Core: Update the default validation type to pacemaker-1.0
- Core: Prevent recently introduced use-after-free in replace_xml_child()
- crmd: Update failcount for failed promote and demote operations
- PE: Prevent use-of-NULL when there is status for an undefined node
- Shell: warn on non-existing nodes in location constraints (lf#2486)
- Shell: put completion bits into a separate module
- Shell: repair ability to display multiple property sets
- Build: Script for determining test coverage
- Remove usage of the xml_child_iter macro to obtain better information
  from tracing tools.
- Shell: Let crm_resource handle node & resource iteration during
  resource cleanup (skips down nodes: bnc#647378)
- PE: Avoid needless string compares
- cib: Fix a log message
- Core: Provide arguments to do_crm_log_alias() in the correct order
  when logging xml
- Add gcov support to spec file (disabled by default)
- crmd: Determin the target rc for an action once
- crmd: Prevent use of NULL by making copies of the operation's hash
  table
- Core: Turn off unneeded checks when applying a diff
- crmd: Allow operations in the PE state
- crmd: Ensure the CIB is always writable on the DC by removing a timing
  hole
- cib: Deprecate the set_slave_all() API call
- PE: Ensure fencing of the DC preceeds the STONITH_DONE operation
- PE: Complete all fencing before attempting atomic migrations
- stonith-ng: fix two memory leaks.
- Core: Preserve ordering when removing subtrees with a diff
- Tools: Calculate the digest after applying a diff
- Core: Correctly extract the version details from a diff
- cib: Drop the severity of a log message
- crmd: Don't abort transitions when probes are completed on a node
- PE: Try to ensure atomic migration ops occur within a single
  transition
- Core: Correctly compare against crm_log_level in the logging macros
- cib: Revert part of a recent commit that purged still valid
  connections
- PE: reduce logging severity for single rsc sets
- Core: Prevent use-after-free when creating a CIB update for a timed
  out action
- Shell: update shadow file directory processing
- Tools: crm_resource - Improved output when listing constraints
  relevant to a given resource
- Tools: crm_resource - Fix -x, the short form of --xml-file
- Tools: crm_resource - Include location constraints in -A|-a output
- Tools: crm_shadow - Avoid replacing the entire configuration
  (including status)
- PE: Prevent clones from being stopped because resources colocated with
  them cannot be active
- crmd: Include the correct transition details for timed out operations
- Core: Drop the compression limit (lf#2506)
- cib: Don't remove client's when notifications fail, they might just be
  too big (lf#2506)
- cib: Do not calculate changes for status updates that wont be
  broadcast
- cib: Speed up the establishment of remote connections
- crmd: All pending operations should be recorded, even recurring ones
  with high start delays
- stonith-ng: reduce logging.
- Core: Provide significant performance improvements by implementing
  versioned diffs and digests
- cib: Reject updates with a feature set greater than our own
- Core: Some performance enhancements when comparing xml objects
- crmd: Use the supplied timeout for stop actions
- Core: Ensure ordering is preserved when applying diffs
- crmd: There's no need to check the cib version from the 'added' part
  of diff updates
- crmd: Additional logging for the cause of new transitions
- cib: Drop invalid/failed connections from the client hashtable
- PE: Use the original digest algorithm for parameter lists
- cib: Ensure all diffs sent to peers have sufficient ordering
  information
- cib: Reduce unnecessary copying when comparing xml objects
- Core: Purge diff markers before calculating and comparing digests
- Core: Minor speedup when comparing xml objects
- cib: The feature set version check is only valid if the current value
  is non-NULL
- Tools: crm_resource - Ensure xml-related memory is cleaned up at exit
- Tools: crm_simulate - Ensure xml-related memory is cleaned up at exit
- PE: lf#2478 - Implement improved handling and recovery of atomic
  resource migrations
- PE: Fix memory leak when processing completed migration actions
- Large number of performance improvements to the Policy Engine and
  CIB.
- Core: Cache Relax-NG schemas - profiling indicates many cycles are
  wasted needlessly re-parsing them
- Core: Don't compress large payload elements unless we're approaching
  message limits
- Tools: crm_node - Fix the return code for operations on corosync
  clusters
- Stonith: Fix two memory leaks
- crmd: Record completed migrate ops in CIB status section as
  migrate_to/migrate_from, not as stop/start (lf#2481)
- PE: Fix typo leading to use-of-NULL in the new ordering code
  (bnc#653635)
- crmd: on version print everything to stdout
- stonith: cleanup children on timeout in fence_legacy
- Shell: use uname instead of id in nodes when building other ids
- Shell: add "clearstate" command for nodes
- crmd: Don't hide stop events that time out - allowing faster recovery
  in the presence of overloaded hosts
- PE: Use hashtables instead of linked lists for performance sensitive
  datastructures
- PE: Skip probe_resources() completely if probing is disabled
- PE: Obtain massive speedup by prepending to the list of ordering
  constraints (which can grow quite large)
- PE: Detect start/stop actions with intervals
- PE: Optimize the logic for deciding which non-grouped anonymous clone
  instances to probe for
- stonith: Use the timeout specified by the user
- stonith: Add the timeout at the top level where the
  daemon is looking for it (lf#2473)
- stonith: Ensure timeouts are included for fencing
  operations (lf#2473)
- Logging tuning
- crmd: Use an operation's interval when an invalid timeout was
  specified
- crmd: Use the correct define/size for lrm resource IDs
- Tools: Ensure the line we're grabbling the time from contains a time
- Tools: crm_simulate - Fix use-after-free in when terminating
- Stonith: Ensure stonith operations complete within the timeout and are
  terminated if they run too long (lf#2473)
- crmd: Prevent assertion failure for stop actions
- PE: Prevent segfault by ensuring the arguments to do_calculations()
  are initialized
- PE: Correct use-after-free
- Tools: crm_simulate - Resolve memory leak reported by valgrind
- PE: Ignore failed actions on nodes that have been shutdown
- crmd: Better logging of failed stonith operations (lf#2473)
- stonith: Gracefully handle remote operations that arrive late (after
  we've done notifications) (lf#2473)
- Tools: crm_simulate - Resolve memory leak reported by valgrind
- PE: Repair on-fail=block for groups and primitive
  resources (lf$2476)
- crmd: Ensure stop actions always have the relevant resource attributes
  (lf#2458)
- Tools: Fix assertion failure in crm_resource (lf#2456)
- PE: Do not demote resources because something that requires it can't
  run
- PE: Display managed/unmanaged state for resources when grouped by node
  in crm_mon (lf#2479)
- cib: Clean up disconnected remote connections (lf#2469)
- Tools: crm_mon - Only display attributes of online nodes (and sort
  them)
- RA: ping - Indicate that host_list is a required parameter in the
  metadata
- stonith: Prevent segfault by not looking up operations if the
  hashtable hasn't been initialized yet (lf#2461)
- Tools: Have crm_resource --locate indicate which instances are
  promoted (lf#2477)
- PE: Ensure resource op timeout takes precedence over op_defaults
  (lf#2474)
- Upstream version cs: bdd89e69ba54

-------------------------------------------------------------------
Thu Nov 18 00:56:14 CET 2010 - meissner@suse.de

- SUSE_ASNEEDED also during %install, if by chance we rebuild
  things in there.

-------------------------------------------------------------------
Mon Aug 16 20:08:41 UTC 2010 - lmb@novell.com

- cib: Allow backup files to proceed after wrap-around (bnc#630322)
- Upstream version cs: dfc6b2561373

-------------------------------------------------------------------
Mon Aug  9 20:17:36 UTC 2010 - lmb@novell.com

- stonith-ng: record exit code and log output for failed port list query
  (bnc#625594)
- Upstream version cs: 0db65fda4b15

-------------------------------------------------------------------
Fri Aug  6 13:24:07 UTC 2010 - lmb@novell.com

- Shell: print error if a resource is not found in stop/start/manage
  (bnc#627757)
- PE: Fix memory leak when unpacking recurring operations
- PE: Fix potential use-of-NULL when calculating the set of required
  actions
- Shell: set shadow directory properly (bnc#626638)
- Core: Enable coredumps properly for MCP and AIS plugin (lf#2463)
- Upstream version cs: 61360150595d

-------------------------------------------------------------------
Thu Aug  5 14:55:22 UTC 2010 - tserong@novell.com

- Explicitly require libglue2 to avoid potential conflict with
  libheartbeat2 (bnc#628243)

-------------------------------------------------------------------
Wed Jul 28 13:55:08 UTC 2010 - lmb@novell.com

- crmd: Prevent everyone from losing DC elections by correctly
  initializing all relevant variables
- crmd: Ensure we activate the DC timer if we detect an alternate DC
- PE: Wait until stonith is available, don't fall back to shutdown for
  nodes requesting termination
- Upstream version cs: e0d731c2b1be

-------------------------------------------------------------------
Wed Jul 21 10:15:37 UTC 2010 - lmb@novell.com

- PE: Correctly order clone startup after group/clone start
- stonith-ng: pass the configuration to the stonith program via
  environment variables; requires cluster-glue >= 1.0.6 (bnc#620781,
  CVE-2010-2496)
- Logging improvements.
- Upstream version cs: f9fbf97b0ce8

-------------------------------------------------------------------
Wed Jul 14 14:58:10 UTC 2010 - lmb@novell.com

- Shell: allow adding force parameter to resource migrate
- Shell: add the actions option to configure ptest (lf#2360)
- Shell: test early for duplicate elements in edit (bnc#620460)
- Shell: Use crm_attribute directly instead of the deprecated
  crm_standby and crm_failcount wrappers
- PE: Correctly detect when there is a real failcount that expired and
  needs to be cleared
- PE: Avoid creating invalid ordering constraints for probes that aren't
  needed
- PE: Include the prefix for clone children when printing the clone
- PE: Bug lf#2453 - Enforce clone ordering in the absense of colocation
  constraints (lf#2453, bnc#619581)
- crmd: Only log the failcount op if something is wrong
- crmd: Base DC election on process relative uptime
- crmd: Make sure we always poke the FSA after a transition to clear any
  TE_HALT actions
- crmd:  Make sure the membership cache is accurate after a sucessful
  fencing operation
- crmd: All nodes should see status updates, not just the DC
- stonith-ng: Advertise stonith-ng options in the metadata
- Core: Correctly unpack HA_Messages containing multiple entries with
  the same name
- ais: Sign everyone up for peer process updates, not just the crmd
- ais: Move the code for finding uid before the fork so that the child
  does no logging
- Upstream version cs: e9b2f255a20e

-------------------------------------------------------------------
Tue Jul  6 14:53:24 UTC 2010 - lmb@novell.com

- PE: Fail unmanaged resources should not prevent other services from shutting down (lf#1959)
- crmd: Handle asynchronous notification of resource deletion events (lf#2439)
- Shell: add support for classes to the providers command
- crmd: Pass in the correct result when processing synchronous resource deletion operations
- ais: Fix unterminated recursion in init_ais_connection()
- Tools: Make sure crm_resource waits for the completion of crmd operations it sent
- stonith: Support the poweron/poweroff actions (bnc#618798)
- stonith: Map poweron/poweroff back to on/off expected by the stonith
  tool from cluster-glue (bnc#618798)
- PE: Correctly handle pseudo action creation
- Tools: crm_node - Enable the -A parameter, the short form of --openais
- CLI: report bad ISO8601 duration specifiers (bnc#618808)
- crmd: Fix assertion failure when performing async resource failures
- crmd: Include the action for crm graph operations
- crmd: Allow non-DC nodes to clear failcounts too and tidy up logging
- Fix some valgrind reported leaks.
- Upstream version cs: ea6cdd9d9613

-------------------------------------------------------------------
Mon Jun 14 14:25:25 UTC 2010 - lmb@novell.com

- Shell: templates: clvm,ocfs2: add the fs/vg resource to the base
  group, add timeouts (bnc#605580)
- Shell: skip resource checks for property-like elements (lf#2420)
- Shell: on no id match the first of property-like elements (lf#2420)
- Shell: set proper ids for rsc/op_defaults (lf#2420)
- Shell: add exit codes for non-interactive use
- PE: No services should be stopped until probes finish (lf#2433)
- PE: Support clones in resource sets (bnc#586613, lf#2404, lf#2409)
- Tools: Allow ptest and crm_simulate to work with configs that lack a
  status section
- Core: Reduce logging for failed xpath searches
- PE: Support colocation sets with negative scores (lf#2435)
- PE: Ensure deallocated resources are stopped
- PE: Ordering dependencies on partially active groups not observed
  properly (lf#2422, bnc#607125)
- PE: If there are no compatible peers when interleaving clones, ensure
  the instance is stopped
- PE: Fix colocation for interleaved clones
- PE: Fix colocation with partially active groups
- PE: Don't overwrite existing meta attributes (like timeout) for notify
  operations (lf#2424)
- PE: stop-all-resources shouldn't apply to stonith resources (lf#2426)
- Fencing: Reduce stonith-ng logging (lf#2431)
- ais: Improved processing when the peer crmd processes join/leave
  (lf#2401)
- Tools: crm_resource - Report crmd connection errors
- Tools: Depreciate the 'pingd' daemon and resource agent in favor of
  ocf:pacemaker:ping
- cib: Fix the application of unversioned diffs
- Several valgrind + coverity issues fixed.
- Upstream version cs: 8b9ec9ccc506

-------------------------------------------------------------------
Tue Jun  8 02:43:35 UTC 2010 - tserong@novell.com

- Install crm shell and cts in $(pyexecdir) instead of $(pythondir)
  to ensure installation in /usr/lib64 on x86_64

-------------------------------------------------------------------
Tue May 18 06:30:42 UTC 2010 - tserong@novell.com

- Fix crm membership check (bnc#603685, reverts changesets
  6e6980376f01 and 2e096a41a5f9)
- Upstream version cs: e8717a29601a (1.1.2.1)

-------------------------------------------------------------------
Fri May 14 13:08:29 UTC 2010 - lmb@novell.com

- ais: fix list of active processes sent to clients (bnc#603685)
- Upstream version cs: 2e096a41a5f9

-------------------------------------------------------------------
Wed May 12 13:57:23 UTC 2010 - lmb@novell.com

- crmd: Prevent use-after-free of the stonith-ng connection (lf#2414)
- Core: Prevent use-after-free reported by valgrind when
  doing xpath based deletions (lf#2414)
- PE: Fix memory leaks reported by valgrind
- Core: Fix memory leak in replace_xml_child() reported by valgrind
- PE: Remove developemnt logging which mistakenly logged at "ERROR"
  level.
- Upstream version cs: b59c27dc114a (1.1.2)

-------------------------------------------------------------------
Mon May 10 13:19:09 UTC 2010 - lmb@novell.com

- crmd: Prevent use-after-free of the PE connection after it dies
  (lf#2414)
- Shell: support for clone instances in constraints (lf#2169)
- Upstream version cs: 42a5aa3413f4

-------------------------------------------------------------------
Mon May 10 09:52:28 UTC 2010 - lmb@novell.com

- Shell: new command default-timeouts to set default operation timeouts
  (bnc#479052)
- crmd: ais: Use the threadsafe version of getpwnam
- PE: Enforce mandatory promotion (colocation) constraints (lf#2403)
- PE: Don't complain about missing agents during probes of a-symetric
  clusters (lf#2410)
- Shell: don't error on missing resource agent with asymmetrical
  clusters (lf#2410)
- ais: Ensure the list of active processes sent to clients is always
  up-to-date
- PE: Allow constraints to apply to specific instances of clones
  (lf#2169)
- PE: Allow ordering constraints to apply to specific instances of
  clones
- PE: Clean up failcount after it expires (lf#2066)
- PE: Before starting utilization-using resources on a node, take off
  the load which will no longer run there (bnc#594782)
- PE: Don't be so quick to pull the trigger on nodes that are coming up
- crmd: Use global fencing notifications to prevent secondary fencing
  operations of the DC
- cib: Changes to group order are not detected or broadcast to peers
  (lf#2352)
- Core: Only use the named schema if the validation passes
- Shell: don't verify empty configurations (bnc#602711)
- crmd: Send erase_status_tag() calls to the local CIB when the DC is
  fenced, since there is no DC to accept them
- crmd: Include operation interval in logged action
- crmd: Arrange for only one node to clean up after a fenced DC node
- crmd: create the final directory too for resource agents (bnc#603190)
- Tools: crm_mon: refresh screen on terminal resize (bnc#589811)
- PE: Correctly locate clone instances by their prefix (lf#2412)
- ais: Make a better attempt at determining an accurate born-on value
  from corosync
- tools: crm_mon - Enable 'connectivity' mode for 'ping' resources too
- Upstream version cs: e8624c181a3f

-------------------------------------------------------------------
Tue Apr 27 08:54:11 UTC 2010 - lmb@novell.com

- Fix small error so that regression test suite passes.

-------------------------------------------------------------------
Tue Apr 27 03:07:40 UTC 2010 - ygao@novell.com

- PE: Before starting utilization-using resources on a node, take off
  the load which will no longer run there (bnc#594782)

-------------------------------------------------------------------
Mon Apr 26 10:03:44 UTC 2010 - lmb@novell.com

- PE: Don't create scaffolding for ordering sets with a single resources
  (bnc#586613)
- PE: Ignore colocation weights from clone instances
- PE: Print allocation scores as +/-INFINITY when appropriate
- Upstream version cs: fa1c810f1d1d

-------------------------------------------------------------------
Fri Apr 23 10:09:51 UTC 2010 - lmb@novell.com

- Fix regression test for build environment.
- Upstream version cs: c11e18619efd

-------------------------------------------------------------------
Wed Apr 21 13:25:26 UTC 2010 - lmb@novell.com

- Fix several memory leaks exposed by valgrind.
- Improve regression tests.
- Low: Fencing: Delay system initialization until after we handle
  possible metadata queries
- Tools: Do not print help on executing "crm_node -i"
- crm_simulate: Allow bringing new node online (bnc#591162)
- crmd: Improved detection of partially active peers (lf#2401)
- PE: Fix intra-set colocation and ordering (lf#2384)
- PE: Combine failcounts for all instances of an anonymous clone on a
  host (lf#2383)
- crmd: Add missing fields to the metadata for use by the shell
  (lf#2387)
- PE: Check for use-of-NULL in dump_node_scores()
- PE: Rewrite native_merge_weights() to avoid Fix use-after-free
- Upstream version cs: 2a90abe96048

-------------------------------------------------------------------
Mon Apr 12 11:09:09 UTC 2010 - lmb@novell.com

- Automated test case improvements.
- Upstream version cs: 536bf0b9d3ba

-------------------------------------------------------------------
Fri Apr  9 08:38:55 UTC 2010 - lmb@novell.com

- Shell: always reload status if working with the cluster (bnc#590035)
- Shell: add new regression tests
- Shell: don't allow empty attributes for properties/*_defaults
  (lf#2395)
- Shell: add another attribute not present in the crmd metadata
- Tools: crm_mon - Enable specification of community for SNMP traps
- PE: Ensure important options (notify, unique, etc) are always exposed
  during resource operations (lf#2391)
- Tools:  Support short form of crm_simulate --quorum (bnc#591168)
- ais: Convert endian for all of the integer fields in messages
  (bnc#472014)
- Upstream version cs: 80e0bb600e6c

-------------------------------------------------------------------
Wed Mar 31 19:18:35 UTC 2010 - lmb@novell.com

- Shell: Default to using the status section from the live CIB
  (bnc#592762)
- Upstream version cs: 739282ba9e2e

-------------------------------------------------------------------
Wed Mar 31 13:03:43 UTC 2010 - lmb@novell.com

- crmd: fix non-fatal assert in lrmd.c when resources are manually
  failed (bnc#590924)
- Upstream version cs: f77530201221

-------------------------------------------------------------------
Tue Mar 30 13:12:24 UTC 2010 - lmb@novell.com

- tools: crm_simulate - fix small xpath memory leak in inject_node_state
- Shell: templates: new sbd template
- Shell: templates: update apache documentation
- crmd: Do not ignore action timeouts based on FSA state (could cause
  transitions that never terminate)
- Upstream version cs: 322ff3419bc8

-------------------------------------------------------------------
Mon Mar 29 14:55:27 UTC 2010 - lmb@novell.com

- Shell: add two attributes not present in the crmd metadata, which
  broke "configure verify"
- Upstream version cs: 24ee74882b42

-------------------------------------------------------------------
Mon Mar 29 13:58:05 UTC 2010 - lmb@novell.com

- Shell: fix bad cib passed to crm_verify
- Upstream version cs: c02327f742a0

-------------------------------------------------------------------
Mon Mar 29 13:05:26 UTC 2010 - lmb@novell.com

- Shell: verify only changed elements on commit (bnc#590033)
- Shell: observe op_defaults when verifying primitives (bnc#590033)
- Shell: update meta attributes list
- Shell: verify meta attributes and properties (bnc#589867)
- Shell: fix wrong exit code setting logic in resource cleanup
- Shell/PE: Show utilization/capacity information (bnc#589873)
- Shell: implement new cibstatus interface and commands (bnc#580492)
- crmd: Do not allow the target_rc to be misused by resource agents
- Shell: check python version at start (lf#2369)
- extra/showscores.sh: Correctly display stickiness if unset
- RA: SystemHealth: exit properly when the required software is not
  installed (bnc#587940)
- ais: Look for the correct conf variable for turning on file logging
- crmd: Ensure the cluster terminates when the PE isn't available
  (lf#2379)
- crmd: Ensure we dont get stuck in S_PENDING if we loose an election to
  someone that never talks to us again
- Upstream version cs: 3fea355803af

-------------------------------------------------------------------
Fri Mar 19 19:59:58 UTC 2010 - lmb@novell.com

- crmd: Remove race condition that could lead to multiple instances of a
  clone being active on a machine
- PE: Consolidate and unify logging of fencing causes
- hb2openais: add support for corosync as target
- Shell: templates: add cmirror to ocfs2 and clvm (bnc#587493)
- Shell: support for resource/node utilization
- Shell: switch to single cibadmin for commit
- Shell: enable comments (lf#2221)
- Upstream version cs: 83f654529b5c

-------------------------------------------------------------------
Mon Mar 15 11:23:49 UTC 2010 - lmb@novell.com

- Shell: don't touch resources within a group when managing
  groups/clones
- Shell: repair node show (bnc#587883)
- Upstream version cs: 3002fabf85d4

-------------------------------------------------------------------
Wed Mar 10 15:16:33 UTC 2010 - lmb@novell.com

- PE: Make sure migration ops use the correct meta options (bnc#586710)
- Upstream version cs: aaf4d36b8494

-------------------------------------------------------------------
Tue Mar  9 21:39:20 UTC 2010 - dmuhamedagic@novell.com

- Shell: fix commit for new clones of new groups (bnc#585471)
- Shell: edit multiple meta_attributes sets in resource management (lf#2315)
- Shell: don't cache node and resource ids (lf#2368)
- Shell: new cibstatus import command (bnc#585471)
- Shell: check timeouts also against the default-action-timeout property

-------------------------------------------------------------------
Tue Mar  9 14:29:40 UTC 2010 - lmb@novell.com

- PE: Avoid needless restart of primitive depending on a clone (lf#2317,
  bnc#586613)
- PE: Only log orphans when they are found to be active (lf#2364)
- PE: Ensure clones observe mandatory ordering constraints if the LHS is
  unrunnable (lf#2361)
- Tools: Add utilization support for crm_attribute and crm_resource
- Upstream version vs: c23bbc5262b2

-------------------------------------------------------------------
Fri Mar  5 15:45:15 UTC 2010 - lmb@novell.com

- ais: Do not count votes from offline nodes and calculate current
  votes before sending quorum data.
- PE: Repair handling of unordered groups in RHS ordering constraints.
- Shell: update regression tests.
- CTS: Make it work for openais.
- Upstream version cs: a9f5a06a8f9e

-------------------------------------------------------------------
Thu Mar  4 09:57:38 UTC 2010 - lmb@novell.com

- Conflict with ocfs2-tools-o2cb prevented said package from being
  installed at all due to dependencies (bnc#582697).

-------------------------------------------------------------------
Wed Mar  3 19:46:15 UTC 2010 - lmb@novell.com

- Shell: implement lifetime for rsc migrate and node standby (lf#2353)
- Shell: node attributes update in configure (bnc#582767)
- Tools/PE: Do not warn if the configuration is fully
  forward-compatible.
- Upstream version cs: 745c756006da

-------------------------------------------------------------------
Mon Mar  1 12:04:11 UTC 2010 - lmb@novell.com

- Shell: update previous node lookup procedure to include the id where
  necessary
- Shell: improve batch mode.
- Shell: add support for xml in cli.
- Shell: repare clone/ms cleanup (bnc#583288)
- Shell: load update should update existing elements.
- crmd: expected-quorum-votes not correctly updated after membership
  change (lf#2359)
- PE: Fix master-master anti-colocation (lf#2358)
- Upstream version cs: 059e4095d2ca

-------------------------------------------------------------------
Wed Feb 24 10:15:57 UTC 2010 - lmb@novell.com

- Work around non-thread-safe setenv() calls that could cause a crash
  (bnc#582598)
- Upstream version cs: ae0170640c3e

-------------------------------------------------------------------
Tue Feb 23 15:35:05 UTC 2010 - lmb@novell.com

- Shell: update supported CIB RE to include pacemaker 1.1 and 1.2
- ais: Fix the child shutdown escalation logic
- Core: Give signal handlers higher priority
- PE: Correctly implement optional colocation between primitives and
  clone resources
- crmd: Don't send operation updates for deleted resources (bnc#578644)
- Upstream version cs: 530add2a3721

-------------------------------------------------------------------
Mon Feb 22 14:00:00 UTC 2010 - lmb@novell.com

- Shell: add tab completion for nodes (bnc#577003)
- Shell: fix wrong var reference
- Shell: improve configure commit (lf#2336)
- Shell: add tab completion for op/rsc_defaults (bnc#552541)
- Shell: add option to control sorting of cib elements (lf#2290)
- Shell: add tab completion for nodes (bnc#577003)
- RA: ping(d) - Fix metadata.
- xml schema: support differentiation between stable and experimental
  feature sets.
- Upstream version cs: 0591630c8bd3

-------------------------------------------------------------------
Thu Feb 18 22:04:16 UTC 2010 - lmb@novell.com

- Conflict with ocfs2-tools-o2cb; a system needs to be configured
  either for Pacemaker or O2CB/Oracle RAC, but never both.

-------------------------------------------------------------------
Thu Feb 18 14:27:00 UTC 2010 - lmb@novell.com

- stonith-ng: Fix meta-data not always being retrieved properly.
- Tools: crm: fix CIB upgrade command (bnc#578637)
- PE: Improved graphs when probing partially up nodes
- crmd: Improve handling of cancelled operations caused by resource
  cleanup (bnc#578644)
- PE: Significant performance bugs for larger clusters with many
  nodes/resources/constraints removed.
- Upstream version cs: 4bc7a38e2b10

-------------------------------------------------------------------
Tue Feb  9 10:27:47 UTC 2010 - lmb@novell.com

- Add dependencies on python and python-xml so the shell works
  immediately (bnc#578006).

-------------------------------------------------------------------
Mon Feb  8 15:07:35 UTC 2010 - lmb@novell.com

- Incorporate code for hard resource limits (FATE#303384) in shell and
  pacemaker policy engine.
- External stonith agents were not properly handled (bnc#577007).
- Upstream version cs: 46679a8feec7

-------------------------------------------------------------------
Fri Jan 22 10:36:45 UTC 2010 - lmb@novell.com

- crmd: Ensure we have the latest status after a transition abort
- crm: optimize shell start-up time (lf#2303).
- crm: simplify template for ocfs2
- crm: don't remove sets which contain id-ref attribute (lf#2304)
- crm: add update method to template apply (lf#2289)
- crm: make template new more robust, add documentation
- crm: fix check for invalid constraints
- crm: rename status to cibstatus (lf#2236)
- crm: save options if run from the command line (lf#2310)
- crm: add notify to the list of valid operations
- crm: fix node delete (lf#2305)
- crm_node: accept -f as the short form of --force
- crm_node: rovide a way to determin the nodeid of past cluster members
  (lf#2307)
- Upstream version cs: 6a6aa02deea9

-------------------------------------------------------------------
Mon Jan 11 15:49:30 UTC 2010 - lmb@novell.com

- PE: Don't log uninstalled resource agents as errors (lf#2251)
- fix refresh time for html interface of crm_mon
- Tools: crm: don't consider warnings as errors (lf#2274)
- Tools: crm: direct RA interface for ocf class resource agents
  (lf#2270)
- cib: Check also whether an user's primary group is matched
- PE: Bug lf#2153 - non-clones shouldn't restart when clones stop/start
  on other nodes
- PE: Bug lf#2153 - Update regression tests
- PE: Correctly anti-colocate with a group
- Tools: crm: define missing index in validate_template (lf#2287)
- Tools: crm: stay in crm if user specified level only (lf#2286)
- Tools: crm: fix exit code on single shot commands
- Tools: Bug lf#2286 - Allow the shell to accept template parameters on
  the command line
- Tools: crm: allow entering level and input file (-f)
- Tools: crm: relax check for RA existence (lf#2270)
- Tools: crm: fix OCF_ROOT processing
- Tools: crm: catch EOFError exception in raw_input (lf#2289)
- Tools: crm: implement -F (--force) option
- Tools: crm: rename some misnamed functions
- PE: Prevent non-multistate resources from being promoted through
  target-role
- Tools: crm: direct RA interface for stonith class resource agents
  (lf#2270)
- fencing: stonithd: ignore case when comparing host names (lf#2292)
- Tools: crm: direct RA interface for lsb class resource agents
  (lf#2270)
- PE: Bug lf#2153 - non-clones shouldn't restart when clones stop/start
  on other nodes - improved
- TE: Fix batch-limit processing.
- Tools: crm: exclude locations when testing for pathological
  constraints (lf#2300)
- PE: Only complain about target-role=master for non m/s resources
- Tools: crm: load help from crm_cli.txt
- pengine/crmd: move crm_log_init after version and metadata calls
  (lf#2272)
- crmd: Ensure batch-limit is correctly enforced
- PE: Don't overwrite the value of batch-limit
- cts: Add the 'cmd' to the output of external commands
- pengine: crmd: Ensure help text includes correct binary name
- Tools: crm: don't fall apart if there's no help text file
- Tools: crm: cache help tables (lf#2303)
- Upstream version cs: 443ff5d69319

-------------------------------------------------------------------
Thu Dec 10 18:46:03 UTC 2009 - "lmb@novell.com"

- PE: Correctly unpack ordering constraints for resource sets to avoid
  graph loops
- Two new system health RAs.
- PE: Don't log uninstalled resource agents as errors (lf#2251)
- Upstream version cs: cd2aaf7e35cf

-------------------------------------------------------------------
Tue Dec  8 08:44:07 UTC 2009 - "lmb@novell.com"

- Tools: crm: fix parentheses parsing in resource sets
- Tools: crm: support for description attribute in resources/operations
  (bnc#548690)
- Tools: hb2openais: add EVMS2 CSM processing (and other changes)
  (bnc#548093)
- Tools: crm: don't add score which doesn't exist
- Tools: crm: copy score from/to resource_set
- Tools: crm: update tab completion for constraints (support resource
  sets)
- Tools: crm: handle resource_set resource references in delete and
  rename
- PE: Provide a default action for resource-set ordering
- Tools: crm: drop empty attributes elements
- xml: Add stopped as a supported role for operations
- Tools: hb2openais: don't allow empty rules, clones, or groups
  (lf#2215)
- Tools: hb2openais: refuse to convert pure EVMS volumes
- Tools: hb2openais: add inf score to order constraints
- crm: Enhance "colocation" help to explain how it works.
- crm_mon: Mail subject needs space for \0 byte.
- fencing: stonithd: add metadata for stonithd instance attributes (and
  support in the shell)
- Tools: crm: drop short description from the metadata if it equals long
  description
- Tools: crm: relax checks for advertised monitor operations (lf#2222)
- Tools: crm: support for comments (lf#2221)
- Tools: crm: test operation name against a list of possible ops
- tools: Dont waste vertical space in crm_mon output
- xml: Treat node unames as text fields not IDs (bnc#552713)
- PE: rsc_order constraints always use score at the top level (lf#2206)
- xml: Create an always-true expression for empty rules when upgrading
  from 0.6 (lf#2215)
- PE: Clone ordering should be able to prevent startup of dependant
  clones (lf#2209)
- PE: Add regression test (lf#2209)
- PE: Correctly identify the state of anonymous clones when deciding
  when to probe (lf#2216)
- PE: Operations that require fencing should wait for 'stonith_complete'
  not 'all_stopped'. (lf#2225)
- PE: Prevent clone peers from stopping while another is instance is
  (potentially) being fenced (lf#2225)
- crmd: C_TIMER_POPPED is now quite normal thanks to the recheck timer,
  downgrade log message
- PE: Silently fix requires=fencing for stonith resources so that it can
  be set in op_defaults
- xml: Preserve the old stonith-enabled=false symantics from 0.6 during
  an upgrade (lf#2230)
- xml: Allow the auto-id base to be specified, because generate-id()
  isn't always unique
- PE: Ensure groups process location constraints so that clone-node-max
  works for cloned groups (lf#2213)
- Tools: crm: relax check for RA actions
- Upstream version cs: 9f61f272598a

-------------------------------------------------------------------
Tue Nov  3 23:00:00 UTC 2009 - "lmb@novell.com"

- PE: Provide better defaults for lt(e) and gt(e) comparisons
  (bnc#515172)
- Upstream version cs: 405fe9a92d82

-------------------------------------------------------------------
Tue Sep 29 06:35:15 UTC 2009 - "lmb@novell.com"

- Revert conflicts with ocfs2-tools-o2cb to ease automatic upgrades. The
  two should still not be installed in parallel; please see release
  notes!
- High: ais: Gracefully handle changes to the AIS nodeid
- Low: PE: Fix the metadata to advertise the correct type for
  stonith-timeout
- High: cib: Repair the ability to connect to the cluster from
  non-cluster machines
- Medium: Tools: Use -q as the short form for --quiet (for consistency)
- Medium (bnc#520707): Tools: crm: new templates ocfs2 and clvm
- Medium (LF 2185): Tools: crm: add resource promote/demote commands
- Low (LF 2175): Tools: crm: add help for node status
- High: xml: Mask the "symmetrical" attribute on rsc_colocation
  constraints (bnc#540672)
- Upstream version cs: 05c8b63cbca7

-------------------------------------------------------------------
Thu Aug 27 15:58:01 UTC 2009 - "lmb@novell.com"

- Upstream version cs: 595cca870aff
- Dev: Tools: crm: do not allow empty attribute names
- Low: Tools: crm: make check for operations id attribute stricter
- Dev: Tools: crm: implement binary op types properly (thanks to Alain
  St-Denis)
- Dev: Tools: crm: allow id-refs to stand by themselves (update for fix
  37077ed56af5)
- High: crmd: Terminate if we are ever evicted from the membership
- High: crmd: Unset any existing DC value before querying for a new one
- High: PE: Bug bnc#515172 - Fix the boolean-op attribute of rules
- High: PE: Bug bnc#515172 - Correctly process location constraint rules
  which contain multiple expressions
- High (bnc#507255): Tools: crm: implement date expressions
- Low: Tools: crm: let the user know that curses is needed for colors
- High: Tools: crm: new display type (uppercase keywords)
- Medium: Extra: Add tools, an RA and tests for the System Health
  feature
- Medium: Tools: crm_resource - Prevent use-of-NULL by requiring a
  resource name for the -A and -a options
- Medium: PE: Prevent use-of-NULL in find_first_action()
- High: PE: Only prevent migration if the clone dependancy is
  stopping/starting on the target node
- Low: crmd: Include cib version of the updates which caused a
  transition abort
- High: PE: Bug lf#2160 - Dont shuffle clones due to colocation
- Low: PE: Fix find_first_action() when no node filter is specified
- Low: PE: ptest - Suppress deleted ordering constraints from the .dot
  graph
- High: PE: New implementation of the resource migration (not
  stop/start) logic
- Medium: crmd: Note that dc-deadtime can be used to mask the brokeness
  of some switches
- High: Tools: crm_resource - Advertise --move instead of --migrate
- Medium: Extra: New node connectivity RA that uses system ping and
  attrd_updater
- High: crmd: Bug bnc#527530 - Wait for the transition to complete
  before leaving S_TRANSITION_ENGINE
- High: ais: Avoid excessive load by checking for dead children every 1s
  (instead of 100ms)
- Medium: PE: Stop ptest from logging to syslog
- Medium: PE: Correctly log resources that would like to start but can't
- High: PE: Bug lf#2171 - Prevent groups from starting if they depend on
  a complex resource which can't
- Low: PE: Add regression test for lf#2171
- High: PE: Bug lf#2170 - stop-all-resources option had no effect
- High: PE: Disable resource management if stonith-enabled=true and no
  stonith resources are defined
- High: Core: Bug lf#2169 - Allow dtd/schema validation to be disabled
- Medium: PE: Bug lf#2180 - Include node information for all failed ops
- Medium: PE: Bug lf#2178 - Indicate unmanaged clones
- Medium: ais: Include version details in plugin name
- High: PE: Bug lf#2106 - Not all anonymous clone children are restarted
  after configuration change
- Medium: ais: Attempt to enable core file generation if it was disabled
- Medium: crmd: Requery the resource metadata after every start
  operation
- High: Tools: crm: add semantic checks depending on the meta-data from
  resource agents

-------------------------------------------------------------------
Thu Aug 13 14:48:06 CEST 2009 - abeekhof@suse.de

- Update source tarball to revision: b05d5a2b9c52
  + High (bnc#507255): Tools: crm: implement date expressions
  + High: Build: Fix compilation when snmp and esmtp are not available
  + High: PE: Bug 2160 - Dont shuffle clones due to colocation
  + High: PE: Bug bnc#515172 - Correctly process location constraint rules which contain multiple expressions
  + High: PE: Bug bnc#515172 - Fix the boolean-op attribute of rules
  + High: PE: New implementation of the resource migration (not stop/start) logic
  + High: PE: Only prevent migration if the clone dependancy is stopping/starting on the target node
  + High: Tools: crm: new display type (uppercase keywords)
  + High: Tools: crm_resource - Advertise --move instead of --migrate
  + High: ais: Fix cluster connection when using corosync 1.0
  + High: ais: Ubuntu needs a leading zero for directory modes
  + High: crmd: Terminate if we are ever evicted from the membership
  + High: crmd: Unset any existing DC value before querying for a new one
  + Medium: Extra: Add tools, an RA and tests for the System Health feature written by Mark Hamzy
  + Medium: Extra: New node connectivity RA that uses system ping and attrd_updater
  + Medium: PE: Prevent use-of-NULL in find_first_action()
  + Medium: Tools: crm_resource - Prevent use-of-NULL by requiring a resource name for the -A and -a options
  + Medium: crmd: Note that dc-deadtime can be used to mask the brokeness of some switches

-------------------------------------------------------------------
Thu Aug 13 12:29:37 UTC 2009 - lmb@novell.com

- Remove references to heartbeat packages.

-------------------------------------------------------------------
Mon Aug  3 14:00:07 UTC 2009 - lmb@novell.com

- Require python-curses for CLI color support.

-------------------------------------------------------------------
Tue Jul 21 14:27:31 CEST 2009 - lmb@novell.com

- Update to 0123af21a705.

-------------------------------------------------------------------
Mon Jul 13 12:51:34 CEST 2009 - lmb@novell.com

- Prevent pacemaker from being installed along with ocfs2-tools-o2cb to
  reduce likelihood of misconfiguration (bnc#520721).

-------------------------------------------------------------------
Wed Jul  8 17:00:00 CEST 2009 - lmb@suse.de

- Build: properly install crm_standby, crm_failcount, crm_master.

-------------------------------------------------------------------
Wed Jul  8 10:45:00 CEST 2009 - lmb@suse.de

- Update source tarball to revision: b05d5a2b9c52
  + High: Core: Show help text and exit with rc 1 if option processing failed
  + High: PE: Fix reload for master/slave resources
  + High: Tools: Differentiate between --help and an unknown option
  + High: Tools: crm: support for color output
  + High: lrm: Look in the correct location for stonith agents
  + Low: Core: Reduce logging noise
  + Low: Tools: Ensure crm_resource -q prints a trailing newline
  + Low: Tools: ptest no longer supports --xml-pipe
  + Low: Tools: remove spurios newline output to stderr
  + Low: ais: Better handling of to_file: and to_syslog: options
  + Low: ais: set HA_LOGFACILITY too
  + Low: extra: Add a dummy parameter to 'Dummy' so we can test reload
  + Medium: Tools: crm: fix the verify exit code properly
  + Medium: cib: Supply an empty status section for replace operations
  + Dev: Tools: crm: recreate constraints on grouping resources

-------------------------------------------------------------------
Wed Jun 10 16:05:25 CEST 2009 - abeekhof@suse.de

- Update source tarball to revision: Pacemaker-1.0.4
  + High: ais: bnc#488291 - don't rely on byte endianness on ptr cast
  + High: Tools: bnc#507255 - crm: import properly rsc/op_defaults
  + High: Tools: lf#2114 - crm: add support for operation instance attributes
  + High: ais: Bug lf#2126 - Messages replies cannot be routed to transient clients
  + High: attrd: Support the value++ and value+=... syntax required for failcounts
  + High: cib: Fix huge memory leak affecting heartbeat-based clusters
  + High: Core: Generate the help text directly from a tool options struct
  + High: crmd: Bug lf#2120 - All transient node attribute updates need to go via attrd
  + High: crmd: Fix another large memory leak affecting Heartbeat based clusters
  + High: PE: Bug bnc#495687 - Filesystem is not notified of successful STONITH under some conditions
  + High: PE: Make running a cluster with STONITH enabled but no STONITH resources an error and provide details on resolutions
  + High: PE: Prevent use-of-NULL when using resource ordering sets
  + High: Tools: attrd - Prevent race condition resulting in the cluster forgetting node's wish to shut down
  + High: Tools: crm_mon - Fix smtp notifications
  + High: Tools: crm_resource - Repair the ability to query meta attributes
  + Medium: Core: Include supported stacks in version information
  + Medium: Tools: Include current stack in crm_mon output
  + Medium: PE: Correctly log the actions for resources that are being recovered
  + Medium: PE: Correctly log the occurance of promotion events

-------------------------------------------------------------------
Fri Apr  3 12:16:27 CEST 2009 - abeekhof@suse.de

- Add a man page for crm_shadow
- Update source tarball to revision: 9196be9830c2
  + High: crmd: Bug bnc#480977 - Prevent extra, partial, shutdown when a node restarts too quickly (verified)
  + Medium: crmd: Bug bnc#490426 - Escalated shutdowns stall when there are pending resource operations
  + Medium: PE: Bug bnc#491441 - crm_mon does not display operations returning 'uninstalled' correctly

-------------------------------------------------------------------
Tue Mar 31 14:53:08 CEST 2009 - abeekhof@suse.de

- Update for SLE11 HAE RC9
- Update source tarball to revision: 61da7b5260df
  + High: PE: Bug bnc#490418 - Correctly determine node state for nodes wishing to be terminated
  + High: RA: Bug bnc#490641 - Shut down dlm_controld with -TERM instead of -KILL

-------------------------------------------------------------------
Mon Mar 30 21:21:47 CEST 2009 - abeekhof@suse.de

- Update source tarball to revision: f090699a99c5
  + High: PE: Bug bnc#488721 - Fix id-ref expansion for clones, the doc-root for clone children is not the cib root
  + High: PE: Bug lf#2094 - Fix probe ordering for cloned groups
  + High: crmd: Bug bnc#489063 - Ensure the DC is always unset after we 'loose' an election

-------------------------------------------------------------------
Fri Mar 20 21:16:26 CET 2009 - abeekhof@suse.de

- Update for SLE11 HAE RC8
- Update to upstream version number
- Update source tarball to revision: be123e8615a5
  + High: PE: Bug lf#2089 - Meta attributes are not inherited by clone children
  + High: PE: Bug lf#2091 - Correctly restart modified resources that were found active by a probe
  + High: PE: Correctly handle terminate node attributes that are set to the output from time()
  + High: ais plugin: Fix quorum calculation (bnc#487003)
  + High: ais: Bug bnc#486858 - Fix update_member() to prevent spamming clients with membership events containing no changes
  + High: fencing: stonithd: is_heartbeat_cluster is a no-no if there is no heartbeat support

-------------------------------------------------------------------
Mon Mar 16 16:15:00 CET 2009 - lmb@suse.de

- Update for SLE11 HAE RC7
- Update source tarball to revision: 7e44933b0e46
  - Tools: crm: print short help if there is no long help; replace "desc" with "help"
  - Tools: crm: issue warnings on all unrecognized elements of the cib configuration
  - Tools: crm: the new configure monitor command
  - Tools: crm: return exit code from configure commands
  - Tools: crm: check shadow name for sanity in the cib use command
  - Tools: crm: more shadow name sanity checks

-------------------------------------------------------------------
Mon Mar 16 07:16:29 CET 2009 - abeekhof@suse.de

- Update source tarball to revision: ec6b0bbee1f3
  + High: PE: The ordered option for clones no longer causes extra start/stop operations
  + High: RA: pingd: Set default ping interval to 1 instead of 0 seconds
  + High: Tools: crm: the new configure node command
  + High: Tools: crm_mon - Prevent use-of-NULL when summarizing an orphan
  + High: ais: Bug bnc#482847, bnc#482905 - Force a clean exit of OpenAIS once Pacemaker has finished unloading

-------------------------------------------------------------------
Tue Mar 10 13:54:38 CET 2009 - abeekhof@suse.de

- Update for SLE11 HAE RC6.1
- Update source tarball to revision: 37e5ae18279e
  + High: Fix compilation on x64 - We dont need longclock_t intervals/precision for debug timers
  + High: cib: Bug bnc#482885 - Simplify CIB disk-writes to prevent data loss
  + High: Tools: The default re-ping interval for pingd should be 1s not 1ms

-------------------------------------------------------------------
Mon Mar  9 15:19:28 CET 2009 - abeekhof@suse.de

- Update for SLE11 HAE RC6
- Remove heartbeat-specific binary from the distribution
- Update source tarball to revision: 3028846cc3f5
  + High: PE: Bug bnc#478687 - Don't crash when clone-max is 0
  + High: PE: Bug LF#2087 - Correctly parse the state of anonymous clones that have multiple instances on a given node
  + High: PE: Bug LF:2075 - Fix large pingd memory leaks
  + High: PE: Bug bnc#466788 - Make colocation based on node attributes work
  + High: PE: Correctly attach orphaned clone children to their parent
  + High: PE: Fix memory leak in LogActions
  + High: PE: Fix the determination of whether a group is active
  + High: PE: Look up the correct promotion preference for anonymous masters
  + High: PE: Simplify handling of start failures by changing the default migration-threshold to INFINITY
  + High: Tools: Bug bnc#483365 - Ensure the command from cluster_test includes a value for --log-facility
  + High: Tools: crm: add support for command aliases and some common commands (i.e. cd,exit)
  + High: Tools: crm: create top configuration nodes if they are missing
  + High: Tools: crm: fix parsing attributes for rules (broken by the previous changeset)
  + High: Tools: crm: new ra set of commands
  + High: Tools: crm: resource agents information management
  + High: Tools: crm: support for no value attribute in nvpairs
  + High: Tools: hb2openais: fix ocfs2 processing
  + High: Tools: pingd - prevent double free of getaddrinfo() output in error path
  + High: ais: Correctly handle a return value of zero from openais_dispatch_recv()
  + High: ais: Fix memory leak in error path
  + High: ais: IPC messages are only in scope until a response is sent
  + High: cib: Bug bnc#482885 - Simplify CIB disk-writes to prevent data loss.  Required a change to the backup filename format
  + High: crm: Avoid infinite loop during crm configure edit (bnc#480327)
  + High: crmd: Avoid a race condition by waiting for the attrd update to trigger a transition automatically
  + High: crmd: Bug bnc#479543 - Correctly find the migration source for timed out migrate_from actions
  + High: crmd: Fix memory leaks found by valgrind

-------------------------------------------------------------------
Thu Mar  5 16:42:23 CET 2009 - abeekhof@suse.de

- heartbeat-common _must_ be a PreReq: instead of a Requires: so that
  the script which creates hacluster/haclient has completed before
  Pacemaker is installed.  Otherwise the file permissions are all wrong.

-------------------------------------------------------------------
Tue Mar  3 16:40:20 CET 2009 - abeekhof@suse.de

- Add man page for the crm shell

-------------------------------------------------------------------
Fri Feb 27 13:00:00 CET 2009 - lmb@suse.de

- Update source tarball to revision: e0f361e9bd17
- High: Tools: cli: fix and improve delete command
- High: Tools: crm: support rsc/op_defaults

-------------------------------------------------------------------
Wed Feb 25 16:30:59 CET 2009 - abeekhof@suse.de

- Add extra soft dependancies: graphviz, libdlm, heartbeat-resources

-------------------------------------------------------------------
Mon Feb 23 14:37:32 CET 2009 - abeekhof@suse.de

- Update for SLE11 HAE RC5
- Update source tarball to revision: 33e92390b2ed
  + High: Core: Prevent unterminated strings after decompression
  + High: PE: Clones now default to globally-unique=false
  + High: PE: Prevent use-of-NULL for failed migrate actions in process_rsc_state()
  + High: PE: Start the correct monitor operation for unmanaged masters
  + High: Tools: Cause the correct clone instance to be failed with crm_resource -F
  + High: ais: Centralize all quorum calculations in the ais plugin and allow expected votes to be configured int he cib
  + High: crmd: Ensure updates for lost migrate operations indicate which node it tried to migrating to
  + High: crmd: Fix memory leak in cib notication processing code
  + High: crmd: Fix memory leak in transition graph processing
  + Medium: Core: Bug BNC#474727 - Set a maximum time to wait for IPC messages
  + Medium: PE: Ensure clones always have a value for globally-unique
  + Medium: crmd: Add new expected-quorum-votes option
  + Medium: crmd: Automatically detect and use new values for crm_config options
  + Medium: crmd: Bug BNC#472473 - Don't wait excessive amounts of time for lost actions
  + Medium: crmd: Bug BNC#472473 - Reduce the transition timeout to action_timeout+network_delay

-------------------------------------------------------------------
Fri Feb  6 18:12:28 CET 2009 - abeekhof@suse.de

- Update source tarball to revision: 09be44da9b32
  + High: PE: Remove an optimization for the terminate node attribute that caused the cluster to block indefinitly
  + High: Tools: Bug BNC#468066 - Don't use the result of uname() when its no longer in scope
  + High: Tools: Bug LF:2036 - crm_resource cannot set/get parameters for cloned resources
  + High: ais: Add optional support for the new AIS IPC layer
  + High: ais: Always set header.error to the correct default: SA_AIS_OK
  + High: ais: Ensure crm_peer_seq is updated after a membership update
  + High: ais: Make sure all IPC header fields are set to sane defaults
  + High: cib: Allow clients without mainloop to connect to the cib
  + High: cib: Fix four moderately sized memory leaks detected by Valgrind
  + High: Core: Fix more memory leaks foudn by valgrind
  + High: Tools: Bug BNC#473265 - crm_resource -L dumps core
  + High: Tools: Bug LF:2046 - Node attribute updates are lost because attrd can take too long to start
  + High: Tools: hb2openais: add constraints for clvmd to controld
  + High: Tools: hb2openais: improve media processing and set rrp_mode for multiple rings configuration
  + High: Tools: hb2openais: openais supports up to two rings

-------------------------------------------------------------------
Mon Jan 26 11:33:42 CET 2009 - abeekhof@suse.de

-  Update source tarball to revision: 7eef42ed409d
  + High: Tools: Bug BNC#468066 - crm_standby - Don't use the result of uname() when its no longer in scope
  + High: PE: Bug BNC#465484 - Fix the no-quorum-policy=suicide option
  + High: PE: Only shoot online nodes with no-quorum-policy=suicide
  + High: ais: Bug BNC#456208 - Prevent deadlocks by not logging in the child process before exec()
  + High: ais: Detect and handle situations where ais and the crm disagree on the node name
  + High: crmd: Bug BNC#467995 - Delay marking STONITH operations complete until STONITH tells us so
  + High: crmd: Prevent node attribute loss by detecting attrd disconnections immediately
- Enabled support for SNMP and SMTP notifications on resource state changes

-------------------------------------------------------------------
Wed Jan 21 13:38:15 CET 2009 - abeekhof@suse.de

- Update source tarball to revision: a2f46902d821
  + High: Core: CID:10 - Prevent indexing into an array of schemas with a negative value
  + High: Core: CID:13 - Fix memory leak in log_data_element
  + High: Core: CID:15 - Fix memory leak in crm_get_peer
  + High: Core: CID:6 - Fix use-of-NULL in copy_ha_msg_input
  + High: Core: Fix crash in the membership code preventing node shutdown
  + High: PE: CID:19 - Fix use-of-NULL in determine_online_status
  + High: Tools: Bug 2003 - pingd doesn't correctly handle node-down events on multi-NIC systems
  + High: Tools: Bug 2021 - pingd does not detect sequence wrapping correctly, incorrectly reports nodes offline
  + High: Tools: attrd - Correctly determine when an attribute has stopped changing and should be committed to the CIB
  + High: Tools: crm_master shouldn't define a set id now that attrd is used.  Defining one can break lookups
  + High: Tools: hb2openais: adjust path to the supporting script and set CONF variable
  + High: Tools: hb2openais: set no-quorum-policy to ignore for 2-node clusters
  + High: ais: Bug BNC#456243 - Ensure the membership cache always contains an entry for the local node
  + High: cib: CID:18 - Fix use-of-NULL in cib_perform_op
  + High: cib: CID:18 - Repair errors introduced in b5a18704477b - Fix use-of-NULL in cib_perform_op
  + High: crmd: Bug LF:2010 - Ensure fencing cib updates create the node_state entry if needed to preent re-fencing during cluster startup
  + High: crmd: Correctly handle reconnections to attrd
  + High: stonith: CID:3 - Fix another case of exceptionally poor error handling by the original stonith developers
  + High: stonith: CID:5 - Checking for NULL and then dereferencing it anyway is an interesting approach to error handling
  + High: stonithd: wrong checks for shmid (0 is a valid id)

-------------------------------------------------------------------
Wed Dec  3 13:32:20 CET 2008 - abeekhof@suse.de

- Reduce bloat - remove regession tests from source tarball
- Update source tarball to revision: 6b8d46c7ab9c
  + High: crmd: Don't fast-track the processing of LRM refreshes when there are pending actions.
  + High: PE: Bug LF:2005 - Fix startup ordering of cloned stonith groups
  + High: PE: Bug LF:2006 - Correctly reprobe cloned groups
  + High: PE: Prevent on-fail settings being ignored after a resource is successfully stopped
  + High: Tools: Bug LF:2003 - pingd doesn't correctly detect failures when the interface is down
  + High: Tools: Bug LF:2001 - Transient node attributes should be set via attrd
  + High: Tools: crm cli: Bug bnc:450815 - don't generate id for the operations tag
  + High: Tools: crm cli: drop '-rsc' from attributes for order constraint
  + High: Tools: crm cli: fix wrong order of action and resource in order constraint
  + High: Tools: crm cli: return on syntax error when parsing score

-------------------------------------------------------------------
Fri Nov 21 19:55:34 CET 2008 - abeekhof@suse.de

- Update source tarball to revision: 27be064e0907
  + High: ais: Repair and streamline service load now that OpenAIS startup functions correctly
- Requires and is related to sr3936: Fix Bug bnc#444376 - openais segafults in lcr_ifact_release during shutdown

-------------------------------------------------------------------
Fri Nov 21 14:00:11 CET 2008 - abeekhof@suse.de

- Update source tarball to revision: 61d0af5c31c0
  + High: cib: Ensure configuration updates contain the correct values of admin_epoch
    Otherwise the configuration can not be kept in sync across the cluster
  + High: crmd: Bug LF:1962 - Don't NACK peers because they're not (yet) in our membership.  Just ignore them.
  + High: crmd: Prevent node re-probe loops by ensuring manditory actions always complete
  + High: PE: Bug LF:1996 - Correctly process disabled monitor operations
  + High: PE: Correctly calculate the number of available nodes for the clone to use
  + High: Tools: crm cli: catch system errors on file operations
  + High: Tools: crm cli: exit with an appropriate exit code
  + High: Tools: crm cli: new command: configure upgrade
  + High: Tools: crm cli: prevent key errors on missing cib attributes
  + High: Tools: crm cli: sometimes, on errors, level would change on single shot use
  + Medium: crmd: do_dc_join_filter_offer - Check the 'join' message is for the current instance before deciding to NACK peers
  + Medium: Tools: crm cli: replace inf with INFINITY
  + Medium: Tools: crm cli: supply provider only for ocf class primitives

-------------------------------------------------------------------
Tue Nov 18 14:57:43 CET 2008 - abeekhof@suse.de

- Add man pages for Pacemaker admin tools
- Update source tarball to revision: eda05459ce58
  + High: Core: Repair the ability to have comments in the configuration
  + High: Tools: hb2openais: update logging and set logfile appropriately
  + High: ais: Hook up the openais.conf config logging options
  + High: ais: Zero out the PID of disconnecting clients
  + High: cib: Ensure global updates cause a disk write when appropriate
  + High: crmd: Ensure PE processing does not occur for all error cases in do_pe_invoke_callback
  + High: crmd: Requests to the CIB should cause any prior PE calculations to be ignored
  + Medium: PE: Prevent lsb scripts from being used in globally unique clones
  + Medium: Tools: crm_mon - display the meaning of the operation's rc code instead of the status
  + Medium: ais: Hook up the options for specifying the expected number of nodes and total quorum votes
  + Medium: crmd: Fix the handling of unexpected PE exits to ensure the current CIB is stored

-------------------------------------------------------------------
Sat Nov  8 10:24:36 CET 2008 - abeekhof@suse.de

- Update source tarball to revision: e21021b77657
  + High: crmd: Erase the correct node's status section when it returns

-------------------------------------------------------------------
Fri Nov  7 14:09:15 CET 2008 - abeekhof@suse.de

- Update source tarball to revision: 7508f211e536
  + High: PE: Bug LF:1988 - Ensure recurring operations always have the correct target-rc set
  + High: PE: Fix optional colocation
  + High: PE: Improve up the detection of 'new' nodes joining the cluster
  + High: PE: Prevent assert failures in master_color() by ensuring unmanaged masters are always reallocated to their current location
  + High: Tools: crm_shadow - Show more line number information after validation failures
  + High: ais: Ensure HA_RSCTMP exists for use by resource agents
  + High: crmd: Bug:1975 - crmd should wait indefinitely for stonith operations to complete
  + Medium: PE: Bug N:437719 - Ensure scores from colocated resources count when allocating groups
  + Medium: Tools: Bug LF:1985 - crm_mon - Correctly process failed cib queries to allow reconnection after cluster restarts
  + Medium: Tools: Bug LF:1987 - crm_verify incorrectly warns of configuration upgrades for the most recent version
  + Medium: Tools: attrd - Automatically refresh all attributes after a CIB replace operation
  + Medium: Tools: crm (bnc#441028): check for key error in attributes management
  + Medium: crmd: Detect deleted resource operations automatically
  + Medium: crmd: Erase a node's resource operations and transient attributes after a successful STONITH
  + Medium: crmd: Fix the recording of pending operations in the CIB
  + Medium: xml: Relax the restriction on the contents of rsc_locaiton.node

-------------------------------------------------------------------
Mon Oct 27 14:15:30 CET 2008 - abeekhof@suse.de

- Update source tarball to revision: 9082ded546ec
  + High: Tools: LF:1969 - Attrd never sets any properties in the cib
  + Medium: Core: Provide better feedback if Pacemaker is started by a stack it doesn't support
  + Medium: Ensure meta attributes are used consistantly
  + Medium: PE: Allow group and clone level resource attributes
  + Medium: PE: Make a best-effort guess at a migration threshold for people with 0.6 configs
  + Medium: Tools: crm_mon - Fix the display of timing data
  + Medium: Tools: crm_verify - check that we're being asked to validate a complete config

-------------------------------------------------------------------
Tue Oct 14 08:10:28 CEST 2008 - abeekhof@suse.de

- Add heartbeat-common as a runtime dependancy
  This ensures the clustering user/group is installed and directories
  iare created with the right permissions

-------------------------------------------------------------------
Mon Oct 13 11:58:59 CEST 2008 - abeekhof@suse.de

- Add openais as a hard dependancy

-------------------------------------------------------------------
Thu Oct  9 12:20:08 CEST 2008 - abeekhof@suse.de

- Update source tarball to revision: 9a6c6d1dd871 (1.0.0)
  + High: Core: Allow the expected number of quorum votes to be configrable
  + High: Tools: Make pingd functional on Linux
  + Medium: crmd: Avoid calling GHashTable functions with NULL
  + Medium: tools: crm_resource - return with non-zero when a resource migration command is invalid
  + Medium: tools: crm_shadow - Allow the admin to start with an empty CIB (and no cluster connection)
  + Medium: PE: Use the correct attribute for action 'requires' (was prereq)

-------------------------------------------------------------------
Sun Sep 28 18:57:45 CEST 2008 - abeekhof@suse.de

- Update source tarball to revision: 8415675fe428
  + High: Core: Only call xmlCleanupParser() if we parsed anything.  Doing so unconditionally seems to cause a segfault
  + High: hb2openais.sh: improve pingd handling; several bugs fixed
  + High: hb2openais: fix clone creation; replace EVMS strings
  + High: stonithd: fix handling of timeouts
  + High: stonithd: fix logic for stonith resource priorities
  + High: stonithd: initialize value before reading fence-timeout
  + Medium: PE: Remove new options that are better set in rsc_defaults
  + Medium: PE: Detect clients that disconnect before receiving their reply
  + Medium: PE: ptest - check the input is valid before proceeding
  + Medium: crmd: Hook up the stonith-timeout option to stonithd
  + Medium: crmd: Prevent potential use-of-NULL in global_timer_callback
  + Medium: crmd: Rationalize the logging of graph aborts
  + Medium: xml: pacemaker-0.7 should be an alias for the 1.0 schema

-------------------------------------------------------------------
Mon Sep 15 11:08:19 CEST 2008 - abeekhof@suse.de

- Create a libpacemaker subpackage

-------------------------------------------------------------------
Thu Sep 11 09:33:12 CEST 2008 - abeekhof@suse.de

-  Update source tarball to revision: 2087f5b1a5a0
  + High: PE: Bug LF:1950 - Ensure the current values for all notification variables are always set (even if empty)
  + High: PE: Bug LF:1955 - Ensure unmanaged masters are unconditionally repromoted to ensure they are monitored correctly.
  + High: PE: Bug LF:1955 - Fix another case of filtering causing unmanaged master failures
  + High: PE: Bug LF:1955 - Umanaged mode prevents master resources from being allocated correctly
  + High: PE: Bug N:420538 - Anit-colocation caused a positive node preference
  + High: PE: Correctly handle unmanaged resources to prevent them from being started elsewhere
  + High: PE: crm_resource - Fix the --migrate command
  + High: ais: Move the service id definition to a common location and make sure it is always used
  + High: stonithd (LF 1951): fix remote stonith operations
  + Medium: Build: Make sure crm_config.h is only ever included once
  + Medium: PE: Bug LF:1950 - Notifications do not contain all documented resource state fields
  + Medium: PE: Bug N:417585 - Don't restart group children who's individual score drops below zero
  + Medium: PE: Implement a true maintenance mode
  + Medium: ais: Use the agreed service number
  + Medium: Tools: Implement a unified CLI shell

-------------------------------------------------------------------
Mon Sep  1 10:25:58 CEST 2008 - abeekhof@suse.de

- Update source tarball to revision: 1df197982079
- Try again to fix compilation in STABLE (this time also tested with mbuild)
- STONITH is now enabled by default and the cluster will warn if no STONITH resource is found

-------------------------------------------------------------------
Sat Aug 30 12:38:56 CEST 2008 - abeekhof@suse.de

- Update source tarball to revision: 902885c90d96
- Fixes build ordering ssue that prevented compilation of lib/common

-------------------------------------------------------------------
Wed Aug 20 17:05:00 CEST 2008 - abeekhof@suse.de

 - Update source tarball to revision: f567855328b7 (0.7.1)
  + Added features needed to support libdlm and ocfs2-tools
  + High: admin: Fix use-after-free in crm_mon
  + High: cib: Use single quotes so that the xpath queries for nvpairs will succeed
  + High: crmd: Always connect to stonithd when the TE starts and ensure we notice if it dies
  + High: crmd: Make sure async-failures cause the failcount to be incrimented
  + High: PE: Bug LF:1941 - Handle failed clone instance probes when clone-max < #nodes
  + High: PE: Prevent use-of-NULL - order->rsc_rh will not always be non-NULL
  + High: PE: Unpack colocation sets correctly
  + High: Tools: crm_mon - Prevent use-of-NULL for orphaned resources
  + Medium: Core: Get more details regarding parser errors
  + Medium: Core: Switch to the libxml2 parser - its significantly faster
  + Medium: PE: Allow groups to be involved in optional ordering constraints
  + Medium: PE: Allow sets of operations to be reused by multiple resources
  + Medium: PE: Bug LF:1941 - Mark extra clone instances as orphans and don't show inactive ones
  + Medium: PE: Determin the correct migration-threshold during resource expansion
  + Medium: PE: Implement no-quorum-policy=suicide (FATE #303619)
  + Lots of bug fixes

-------------------------------------------------------------------
Mon Jul 21 16:26:00 CEST 2008 - abeekhof@suse.de

 - Update source tarball to revision: 7a31d0c33e22 (0.7.0)
  + High: Performance enhancements
  + High: Fix memory leaks and use-after-free
  + High: Admin: All tools now use --node (-N) for specifying node unames
  + High: Admin: All tools now use --xml-file (-x) and --xml-text (-X) for specifying where to find XML blobs
  + High: cib: Implement CIB_shadow - a facility for making and testing changes before uploading them to the cluster
  + High: cib: Make registering per-op callbacks an API call and renamed (for clarity) the API call for requesting notifications
  + High: Core: Add a facility for automatically upgrading old configurations
  + High: Core: Adopt libxml2 as the XML processing library - all external clients need to be recompiled
  + High: PE: Bug LF:1459 - Allow failures to expire
  + High: PE: Replace failure-stickiness with a simple 'migration-threshold'
  + High: PE: Bug LF:1941 - Handle failed clone instance probes when clone-max < #nodes
  + High: PE: Make OCF_ERR_ARGS a node-level error rather than a cluster-level one
  + High: PE: Properly handle clones that are not installed on all nodes
  + Medium: Admin: Bug LF:1438 - Allow the list of all/active resource operations to be queried by crm_resource
  + Medium: Admin: Bug LF:1708 - crm_resource should print a warning if an attribute is already set as a meta attribute
  + Medium: Admin: Bug LF:1883 - crm_mon should display fail-count and operation history
  + Medium: Admin: Bug N:371785 - crm_resource -C doesn't also clean up fail-count attributes
  + Medium: Admin: crm_mon - include timing data for failed actions
  + Medium: cib: Bug LF:1348 - Allow rules and attribute sets to be referenced for use in other objects
  + Medium: cib: BUG LF:1918 - By default, all cib calls now timeout after 30s
  + Medium: cib: Remove some useless parts of the API
  + Medium: cib: Implement the ability for clients to connect to remote servers
  + Medium: Core: Add support for validating xml against RelaxNG schemas
  + Medium: PE: Bug LF:1328 - Don't fencing nodes in clusters without managed resources
  + Medium: PE: Bug LF:1461 - Give transient node attributes (in <status/>) preference over persistent ones (in <nodes/>)
  + Medium: PE: Bug LF:1884, Bug LF:1885 - Implement N:M ordering and colocation constraints
  + Medium: PE: Bug LF:1886 - Create a resource and operation 'defaults' config section
  + Medium: PE: Bug LF:1892 - Allow recurring actions to be triggered at known times
  + Medium: PE: Bug LF:1926 - Probes should complete before stop actions are invoked
  + Medium: PE: Prefer the current location if it is one of a group of nodes with the same (highest) score

-------------------------------------------------------------------
Sat May  3 07:35:35 CEST 2008 - abeekhof@suse.de

- Use a libexecdir consistent with openais

-------------------------------------------------------------------
Tue Apr 29 08:01:10 CEST 2008 - abeekhof@suse.de

- Updated to upstream version 0.6.3-1
- Update source tarball to revision: fd8904c9bc67
- SNMP has been moved to the management/pygui project
- Many bugfixes, primarily related to master/slave resources and failcount handling
- Fix libtool version check and supply a better default for the LCRSO directory

-------------------------------------------------------------------
Sat Apr 12 19:14:17 CEST 2008 - abeekhof@suse.de

- version 0.6.2-1
- Initial package check-in


From c2472e893d0a438fd5cef7d9eae98ccea1bf2d60 Mon Sep 17 00:00:00 2001
From: =?UTF-8?q?Fridrich=20=C5=A0trba?= <fridrich.strba@bluewin.ch>
Date: Thu, 13 Jun 2024 09:02:59 +0200
Subject: [PATCH] Remove support for zstd

---
 .../java/org/codehaus/plexus/archiver/tar/TarArchiver.java     | 3 +--
 .../java/org/codehaus/plexus/archiver/tar/TarUnArchiver.java   | 3 +--
 2 files changed, 2 insertions(+), 4 deletions(-)

diff --git a/src/main/java/org/codehaus/plexus/archiver/tar/TarArchiver.java b/src/main/java/org/codehaus/plexus/archiver/tar/TarArchiver.java
index 2091eaf8..78c469ef 100644
--- a/src/main/java/org/codehaus/plexus/archiver/tar/TarArchiver.java
+++ b/src/main/java/org/codehaus/plexus/archiver/tar/TarArchiver.java
@@ -29,7 +29,6 @@
 import org.apache.commons.compress.compressors.bzip2.BZip2CompressorOutputStream;
 import org.apache.commons.compress.compressors.snappy.FramedSnappyCompressorOutputStream;
 import org.apache.commons.compress.compressors.xz.XZCompressorOutputStream;
-import org.apache.commons.compress.compressors.zstandard.ZstdCompressorOutputStream;
 import org.codehaus.plexus.archiver.AbstractArchiver;
 import org.codehaus.plexus.archiver.ArchiveEntry;
 import org.codehaus.plexus.archiver.ArchiverException;
@@ -429,7 +428,7 @@ private OutputStream compress(TarCompressionMethod tarCompressionMethod, final O
         } else if (TarCompressionMethod.xz.equals(tarCompressionMethod)) {
             return new XZCompressorOutputStream(bufferedOutputStream(ostream));
         } else if (TarCompressionMethod.zstd.equals(tarCompressionMethod)) {
-            return new ZstdCompressorOutputStream(bufferedOutputStream(ostream));
+            throw new UnsupportedOperationException( "This version of plexus-archiver does not support zstd compression" );
         }
 
         return ostream;
diff --git a/src/main/java/org/codehaus/plexus/archiver/tar/TarUnArchiver.java b/src/main/java/org/codehaus/plexus/archiver/tar/TarUnArchiver.java
index de73c106..173e4c22 100644
--- a/src/main/java/org/codehaus/plexus/archiver/tar/TarUnArchiver.java
+++ b/src/main/java/org/codehaus/plexus/archiver/tar/TarUnArchiver.java
@@ -28,7 +28,6 @@
 import org.apache.commons.compress.compressors.bzip2.BZip2CompressorInputStream;
 import org.apache.commons.compress.compressors.snappy.FramedSnappyCompressorInputStream;
 import org.apache.commons.compress.compressors.xz.XZCompressorInputStream;
-import org.apache.commons.compress.compressors.zstandard.ZstdCompressorInputStream;
 import org.codehaus.plexus.archiver.AbstractUnArchiver;
 import org.codehaus.plexus.archiver.ArchiverException;
 import org.codehaus.plexus.archiver.util.Streams;
@@ -141,7 +140,7 @@ private InputStream decompress(UntarCompressionMethod compression, final File fi
         } else if (compression == UntarCompressionMethod.XZ) {
             return new XZCompressorInputStream(istream);
         } else if (compression == UntarCompressionMethod.ZSTD) {
-            return new ZstdCompressorInputStream(istream);
+            throw new UnsupportedOperationException( "This version of plexus-archiver does not support zstd compression" );
         }
         return istream;
     }
-- 
2.52.0


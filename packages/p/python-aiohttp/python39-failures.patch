---
 tests/test_web_middleware.py |   27 ++++++++++++++++++++++-----
 1 file changed, 22 insertions(+), 5 deletions(-)

--- a/tests/test_web_middleware.py
+++ b/tests/test_web_middleware.py
@@ -1,4 +1,5 @@
 import re
+import sys
 from typing import Any
 
 import pytest
@@ -6,6 +7,7 @@ from yarl import URL
 
 from aiohttp import web
 
+py39 = sys.version_info[:3] >= (3, 9, 7)
 
 async def test_middleware_modifies_response(loop, aiohttp_client) -> None:
     async def handler(request):
@@ -410,7 +412,10 @@ async def test_old_style_middleware(loop
         txt = await resp.text()
         assert "OK[old style middleware]" == txt
 
-    assert len(warning_checker) == 1
+    if py39:
+        assert len(warning_checker) == 2
+    else:
+        assert len(warning_checker) == 1
     msg = str(warning_checker.list[0].message)
     assert re.match(
         "^old-style middleware "
@@ -464,7 +469,10 @@ async def test_mixed_middleware(loop, ai
         txt = await resp.text()
         assert "OK[new style 2][old style 2][new style 1][old style 1]" == txt
 
-    assert len(w) == 2
+    if py39:
+        assert len(w) == 3
+    else:
+        assert len(w) == 2
     tmpl = (
         "^old-style middleware "
         '"<function test_mixed_middleware.<locals>.'
@@ -503,7 +511,10 @@ async def test_old_style_middleware_clas
         txt = await resp.text()
         assert "OK[old style middleware]" == txt
 
-    assert len(warning_checker) == 1
+    if py39:
+        assert len(warning_checker) == 2
+    else:
+        assert len(warning_checker) == 1
     msg = str(warning_checker.list[0].message)
     assert re.match(
         "^old-style middleware "
@@ -537,7 +548,10 @@ async def test_new_style_middleware_clas
         txt = await resp.text()
         assert "OK[new style middleware]" == txt
 
-    assert len(warning_checker) == 0
+    if py39:
+        assert len(warning_checker) == 1
+    else:
+        assert len(warning_checker) == 0
 
 
 async def test_new_style_middleware_method(loop, aiohttp_client) -> None:
@@ -563,4 +577,7 @@ async def test_new_style_middleware_meth
         txt = await resp.text()
         assert "OK[new style middleware]" == txt
 
-    assert len(warning_checker) == 0
+    if py39:
+        assert len(warning_checker) == 1
+    else:
+        assert len(warning_checker) == 0

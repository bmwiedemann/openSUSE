Index: Linux-PAM-1.3.1/modules/pam_access/pam_access.c
===================================================================
--- Linux-PAM-1.3.1.orig/modules/pam_access/pam_access.c
+++ Linux-PAM-1.3.1/modules/pam_access/pam_access.c
@@ -716,7 +716,7 @@ network_netmask_match (pam_handle_t *pam
 
     if (item->debug)
       pam_syslog (pamh, LOG_DEBUG,
-		"network_netmask_match: tok=%s, item=%s", tok, string);
+		"network_netmask_match: tok=%s, string=%s", tok, string);
 
     /* OK, check if tok is of type addr/mask */
     if ((netmask_ptr = strchr(tok, '/')) != NULL)
@@ -734,7 +734,7 @@ network_netmask_match (pam_handle_t *pam
 
 	/* check netmask */
 	if (isipaddr(netmask_ptr, NULL, NULL) == NO)
-	  { /* netmask as integre value */
+	  { /* netmask as integer value */
 	    char *endptr = NULL;
 	    netmask = strtol(netmask_ptr, &endptr, 0);
 	    if ((endptr == netmask_ptr) || (*endptr != '\0'))
@@ -778,9 +778,9 @@ network_netmask_match (pam_handle_t *pam
 
 	ai = NULL;	/* just to be on the safe side */
 
-	if (getaddrinfo (string, NULL, &hint, &ai) != 0)
+	if (getaddrinfo (tok, NULL, &hint, &ai) != 0)
 	  {
-	    pam_syslog(pamh, LOG_ERR, "cannot resolve hostname \"%s\"", string);
+	    pam_syslog(pamh, LOG_ERR, "cannot resolve hostname \"%s\"", tok);
 
 	    return NO;
 	  }

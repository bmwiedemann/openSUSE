Index: tcpreplay-4.5.1/libopts/save.c
===================================================================
--- tcpreplay-4.5.1.orig/libopts/save.c
+++ tcpreplay-4.5.1/libopts/save.c
@@ -495,6 +495,9 @@ remove_settings(tOptions * opts, char co
     char *       text = text_mmap(fname, PROT_READ|PROT_WRITE, MAP_PRIVATE, &map_info);
     char *       scan = text;
 
+    if (TEXT_MMAP_FAILED_ADDR(text))
+      goto leave;
+
     for (;;) {
         char * next = scan = strstr(scan, zCfgProg);
         if (scan == NULL)

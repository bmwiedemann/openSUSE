Index: hydrogen-0.99+git20200527/src/core/CMakeLists.txt
===================================================================
--- hydrogen-0.99+git20200527.orig/src/core/CMakeLists.txt	2020-06-03 11:45:34.860742802 +0200
+++ hydrogen-0.99+git20200527/src/core/CMakeLists.txt	2020-06-03 11:45:53.025432819 +0200
@@ -5,7 +5,7 @@ FILE(GLOB_RECURSE hydrogen_INCLUDES incl
 FILE(GLOB_RECURSE hydrogen_SOURCES src/*.cpp src/*.cc src/*.c)
 LIST(APPEND hydrogen_INCLUDES ${CMAKE_CURRENT_BINARY_DIR}/include/hydrogen/config.h)
 
-ADD_LIBRARY( hydrogen-core-${VERSION} ${H2CORE_LIBRARY_TYPE} ${hydrogen_SOURCES})
+ADD_LIBRARY( hydrogen-core ${H2CORE_LIBRARY_TYPE} ${hydrogen_SOURCES})
 INCLUDE_DIRECTORIES( include
     ${CMAKE_SOURCE_DIR}/include                 # regular headers
     ${CMAKE_CURRENT_BINARY_DIR}/include         # generated config.h
@@ -26,7 +26,7 @@ INCLUDE_DIRECTORIES( include
     ${RUBBERBAND_INCLUDE_DIRS}
 )
 
-TARGET_LINK_LIBRARIES(hydrogen-core-${VERSION}
+TARGET_LINK_LIBRARIES(hydrogen-core
     ${LIBTAR_LIBRARIES}
     ${LIBARCHIVE_LIBRARIES}
     ${LIBSNDFILE_LIBRARIES}
@@ -48,21 +48,27 @@ TARGET_LINK_LIBRARIES(hydrogen-core-${VE
     ${OSC_LIBRARIES}
 )
 
-TARGET_LINK_LIBRARIES(hydrogen-core-${VERSION}
+TARGET_LINK_LIBRARIES(hydrogen-core
 	Qt5::Core
 	Qt5::Xml
 	Qt5::XmlPatterns
 )
 
-#SET_TARGET_PROPERTIES(hydrogen-core-${VERSION} PROPERTIES PUBLIC_HEADER   "${hydrogen_INCLUDES}" )
-SET_PROPERTY(TARGET hydrogen-core-${VERSION} PROPERTY CXX_STANDARD 14)
+SET_TARGET_PROPERTIES(hydrogen-core PROPERTIES SOVERSION ${H2CORE_LIBRARY_SONAME})
+#SET_PROPERTY(TARGET hydrogen-core-${VERSION} PROPERTY CXX_STANDARD 14)
 
-INSTALL(TARGETS hydrogen-core-${VERSION}
-    LIBRARY DESTINATION "${CMAKE_INSTALL_LIBDIR}"
-    ARCHIVE DESTINATION "${CMAKE_INSTALL_LIBDIR}"
+# SOVERSION ${coreversion} LINK_FLAGS '-Wl,-soname=libhydrogen-core.so.${soversion}"
+
+if(H2CORE_LIBRARY_TYPE STREQUAL SHARED)
+    INSTALL(TARGETS hydrogen-core
+    LIBRARY DESTINATION ${CMAKE_CURRENT_LIBRARY_DIR})
+    elseif(H2CORE_LIBRARY_TYPE STREQUAL STATIC)
+INSTALL(TARGETS hydrogen-core
+    ARCHIVE DESTINATION lib)
+    endif(H2CORE_LIBRARY_TYPE STREQUAL SHARED)
+    #
     # do not copy directory hierarchy
     #PUBLIC_HEADER DESTINATION include/hydrogen
-)
 
 IF(NOT APPLE AND NOT WIN32)
     INSTALL(DIRECTORY include DESTINATION "${CMAKE_INSTALL_PREFIX}" FILES_MATCHING PATTERN "*.h" PATTERN ".svn" EXCLUDE)
Index: hydrogen-0.99+git20200527/src/player/CMakeLists.txt
===================================================================
--- hydrogen-0.99+git20200527.orig/src/player/CMakeLists.txt	2020-06-03 11:45:34.860742802 +0200
+++ hydrogen-0.99+git20200527/src/player/CMakeLists.txt	2020-06-03 11:45:53.029432972 +0200
@@ -11,10 +11,10 @@ ADD_EXECUTABLE(h2player WIN32 MACOSX_BUN
 
 SET_PROPERTY(TARGET h2player PROPERTY CXX_STANDARD 14)
 TARGET_LINK_LIBRARIES(h2player
-	hydrogen-core-${VERSION}
+	hydrogen-core
 	Qt5::Widgets
 	)
 
-ADD_DEPENDENCIES(h2player hydrogen-core-${VERSION})
+ADD_DEPENDENCIES(h2player hydrogen-core)
 
 INSTALL(TARGETS h2player RUNTIME DESTINATION ${CMAKE_INSTALL_BINDIR} BUNDLE DESTINATION ${CMAKE_INSTALL_BINDIR})
Index: hydrogen-0.99+git20200527/src/cli/CMakeLists.txt
===================================================================
--- hydrogen-0.99+git20200527.orig/src/cli/CMakeLists.txt	2020-06-03 11:45:34.860742802 +0200
+++ hydrogen-0.99+git20200527/src/cli/CMakeLists.txt	2020-06-03 11:45:53.029432972 +0200
@@ -13,12 +13,12 @@ ADD_EXECUTABLE(h2cli WIN32 MACOSX_BUNDLE
 
 SET_PROPERTY(TARGET h2cli PROPERTY CXX_STANDARD 14)
 TARGET_LINK_LIBRARIES(h2cli
-	hydrogen-core-${VERSION}
+	hydrogen-core
 	Qt5::Widgets
 	${LASH_LIBRARIES}
 	${OSC_LIBRARIES}
 	)
 
-ADD_DEPENDENCIES(h2cli hydrogen-core-${VERSION})
+ADD_DEPENDENCIES(h2cli hydrogen-core)
 
 INSTALL(TARGETS h2cli RUNTIME DESTINATION ${CMAKE_INSTALL_BINDIR} BUNDLE DESTINATION ${CMAKE_INSTALL_BINDIR})
Index: hydrogen-0.99+git20200527/CMakeLists.txt
===================================================================
--- hydrogen-0.99+git20200527.orig/CMakeLists.txt	2020-06-03 11:45:34.860742802 +0200
+++ hydrogen-0.99+git20200527/CMakeLists.txt	2020-06-03 11:45:53.029432972 +0200
@@ -110,7 +110,7 @@ ELSE()
 ENDIF()
 
 IF(WANT_SHARED)
-    SET(H2CORE_LIBRARY_TYPE SHARED)
+    SET(H2CORE_LIBRARY_SONAME ${coreversion}.${soage}.${sorevision})
 ELSE()
     SET(H2CORE_LIBRARY_TYPE STATIC)
 ENDIF()
Index: hydrogen-0.99+git20200527/src/gui/CMakeLists.txt
===================================================================
--- hydrogen-0.99+git20200527.orig/src/gui/CMakeLists.txt	2020-06-03 11:45:34.860742802 +0200
+++ hydrogen-0.99+git20200527/src/gui/CMakeLists.txt	2020-06-03 11:45:53.029432972 +0200
@@ -58,9 +58,9 @@ if(APPLE)
 endif()
 
 TARGET_LINK_LIBRARIES(hydrogen
-	hydrogen-core-${VERSION}
+	hydrogen-core
 	Qt5::Widgets
 )
-ADD_DEPENDENCIES(hydrogen hydrogen-core-${VERSION})
+ADD_DEPENDENCIES(hydrogen hydrogen-core)
 
 INSTALL(TARGETS hydrogen RUNTIME DESTINATION ${CMAKE_INSTALL_BINDIR} BUNDLE DESTINATION ${CMAKE_INSTALL_BINDIR})
Index: hydrogen-0.99+git20200527/src/tests/CMakeLists.txt
===================================================================
--- hydrogen-0.99+git20200527.orig/src/tests/CMakeLists.txt	2020-06-03 11:45:53.029432972 +0200
+++ hydrogen-0.99+git20200527/src/tests/CMakeLists.txt	2020-06-03 11:48:09.718618501 +0200
@@ -14,10 +14,10 @@ add_executable(tests ${TESTS_SRCS})
 SET_PROPERTY(TARGET tests PROPERTY CXX_STANDARD 14)
 
 target_link_libraries(tests
-	hydrogen-core-${VERSION}
+	hydrogen-core
 	${CPPUNIT_LIBRARIES}
 	Qt5::Core
 	Qt5::Test
 )
 
-add_dependencies(tests hydrogen-core-${VERSION})
+add_dependencies(tests hydrogen-core)

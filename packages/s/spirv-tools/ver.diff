From: Jan Engelhardt <jengelh@inai.de>
Date: 2016-06-13 11:46:16.846841814 +0200

Unversioned libraries suck!

---
 source/CMakeLists.txt        |    2 ++
 source/fuzz/CMakeLists.txt   |    1 +
 source/link/CMakeLists.txt   |    1 +
 source/opt/CMakeLists.txt    |    1 +
 source/reduce/CMakeLists.txt |    1 +
 5 files changed, 6 insertions(+)

Index: spirv-tools-2019.5~git157/source/CMakeLists.txt
===================================================================
--- spirv-tools-2019.5~git157.orig/source/CMakeLists.txt
+++ spirv-tools-2019.5~git157/source/CMakeLists.txt
@@ -336,6 +336,7 @@ set_source_files_properties(
 spvtools_pch(SPIRV_SOURCES pch_source)
 
 add_library(${SPIRV_TOOLS} ${SPIRV_SOURCES})
+set_target_properties(${SPIRV_TOOLS} PROPERTIES SOVERSION suse15)
 spvtools_default_compile_options(${SPIRV_TOOLS})
 target_include_directories(${SPIRV_TOOLS}
   PUBLIC
@@ -349,6 +350,7 @@ spvtools_check_symbol_exports(${SPIRV_TO
 add_dependencies( ${SPIRV_TOOLS} core_tables enum_string_mapping extinst_tables )
 
 add_library(${SPIRV_TOOLS}-shared SHARED ${SPIRV_SOURCES})
+set_target_properties(${SPIRV_TOOLS}-shared PROPERTIES SOVERSION suse15)
 spvtools_default_compile_options(${SPIRV_TOOLS}-shared)
 target_include_directories(${SPIRV_TOOLS}-shared
   PUBLIC
Index: spirv-tools-2019.5~git157/source/fuzz/CMakeLists.txt
===================================================================
--- spirv-tools-2019.5~git157.orig/source/fuzz/CMakeLists.txt
+++ spirv-tools-2019.5~git157/source/fuzz/CMakeLists.txt
@@ -146,6 +146,7 @@ if(SPIRV_BUILD_FUZZER)
   spvtools_pch(SPIRV_TOOLS_FUZZ_SOURCES pch_source_fuzz)
 
   add_library(SPIRV-Tools-fuzz ${SPIRV_TOOLS_FUZZ_SOURCES})
+  set_target_properties(SPIRV-Tools-fuzz PROPERTIES SOVERSION suse15)
 
   spvtools_default_compile_options(SPIRV-Tools-fuzz)
   target_compile_definitions(SPIRV-Tools-fuzz PUBLIC -DGOOGLE_PROTOBUF_NO_RTTI -DGOOGLE_PROTOBUF_USE_UNALIGNED=0)
Index: spirv-tools-2019.5~git157/source/link/CMakeLists.txt
===================================================================
--- spirv-tools-2019.5~git157.orig/source/link/CMakeLists.txt
+++ spirv-tools-2019.5~git157/source/link/CMakeLists.txt
@@ -14,6 +14,7 @@
 add_library(SPIRV-Tools-link
   linker.cpp
 )
+set_target_properties(SPIRV-Tools-link PROPERTIES SOVERSION suse15)
 
 spvtools_default_compile_options(SPIRV-Tools-link)
 target_include_directories(SPIRV-Tools-link
Index: spirv-tools-2019.5~git157/source/opt/CMakeLists.txt
===================================================================
--- spirv-tools-2019.5~git157.orig/source/opt/CMakeLists.txt
+++ spirv-tools-2019.5~git157/source/opt/CMakeLists.txt
@@ -231,6 +231,7 @@ spvtools_pch(SPIRV_TOOLS_OPT_SOURCES pch
 
 add_library(SPIRV-Tools-opt ${SPIRV_TOOLS_OPT_SOURCES})
 
+set_target_properties(SPIRV-Tools-opt PROPERTIES SOVERSION suse15)
 spvtools_default_compile_options(SPIRV-Tools-opt)
 target_include_directories(SPIRV-Tools-opt
   PUBLIC
Index: spirv-tools-2019.5~git157/source/reduce/CMakeLists.txt
===================================================================
--- spirv-tools-2019.5~git157.orig/source/reduce/CMakeLists.txt
+++ spirv-tools-2019.5~git157/source/reduce/CMakeLists.txt
@@ -83,6 +83,7 @@ target_include_directories(SPIRV-Tools-r
 	$<INSTALL_INTERFACE:${CMAKE_INSTALL_INCLUDEDIR}>
   PRIVATE ${spirv-tools_BINARY_DIR}
 )
+set_target_properties(SPIRV-Tools-reduce PROPERTIES SOVERSION suse15)
 # The reducer reuses a lot of functionality from the SPIRV-Tools library.
 target_link_libraries(SPIRV-Tools-reduce
   PUBLIC ${SPIRV_TOOLS}

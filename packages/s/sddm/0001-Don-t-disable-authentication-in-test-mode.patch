From ba1a742322378eed325cfd78e089102eabceb6d0 Mon Sep 17 00:00:00 2001
From: Fabian Vogt <fabian@ritter-vogt.de>
Date: Fri, 9 Oct 2020 20:53:34 +0200
Subject: [PATCH] Don't disable authentication in --test-mode

For some reason Xephyr was started with the "-ac" option, although handling
of the auth file is completely functional.

(cherry picked from commit bb8e817493020113e1b0f3207f7bbcd1593e9c9e)
---
 src/daemon/XorgDisplayServer.cpp | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

diff --git a/src/daemon/XorgDisplayServer.cpp b/src/daemon/XorgDisplayServer.cpp
index 28ce524..80b2227 100644
--- a/src/daemon/XorgDisplayServer.cpp
+++ b/src/daemon/XorgDisplayServer.cpp
@@ -128,7 +128,7 @@ namespace SDDM {
 
         if (daemonApp->testing()) {
             QStringList args;
-            args << m_display << QStringLiteral("-ac") << QStringLiteral("-br") << QStringLiteral("-noreset") << QStringLiteral("-screen") << QStringLiteral("800x600");
+            args << m_display << QStringLiteral("-auth") << m_authPath << QStringLiteral("-br") << QStringLiteral("-noreset") << QStringLiteral("-screen") << QStringLiteral("800x600");
             process->start(mainConfig.X11.XephyrPath.get(), args);
 
 
-- 
2.25.1


Index: socat-1.7.4.1/filan.c
===================================================================
--- socat-1.7.4.1.orig/filan.c
+++ socat-1.7.4.1/filan.c
@@ -20,6 +20,10 @@
 
 #include "filan.h"
 
+#ifdef WITH_LIBWRAP
+#include <tcpd.h>
+#endif
+
 
 struct sockopt {
    int so;
Index: socat-1.7.4.1/procan.c
===================================================================
--- socat-1.7.4.1.orig/procan.c
+++ socat-1.7.4.1/procan.c
@@ -16,6 +16,9 @@
 #include "filan.h"
 
 #include <sys/resource.h>
+#ifdef WITH_LIBWRAP
+#include <tcpd.h>
+#endif
 
 #include "procan.h"
 
Index: socat-1.7.4.1/xio-tcpwrap.c
===================================================================
--- socat-1.7.4.1.orig/xio-tcpwrap.c
+++ socat-1.7.4.1/xio-tcpwrap.c
@@ -13,6 +13,7 @@
 #include "xio-tcpwrap.h"
 
 
+
 #if (WITH_TCP || WITH_UDP) && WITH_LIBWRAP
 
 const struct optdesc opt_tcpwrappers = { "tcpwrappers", "tcpwrap", OPT_TCPWRAPPERS, GROUP_RANGE,  PH_ACCEPT, TYPE_STRING_NULL, OFUNC_SPEC };

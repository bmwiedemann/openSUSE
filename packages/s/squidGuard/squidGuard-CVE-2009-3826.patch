Index: squidGuard-1.4/src/sg.h.in
===================================================================
--- squidGuard-1.4.orig/src/sg.h.in
+++ squidGuard-1.4/src/sg.h.in
@@ -73,7 +73,7 @@ int tolower();
 #define REQUEST_TYPE_REDIRECT   2
 #define REQUEST_TYPE_PASS       3
 
-#define MAX_BUF 4096
+#define MAX_BUF 12288
 
 #define DEFAULT_LOGFILE "squidGuard.log"
 #define WARNING_LOGFILE "squidGuard.log"
Index: squidGuard-1.4/src/sgDiv.c.in
===================================================================
--- squidGuard-1.4.orig/src/sgDiv.c.in
+++ squidGuard-1.4/src/sgDiv.c.in
@@ -745,7 +745,7 @@ char *sgParseRedirect(redirect, req, acl
       p++;
       break;
     case 'u': /* Requested URL */
-      strcat(buf, req->orig);
+      strncat(buf, req->orig, 2048);
       p++;
       break;
     default:

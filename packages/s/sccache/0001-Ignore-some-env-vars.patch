From b1af4f10aa3ec94b2f16d092cfd9f0025a1c5f58 Mon Sep 17 00:00:00 2001
From: William Brown <william@blackhats.net.au>
Date: Sun, 27 Mar 2022 11:19:09 +1000
Subject: [PATCH] Ignore some env vars

---
 src/cmdline.rs | 14 +++++++++++++-
 1 file changed, 13 insertions(+), 1 deletion(-)

diff --git a/src/cmdline.rs b/src/cmdline.rs
index 13773c7..bd89cb3 100644
--- a/src/cmdline.rs
+++ b/src/cmdline.rs
@@ -208,7 +208,19 @@ pub fn parse() -> Result<Command> {
             //
             // FIXME: Maybe we should strip out `LD_PRELOAD` always?
             if env::var_os("RUNNING_UNDER_RR").is_some() {
-                env_vars.retain(|(k, _v)| k != "LD_PRELOAD" && k != "RUNNING_UNDER_RR");
+                env_vars.retain(|(k, _v)|
+                    k != "LD_PRELOAD" &&
+                    k != "RUNNING_UNDER_RR" &&
+                    k != "HOSTNAME" &&
+                    k != "PWD" &&
+                    k != "HOST" &&
+                    k != "RPM_BUILD_ROOT" &&
+                    k != "SOURCE_DATE_EPOCH" &&
+                    k != "RPM_PACKAGE_RELEASE" &&
+                    k != "MINICOM" &&
+                    k != "DESTDIR" &&
+                    k != "RPM_PACKAGE_VERSION"
+                );
             }
 
             Ok(Command::Compile {
-- 
2.32.0 (Apple Git-132)


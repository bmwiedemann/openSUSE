https://github.com/shadow-maint/shadow/commit/497e90751bc0d95cc998b0f06305040563903948
Index: shadow-4.9/src/newgrp.c
===================================================================
--- shadow-4.9.orig/src/newgrp.c
+++ shadow-4.9/src/newgrp.c
@@ -163,8 +163,8 @@ static void check_perms (const struct gr
 	spwd = xgetspnam (pwd->pw_name);
 	if (NULL != spwd) {
 		pwd->pw_passwd = xstrdup (spwd->sp_pwdp);
+	    spw_free (spwd);
 	}
-	spw_free (spwd);
 
 	if ((pwd->pw_passwd[0] == '\0') && (grp->gr_passwd[0] != '\0')) {
 		needspasswd = true;

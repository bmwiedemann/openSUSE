From b894975bedb2b9e01385261183db19f7d0642292 Mon Sep 17 00:00:00 2001
From: Frediano Ziglio <freddy77@gmail.com>
Date: Tue, 22 Sep 2020 11:45:56 +0100
Subject: [PATCH] vdagent-connection: Pass "err" to g_credentials_get_unix_pid
MIME-Version: 1.0
Content-Type: text/plain; charset=UTF-8
Content-Transfer-Encoding: 8bit

Git-commit: b894975bedb2b9e01385261183db19f7d0642292
References: bsc#1173749

Allows to return detailed information if g_credentials_get_unix_pid
fails.

Signed-off-by: Frediano Ziglio <freddy77@gmail.com>
Acked-by: Julien Rop√© <jrope@redhat.com>
Signed-off-by: Bruce Rogers <brogers@suse.com>
---
 src/vdagent-connection.c | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

diff --git a/src/vdagent-connection.c b/src/vdagent-connection.c
index ede784b..ff8b88d 100644
--- a/src/vdagent-connection.c
+++ b/src/vdagent-connection.c
@@ -155,7 +155,7 @@ gint vdagent_connection_get_peer_pid(VDAgentConnection *self,
     sock = g_socket_connection_get_socket(G_SOCKET_CONNECTION(priv->io_stream));
     cred = g_socket_get_credentials(sock, err);
     if (cred) {
-        pid = g_credentials_get_unix_pid(cred, NULL);
+        pid = g_credentials_get_unix_pid(cred, err);
         g_object_unref(cred);
     }
 
-- 
2.29.0


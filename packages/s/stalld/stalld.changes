-------------------------------------------------------------------
Tue Sep 16 20:36:38 UTC 2025 - Marco Chiappero <marco.chiappero@suse.com>

- update to 1.21.1: 
  * systemd: fix duplicate ExecStart in service files (previously
             provided by systemd-execstart.patch, now removed)
  * systemd: change systemd service startup to use RuntimeDirectory
             (previously provided by run-dir.patch, now removed)
  * stalld: cleanup and refactorning
  * stalld: fix erroneous log messages, stale PIDs are now purged
            as soon as they are detected
  * bpf: cleanup and refactoring; improved code quality and comments
  * bpf: improved logging
  * bpf: support field `thread_info.cpu` in newer kernels (and `cpu` on
         older ones) from `struct task_struct`
  * bpf: fix cpu_data->nr_rt_running not reset when a non-RT task
         was scheduled next
  * bpf: fix bpf_get_smp_processor_id() used to determine the exact CPU
         the task is running on
  * bpf: add a BPF handler for the `sched_migrate_task` tracepoint to
         accurately track tasks as they move between CPUs
  * bpf: capture an initial state snapshot of system tasks at startup
  * bpf: levergate CO-RE to reliably determine if a task is in the
         TASK_RUNNING state across different kernel versions
  * bpf: fix a possible startup stall by adding non-blocking BTF
         tracepoints

-------------------------------------------------------------------
Tue Aug 19 17:11:49 UTC 2025 - Marco Chiappero <marco.chiappero@suse.com>

- Add run-dir.patch:
  *  let the systemd unit file create /run/stalld with the proper
     permissions

-------------------------------------------------------------------
Mon Aug 18 19:10:36 UTC 2025 - Marco Chiappero <marco.chiappero@suse.com>

- Add systemd-execstart.patch:
  * fix "Service has more than one ExecStart= setting" error
    introduced in 9f2e4fc3
- Add util-linux to the dependencies due to chrt

-------------------------------------------------------------------
Mon Aug 18 13:17:38 UTC 2025 - Dirk Müller <dmueller@suse.com>

- update to 1.20.3:
  * stalld.service: Fix failure to set FIFO scheduling class
  * bpf: Improve task tracking in sched_switch
  * bpf/stalld: Introduce compute_ctxswc helper and update ctxswc
    on sched_switch
  * stalld: Automatically switch to log-only mode if DL-server
    present
  * bpf/stalld: Implement and use find_queued_task helper in
    dequeue_task
  * bpf/stalld: Introduce and use for_each_task_entry/
    for_each_queued_task macros
  * stalld: sched_attr: Do not define for glibc >= 2.41
  * stalld: Refactor verbose logging with dedicated macros
  * bpf/stalld: Introduce generic 'log' macro for BPF debug prints
  * bpf/stalld: Unify and generalize debug macro to DEBUG_STALLD

-------------------------------------------------------------------
Mon Aug 18 10:28:10 UTC 2025 - Dirk Müller <dmueller@suse.com>

- build with BPF support on aarch64/x86_64

-------------------------------------------------------------------
Mon Mar 10 11:04:00 UTC 2025 - Christophe Marin <christophe@krop.fr>

- Update to 1.19.8. Check https://gitlab.com/rt-linux-tools/stalld/-/releases
  for the full list of changes.
  Changes since 1.19.6:
  * Address CVE-2024-54159, which is a DoS issue with the way
    throttlectl.sh uses temp files (boo#1230327)
  * Fix a compilation issue with a prototype mis-match in
    stalld.h and utils.c for cleanup_regex()
  * Workaround missing sched_getattr() export from glibc
  * Fix a problem with parsing /sys/kernel/debug/sched/debug on
    aarch64
- Drop patches:
  * pid-dir.patch
  * fixed-tmpfile-fix.patch

-------------------------------------------------------------------
Thu Nov 28 08:53:21 UTC 2024 - Matthias Gerstner <matthias.gerstner@suse.com>

- add fixed-tmpfile-fix.patch: place the original scheduling values in a
  root-owned directory in /run/stalld, not into the public /tmp directory
  (bsc#1230327).

-------------------------------------------------------------------
Tue Aug 27 07:56:21 UTC 2024 - Marcus Meissner <meissner@suse.com>

- use source url, some spec cleanups
- use common set of systemd macros

-------------------------------------------------------------------
Tue Aug 27 07:54:27 UTC 2024 - Marcus Meissner <meissner@suse.com>

- initial package

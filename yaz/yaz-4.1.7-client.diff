--- yaz-4.0.12/client/client.c.orig	2010-08-16 13:05:23.000000000 +0200
+++ yaz-4.0.12/client/client.c	2010-08-25 14:02:44.000000000 +0200
@@ -2533,6 +2533,7 @@
         int noread = 0;
         Odr_oid *oid;
         char oid_str[51];
+        union { unsigned char **ucp; char **cp; }pun;
         Z_APDU *apdu = zget_APDU(out, Z_APDU_extendedServicesRequest);
         Z_ExtendedServicesRequest *req = apdu->u.extendedServicesRequest;
 
@@ -2552,7 +2553,8 @@
             return 0;
         }
         arg += noread;
-        if (parse_cmd_doc(&arg, out, &asn_buf,
+        pun.ucp = &ext->u.single_ASN1_type->buf;
+        if (parse_cmd_doc(&arg, out, pun.ucp,
                           &ext->u.single_ASN1_type->len) == 0)
             return 0;
 

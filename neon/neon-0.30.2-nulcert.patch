From 1678726ca3198f0a495a26647cdc7c8ed2e3c709 Mon Sep 17 00:00:00 2001
From: Joe Orton <jorton@redhat.com>
Date: Wed, 14 Aug 2019 15:47:48 +0100
Subject: [PATCH] * test/ssl.c: Update failures since the nul*.pem certs
 expired.

---
 test/ssl.c | 4 ++--
 1 file changed, 2 insertions(+), 2 deletions(-)

diff --git a/test/ssl.c b/test/ssl.c
index 870a3de..266b2a5 100644
--- a/test/ssl.c
+++ b/test/ssl.c
@@ -889,7 +889,7 @@ static int fail_nul_cn(void)
     CALL(fail_ssl_request_with_error2(nul_cn_fn, key, ca,
                                       "www.bank.com", "localhost",
                                       "certificate with incorrect CN was accepted",
-                                      NE_SSL_IDMISMATCH,
+                                      NE_SSL_IDMISMATCH|NE_SSL_EXPIRED|NE_SSL_BADCHAIN,
                                       "certificate issued for a different hostname"));
     ne_free(key);
     ne_free(ca);
@@ -904,7 +904,7 @@ static int fail_nul_san(void)
     CALL(fail_ssl_request_with_error2(cert, key, ca, 
                                       "www.bank.com", "localhost",
                                       "certificate with incorrect CN was accepted",
-                                      NE_SSL_IDMISMATCH,
+                                      NE_SSL_IDMISMATCH|NE_SSL_EXPIRED|NE_SSL_BADCHAIN,
                                       "certificate issued for a different hostname"));
     ne_free(cert);
     ne_free(key);
-- 
2.16.4


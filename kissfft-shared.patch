Index: kissfft-131/Makefile
===================================================================
--- kissfft-131.orig/Makefile
+++ kissfft-131/Makefile
@@ -1,18 +1,38 @@
 KFVER=131
 
+SRCDIR = .
+PREFIX ?= /usr
+CFLAGS ?= $(RPM_OPT_FLAGS)
+LBITS := $(shell getconf LONG_BIT)
+ifeq ($(LBITS),64)
+LIBDIR ?= $(PREFIX)/lib64
+else
+LIBDIR ?= $(PREFIX)/lib
+endif
+
 ifeq ($(shell uname -s),Darwin)
 	SHARED := -Wl,-install_name,libkissfft.dylib -o libkissfft.dylib
 else
-	SHARED := -Wl,-soname,libkissfft.so -o libkissfft.so
+	SHARED := -Wl,-soname,libkissfft-$(KFVER).so -o libkissfft-$(KFVER).so
 endif
 
+HEADERS= \
+	$(SRCDIR)/kiss_fft.h \
+	$(SRCDIR)/kissfft.hh \
+	$(SRCDIR)/tools/kfc.h \
+	$(SRCDIR)/tools/kiss_fftnd.h \
+	$(SRCDIR)/tools/kiss_fftndr.h \
+	$(SRCDIR)/tools/kiss_fftr.h
+
 all:
-	gcc -Wall -fPIC -c *.c -Dkiss_fft_scalar=float -o kiss_fft.o
-	ar crus libkissfft.a kiss_fft.o
+	$(CC) -Wall -fPIC $(CFLAGS) -c *.c -Dkiss_fft_scalar=float -o kiss_fft.o
 	gcc -shared $(SHARED) kiss_fft.o
 
 install: all
-	cp libkissfft.so /usr/local/lib/
+	mkdir -p $(DESTDIR)$(LIBDIR) $(DESTDIR)$(PREFIX)/include/kissfft
+	install -p -m 0755 libkissfft-$(KFVER).so $(DESTDIR)$(LIBDIR)
+	ln -s $(LIBDIR)/libkissfft-$(KFVER).so $(DESTDIR)$(LIBDIR)/libkissfft.so
+	install -p -m 0644 $(HEADERS) $(DESTDIR)$(PREFIX)/include/kissfft
 
 doc:
 	@echo "Start by reading the README file.  If you want to build and test lots of stuff, do a 'make testall'"
